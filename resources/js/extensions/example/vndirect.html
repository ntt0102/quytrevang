<!DOCTYPE html>

<head>
  <title>WebSocket client test</title>
</head>

<body>
  <h1>WebSocket Vndirect</h1>
</body>

<script language="javascript" type="text/javascript">
  var wsUri = "wss://price-api.vndirect.com.vn/realtime";
  // var wsUri =
  //   "wss://notiv2.vndirect.com.vn/notisocket/noti/108/91ra1155/websocket";
  function testWebSocket() {
    websocket = new WebSocket(wsUri);
    websocket.onopen = function (evt) {
      console.log("onopen", evt);
      websocket.send("a");
      // websocket.send("s|CF:10,11,12,13,02,03,VN100");
      websocket.send("s|D:VN30F2211");
      // websocket.send("ss|D:code=VN30F2211");
      // ss|D:code=VN30F2306,VN30F2212,GB10F2212,GB10F2306,GB05F2306,VN30F2303,GB10F2303,VN30F2211,GB05F2303,GB05F2212
      // s|D:VN30F2306,VN30F2212,GB10F2212,GB10F2306,GB05F2306,VN30F2303,GB10F2303,VN30F2211,GB05F2303,GB05F2212
    };
    websocket.onclose = function (evt) {
      console.log("onclose", evt);
      testWebSocket();
    };
    websocket.onmessage = function (evt) {
      console.log("onmessage", evt.data);
      if (evt.data == 0) websocket.send("1");
    };
    websocket.onerror = function (evt) {
      console.log("onerror", evt);
    };
  }
  window.addEventListener("load", testWebSocket, false);
</script>
