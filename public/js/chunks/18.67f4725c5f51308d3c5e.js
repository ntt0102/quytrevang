(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"AZ+H":function(t,e,r){"use strict";r("XW7c")},"LI/c":function(t,e,r){"use strict";function n(){return{contracts:[],interestRate:0,principalMin:0,holdWeeksMin:0,transferInfo:null,updatedAt:null}}var a={fetch:function(t){var e=t.commit,r=(t.dispatch,t.getters,t.state),n=(t.rootGetters,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);return!(moment().diff(r.updatedAt,"seconds")<3)&&new Promise((function(t,r){axios.get("contract?isOld="+n).then((function(r){e("setState",r.data),t()}))}))},save:function(t,e){t.commit;var r=t.dispatch;t.getters,t.state,t.rootGetters;return new Promise((function(t,n){axios.post("contract",e).then((function(e){r("fetch"),r("Auth/fetch",!0,{root:!0}),t(e.data)}))}))},payingContract:function(t,e){t.commit;var r=t.dispatch;t.getters,t.state,t.rootGetters;return new Promise((function(t,n){axios.post("contract/paying",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){e.data.isOk&&r("fetch"),t(e.data.isOk)}))}))},withdrawingContract:function(t,e){t.commit;var r=t.dispatch;t.getters,t.state;return new Promise((function(t,n){axios.post("contract/withdrawing",e).then((function(e){e.data.isOk&&r("fetch"),t(e.data.isOk)}))}))},resetState:function(t){(0,t.commit)("resetState")}},i={setState:function(t,e){t.contracts=e.contracts,t.interestRate=e.interestRate,t.principalMin=e.principalMin,t.holdWeeksMin=e.holdWeeksMin,t.transferInfo=e.transferInfo,t.updatedAt=moment()},resetState:function(t){t=Object.assign(t,{contracts:[],interestRate:0,principalMin:0,holdWeeksMin:0,transferInfo:null,updatedAt:null})}};e.a={namespaced:!0,state:n,getters:{contracts:function(t){return t.contracts},interestRate:function(t){return t.interestRate},principalMin:function(t){return t.principalMin},holdWeeksMin:function(t){return t.holdWeeksMin},transferInfo:function(t){return t.transferInfo}},actions:a,mutations:i}},XW7c:function(t,e,r){var n=r("ojnz");"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,a);n.locals&&(t.exports=n.locals)},Zkhe:function(t,e,r){"use strict";r.r(e);var n=r("L2JU"),a=r("0woa"),i=r("thsF"),s=r("LI/c");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u={components:{DxDataGrid:a.DxDataGrid,DxColumn:a.DxColumn,ContractDetailPopup:i.a},data:function(){return{gridData:null,sum:{},interval:{},change:{},doneFlag:!1,asset:null,principal:null,interest:null}},beforeCreate:function(){this.$store.registerModule("User.contract",s.a)},created:function(){var t=this;this.fetch(!1).then((function(){t.gridData=t.contracts,t.calculateSummary()}))},destroyed:function(){this.$store.unregisterModule("User.contract")},computed:l(l(l({},Object(n.c)("User.contract",["contracts"])),Object(n.c)("Auth",["level"])),{},{dataGrid:function(){return this.$refs.dataGrid.instance}}),methods:l(l({},Object(n.b)("User.contract",["fetch","resetState"])),{},{onRowPrepared:function(t){"header"==t.rowType&&(t.rowElement.style.display="none")},getStatusClass:function(t){return"status-".concat(t)},calculateSummary:function(){var t=this;this.sum=this.gridData.reduce((function(t,e){return[2,3].includes(e.status)&&(t.principal+=e.principal,t.interest+=e.interest,t.asset+=e.total),t}),{principal:0,interest:0,asset:0}),this.calculateChange(),this.interval=setInterval((function(){t.animatedNumber("principal"),t.animatedNumber("interest"),t.animatedNumber("asset"),t.doneFlag&&clearInterval(t.interval)}),4)},calculateChange:function(){this.change={principal:this.sum.principal/25,interest:this.sum.interest/25,asset:this.sum.asset/25}},animatedNumber:function(t){this[t]<this.sum[t]-this.change[t]?(this[t]+=this.change[t],this.doneFlag=!1):(this[t]=this.sum[t],this.doneFlag=!0)}})},p=(r("AZ+H"),r("KHd+")),f=Object(p.a)(u,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"overview-contracts"},[e("div",{staticClass:"sum dx-card responsive-paddings content-block"},[e("div",[e("div",{staticClass:"title"},[t._v(t._s(t.$t("user.overview.assetSum")))]),t._v(" "),null!=t.asset?e("div",{staticClass:"currency"},[t._v("\n        "+t._s(t._f("currency")(t.asset.toFixed(0)))+"\n      ")]):e("div",[t._v("-")])]),t._v(" "),e("div",[e("div",{staticClass:"title"},[t._v(t._s(t.$t("user.overview.principalSum")))]),t._v(" "),null!=t.principal?e("div",{staticClass:"currency"},[t._v("\n        "+t._s(t._f("currency")(t.principal.toFixed(0)))+"\n      ")]):e("div",[t._v("-")])]),t._v(" "),e("div",[e("div",{staticClass:"title"},[t._v(t._s(t.$t("user.overview.interestSum")))]),t._v(" "),null!=t.interest?e("div",{staticClass:"currency interest"},[t._v("\n        "+t._s(t._f("currency")(t.interest.toFixed(0),"+ "))+"\n      ")]):e("div",[t._v("-")])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.level>=6,expression:"level >= 6"}],staticClass:"list content-block"},[e("DxDataGrid",{ref:"dataGrid",attrs:{"data-source":t.gridData,"key-expr":"id","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate"},on:{contentReady:function(e){return t.$mf.dataGridPreload(t.gridData,t.dataGrid)},rowPrepared:t.onRowPrepared},scopedSlots:t._u([{key:"dataRowTemplate",fn:function(r){var n=r.data;return[e("tr",{staticClass:"item",attrs:{role:"cell"},on:{click:function(e){return t.$refs.contractDetailPopup.show(n.data)}}},[e("td",[e("div",{staticClass:"responsive-paddings",staticStyle:{position:"relative"}},[e("div",{class:["status",t.getStatusClass(n.data.status)]}),t._v(" "),e("div",{staticClass:"info"},[e("div",[e("span",[t._v("#"+t._s(n.data.code))]),t._v(" "),e("span",{staticClass:"interest-rate"},[t._v("\n                    "+t._s(t._f("percentInterestRate")(n.data.interest_rate))+"\n                  ")])]),t._v(" "),e("div",{staticClass:"date"},[e("div",[t._v("\n                    "+t._s(t._f("formatDate")(n.data.paid_at))+" ~\n                    "+t._s(t._f("formatDate")(n.data.withdrawn_at))+"\n                     \n                  ")]),t._v(" "),e("div",[t._v("("+t._s(n.data.duration)+")")])])]),t._v(" "),e("div",{staticClass:"currency"},[e("div",{staticClass:"principal"},[t._v("\n                  "+t._s(t._f("currency")(n.data.principal))+"\n                ")]),t._v(" "),e("div",{staticClass:"interest"},[t._v("\n                  "+t._s(t._f("currency")(n.data.interest,"+ "))+"\n                ")])])])])])]}}])},[e("DxColumn")],1)],1),t._v(" "),e("ContractDetailPopup",{ref:"contractDetailPopup"})],1)}),[],!1,null,null,null);e.default=f.exports},gFUj:function(t,e,r){"use strict";r("xTcV")},ojnz:function(t,e,r){(e=t.exports=r("I1BE")(!1)).push([t.i,".overview-contracts .sum{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:15px}.overview-contracts .sum>div{text-align:center;display:flex;align-items:center}.overview-contracts .sum>div .title{margin-right:10px;color:#b3b3b3}.overview-contracts .sum .currency{font-size:20px}.overview-contracts .sum .currency.interest{color:#0f0}.overview-contracts .list .dx-datagrid-headers{border-bottom:none}.overview-contracts .list .item{position:relative}.overview-contracts .list .item td{padding:0;cursor:pointer;border-bottom:5px solid #2a2a32}.overview-contracts .list .item .responsive-paddings{padding:10px 15px 10px 25px}.overview-contracts .list .status{position:absolute;top:8px;bottom:12px;left:8px;width:5px;border-radius:2px}.overview-contracts .list .status.status-0,.overview-contracts .list .status.status-1{background:#adadad}.overview-contracts .list .status.status-2{background:#86c285}.overview-contracts .list .status.status-3{background:#edc578}.overview-contracts .list .status.status-4{background:#ef7d59}.overview-contracts .list .info{display:flex;justify-content:space-between;color:#b3b3b3}.overview-contracts .list .info .interest-rate{margin-left:20px}.overview-contracts .list .info .date{display:flex;flex-wrap:wrap}.overview-contracts .list .currency{display:flex;flex-wrap:wrap;align-items:center;margin-top:10px}.overview-contracts .list .currency>div:first-child{margin-right:auto}.overview-contracts .list .currency .interest{color:#0f0;font-size:20px}.overview-contracts .list .currency .principal{font-size:20px;color:#fff}body[screen-size=small] .overview-contracts .sum>div{width:100%;justify-content:space-between}body[screen-size=small] .overview-contracts .list .info{flex-direction:column}",""]),e.locals={baseAccent:"#ff5722"}},t1Kn:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,".contract-detail .interest-item .dx-texteditor-input{color:#0f0;font-weight:700}.contract-detail .contract{display:flex;flex-wrap:wrap;padding:0}.contract-detail .contract>div{flex:50%;max-width:50%;padding:0 4px}.contract-detail .contract>div>img{margin-top:8px;vertical-align:middle;width:100%}body[screen-size=small] .contract-detail .contract>div{flex:100%;max-width:100%}",""])},thsF:function(t,e,r){"use strict";var n=r("Ztyd"),a={components:{DxForm:r.n(n).a,DxItem:n.DxItem},data:function(){return{enabled:!1,formData:{url_paid_docs:[],url_withdrawn_docs:[]}}},computed:{popup:function(){return this.$refs.popup.instance},hasConfirmedDocs:function(){return this.formData.url_paid_docs.length>0||this.formData.url_withdrawn_docs.length>0}},methods:{show:function(t){var e=this;this.popup.option("title","".concat(this.$t("models.contract.popup.detail")," #").concat(t.code)),this.popup.show(),this.formData=t,this.$mf.pushPopupToHistoryState((function(){return e.popup.hide()}))}}},i=(r("gFUj"),r("KHd+")),s=Object(i.a)(a,(function(){var t=this,e=t._self._c;return e("DxPopup",{ref:"popup",attrs:{showCloseButton:!0,fullScreen:!!t.$devices.phone,"show-title":!0},on:{hiding:t.$mf.popRouteHistoryState},scopedSlots:t._u([{key:"content",fn:function(){return[e("DxForm",{staticClass:"contract-detail",attrs:{"form-data":t.formData,"read-only":!0,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[e("DxItem",{attrs:{"col-count":2,"item-type":"group"}},[e("DxItem",{attrs:{"data-field":"status","editor-type":"dxSelectBox","editor-options":{searchEnabled:!1,items:t.$mf.getContractStatusList(),displayExpr:"name",valueExpr:"value"},label:{text:t.$t("models.contract.status")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"principal","editor-type":"dxNumberBox","editor-options":{format:"#,##0 ₫"},label:{text:t.$t("models.contract.principal")}}}),t._v(" "),e("DxItem",{attrs:{"css-class":"interest-item","data-field":"interest","editor-type":"dxNumberBox","editor-options":{format:"#,##0 ₫"},label:{text:t.$t("models.contract.interest")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"interest_rate","editor-type":"dxNumberBox","editor-options":{format:"#0.# %/"+t.$t("models.contract.frequency")},label:{text:t.$t("models.contract.interestRate")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"paid_at","editor-type":"dxDateBox",label:{text:t.$t("models.contract.paidAt")}}}),t._v(" "),t.formData.withdrawn_at?e("DxItem",{attrs:{"data-field":"withdrawn_at","editor-type":"dxDateBox",label:{text:t.$t("models.contract.withdrawnAt")}}}):t._e(),t._v(" "),e("DxItem",{attrs:{"data-field":"duration",label:{text:t.$t("models.contract.duration")}}})],1),t._v(" "),e("DxItem",{attrs:{visible:t.hasConfirmedDocs,"item-type":"group","col-span":2,caption:t.$t("models.contract.receipt")}},[e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("Photoswipe",{on:{opened:t.$mf.pushPhotoswipeToHistoryState,close:t.$mf.popRouteHistoryState}},[t._l(t.formData.url_paid_docs,(function(r,n){return e("div",{key:10+n},[e("img",{directives:[{name:"pswp",rawName:"v-pswp",value:r,expression:"image"}],attrs:{src:r,alt:t.$appName}})])})),t._v(" "),t._l(t.formData.url_withdrawn_docs,(function(r,n){return e("div",{key:20+n},[e("img",{directives:[{name:"pswp",rawName:"v-pswp",value:r,expression:"image"}],attrs:{src:r,alt:t.$appName}})])}))],2)]},proxy:!0}])})],1)],1)]},proxy:!0}])})}),[],!1,null,null,null);e.a=s.exports},xTcV:function(t,e,r){var n=r("t1Kn");"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,a);n.locals&&(t.exports=n.locals)}}]);