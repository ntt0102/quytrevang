/*! For license information please see 26.c26d9951c09f3fce99ad.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"6tsc":function(t,e,r){"use strict";r.r(e);var n=r("L2JU");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,a=void 0,a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===i(a)?a:String(a)),n)}var o,a}var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.create()}var e,r,n;return e=t,(r=[{key:"create",value:function(){var t=this;return new Promise((function(e,r){var n=indexedDB.open("orderChart",1);n.onupgradeneeded=function(r){console.log("onupgradeneeded"),t.store=r.target.result,t.store.createObjectStore("order",{keyPath:"kind"}),t.store.createObjectStore("line",{keyPath:"price"}),t.store.createObjectStore("ruler",{keyPath:"point"}),e()},n.onsuccess=function(r){console.log("onsuccess"),t.store=r.target.result,e()},n.onerror=function(){console.log("onerror"),location.reload(),r()}}))}},{key:"get",value:function(t){var e=this.store;return new Promise((function(n,i){var o=e.transaction(t,"readonly");if(Array.isArray(t)){var a=t.map((function(t){return o.objectStore(t)})).map(r);Promise.all(a).then((function(t){return n(t)}))}else r(o.objectStore(t)).then((function(t){return n(t)}))}));function r(t){return new Promise((function(e,r){var n=t.getAll();n.onsuccess=function(t){return e(t.target.result)},n.onerror=function(){return r()}}))}}},{key:"set",value:function(t,e){var r=this.store.transaction(t,"readwrite").objectStore(t);Array.isArray(e)?e.length>0&&e.forEach((function(t){return r.put(t)})):r.put(e)}},{key:"clear",value:function(t){var e=this.store;return new Promise((function(r,n){var i=e.transaction(t,"readwrite").objectStore(t).clear();i.onsuccess=function(){r()},i.onerror=function(e){console.error("Error to empty Object Store: ".concat(t)),n()}}))}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function s(){return{config:{},status:{connection:!0},chartData:[],isChartLoading:!1}}var c={namespaced:!0,state:s,getters:{config:function(t){return t.config},status:function(t){return t.status},chartData:function(t){return t.chartData},isChartLoading:function(t){return t.isChartLoading}},actions:{getChartData:function(t,e){var r=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return r("setChartLoading",!0),new Promise((function(t,n){axios.post("order-chart",{date:e},{noLoading:!0,crypto:!0}).then((function(e){r("setChartData",e.data),r("setChartLoading",!1),t()}))}))},getStatus:function(t){var e=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return new Promise((function(t,r){axios.post("order-chart/get-status",{},{noLoading:!0,crypto:!0}).then((function(r){e("setStatus",r.data),t()}))}))},getConfig:function(t){var e=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return new Promise((function(t,r){axios.post("order-chart/get-config",{},{crypto:!0}).then((function(r){e("setConfig",r.data),t()}))}))},setConfig:function(t,e){var r=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return new Promise((function(t,n){axios.post("order-chart/set-config",{date:e},{noLoading:!0,crypto:!0}).then((function(e){r("setChartData",e.data),t()}))}))},executeOrder:function(t,e){var r=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return r("setChartLoading",!0),new Promise((function(t,n){axios.post("order-chart/execute-order",e,{noLoading:!0,crypto:!0,notify:!0}).then((function(e){r("setChartLoading",!1),t(e.data)}))}))},resetState:function(t){(0,t.commit)("resetState")}},mutations:{setChartData:function(t,e){t.chartData=e},setChartLoading:function(t,e){t.isChartLoading=e},setStatus:function(t,e){t.status=e},setConfig:function(t,e){t.config=e},resetState:function(t){t=Object.assign(t,{config:{},status:{connection:!0},chartData:[],isChartLoading:!1})}}},d=r("Ugxn");function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(){p=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new P(i||[]);return n(a,"_invoke",{value:x(t,r,s)}),a}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var h={};function f(){}function m(){}function g(){}var v={};c(v,o,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(T([])));b&&b!==e&&r.call(b,o)&&(v=b);var O=g.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){var i;n(this,"_invoke",{value:function(n,o){function a(){return new e((function(i,a){!function n(i,o,a,s){var c=u(t[i],t,o);if("throw"!==c.type){var d=c.arg,h=d.value;return h&&"object"==l(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(h).then((function(t){d.value=t,a(d)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}(n,o,i,a)}))}return i=i?i.then(a,a):a()}})}function x(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return E()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=k(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function k(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=g,n(O,"constructor",{value:g,configurable:!0}),n(g,"constructor",{value:m,configurable:!0}),m.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(O),t},t.awrap=function(t){return{__await:t}},w(C.prototype),c(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new C(d(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(O),c(O,s,"Generator"),c(O,o,(function(){return this})),c(O,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function f(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.2,bottom:.1}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!0,rightOffset:20,minBarSpacing:.05}},b=moment().format("YYYY-MM-DD"),O=moment(b+" 08:45:00").unix(),w=moment(b+" 09:00:00").unix(),C=moment(b+" 14:30:00").unix(),x=moment(b+" 14:45:00").unix(),k={data:function(){return{chart:{},series:{},data:{whitespace:[],price:[]},order:{side:0,position:0,entry:{},tp:{},sl:{}},lines:[],ruler:{start:{},end:{},point:0},crosshair:{},loadWhitespace:!0,chartDate:b,interval:null,interval60:null,clock:moment().format("HH:mm:ss"),isFullscreen:!1,websocket:null,isAutoOrdering:!1}},beforeCreate:function(){if(this.$store.registerModule("Trading.orderChart",c),!document.getElementById("orderChartJs")){var t=document.createElement("script");t.src="/js/order-chart.min.js",t.id="orderChartJs",document.getElementsByTagName("head")[0].appendChild(t)}},created:function(){this.getConfig().then(this.connectSocket),this.getStatus(),this.interval=setInterval(this.intervalHandler,1e3),this.interval60=setInterval(this.getStatus,6e4),a.create()},mounted:function(){var t=this;setTimeout((function(){t.chart=LightweightCharts.createChart(t.$refs.orderChart,y),t.chartContainer.addEventListener("click",t.eventChartClick),t.chartContainer.addEventListener("contextmenu",t.eventChartContextmenu),t.chart.subscribeCrosshairMove(t.eventChartCrosshairMove),t.chart.subscribeCustomPriceLineDragged(t.eventPriceLineDrag),t.series.whitespace=t.chart.addLineSeries({priceScaleId:"whitespace",visible:!1}),t.series.price=t.chart.addLineSeries({color:"#CCCCCC",priceFormat:{minMove:.1}}),new ResizeObserver(t.eventChartResize).observe(t.chartContainer),window.addEventListener("keydown",t.eventKeyPress),document.addEventListener("fullscreenchange",t.eventFullscreenChange),t.getChartData(t.chartDate).then((function(){t.loadToolsData(),t.loadWhitespace=!0}))}),1e3)},destroyed:function(){this.$store.unregisterModule("Trading.orderChart"),clearInterval(this.interval),clearInterval(this.interval60),this.websocket.close(),this.websocket=null},computed:g(g({},Object(n.c)("Trading.orderChart",["chartData","status","config","isChartLoading"])),{},{chartContainer:function(){return this.$refs.chartContainer},lastPrice:function(){return this.data.price.slice(-1)[0]}}),watch:{chartData:function(){this.loadChartData()},isChartLoading:function(t){this.$refs.spinner.style.display=t?"block":"none"}},methods:g(g({},Object(n.b)("Trading.orderChart",["getChartData","getStatus","getConfig","executeOrder"])),{},{eventChartContextmenu:function(t){this.showOrderButton(),t.preventDefault()},eventChartClick:function(){this.hideOrderButton(),this.$refs.lineTool.classList.contains("selected")?this.drawLineTool():this.$refs.rulerTool.classList.contains("selected")&&this.drawRulerTool()},eventChartCrosshairMove:function(t){if(t.time){var e=t.seriesPrices.get(this.series.price);this.hasCrosshair=!0,this.crosshair.time=t.time,this.crosshair.price=e}else this.hasCrosshair=!1,this.$devices.phone||(this.crosshair.time=null,this.crosshair.price=null);null!=t.point&&(this.crosshair.x=t.point.x,this.crosshair.y=t.point.y)},eventPriceLineDrag:function(t){var e=this,r=t.customPriceLine,n=r.options();n.price=this.formatPrice(n.price);var i=+t.fromPriceString,o=n.price;switch(n.lineType){case"order":if(o!=i){var s=!1;"entry"==n.kind?this.order.position||(s=!0,this.order[n.kind].price=o,this.executeOrder({action:"entry",data:{cmd:"change",side:this.order.side,price:this.order.entry.price}}).then((function(t){t.isOk?(e.drawOrderLine(n.kind),e.$toasted.success(e.$t("trading.orderChart.changeEntrySuccess"))):(r.applyOptions({price:i}),e.toasteOrderError(t.message))}))):(s=!0,this.order[n.kind].price=o,"tp"==n.kind?this.executeOrder({action:"tp",data:{cmd:"change",side:-this.order.side,price:this.order.tp.price}}).then((function(t){t.isOk?(e.drawOrderLine(n.kind),e.$toasted.success(e.$t("trading.orderChart.changeTpSuccess"))):(r.applyOptions({price:i}),e.toasteOrderError(t.message))})):this.executeOrder({action:"sl",data:{action:"change",side:-this.order.side,price:this.order.sl.price}}).then((function(t){t.isOk?(e.drawOrderLine(n.kind),e.$toasted.success(e.$t("trading.orderChart.changeSlSuccess"))):(r.applyOptions({price:i}),e.toasteOrderError(t.message))}))),s||(r.applyOptions({price:i}),this.$toasted.show(this.$t("trading.orderChart.noChangeOrderLine")))}break;case"line":a.set("line",{price:i,removed:!0}),a.set("line",n),this.$refs.lineTool.classList.remove("selected");break;case"ruler":if(1==n.point){if(a.set("ruler",n),2==this.ruler.point){var c=+(o+ +this.ruler.end.options().title).toFixed(1);this.ruler.end.applyOptions({price:c}),a.set("ruler",this.ruler.end.options())}}else{var d=(o-+this.ruler.start.options().price).toFixed(1);r.applyOptions({title:d}),a.set("ruler",r.options())}}},eventChartResize:function(){var t=this.chartContainer;this.chart.resize(t.offsetWidth,t.offsetHeight)},eventKeyPress:function(t){if(t.ctrlKey||t.metaKey)switch(t.keyCode){case 38:this.chart.timeScale().applyOptions({barSpacing:this.chart.options().timeScale.barSpacing+.05});break;case 40:this.chart.timeScale().applyOptions({barSpacing:this.chart.options().timeScale.barSpacing-.05});break;case 37:this.chart.timeScale().scrollToPosition(this.chart.timeScale().scrollPosition()-10);break;case 39:this.chart.timeScale().scrollToPosition(this.chart.timeScale().scrollPosition()+10);break;case 96:this.$refs.rulerTool.click();break;case 97:this.$refs.lineTool.click();break;case 98:this.$refs.reloadTool.click();break;case 99:this.$refs.fullscreenTool.click()}},eventFullscreenChange:function(){document.fullscreenElement?(this.isFullscreen=!0,this.chartContainer.classList.add("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.transform="translate(-250px, 0px)"):(this.isFullscreen=!1,this.chartContainer.classList.remove("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.transform="unset")},toggleFullscreen:function(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},loadToolsData:function(){var t=this;return new Promise(function(){var e,r=(e=p().mark((function e(r){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get("order");case 2:return e.sent.map((function(e){t.order.side=e.side,t.order[e.kind].price=e.price,t.drawOrderLine(e.kind),t.toggleCancelOrderButton(!0),"tp"==e.kind&&(t.order.position=e.side)})),t.order.tp.hasOwnProperty("line")&&t.order.entry.line.applyOptions({draggable:!1}),e.next=7,a.get("line");case 7:return e.sent.forEach((function(e){e.removed||t.lines.push(t.series.price.createPriceLine(e))})),e.next=11,a.get("ruler");case 11:2==(n=e.sent).length&&n.forEach((function(e){t.ruler.point=2,1==e.point?t.ruler.start=t.series.price.createPriceLine(e):t.ruler.end=t.series.price.createPriceLine(e)})),r();case 14:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(t){f(o,n,i,a,s,"next",t)}function s(t){f(o,n,i,a,s,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}())},loadChartData:function(){this.loadWhitespace&&(this.data.whitespace=this.mergeChartData(this.data.whitespace,this.createWhitespaceData()),this.series.whitespace.setData(this.data.whitespace)),this.data.price=this.mergeChartData(this.chartData,this.data.price),this.series.price.setData(this.data.price)},updateChartData:function(t){this.data.price=this.mergeChartData([t],this.data.price),this.series.price.update(this.lastPrice)},createWhitespaceData:function(){var t,e=this.chartDate,r=moment("".concat(e," 09:00:00")).unix(),n=moment("".concat(e," 11:30:00")).unix(),i=moment("".concat(e," 13:00:00")).unix(),o=moment("".concat(e," 14:30:00")).unix(),a=[];for(t=r;t<=n;t++)a.push({time:t+25200});for(t=i;t<=o;t++)a.push({time:t+25200});return a},mergeChartData:function(t,e){var r=new Set(t.map((function(t){return t.time})));return[].concat(u(t),u(e.filter((function(t){return!r.has(t.time)})))).sort((function(t,e){return t.time-e.time}))},connectSocket:function(){var t=this,e=this;e.websocket=new WebSocket("wss://datafeed.vps.com.vn/socket.io/?EIO=3&transport=websocket"),e.websocket.onopen=function(t){var r={action:"join",list:e.config.symbol};e.websocket.send("42".concat(JSON.stringify(["regs",JSON.stringify(r)])))},e.websocket.onclose=function(t){if(e._isDestroyed)return!1;e.inSession()&&(e.connectSocket(),e.getChartData(e.chartDate))},e.websocket.onmessage=function(r){if(4==r.data.substr(0,1)&&2==r.data.substr(1,1)){var n=JSON.parse(r.data.substr(2));if("stockps"==n[0]){var i=n[1].data;3220==i.id&&(e.updateChartData({time:moment("".concat(b," ").concat(i.time)).unix()+25200,value:i.lastPrice}),e.order.entry.hasOwnProperty("line")&&(e.order.tp.hasOwnProperty("line")?((e.order.side>0&&i.lastPrice>=e.order.tp.price||e.order.side<0&&i.lastPrice<=e.order.tp.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,e.executeOrder({action:"sl",data:{cmd:"delete"}}).then((function(r){r.isOk?(e.removeOrderLine("entry"),e.removeOrderLine("tp"),e.removeOrderLine("sl"),a.clear("order"),e.$toasted.success(t.$t("trading.orderChart.deleteTpSuccess")),t.hideOrderButton()):e.toasteOrderError(r.message),e.isAutoOrdering=!1})))),(e.order.side>0&&i.lastPrice<=e.order.sl.price||e.order.side<0&&i.lastPrice>=e.order.sl.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,e.executeOrder({action:"tp",data:{cmd:"cancel"}}).then((function(r){r.isOk?(e.removeOrderLine("entry"),e.removeOrderLine("tp"),e.removeOrderLine("sl"),a.clear("order"),e.$toasted.success(t.$t("trading.orderChart.deleteSlSuccess")),t.hideOrderButton()):e.toasteOrderError(r.message),e.isAutoOrdering=!1}))))):(e.order.side>0&&i.lastPrice>=e.order.entry.price||e.order.side<0&&i.lastPrice<=e.order.entry.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,e.executeOrder({action:"tpsl",tpData:{cmd:"new",side:-e.order.side,price:e.order.tp.price},slData:{cmd:"new",side:-e.order.side,price:e.order.sl.price}}).then((function(r){r.isOk?(e.drawOrderLine("tp"),e.drawOrderLine("sl"),e.order.entry.line.applyOptions({draggable:!1}),e.$toasted.success(t.$t("trading.orderChart.autoNewTpSlSuccess"))):e.toasteOrderError(r.message),e.isAutoOrdering=!1}))))))}}}},intervalHandler:function(){var t=this,e=moment().unix();this.inSession(e)&&(this.status.position&&e>C-300&&(this.blinkCancelOrderButton(),e>C-60&&this.order.tp.hasOwnProperty("line")&&this.executeOrder({action:"cancel",tpData:{cmd:"cancel"},slData:{cmd:"delete"}}).then((function(e){e.isOk?(t.removeOrderLine("entry"),t.removeOrderLine("tp"),t.removeOrderLine("sl"),a.clear("order"),t.$toasted.success(t.$t("trading.orderChart.autoCancelTpSlSuccess"))):t.toasteOrderError(e.message)}))),e==O&&this.connectSocket()),this.clock=Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"numeric",second:"numeric"}).format()},showOrderButton:function(){var t=moment().unix();if(this.inSession(t))if(this.order.position)this.order.entry.hasOwnProperty("line")&&!this.order.tp.hasOwnProperty("line")&&(this.$refs.tpslOrder.style.left=+(this.crosshair.x+(this.crosshair.x>innerWidth-61?-61:1))+"px",this.$refs.tpslOrder.style.top=+(this.crosshair.y+(this.crosshair.y>innerHeight-51?-51:1))+"px",this.$refs.tpslOrder.style.display="block");else if(!this.order.entry.hasOwnProperty("line")){var e=this.coordinateToPrice(this.crosshair.y),r=e>=this.data.price.slice(-1)[0].value?1:-1;this.order.side=r,t<w?e="ATO":t<C?(this.order.tp.price=e+3*r,this.order.sl.price=e-2*r):e="ATC",this.order.entry.price=e,this.$refs.entryOrder.style.left=+(this.crosshair.x+(this.crosshair.x>innerWidth-71?-71:1))+"px",this.$refs.entryOrder.style.top=+(this.crosshair.y+(this.crosshair.y>innerHeight-61?-61:1))+"px",this.$refs.entryOrder.style.background=r>0?"green":"red",this.$refs.entryOrder.innerText="".concat(r>0?"LONG":"SHORT"," ").concat(e),this.$refs.entryOrder.style.display="block"}},hideOrderButton:function(){this.$refs.entryOrder.style.display="none",this.$refs.tpslOrder.style.display="none"},toggleCancelOrderButton:function(t){this.$refs.cancelOrder.style.display=t?"block":"none"},blinkCancelOrderButton:function(){this.$refs.cancelOrder.classList.contains("warning")?this.$refs.cancelOrder.classList.remove("warning"):this.$refs.cancelOrder.classList.add("warning")},drawOrderLine:function(t){var e,r;switch(t){case"entry":e="yellow",r=this.order.side>0?"LONG":"SHORT";break;case"tp":e="lime",r=Math.abs(this.order.tp.price-this.order.entry.price).toFixed(1);break;case"sl":e="red",r=Math.abs(this.order.sl.price-this.order.entry.price).toFixed(1)}this.order[t].hasOwnProperty("line")?this.order[t].line.applyOptions({price:this.order[t].price,title:r}):this.order[t].line=this.series.price.createPriceLine({lineType:"order",kind:t,price:this.order[t].price,color:e,lineWidth:1,lineStyle:LightweightCharts.LineStyle.Solid,title:r,draggable:!0}),a.set("order",{kind:t,price:+this.order[t].price,side:this.order.side})},removeOrderLine:function(t){this.order[t].hasOwnProperty("line")&&(this.series.price.removePriceLine(this.order[t].line),delete this.order[t].line)},lineToolClick:function(t){var e=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach((function(t){return t.classList.remove("selected")})),e||t.target.classList.add("selected"),t.stopPropagation()},lineToolContextmenu:function(t){this.removeLineTool(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()},drawLineTool:function(){var t=this.formatPrice(this.coordinateToPrice(this.crosshair.y)),e=this.lines.findIndex((function(e){var r=e.options();return r.type=+r.price==t}));if(-1!=e){var r=this.lines.splice(e,1);this.series.price.removePriceLine(r[0]),a.set("line",{price:t,removed:!0})}else{var n={lineType:"line",price:t,color:"aqua",lineWidth:1,lineStyle:LightweightCharts.LineStyle.Dotted,draggable:!0};this.lines.push(this.series.price.createPriceLine(n)),a.set("line",n)}this.$refs.lineTool.classList.remove("selected")},removeLineTool:function(){var t=this;this.lines.forEach((function(e){return t.series.price.removePriceLine(e)})),this.lines=[],a.clear("line")},rulerToolClick:function(t){var e=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach((function(t){return t.classList.remove("selected")})),e||(t.target.classList.add("selected"),this.removeRulerTool()),t.stopPropagation()},rulerToolContextmenu:function(t){this.removeRulerTool(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()},drawRulerTool:function(){var t=this.coordinateToPrice(this.crosshair.y),e={lineType:"ruler",price:t,color:"#FF00FF",lineWidth:1,lineStyle:LightweightCharts.LineStyle.Dotted,draggable:!0};if(0==this.ruler.point){e.point=1,e.title="0",this.ruler.start=this.series.price.createPriceLine(e),this.ruler.point=1,a.set("ruler",e)}else if(1==this.ruler.point){var r=+this.ruler.start.options().price;e.point=2,e.title=(t-r).toFixed(1),this.ruler.end=this.series.price.createPriceLine(e),this.ruler.point=2,a.set("ruler",e),this.$refs.rulerTool.classList.remove("selected")}},removeRulerTool:function(){this.ruler.point>0&&(this.series.price.removePriceLine(this.ruler.start),this.ruler.point>1&&this.series.price.removePriceLine(this.ruler.end),this.ruler={start:{},end:{},point:0},a.clear("ruler"))},cancelOrderClick:function(){var t=this;Object(d.b)(this.$t("trading.orderChart.cancelOrder"),this.$t("trading.orderChart.cancelConfirm")).then((function(e){e&&(t.toggleCancelOrderButton(!1),t.order.entry.hasOwnProperty("line")&&(t.order.tp.hasOwnProperty("line")?t.executeOrder({action:"exit",tpData:{cmd:"cancel"},slData:{cmd:"delete"},exitData:{cmd:"new",side:-t.order.side,price:"MTL"}}).then((function(e){e.isOk?(t.removeOrderLine("entry"),t.removeOrderLine("tp"),t.removeOrderLine("sl"),a.clear("order"),t.$toasted.success(t.$t("trading.orderChart.exitSuccess"))):(t.toggleCancelOrderButton(!0),t.toasteOrderError(e.message))})):t.executeOrder({action:"entry",data:{cmd:"delete"}}).then((function(e){e.isOk?(t.removeOrderLine("entry"),a.clear("order"),t.$toasted.success(t.$t("trading.orderChart.deleteEntrySuccess"))):(t.toggleCancelOrderButton(!0),t.toasteOrderError(e.message))}))))}))},entryOrderClick:function(){var t=this,e=moment().unix();if(this.inSession(e))if(e<w)Object(d.b)(this.$t("trading.orderChart.atoOrder"),this.$t("trading.orderChart.cancelConfirm")).then((function(e){e&&t.executeOrder({action:"exit",exitData:{cmd:"new",side:-t.order.side,price:"ATO"}}).then((function(e){e.isOk?t.$toasted.success(t.$t("trading.orderChart.atoOrderSuccess")):t.toasteOrderError(e.message)}))}));else if(e<C)this.executeOrder({action:"entry",data:{cmd:"new",side:this.order.side,price:this.order.entry.price}}).then((function(e){e.isOk?(t.drawOrderLine("entry"),t.toggleCancelOrderButton(!0),t.$toasted.success(t.$t("trading.orderChart.newEntrySuccess"))):t.toasteOrderError(e.message)}));else{Object(d.b)(this.$t("trading.orderChart.atcOrder"),this.$t("trading.orderChart.cancelConfirm")).then((function(e){e&&t.executeOrder({action:"exit",exitData:{cmd:"new",side:-t.order.side,price:"ATC"}}).then((function(e){e.isOk?t.$toasted.success(t.$t("trading.orderChart.atcOrderSuccess")):t.toasteOrderError(e.message)}))}))}},tpslOrderClick:function(){var t=this;this.executeOrder({action:"tpsl",tpData:{cmd:"new",side:-this.order.side,price:this.order.tp.price},slData:{cmd:"new",side:-this.order.side,price:this.order.sl.price}}).then((function(e){e.isOk?(t.drawOrderLine("tp"),t.drawOrderLine("sl"),t.order.entry.line.applyOptions({draggable:!1}),t.$toasted.success(t.$t("trading.orderChart.newTpSlSuccess"))):t.toasteOrderError(e.message)}))},chartTopClick:function(){this.chart.timeScale().scrollToRealTime()},inSession:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t||(t=moment().unix()),t>=O&&t<=x},coordinateToPrice:function(t){return this.formatPrice(this.series.price.coordinateToPrice(t))},formatPrice:function(t){return t?+ +t.toFixed(1):0},toasteOrderError:function(t){t||(t="unknown"),this.$toasted.error(this.$t("admin.orderChart.".concat(t)))}})},L=(r("L/vo"),r("KHd+")),S=Object(L.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-chart-page"},[e("h2",{staticClass:"content-block"},[t._v("\n        "+t._s(t.$t("trading.orderChart.title"))+"\n    ")]),t._v(" "),e("div",{staticClass:"content-block dx-card responsive-paddings"},[e("div",{ref:"chartContainer",staticClass:"order-chart-container"},[e("div",{ref:"orderChart",staticClass:"chart-wrapper"},[e("div",{staticClass:"area data-area"},[e("div",{class:"command noaction far fa-".concat(t.status.connection?"link":"unlink"),attrs:{title:t.$t("trading.orderChart.connection")}}),t._v(" "),e("div",{staticClass:"command noaction status",class:{green:t.status.position>0,red:t.status.position<0},attrs:{title:t.$t("trading.orderChart.position")}},[t._v("\n                        "+t._s(t._f("currency")(t.status.position,"",""))+"\n                    ")]),t._v(" "),e("div",{staticClass:"command noaction clock"},[t._v(t._s(t.clock))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.chartDate,expression:"chartDate"}],staticClass:"chart-date command",attrs:{type:"date",title:t.$t("trading.orderChart.date")},domProps:{value:t.chartDate},on:{change:function(){return t.getChartData(t.chartDate)},input:function(e){e.target.composing||(t.chartDate=e.target.value)}}}),t._v(" "),e("img",{ref:"spinner",staticClass:"command spinner",attrs:{src:"spinner.gif"}})]),t._v(" "),e("div",{staticClass:"area tool-area"},[e("div",{ref:"fullscreenTool",class:"command far fa-".concat(t.isFullscreen?"compress":"expand"),attrs:{title:t.$t("trading.orderChart.fullscreen")},on:{click:t.toggleFullscreen}}),t._v(" "),e("div",{ref:"reloadTool",staticClass:"command far fa-sync-alt",attrs:{title:t.$t("trading.orderChart.reload")},on:{click:function(){t.data.price=[],t.getChartData(t.chartDate)}}}),t._v(" "),e("div",{ref:"lineTool",staticClass:"command far fa-minus",attrs:{title:t.$t("trading.orderChart.lineTool")},on:{click:t.lineToolClick,contextmenu:t.lineToolContextmenu}}),t._v(" "),e("div",{ref:"rulerTool",staticClass:"command far fa-arrows-v",attrs:{title:t.$t("trading.orderChart.rulerTool")},on:{click:t.rulerToolClick,contextmenu:t.rulerToolContextmenu}}),t._v(" "),e("div",{ref:"cancelOrder",staticClass:"cancel-order command far fa-trash-alt",attrs:{title:t.$t("trading.orderChart.cancelTool")},on:{click:t.cancelOrderClick}})]),t._v(" "),e("div",[e("div",{ref:"entryOrder",staticClass:"order-button entry",on:{click:t.entryOrderClick}},[t._v("\n                        Entry\n                    ")]),t._v(" "),e("div",{ref:"tpslOrder",staticClass:"order-button tpsl",on:{click:t.tpslOrderClick}},[t._v("\n                        TP/SL\n                    ")]),t._v(" "),e("div",{staticClass:"chart-top command far fa-angle-double-right",on:{click:t.chartTopClick}})])])])])])}),[],!1,null,"5505e102",null);e.default=S.exports},CsEc:function(t,e,r){var n=r("es74");"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,i);n.locals&&(t.exports=n.locals)},"L/vo":function(t,e,r){"use strict";r("CsEc")},Ugxn:function(t,e,r){"use strict";r.d(e,"a",(function(){return j})),r.d(e,"b",(function(){return D}));var n=r("+dKZ"),i=r("W2II"),o=r("mUQo"),a=r("P6tt"),s=r("TE0E"),c=r("OIHa"),d=r("VNvn"),l=r("zAdP"),u=r("v5W6"),h=r("sUSw"),p=r("ua+q"),f=r("RfjA"),m=r("xPQU"),g=r("demn"),v=r("3CDA"),y=r("s6U3"),b=r("oHs6"),O=r("a8dJ"),w=Object(f.d)(),C={text:"OK",onClick:function(){return!0}},x="".concat("dx-dialog","-wrapper"),k="".concat("dx-dialog","-root"),L="".concat("dx-dialog","-content"),S="".concat("dx-dialog","-message"),P="".concat("dx-dialog","-buttons"),T="".concat("dx-dialog","-button"),E=o.a.inherit({ctor:function(t,e){this.callBase(e)},_defaultOptionsRules:function(){return this.callBase().concat([{device:{platform:"ios"},options:{width:276}}])}}),$=function(t){var e,r=new l.a,o=(new E).option();t=Object(p.a)(o,t);var u=Object(i.a)("<div>").addClass("dx-dialog").appendTo(Object(g.c)()),f="messageHtml"in t;"message"in t&&y.a.log("W1013");var v=String(f?t.messageHtml:t.message),$=Object(i.a)("<div>").addClass(S).html(v),j=[];Object(h.a)(t.buttons||[C],(function(){var t=new a.a(this.onClick,{context:D});j.push({toolbar:"bottom",location:s.a.current().android?"after":"center",widget:"dxButton",options:Object(p.a)({},this,{onClick:function(){var e=t.execute(...arguments);_(e)}})})}));var D=new b.default(u,Object(p.a)({title:null!==(e=t.title)&&void 0!==e?e:"",showTitle:Object(O.g)(t.showTitle,!0),dragEnabled:Object(O.g)(t.dragEnabled,!0),height:"auto",width:t.width,showCloseButton:t.showCloseButton||!1,ignoreChildEvents:!1,onContentReady:function(t){t.component.$content().addClass(L).append($)},onShowing:function(t){t.component.bottomToolbar().addClass(P).find(".".concat("dx-button")).addClass(T),Object(d.i)()},onShown:function(t){var e=t.component.bottomToolbar().find(".".concat("dx-button")).first();m.a.trigger(e,"focus")},onHiding:function(){r.reject()},toolbarItems:j,animation:{show:{type:"pop",duration:400},hide:{type:"pop",duration:400,to:{opacity:0,scale:0},from:{opacity:1,scale:1}}},rtlEnabled:Object(c.a)().rtlEnabled,position:{boundaryOffset:{h:10,v:0}}},t.popupOptions));function _(t){r.resolve(t),D.hide().done((function(){D.$element().remove()}))}return D.$wrapper().addClass(x),t.position&&D.option("position",t.position),D.$wrapper().addClass(k),{show:function(){if("android"===s.a.real().platform){var t=Object(n.d)(w)>Object(n.l)(w)?"80%":"60%";D.option({width:t})}return D.show(),r.promise()},hide:_}},j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=Object(u.k)(t)?t:{title:e,messageHtml:t,showTitle:r,dragEnabled:r};return $(n).show()},D=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=Object(u.k)(t)?t:{title:e,messageHtml:t,showTitle:r,buttons:[{text:v.a.format("Yes"),onClick:function(){return!0}},{text:v.a.format("No"),onClick:function(){return!1}}],dragEnabled:r};return $(n).show()}},es74:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,".order-chart-container[data-v-5505e102]{height:300px;background:#131722;border:none}.order-chart-container.fullscreen[data-v-5505e102]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1501}.order-chart-container .chart-wrapper[data-v-5505e102]{position:relative;height:100%}.order-chart-container .area[data-v-5505e102]{position:absolute;display:flex;justify-content:space-between;font-size:17px;background:#131722;border:2px solid #2a2e39;border-bottom-right-radius:5px;z-index:3}.order-chart-container .area.data-area[data-v-5505e102]{top:0;left:0}.order-chart-container .area.data-area .command[data-v-5505e102]:not(:first-child){border-left:2px solid #2a2e39!important}.order-chart-container .area.data-area .clock[data-v-5505e102]{width:80px}.order-chart-container .area.data-area .chart-date[data-v-5505e102]{width:125px}.order-chart-container .area.data-area .status[data-v-5505e102]{width:unset!important;padding:0 10px!important}.order-chart-container .area.data-area .status.green[data-v-5505e102]{color:#0f0!important}.order-chart-container .area.data-area .status.red[data-v-5505e102]{color:red!important}.order-chart-container .area.data-area .spinner[data-v-5505e102]{width:30px;height:30px;display:none}.order-chart-container .area.tool-area[data-v-5505e102]{top:32px;left:0;flex-direction:column}.order-chart-container .area.tool-area .command[data-v-5505e102]:not(:first-child){border-top:2px solid #2a2e39!important}.order-chart-container .area.tool-area .selected[data-v-5505e102]{color:#1f62ff!important}.order-chart-container .area.tool-area .warning[data-v-5505e102]{color:#ff0!important}.order-chart-container .area.tool-area .cancel-order[data-v-5505e102]{display:none;color:red}.order-chart-container .command[data-v-5505e102]{width:30px;height:30px;flex:1 1 auto;text-align:center;color:#bbb;background:transparent!important;line-height:30px;font-size:16px;border:none;cursor:pointer;z-index:3}.order-chart-container .command[data-v-5505e102]:not(.noaction):hover{background:#2a2e39!important}.order-chart-container .command.noaction[data-v-5505e102]{cursor:unset!important}.order-chart-container .order-button[data-v-5505e102]{position:absolute;display:none;padding:5px;text-align:center;border-radius:7px;color:#000;background:silver;z-index:3;cursor:pointer}.order-chart-container .order-button.entry[data-v-5505e102]{width:70px;height:55px;color:#fff!important}.order-chart-container .order-button.tpsl[data-v-5505e102]{width:60px;height:50px}.order-chart-container .chart-top[data-v-5505e102]{position:absolute;bottom:29px;right:55px;border-radius:50%;border:1px solid grey;padding-left:1px;line-height:22px!important;width:25px!important;height:25px!important;font-size:18px}",""])}}]);