/*! For license information please see 3.f02771094becfd9c8c6f.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+sxU":function(e,t,i){"use strict";i.r(t);var o=i("W2II"),a=i("ua+q"),n=i("v5W6"),s=i("zAdP"),r=i("a8dJ"),l=i("3CDA"),d=i("CF5h"),c=i("9lSq"),h=i("P6tt"),u=i("demn"),p=i("RfjA"),m=i("UnSs"),_=i("xPQU"),g=i("FrS1"),f=i("j+Lh"),I=i("jyIZ"),v=i("gDEn"),C=i("IRHc"),b=Object(p.d)(),y=g.a.add,x=["info","warning","error","success"],D=[],S=null,O={top:{my:"top",at:"top",of:null,offset:"0 0"},bottom:{my:"bottom",at:"bottom",of:null,offset:"0 -20"},center:{my:"center",at:"center",of:null,offset:"0 0"},right:{my:"center right",at:"center right",of:null,offset:"0 0"},left:{my:"center left",at:"center left",of:null,offset:"0 0"}},M={h:0,v:0};y((function(){_.a.subscribeGlobal(m.default.getDocument(),I.a.down,(function(e){for(var t=D.length-1;t>=0;t--)if(!D[t]._proxiedDocumentDownHandler(e))return}))}));var F=v.a.inherit({_getDefaultOptions:function(){return Object(a.a)(this.callBase(),{message:"",type:"info",displayTime:2e3,position:"bottom center",animation:{show:{type:"fade",duration:400,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},shading:!1,height:"auto",hideTopOverlayHandler:null,closeOnSwipe:!0,closeOnClick:!1,resizeEnabled:!1})},_defaultOptionsRules:function(){return this.callBase().concat([{device:{platform:"android"},options:{closeOnOutsideClick:!0,width:"auto",position:{at:"bottom left",my:"bottom left",offset:"20 -20"},animation:{show:{type:"slide",duration:200,from:{position:{my:"top",at:"bottom",of:b}}},hide:{type:"slide",duration:200,to:{position:{my:"top",at:"bottom",of:b}}}}}},{device:function(e){var t="phone"===e.deviceType,i="android"===e.platform;return t&&i},options:{width:"100vw",position:{at:"bottom center",my:"bottom center",offset:"0 0"}}},{device:function(e){return"phone"===e.deviceType},options:{width:"100vw"}},{device:function(){return Object(C.d)()},options:{minWidth:344,maxWidth:568,displayTime:4e3}}])},_init:function(){this.callBase(),this._posStringToObject()},_renderContentImpl:function(){this.option("message")&&(this._message=Object(o.a)("<div>").addClass("dx-toast-message").text(this.option("message")).appendTo(this.$content())),this.setAria("role","alert",this._message),Object(f.d)(this.option("type").toLowerCase(),x)>-1&&this.$content().prepend(Object(o.a)("<div>").addClass("dx-toast-icon")),this.callBase()},_render:function(){this.callBase(),this.$element().addClass("dx-toast"),this.$wrapper().addClass("dx-toast-wrapper"),this.$content().addClass("dx-toast-"+String(this.option("type")).toLowerCase()),this.$content().addClass("dx-toast-content"),this._toggleCloseEvents("Swipe"),this._toggleCloseEvents("Click")},_renderScrollTerminator:r.n,_toggleCloseEvents:function(e){var t="dx"+e.toLowerCase();_.a.off(this.$content(),t),this.option("closeOn"+e)&&_.a.on(this.$content(),t,this.hide.bind(this))},_posStringToObject:function(){if(Object(n.o)(this.option("position"))){var e=this.option("position").split(" ")[0],t=this.option("position").split(" ")[1];switch(this.option("position",Object(a.a)({boundaryOffset:M},O[e])),t){case"center":case"left":case"right":this.option("position").at+=" "+t,this.option("position").my+=" "+t}}},_show:function(){return S&&S!==this&&(clearTimeout(S._hideTimeout),S.hide()),S=this,this.callBase.apply(this,arguments).done(function(){clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(this.hide.bind(this),this.option("displayTime"))}.bind(this))},_hide:function(){return S=null,this.callBase.apply(this,arguments)},_overlayStack:function(){return D},_zIndexInitValue:function(){return this.callBase()+8e3},_dispose:function(){clearTimeout(this._hideTimeout),S=null,this.callBase()},_optionChanged:function(e){switch(e.name){case"type":this.$content().removeClass("dx-toast-"+e.previousValue),this.$content().addClass("dx-toast-"+String(e.value).toLowerCase());break;case"message":this._message&&this._message.text(e.value);break;case"closeOnSwipe":this._toggleCloseEvents("Swipe");break;case"closeOnClick":this._toggleCloseEvents("Click");break;case"displayTime":break;default:this.callBase(e)}}});Object(d.a)("dxToast",F);var w=F,E=null,P=function(e,t,i){var s=Object(n.k)(e)?e:{message:e},r=s.onHidden;Object(a.a)(s,{type:t,displayTime:i,onHidden:function(e){Object(o.a)(e.element).remove(),new h.a(r,{context:e.model}).execute(arguments)}}),E=Object(o.a)("<div>").appendTo(Object(u.c)()),new w(E,s).show()},A=function(e,t,i){t=t||r.n,i=i||r.n,Array.isArray(e)||(e=[e]);var o=e.map((e,o)=>Object(s.c)(e).then(i=>(Object(n.h)(t)&&t({item:e,index:o,result:i}),i),e=>(e||(e={}),e.index=o,Object(n.h)(i)&&i(e),(new s.a).resolve().promise())));return s.c.apply(null,o)},T=function(e){for(var t=["B","KB","MB","GB","TB"],i=0,o=e;o>=1024&&i<=t.length-1;)o/=1024,i++;return o=Math.round(10*o)/10,"".concat(o," ").concat(t[i])},j=function(e,t,i){return i.forEach(i=>{Object(a.a)(!0,e,Object(n.d)(t[i])?{[i]:t[i]}:{})}),e},k=function(e){var t=Object.keys(e),i=[];return t.forEach(t=>i.push(e[t])),{keys:t,values:i}},B=i("hpbx"),U=i("lU5B"),$=i("t66f"),V=i("3VAS"),R=i("P9VE"),L=i("fWfm"),N=i("s6U3"),K=i("xOOu"),z=i.n(K);var H=class{constructor(e,t,i){this.errorCode=e,this.fileSystemItem=t,this.errorText=i}},W={NoAccess:0,FileExists:1,FileNotFound:2,DirectoryExists:3,DirectoryNotFound:4,WrongFileExtension:5,MaxFileSizeExceeded:6,InvalidSymbols:7,Other:32767},q=i("ADaq"),Z=Object(p.d)();class G extends B.a{constructor(e){super(e=Object(r.g)(e,{}));var t=e.data;if(t&&!Array.isArray(t))throw R.a.Error("E4006");var i=e.itemsExpr||"items";this._subFileItemsGetter=Object($.a)(i),this._subFileItemsSetter=this._getSetter(i);var o=e.contentExpr||"content";this._contentGetter=Object($.a)(o),this._contentSetter=this._getSetter(o);var a=this._getNameExpr(e);this._nameSetter=this._getSetter(a);var n=this._getIsDirExpr(e);this._getIsDirSetter=this._getSetter(n);var s=this._getKeyExpr(e);this._keySetter=this._getSetter(s);var l=this._getSizeExpr(e);this._sizeSetter=this._getSetter(l);var d=this._getDateModifiedExpr(e);this._dateModifiedSetter=this._getSetter(d),this._data=t||[]}getItems(e){return this._executeActionAsDeferred(()=>this._getItems(e),!0)}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemCore(e,t))}_renameItemCore(e,t){if(e){var i=this._findDataObject(e);this._nameSetter(i,t),e.name=t,e.key=this._ensureDataObjectKey(i)}}createDirectory(e,t){return this._executeActionAsDeferred(()=>{this._validateDirectoryExists(e),this._createDataObject(e,t,!0)})}deleteItems(e){return e.map(e=>this._executeActionAsDeferred(()=>this._deleteItem(e)))}moveItems(e,t){var i=this._findDataObject(t),o=this._getDirectoryDataItems(i);return e.map(e=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(e,t);var i=this._findDataObject(e);this._deleteItem(e),o.push(i)}))}copyItems(e,t){var i=this._findDataObject(t),o=this._getDirectoryDataItems(i);return e.map(e=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(e,t);var i=this._findDataObject(e),a=this._createCopy(i);o.push(a)}))}uploadFileChunk(e,t,i){if(t.chunkIndex>0)return t.customData.deferred;this._validateDirectoryExists(i);var o=t.customData.deferred=new s.a,a=this._createFileReader();return a.readAsDataURL(e),a.onload=()=>{var t=a.result.split(",")[1],n=this._createDataObject(i,e.name,!1);this._sizeSetter(n,e.size),this._dateModifiedSetter(n,e.lastModifiedDate),this._contentSetter(n,t),o.resolve()},a.onerror=e=>o.reject(e),o}downloadItems(e){1===e.length?this._downloadSingleFile(e[0]):this._downloadMultipleFiles(e)}_downloadSingleFile(e){for(var t=this._getFileContent(e),i=Z.atob(t),o=new ArrayBuffer(i.length),a=new Uint8Array(o),n=0;n<i.length;n++)a[n]=i.charCodeAt(n);var s=new Z.Blob([o],{type:"application/octet-stream"});L.b.saveAs(e.name,null,s)}_downloadMultipleFiles(e){var t=new(function(){if(!z.a)throw N.a.Error("E1041","JSZip");return z.a}());e.forEach(e=>t.file(e.name,this._getFileContent(e),{base64:!0}));var i={type:"blob",compression:"DEFLATE",mimeType:"application/zip"},o=new s.a;t.generateAsync?t.generateAsync(i).then(o.resolve):o.resolve(t.generate(i)),o.done(e=>L.b.saveAs("files.zip",null,e))}_getFileContent(e){var t=this._findDataObject(e);return this._contentGetter(t)||""}_validateDirectoryExists(e){if(!this._isFileItemExists(e)||this._isDirGetter(e.fileItem))throw new H(W.DirectoryNotFound,e)}_checkAbilityToMoveOrCopyItem(e,t){var i=this._findDataObject(e),o=this._getKeyFromDataObject(i,e.parentPath),a=t.getFullPathInfo(),n="";a.forEach(t=>{if(n=Object(q.f)(n,t.name),this._getDataObjectKey(t.key,n)===o)throw new H(W.Other,e)})}_createDataObject(e,t,i){var o={};this._nameSetter(o,t),this._getIsDirSetter(o,i),this._keySetter(o,String(new V.a));var a=this._findDataObject(e);return this._getDirectoryDataItems(a).push(o),o}_createCopy(e){var t={};this._nameSetter(t,this._nameGetter(e)),this._getIsDirSetter(t,this._isDirGetter(e));var i=this._subFileItemsGetter(e);if(Array.isArray(i)){var o=[];i.forEach(e=>{var t=this._createCopy(e);o.push(t)}),this._subFileItemsSetter(t,o)}return t}_deleteItem(e){var t=this._findDataObject(e),i=this._findFileItemObj(e.pathInfo),o=this._getDirectoryDataItems(i),a=o.indexOf(t);o.splice(a,1)}_getDirectoryDataItems(e){if(!e)return this._data;var t=this._subFileItemsGetter(e);return Array.isArray(t)||(t=[],this._subFileItemsSetter(e,t)),t}_getItems(e){this._validateDirectoryExists(e);var t=e.getFullPathInfo(),i=t&&t.length>0?t[t.length-1].key:null,o=this._data;if(i){var a=this._findFileItemObj(t);o=a&&this._subFileItemsGetter(a)||[]}return this._ensureKeysForDuplicateNameItems(o),this._convertDataObjectsToFileItems(o,t)}_ensureKeysForDuplicateNameItems(e){var t={};e.forEach(e=>{var i=this._nameGetter(e);t[i]?this._ensureDataObjectKey(e):t[i]=!0})}_findDataObject(e){if(e.isRoot())return null;var t=this._findFileItemObj(e.getFullPathInfo());if(!t){var i=e.isDirectory?W.DirectoryNotFound:W.FileNotFound;throw new H(i,e)}return t}_findFileItemObj(e){var t=this;Array.isArray(e)||(e=[]);for(var i="",o=null,a=this._data,n=function(n){(o=Object(f.a)(a,o=>{var a=t._isDirGetter(o)||n===e.length-1;return t._getKeyFromDataObject(o,i)===e[n].key&&t._nameGetter(o)===e[n].name&&a}))&&(i=Object(q.f)(i,t._nameGetter(o)),a=t._subFileItemsGetter(o))},s=0;s<e.length&&(0===s||o);s++)n(s);return o}_getKeyFromDataObject(e,t){var i=this._keyGetter(e),o=Object(q.f)(t,this._nameGetter(e));return this._getDataObjectKey(i,o)}_getDataObjectKey(e,t){return e||t}_ensureDataObjectKey(e){var t=this._keyGetter(e);return t||(t=String(new V.a),this._keySetter(e,t)),t}_hasSubDirs(e){var t=Object(r.g)(this._subFileItemsGetter(e),[]);if(!Array.isArray(t))return!0;for(var i=0;i<t.length;i++)if(!0===this._isDirGetter(t[i]))return!0;return!1}_getSetter(e){return Object(n.h)(e)?e:Object($.b)(e)}_isFileItemExists(e){return e.isDirectory&&e.isRoot()||!!this._findFileItemObj(e.getFullPathInfo())}_createFileReader(){return new Z.FileReader}}var J=G,X=i("P27Q"),Y=i("sUSw"),Q=Object(p.d)(),ee="GetDirContents",te="CreateDir",ie="Rename",oe="Move",ae="Copy",ne="Remove",se="UploadChunk",re="AbortUpload",le="Download",de="GET",ce="POST";class he extends B.a{constructor(e){super(e=Object(r.g)(e,{})),this._endpointUrl=e.endpointUrl,this._beforeAjaxSend=e.beforeAjaxSend,this._beforeSubmit=e.beforeSubmit,this._requestHeaders=e.requestHeaders,this._hasSubDirsGetter=Object($.a)(e.hasSubDirectoriesExpr||"hasSubDirectories")}getItems(e){var t=e.getFullPathInfo();return this._executeRequest(ee,{pathInfo:t}).then(e=>this._convertDataObjectsToFileItems(e.result,t))}renameItem(e,t){return this._executeRequest(ie,{pathInfo:e.getFullPathInfo(),isDirectory:e.isDirectory,name:t})}createDirectory(e,t){return this._executeRequest(te,{pathInfo:e.getFullPathInfo(),name:t})}deleteItems(e){return e.map(e=>this._executeRequest(ne,{pathInfo:e.getFullPathInfo(),isDirectory:e.isDirectory}))}moveItems(e,t){return e.map(e=>this._executeRequest(oe,{sourcePathInfo:e.getFullPathInfo(),sourceIsDirectory:e.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}copyItems(e,t){return e.map(e=>this._executeRequest(ae,{sourcePathInfo:e.getFullPathInfo(),sourceIsDirectory:e.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}uploadFileChunk(e,t,i){0===t.chunkIndex&&(t.customData.uploadId=new V.a);var o={destinationPathInfo:i.getFullPathInfo(),chunkMetadata:JSON.stringify({UploadId:t.customData.uploadId,FileName:e.name,Index:t.chunkIndex,TotalCount:t.chunkCount,FileSize:e.size})},a={url:this._endpointUrl,headers:this._requestHeaders||{},method:ce,dataType:"json",data:{chunk:t.chunkBlob,arguments:JSON.stringify(o),command:se},upload:{onprogress:r.n,onloadstart:r.n,onabort:r.n},xhrFields:{},cache:!1},n=new s.a;return this._beforeSendInternal(a),X.a.sendRequest(a).done(e=>{!e.success&&n.reject(e)||n.resolve()}).fail(n.reject),n.promise()}abortFileUpload(e,t,i){return this._executeRequest(re,{uploadId:t.customData.uploadId})}downloadItems(e){var t=this._getDownloadArgs(e),i=Object(o.a)("<form>").css({display:"none"}).attr({method:ce,action:t.url}),a={command:t.command,arguments:t.arguments};this._beforeSubmitInternal(a),this._appendFormDataInputsToForm(a,i),i.appendTo("body"),_.a.trigger(i,"submit"),setTimeout(()=>i.remove())}getItemsContent(e){var t=this._getDownloadArgs(e),i={url:t.url,headers:this._requestHeaders||{},method:ce,responseType:"arraybuffer",data:{command:t.command,arguments:t.arguments},upload:{onprogress:r.n,onloadstart:r.n,onabort:r.n},xhrFields:{},cache:!1};return this._beforeSendInternal(i),X.a.sendRequest(i)}_getDownloadArgs(e){var t={pathInfoList:e.map(e=>e.getFullPathInfo())},i=JSON.stringify(t);return{url:this._endpointUrl,arguments:i,command:le}}_getItemsIds(e){return e.map(e=>e.relativeName)}_executeRequest(e,t){var i=e===ee?de:ce,o=new s.a,a={url:this._getEndpointUrl(e,t),headers:this._requestHeaders||{},method:i,dataType:"json",data:{},xhrFields:{},cache:!1};return this._beforeSendInternal(a),X.a.sendRequest(a).then(e=>{!e.success&&o.reject(e)||o.resolve(e)},e=>o.reject(e)),o.promise()}_beforeSubmitInternal(e){Object(n.h)(this._beforeSubmit)&&this._beforeSubmit({formData:e})}_beforeSendInternal(e){if(Object(n.h)(this._beforeAjaxSend)){var t={headers:e.headers,formData:e.data,xhrFields:e.xhrFields};this._beforeAjaxSend(t),e.headers=t.headers,e.data=t.formData,e.xhrFields=t.xhrFields}Object(n.e)(e.data)?delete e.data:(e.responseType||e.upload)&&(e.data=this._createFormData(e.data))}_createFormData(e){var t=new Q.FormData;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&Object(n.d)(e[i])&&t.append(i,e[i]);return t}_appendFormDataInputsToForm(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&Object(n.d)(e[i])&&Object(o.a)("<input>").attr({type:"hidden",name:i,value:e[i]}).appendTo(t)}_getEndpointUrl(e,t){var i=this._getQueryString({command:e,arguments:JSON.stringify(t)}),o=this._endpointUrl&&this._endpointUrl.indexOf("?")>0?"&":"?";return this._endpointUrl+o+i}_getQueryString(e){for(var t=[],i=Object.keys(e),o=0;o<i.length;o++){var a=i[o],n=e[a];if(void 0!==n)if(null===n&&(n=""),Array.isArray(n))this._processQueryStringArrayParam(a,n,t);else{var s=this._getQueryStringPair(a,n);t.push(s)}}return t.join("&")}_processQueryStringArrayParam(e,t,i){Object(Y.a)(t,(t,o)=>{var a=this._getQueryStringPair(e,o);i.push(a)})}_getQueryStringPair(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return"boolean"!=typeof t||t}_getKeyExpr(e){return e.keyExpr||"key"}}var ue=he,pe=i("E6yd");class me{constructor(e){e=e||{},this._options=Object(a.a)({},e),this._isInitialized=!1,this._dataLoading=!1,this._dataLoadingDeferred=null,this._rootDirectoryInfo=this._createRootDirectoryInfo(e.rootText),this._currentDirectoryInfo=this._rootDirectoryInfo,this._defaultIconMap=this._createDefaultIconMap(),this.startSingleLoad(),this._setSecurityController(),this._setProvider(e.fileProvider),this._initialize()}_initialize(){var e=this._options.currentPathKeys&&this._options.currentPathKeys.length?this.setCurrentPathByKeys(this._options.currentPathKeys):this.setCurrentPath(this._options.currentPath),t=()=>{this._isInitialized=!0,this._raiseInitialized()};e?Object(s.c)(e).always(t):t()}_setSecurityController(){this._securityController=new _e({allowedFileExtensions:this._options.allowedFileExtensions,maxFileSize:this._options.uploadMaxFileSize}),this._resetState()}setAllowedFileExtensions(e){Object(n.d)(e)&&(this._options.allowedFileExtensions=e),this._setSecurityController(),this.refresh()}setUploadOptions(e){var{maxFileSize:t,chunkSize:i}=e;Object(n.d)(i)&&(this._options.uploadChunkSize=i),Object(n.d)(t)&&(this._options.uploadMaxFileSize=t,this._setSecurityController(),this.refresh())}_setProvider(e){this._fileProvider=this._createFileProvider(e),this._resetState()}updateProvider(e,t){return Object(n.d)(t)?Object(s.c)(this._getDirectoryByPathParts(this._rootDirectoryInfo,t,!0)).then(t=>{t!==this._rootDirectoryInfo&&this._resetCurrentDirectory(),this._setProvider(e)}).then(()=>this.setCurrentPathByKeys(t)):this._updateProviderOnly(e)}_updateProviderOnly(e){return this._resetCurrentDirectory(),this._setProvider(e),Object(s.c)(this.refresh())}_createFileProvider(e){if(e||(e=[]),Array.isArray(e))return new J({data:e});if(e instanceof B.a)return e;switch(e.type){case"remote":return new ue(e);case"custom":return new pe.a(e)}return new J(e)}setCurrentPath(e){var t=Object(q.e)(e),i=Object(q.f)(...t);return this.getCurrentDirectory().fileItem.relativeName===i?(new s.a).resolve().promise():this._setCurrentDirectoryByPathParts(t)}setCurrentPathByKeys(e){return Object(r.h)(this.getCurrentDirectory().fileItem.pathKeys,e,0,!0)?(new s.a).resolve().promise():this._setCurrentDirectoryByPathParts(e,!0)}getCurrentPath(){for(var e="",t=this.getCurrentDirectory();t&&!t.fileItem.isRoot();){var i=Object(q.b)(t.fileItem.name);e=Object(q.f)(i,e),t=t.parentDirectory}return e}getCurrentPathKeys(){return this.getCurrentDirectory().fileItem.pathKeys}getCurrentDirectory(){return this._currentDirectoryInfo}setCurrentDirectory(e,t){if(e)if(t&&(e=this._getActualDirectoryInfo(e)),this._currentDirectoryInfo&&this._currentDirectoryInfo===e)this._raisePathPotentiallyChanged();else{var i=this._currentDirectoryInfo.fileItem.key!==e.fileItem.key;this._currentDirectoryInfo=e,i&&this._isInitialized&&(this._dataLoading||this._raiseDataLoading("navigation"),this._raiseSelectedDirectoryChanged(e))}}_resetCurrentDirectory(){this._currentDirectoryInfo=this._rootDirectoryInfo}getCurrentItems(e){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._getCurrentItemsInternal(e)):this._getCurrentItemsInternal(e)}_getCurrentItemsInternal(e){var t=this.getCurrentDirectory();return this.getDirectoryContents(t).then(i=>{var o=this._separateItemsByType(i);return t.fileItem.hasSubDirectories=!!o.folders.length,e?o.files:i})}getDirectories(e,t){return this.getDirectoryContents(e,t).then(e=>e.filter(e=>e.fileItem.isDirectory))}_separateItemsByType(e){var t=[],i=[];return e.forEach(e=>e.fileItem.isDirectory?t.push(e):i.push(e)),{folders:t,files:i}}getDirectoryContents(e,t){if(!e)return(new s.a).resolve([this._rootDirectoryInfo]).promise();if(e.itemsLoaded)return(new s.a).resolve(e.items).promise();if(this._singleOperationLockId&&e.itemsSingleLoadErrorId===this._singleOperationLockId)return this._changeDirectoryOnError(e,t,!0),(new s.a).reject().promise();var i=e.getInternalKey(),o=this._loadedItems[i];return o||(o=this._getFileItems(e,t).then(t=>(t=t||[],e.items=t.map(t=>t.isDirectory&&this._createDirectoryInfo(t,e)||this._createFileInfo(t,e)),e.itemsLoaded=!0,e.items),()=>(this._singleOperationLockId&&e.itemsSingleLoadErrorId!==this._singleOperationLockId&&(e.itemsSingleLoadErrorId=this._singleOperationLockId),[])),this._loadedItems[i]=o,o.always(()=>{delete this._loadedItems[i]}),o)}_getFileItems(e,t){var i=null;try{i=this._fileProvider.getItems(e.fileItem)}catch(i){return this._handleItemLoadError(e,i,t)}return Object(s.c)(i).then(e=>this._securityController.getAllowedItems(e),i=>this._handleItemLoadError(e,i,t))}createDirectory(e,t){var i=e.fileItem,o=this._createDirInfoByName(t,e),a=this._createEditActionInfo("create",o,e);return this._processEditAction(a,e=>{e.parentDirectory=i,e.name=t,this._editingEvents.onDirectoryCreating(e)},()=>this._fileProvider.createDirectory(i,t).done(e=>(i.isRoot()||(i.hasSubDirectories=!0),e)),()=>{var e={parentDirectory:i,name:t};this._editingEvents.onDirectoryCreated(e)},()=>this._resetDirectoryState(e,!0))}renameItem(e,t){var i=e.fileItem.createClone(),o=this._createEditActionInfo("rename",e,e.parentDirectory,{itemNewName:t});return this._processEditAction(o,(e,o)=>{o.fileItem.isDirectory||this._securityController.validateExtension(t),e.item=i,e.newName=t,this._editingEvents.onItemRenaming(e)},e=>this._fileProvider.renameItem(e,t),()=>{var e={sourceItem:i,itemName:t};this._editingEvents.onItemRenamed(e)},()=>{var t=this._getActualDirectoryInfo(e.parentDirectory);this._resetDirectoryState(t),this.setCurrentDirectory(t)})}moveItems(e,t){var i=this._createEditActionInfo("move",e,t);return this._processEditAction(i,(e,i)=>{e.item=i.fileItem,e.destinationDirectory=t.fileItem,this._editingEvents.onItemMoving(e)},e=>this._fileProvider.moveItems([e],t.fileItem),e=>{var i={sourceItem:e.fileItem,parentDirectory:t.fileItem,itemName:e.fileItem.name,itemPath:Object(q.f)(t.fileItem.path,e.fileItem.name)};this._editingEvents.onItemMoved(i)},i=>{e.forEach(e=>this._resetDirectoryState(e.parentDirectory,!0)),i&&(this._resetDirectoryState(t),this.setCurrentPathByKeys(t.fileItem.pathKeys),t.expanded=!0)})}copyItems(e,t){var i=this._createEditActionInfo("copy",e,t);return this._processEditAction(i,(e,i)=>{e.item=i.fileItem,e.destinationDirectory=t.fileItem,this._editingEvents.onItemCopying(e)},e=>this._fileProvider.copyItems([e],t.fileItem),e=>{var i={sourceItem:e.fileItem,parentDirectory:t.fileItem,itemName:e.fileItem.name,itemPath:Object(q.f)(t.fileItem.path,e.fileItem.name)};this._editingEvents.onItemCopied(i)},e=>{e&&(t=this._getActualDirectoryInfo(t),this._resetDirectoryState(t),this.setCurrentDirectory(t),t.expanded=!0)})}deleteItems(e){var t=e.length>0?e[0].parentDirectory:null,i=this._createEditActionInfo("delete",e,t);return this._processEditAction(i,(e,t)=>{e.item=t.fileItem,this._editingEvents.onItemDeleting(e)},e=>this._fileProvider.deleteItems([e]),e=>this._editingEvents.onItemDeleted({item:e.fileItem}),()=>{e.forEach(e=>{var t=this._getActualDirectoryInfo(e.parentDirectory);this._resetDirectoryState(t),this.setCurrentDirectory(t)})})}processUploadSession(e,t){var i=this._getItemInfosForUploaderFiles(e.files,t),o=this._createEditActionInfo("upload",i,t,{sessionInfo:e});return this._processEditAction(o,()=>{},(t,i)=>e.deferreds[i],()=>{},()=>this._resetDirectoryState(t,!0))}uploadFileChunk(e,t,i){var o=null;0===t.chunkIndex?(this._securityController.validateMaxFileSize(e.size),this._securityController.validateExtension(e.name),o=this._processBeforeItemEditAction(t=>{t.fileData=e,t.destinationDirectory=i,this._editingEvents.onFileUploading(t)})):o=(new s.a).resolve().promise();var a=o.then(()=>this._fileProvider.uploadFileChunk(e,t,i));return t.chunkIndex===t.chunkCount-1&&(a=a.done(()=>{var t={fileData:e,parentDirectory:i};this._editingEvents.onFileUploaded(t)})),a}abortFileUpload(e,t,i){return Object(s.c)(this._fileProvider.abortFileUpload(e,t,i))}getFileUploadChunkSize(){var e=this._options.uploadChunkSize;return e&&e>0?e:this._fileProvider.getFileUploadChunkSize()}downloadItems(e){var t=e.map(e=>this._processBeforeItemEditAction(t=>{t.item=e.fileItem,this._editingEvents.onItemDownloading(t)},e));return Object(s.c)(...t).then(()=>{var t=e.map(e=>e.fileItem);return Object(s.c)(this._getItemActionResult(this._fileProvider.downloadItems(t))).then(()=>{},t=>{this._raiseDownloadItemsError(e,e[0].parentDirectory,t)})},t=>{this._raiseDownloadItemsError(e,e[0].parentDirectory,t)})}getItemContent(e){var t=e.map(e=>e.fileItem);return Object(s.c)(this._fileProvider.getItemsContent(t))}_handleItemLoadError(e,t,i){return e=this._getActualDirectoryInfo(e),this._raiseGetItemsError(e,t),this._changeDirectoryOnError(e,i),(new s.a).reject().promise()}_raiseGetItemsError(e,t){var i=this._createEditActionInfo("getItems",e,e);this._raiseEditActionStarting(i),this._raiseEditActionResultAcquired(i),this._raiseEditActionError(i,{errorCode:t.errorCode,errorText:t.errorText,fileItem:e.fileItem,index:0})}_raiseDownloadItemsError(e,t,i){var o=this._createEditActionInfo("download",e,t),a=e.length;o.singleRequest=1===a,this._raiseEditActionStarting(o),this._raiseEditActionResultAcquired(o);for(var n=0;n<a-1;n++)this._raiseEditActionItemError(o,{errorCode:i.errorCode,errorText:i.errorText,fileItem:e[n].fileItem,index:n});this._raiseEditActionError(o,{errorCode:i.errorCode,errorText:i.errorText,fileItem:e[a-1].fileItem,index:a-1})}_changeDirectoryOnError(e,t,i){i&&(e=this._getActualDirectoryInfo(e)),this._resetDirectoryState(e),e.expanded=!1,t||this.setCurrentDirectory(e.parentDirectory)}_getItemActionResult(e){return Array.isArray(e)?e[0]:e}_processEditAction(e,t,i,o,a){var n=!1;this._raiseEditActionStarting(e);var s=e.itemInfos.map((e,a)=>this._processBeforeItemEditAction(t,e).then(()=>this._getItemActionResult(i(e.fileItem,a)).done(()=>o(e))));return e.singleRequest=1===s.length,this._raiseEditActionResultAcquired(e),A(s,t=>{n=!0,this._raiseCompleteEditActionItem(e,t)},t=>this._raiseEditActionItemError(e,t)).then(()=>{a(n),this._raiseCompleteEditAction(e)})}_createEditActionInfo(e,t,i,o){o=o||{};var a=(t=Array.isArray(t)?t:[t]).map(e=>e.fileItem);return{name:e,itemInfos:t,items:a,directory:i,customData:o,singleRequest:!0}}_processBeforeItemEditAction(e,t){var i=new s.a,o=this._createBeforeActionArgs();try{e(o,t)}catch(e){return i.reject(e).promise()}if(o.cancel){if(!0===o.cancel)return i.reject({errorText:o.errorText,errorCode:o.errorCode});Object(n.m)(o.cancel)&&Object(s.c)(o.cancel).then(e=>{!0===e?i.reject():Object(n.j)(e)&&!0===e.cancel&&i.reject({errorText:e.errorText,errorCode:e.errorCode}),i.resolve()},i.resolve)}else i.resolve();return i.promise()}_createBeforeActionArgs(){return{errorCode:void 0,errorText:"",cancel:!1}}_getItemInfosForUploaderFiles(e,t){for(var i=this._getPathInfo(t),o=[],a=0;a<e.length;a++){var n=e[a],s=new U.a(i,n.name,!1),r=this._createFileInfo(s,t);o.push(r)}return o}refresh(){return this._lockRefresh?this._refreshDeferred:(this._lockRefresh=!0,this._executeDataLoad(()=>this._refreshDeferred=this._refreshInternal(),"refresh"))}startSingleLoad(){this._singleOperationLockId=(new V.a).toString()}endSingleLoad(){delete this._singleOperationLockId}_refreshInternal(){var e={items:this._rootDirectoryInfo.items},t=this._getDirectoryPathKeyParts(this.getCurrentDirectory());return this._resetDirectoryState(this._rootDirectoryInfo),this._loadItemsRecursive(this._rootDirectoryInfo,e).then(()=>{var e=this._findDirectoryByPathKeyParts(t);this.setCurrentDirectory(e),delete this._lockRefresh})}_loadItemsRecursive(e,t){var i=this;return this.getDirectories(e).then(e=>{for(var o=[],a=function(a){var n=Object(f.a)(t.items,t=>e[a].fileItem.key===t.fileItem.key);if(!n)return"continue";e[a].expanded=n.expanded,e[a].expanded&&o.push(i._loadItemsRecursive(e[a],n))},n=0;n<e.length;n++)a(n);return A(o)},()=>null)}_setCurrentDirectoryByPathParts(e,t){return this._executeDataLoad(()=>this._setCurrentDirectoryByPathPartsInternal(e,t),"navigation")}_setCurrentDirectoryByPathPartsInternal(e,t){return this._getDirectoryByPathParts(this._rootDirectoryInfo,e,t).then(e=>{for(var t=e.parentDirectory;t;t=t.parentDirectory)t.expanded=!0;this.setCurrentDirectory(e)},()=>{this._raisePathPotentiallyChanged()})}_executeDataLoad(e,t){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._executeDataLoad(e,t)):(this._dataLoading=!0,this._dataLoadingDeferred=new s.a,this._isInitialized&&this._raiseDataLoading(t),e().always(()=>{var e=this._dataLoadingDeferred;this._dataLoadingDeferred=null,this._dataLoading=!1,e.resolve()}))}_getDirectoryByPathParts(e,t,i){if(t.length<1)return(new s.a).resolve(e).promise();var o=i?"key":"name";return this.getDirectories(e).then(e=>{var a=Object(f.a)(e,e=>e.fileItem[o]===t[0]);if(!a)return(new s.a).reject().promise();var n=[...t].splice(1);return this._getDirectoryByPathParts(a,n,i)})}_getDirectoryPathKeyParts(e){for(var t=[];e&&e.parentDirectory;)t.unshift(e.fileItem.key),e=e.parentDirectory;return t}_findDirectoryByPathKeyParts(e){var t=this._rootDirectoryInfo;if(0===e.length)return t;for(var i=0,o=t;o&&i<e.length;)(o=Object(f.a)(t.items,t=>t.fileItem.key===e[i]))&&(t=o),i++;return t}_getActualDirectoryInfo(e){var t=this._getDirectoryPathKeyParts(e);return this._findDirectoryByPathKeyParts(t)}_createDirInfoByName(e,t){var i=this._getPathInfo(t),o=new U.a(i,e,!0);return this._createDirectoryInfo(o,t)}_createDirectoryInfo(e,t){return Object(a.a)(this._createFileInfo(e,t),{icon:"folder",expanded:e.isRoot(),items:[]})}_createFileInfo(e,t){return{fileItem:e,parentDirectory:t,icon:this._getFileItemDefaultIcon(e),getInternalKey(){return"FIK_".concat(this.fileItem.key)},getDisplayName(){return this.displayName||this.fileItem.name}}}_resetDirectoryState(e,t){t&&(e=this._getActualDirectoryInfo(e)),e.itemsLoaded=!1,e.items=[]}_getFileItemDefaultIcon(e){if(e.isDirectory)return"folder";var t=e.getFileExtension();return this._defaultIconMap[t]||"doc"}_createDefaultIconMap(){var e={".txt":"txtfile",".rtf":"rtffile",".doc":"docfile",".docx":"docxfile",".xls":"xlsfile",".xlsx":"xlsxfile",".ppt":"pptfile",".pptx":"pptxfile",".pdf":"pdffile"};return[".png",".gif",".jpg",".jpeg",".ico",".bmp"].forEach(t=>{e[t]="image"}),e}_createRootDirectoryInfo(e){var t=new U.a(null,"",!0),i=this._createDirectoryInfo(t,null);return i.displayName=e||"Files",i}setRootText(e){this._rootDirectoryInfo.displayName=e||"Files"}_raiseInitialized(){this._tryCallAction("onInitialized",{controller:this})}_raiseDataLoading(e){this._tryCallAction("onDataLoading",{operation:e})}_raiseSelectedDirectoryChanged(e){this._tryCallAction("onSelectedDirectoryChanged",{selectedDirectoryInfo:e})}_raiseEditActionStarting(e){this._tryCallAction("onEditActionStarting",e)}_raiseEditActionResultAcquired(e){this._tryCallAction("onEditActionResultAcquired",e)}_raiseEditActionError(e,t){this._tryCallAction("onEditActionError",e,t)}_raiseEditActionItemError(e,t){this._tryCallAction("onEditActionItemError",e,t)}_raiseCompleteEditActionItem(e,t){this._tryCallAction("onCompleteEditActionItem",e,t)}_raiseCompleteEditAction(e){this._tryCallAction("onCompleteEditAction",e)}_raisePathPotentiallyChanged(){this._tryCallAction("onPathPotentiallyChanged")}_tryCallAction(e){var t=Array.prototype.slice.call(arguments,1);this._isInitialized&&this._options[e]&&this._options[e](...t)}_resetState(){this._selectedDirectory=null,this._rootDirectoryInfo.items=[],this._rootDirectoryInfo.itemsLoaded=!1,this._loadedItems={}}_getPathInfo(e){for(var t=[],i=e;i&&!i.fileItem.isRoot();i=i.parentDirectory)t.unshift({key:i.fileItem.key,name:i.fileItem.name});return t}on(e,t){var i="on".concat(e);this._options[i]=t}get _editingEvents(){return this._options.editingEvents}}class _e{constructor(e){this._options=Object(a.a)({allowedFileExtensions:[],maxFileSize:0},e),this._extensionsMap={},this._allowedFileExtensions.forEach(e=>{this._extensionsMap[e.toUpperCase()]=!0})}getAllowedItems(e){return 0===this._allowedFileExtensions.length?e:e.filter(e=>e.isDirectory||this._isValidExtension(e.name))}validateExtension(e){if(!this._isValidExtension(e))throw new H(W.WrongFileExtension,null)}validateMaxFileSize(e){if(this._maxFileSize&&e>this._maxFileSize)throw new H(W.MaxFileSizeExceeded,null)}_isValidExtension(e){if(0===this._allowedFileExtensions.length)return!0;var t=Object(q.c)(e).toUpperCase();return this._extensionsMap[t]}get _allowedFileExtensions(){return this._options.allowedFileExtensions}get _maxFileSize(){return this._options.maxFileSize}}var ge={create:!1,copy:!1,move:!1,delete:!1,rename:!1,upload:!1,download:!1};class fe{constructor(e){this._actions={},this._permissions=e||{},this._initCommands()}_initCommands(){this._commands=[{name:"create",text:l.a.format("dxFileManager-commandCreate"),icon:"newfolder",enabled:this._permissions.create,noFileItemRequired:!0},{name:"rename",text:l.a.format("dxFileManager-commandRename"),icon:"rename",enabled:this._permissions.rename,isSingleFileItemCommand:!0},{name:"move",text:l.a.format("dxFileManager-commandMove"),icon:"movetofolder",enabled:this._permissions.move},{name:"copy",text:l.a.format("dxFileManager-commandCopy"),icon:"copy",enabled:this._permissions.copy},{name:"delete",text:l.a.format("dxFileManager-commandDelete"),icon:"trash",enabled:this._permissions.delete},{name:"download",text:l.a.format("dxFileManager-commandDownload"),icon:"download",enabled:this._permissions.download},{name:"upload",text:l.a.format("dxFileManager-commandUpload"),icon:"upload",enabled:this._permissions.upload,noFileItemRequired:!0},{name:"refresh",text:l.a.format("dxFileManager-commandRefresh"),icon:"dx-filemanager-i dx-filemanager-i-refresh",enabled:!0,noFileItemRequired:!0},{name:"thumbnails",text:l.a.format("dxFileManager-commandThumbnails"),icon:"mediumiconslayout",enabled:!0,noFileItemRequired:!0},{name:"details",text:l.a.format("dxFileManager-commandDetails"),icon:"detailslayout",enabled:!0,noFileItemRequired:!0},{name:"clearSelection",text:l.a.format("dxFileManager-commandClearSelection"),icon:"remove",enabled:!0},{name:"showNavPane",hint:l.a.format("dxFileManager-commandShowNavPane"),icon:"menu",enabled:!1,noFileItemRequired:!0}],this._commandMap={},this._commands.forEach(e=>{this._commandMap[e.name]=e})}registerActions(e){this._actions=Object(a.a)(this._actions,e)}executeCommand(e,t){var i=Object(n.o)(e)?e:e.name,o=this._actions[i];if(o)return o(t)}updatePermissions(e){var t=Object(a.a)({},ge,e);this._permissions=t,Object(Y.a)(this._permissions,e=>{this._commandMap[e].enabled=this._permissions[e]})}setCommandEnabled(e,t){var i=this.getCommandByName(e);i&&(i.enabled=t)}getCommandByName(e){return this._commandMap[e]}isCommandAvailable(e,t){var i=this.getCommandByName(e);if(!i||!i.enabled)return!1;if(i.noFileItemRequired)return!0;var o=t&&t.length||0;return 0!==o&&!t.some(e=>e.fileItem.isRoot()||e.fileItem.isParentFolder)&&("download"===e?t.every(e=>!e.fileItem.isDirectory):!i.isSingleFileItemCommand||1===o)}}var Ie=i("hc4w"),ve={create:{},upload:{},download:{},rename:{},move:{},copy:{},delete:{},refresh:{beginGroup:!0}},Ce=["beginGroup","closeMenuOnClick","disabled","icon","selectable","selected","text","visible"];class be extends c.a{_initMarkup(){this._initActions(),this._isVisible=!1;var e=Object(o.a)("<div>").appendTo(this.$element());this._contextMenu=this._createComponent(e,Ie.a,{cssClass:"dx-filemanager-context-menu",showEvent:"",onItemClick:e=>this._onContextMenuItemClick(e.itemData.name,e),onShowing:e=>this._onContextMenuShowing(e),onShown:()=>this._onContextMenuShown(),onHidden:()=>this._onContextMenuHidden()}),super._initMarkup()}showAt(e,t,i,o){var{itemData:a,itemElement:n,isActionButton:s=!1}=o;this._isVisible&&this._onContextMenuHidden(),this._menuShowingContext={targetElement:n,itemData:a,fileItems:e,event:i,isActionButton:s};var r={of:t,at:"top left",my:"top left",offset:""};i?r.offset=i.offsetX+" "+i.offsetY:(r.my="left top",r.at="left bottom",r.boundaryOffset="1"),this._contextMenu.option({target:t,position:r}),this._contextMenu.show()}createContextMenuItems(e,t,i){this._targetFileItems=e,this._targetFileItem=Object(n.d)(i)?i:null==e?void 0:e[0];var o=[];return(t||this.option("items")).forEach(t=>{var i=Object(n.o)(t)?t:t.name,a=this._configureItemByCommandName(i,t,e,this._targetFileItem);this._isContextMenuItemAvailable(a,e)&&o.push(a)}),o}_isContextMenuItemAvailable(e,t){return this._isDefaultItem(e.name)&&e._autoHide?!(this._isIsolatedCreationItemCommand(e.name)&&t&&t.length)&&this._commandManager.isCommandAvailable(e.name,t):Object(r.g)(e.visible,!0)}_isIsolatedCreationItemCommand(e){return("create"===e||"upload"===e)&&this.option("isolateCreationItemCommands")}_isDefaultItem(e){return!!ve[e]}_configureItemByCommandName(e,t,i,o){if(!this._isDefaultItem(e)){var s=Object(a.a)(!0,{},t);return s.originalItemData=t,this._addItemClickHandler(e,s),Array.isArray(t.items)&&(s.items=this.createContextMenuItems(i,t.items,o)),s}var r=this._createMenuItemByCommandName(e),l=ve[e];return Object(a.a)(r,l),r.originalItemData=t,j(r,t,Ce),Object(n.d)(r.visible)||(r._autoHide=!0),e&&!r.name&&Object(a.a)(r,{name:e}),r}_createMenuItemByCommandName(e){var{text:t,icon:i}=this._commandManager.getCommandByName(e),o={name:e,text:t,icon:i};return this._addItemClickHandler(e,o),o}_addItemClickHandler(e,t){t.onItemClick=t=>this._onContextMenuItemClick(e,t)}_onContextMenuItemClick(e,t){var i,o=Object(a.a)(!0,{},t);if(o.itemData=t.itemData.originalItemData,o.fileSystemItem=null===(i=this._targetFileItem)||void 0===i?void 0:i.fileItem,o.viewArea=this.option("viewArea"),this._actions.onItemClick(o),this._isDefaultItem(e)){var n=this._isIsolatedCreationItemCommand(e)?null:this._targetFileItems;this._commandManager.executeCommand(e,n)}}_initActions(){this._actions={onContextMenuHidden:this._createActionByOption("onContextMenuHidden"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onItemClick:this._createActionByOption("onItemClick")}}_onContextMenuShowing(e){if(this._isVisible&&this._onContextMenuHidden(!0),e=Object(a.a)(e,this._menuShowingContext,{options:this.option(),cancel:!1}),this._actions.onContextMenuShowing(e),!e.cancel){var t=this.createContextMenuItems(this._menuShowingContext.fileItems,null,this._menuShowingContext.fileSystemItem);this._contextMenu.option("dataSource",t)}}tryUpdateVisibleContextMenu(){if(this._isVisible){var e=this.createContextMenuItems(this._targetFileItems);this._contextMenu.option("dataSource",e)}}_onContextMenuShown(){this._isVisible=!0}_onContextMenuHidden(e){this._isVisible=!1,e||(this._menuShowingContext={}),this._contextMenu.option("visible",!1),this._raiseContextMenuHidden()}_raiseContextMenuHidden(){this._actions.onContextMenuHidden()}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{commandManager:null,onContextMenuHidden:null,onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":this.repaint();break;case"items":this.tryUpdateVisibleContextMenu();break;case"onItemClick":case"onContextMenuShowing":case"onContextMenuHidden":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _commandManager(){return this.option("commandManager")}}var ye=be,xe=i("HieS"),De=i("JL4z"),Se=i("B61+");class Oe extends c.a{_initMarkup(){this._createClickAction();var e=Object(o.a)("<div>");this.$element().append(e).addClass("dx-filemanager-file-actions-button"),this._button=this._createComponent(e,Se.default,{icon:"overflow",stylingMode:"text",onClick:e=>this._raiseClick(e)}),super._initMarkup()}_createClickAction(){this._clickAction=this._createActionByOption("onClick")}_raiseClick(e){this._clickAction(e)}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{cssClass:"",onClick:null})}_optionChanged(e){switch(e.name){case"cssClass":this.repaint();break;case"onClick":this._createClickAction();break;default:super._optionChanged(e)}}setActive(e){this.$element().toggleClass("dx-filemanager-file-actions-button-activated",e),setTimeout(()=>this._button.$element().toggleClass("dx-state-active",e))}}var Me=Oe;class Fe extends c.a{_initMarkup(){this._initActions(),this._getCurrentDirectory=this.option("getCurrentDirectory"),this._createFileActionsButton=r.n,this._storeExpandedState=this.option("storeExpandedState")||!1;var e=Object(o.a)("<div>").addClass("dx-filemanager-dirs-tree").appendTo(this.$element()),t={dataStructure:"plain",rootValue:"",createChildren:this._onFilesTreeViewCreateSubDirectories.bind(this),itemTemplate:this._createFilesTreeViewItemTemplate.bind(this),keyExpr:"getInternalKey",parentIdExpr:"parentDirectory.getInternalKey",displayExpr:e=>e.getDisplayName(),hasItemsExpr:"fileItem.hasSubDirectories",onItemClick:e=>this._actions.onDirectoryClick(e),onItemExpanded:e=>this._onFilesTreeViewItemExpanded(e),onItemCollapsed:e=>this._onFilesTreeViewItemCollapsed(e),onItemRendered:e=>this._onFilesTreeViewItemRendered(e),onContentReady:()=>this._actions.onFilesTreeViewContentReady()};this._contextMenu&&(this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),t.onItemContextMenu=e=>this._onFilesTreeViewItemContextMenu(e),this._createFileActionsButton=(e,t)=>this._createComponent(e,Me,t)),this._filesTreeView=this._createComponent(e,De.a,t)}_initActions(){this._actions={onDirectoryClick:this._createActionByOption("onDirectoryClick"),onFilesTreeViewContentReady:this._createActionByOption("onFilesTreeViewContentReady")}}_render(){super._render();var e=this;setTimeout(()=>{e._updateFocusedElement()})}_onFilesTreeViewCreateSubDirectories(e){var t=this.option("getDirectories"),i=e&&e.itemData||null;return t&&t(i,!0)}_onFilesTreeViewItemRendered(e){var{itemData:t}=e,i=this._getCurrentDirectory();i&&i.fileItem.equals(t.fileItem)&&(this._updateFocusedElement(),this._restoreScrollTopPosition())}_onFilesTreeViewItemExpanded(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!0)}_onFilesTreeViewItemCollapsed(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!1)}_createFilesTreeViewItemTemplate(e,t,i){var a=Object(o.a)(i);a.closest(this._filesTreeViewItemSelector).data("item",e);var n=Object(xe.a)(e.icon),s=Object(o.a)("<span>").text(e.getDisplayName()).addClass("dx-filemanager-dirs-tree-item-text"),r=Object(o.a)("<div>");a.append(n,s,r),this._createFileActionsButton(r,{onClick:e=>this._onFileItemActionButtonClick(e)})}_onFilesTreeViewItemContextMenu(e){var{itemElement:t,event:i}=e;i.preventDefault(),i.stopPropagation();var a=Object(o.a)(t).data("item");this._contextMenu.showAt([a],t,i,{itemData:a,itemElement:t})}_onFileItemActionButtonClick(e){var{component:t,element:i,event:o}=e;o.stopPropagation();var a=t.$element().closest(this._filesTreeViewItemSelector),n=a.data("item"),s={itemData:n,itemElement:a,isActionButton:!0};this._contextMenu.showAt([n],i,o,s),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}toggleNodeDisabledState(e,t){var i=this._getNodeByKey(e);if(i){var o=this._filesTreeView.option("items").map(e=>e.getInternalKey()).indexOf(i.getInternalKey());-1!==o&&this._filesTreeView.option("items[".concat(o,"].disabled"),t)}}_saveScrollTopPosition(){Object(p.f)()&&(this._scrollTopPosition=this._filesTreeView.getScrollable().scrollTop())}_restoreScrollTopPosition(){Object(p.f)()&&Object(n.i)(this._scrollTopPosition)&&setTimeout(()=>this._filesTreeView.getScrollable().scrollTo(this._scrollTopPosition))}_updateFocusedElement(){var e=this._getCurrentDirectory(),t=this._getItemElementByKey(null==e?void 0:e.getInternalKey());this._$focusedElement&&this._$focusedElement.toggleClass("dx-filemanager-focused-item",!1),this._$focusedElement=t||Object(o.a)(),this._$focusedElement.toggleClass("dx-filemanager-focused-item",!0)}_getNodeByKey(e){var t;return null===(t=this._filesTreeView)||void 0===t?void 0:t._getNode(e)}_getPublicNode(e){for(var t,i=[...null===(t=this._filesTreeView)||void 0===t?void 0:t.getNodes()];i.length;){var o=i.shift();if(o.itemData.getInternalKey()===e)return o;o.children.length&&i.push(...o.children)}}_getItemElementByKey(e){var t=this._getNodeByKey(e);if(t){var i=this._filesTreeView._getNodeElement(t);if(i)return i.children(this._filesTreeViewItemSelector)}return null}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{storeExpandedState:!1,initialFolder:null,contextMenu:null,getItems:null,getCurrentDirectory:null,onDirectoryClick:null})}_optionChanged(e){var t=e.name;switch(t){case"storeExpandedState":this._storeExpandedState=this.option(t);break;case"getItems":case"rootFolderDisplayName":case"initialFolder":case"contextMenu":this.repaint();break;case"getCurrentDirectory":this.getCurrentDirectory=this.option(t);break;case"onDirectoryClick":case"onFilesTreeViewContentReady":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _filesTreeViewItemSelector(){return".".concat("dx-treeview-item")}get _contextMenu(){return this.option("contextMenu")}toggleDirectoryExpandedState(e,t){var i=new s.a,o=this._getPublicNode(null==e?void 0:e.getInternalKey());if(!o)return i.reject().promise();if(o.expanded===t||o.itemsLoaded&&!o.itemData.fileItem.hasSubDirectories)return i.resolve().promise();var a=t?"expandItem":"collapseItem";return this._filesTreeView[a](e.getInternalKey())}refresh(){this._$focusedElement=null,this._saveScrollTopPosition(),this._filesTreeView.option("dataSource",[])}updateCurrentDirectory(){this._disposed||(this._updateFocusedElement(),this._storeExpandedState&&this._updateExpandedStateToCurrentDirectory())}_updateExpandedStateToCurrentDirectory(){return this.toggleDirectoryExpandedStateRecursive(this._getCurrentDirectory().parentDirectory,!0)}toggleDirectoryExpandedStateRecursive(e,t){for(var i=[],o=e;o;o=o.parentDirectory)i.unshift(o);return this.toggleDirectoryLineExpandedState(i,t)}toggleDirectoryLineExpandedState(e,t){return e.length?this.toggleDirectoryExpandedState(e.shift(),t).then(()=>this.toggleDirectoryLineExpandedState(e,t)):(new s.a).resolve().promise()}}var we=Fe,Ee=i("oisP"),Pe=i("f4eO"),Ae=i("AmyY"),Te=i("TE0E"),je=i("ySCK");class ke extends c.a{_init(){this._initActions(),this._lockFocusedItemProcessing=!1,this._focusedItemKey=this.option("focusedItemKey"),super._init()}_initMarkup(){this.$element().addClass("dx-filemanager-files-view");var e=Object(Ae.a)(Pe.a,"dxFileManager_open");_.a.on(this.$element(),e,this._getItemSelector(),this._onItemDblClick.bind(this)),super._initMarkup()}_initActions(){this._actions={onError:this._createActionByOption("onError"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onSelectedItemOpened:this._createActionByOption("onSelectedItemOpened"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onItemListDataLoaded:this._createActionByOption("onItemListDataLoaded")}}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{selectionMode:"single",selectedItemKeys:[],focusedItemKey:void 0,contextMenu:null,getItems:null,getItemThumbnail:null,onError:null,onSelectionChanged:null,onFocusedItemChanged:null,onSelectedItemOpened:null,onContextMenuShowing:null})}_optionChanged(e){var t=e.name;switch(t){case"selectionMode":case"contextMenu":case"getItems":case"getItemThumbnail":this.repaint();break;case"selectedItemKeys":this._setSelectedItemKeys(e.value);break;case"focusedItemKey":this._lockFocusedItemProcessing||this._setFocusedItemKey(e.value);break;case"onError":case"onSelectedItemOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onContextMenuShowing":case"onItemListDataLoaded":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_getItems(){return this._getItemsInternal().done(e=>{this._itemCount=e.length,0===this._itemCount&&this._resetFocus();var t=this._findParentDirectoryItem(e);this._hasParentDirectoryItem=!!t,this._parentDirectoryItemKey=t?t.fileItem.key:null}).always(()=>{this._onDataLoaded()})}_getItemsInternal(){var e=this.option("getItems"),t=e?e():[];return Object(s.c)(t)}_raiseOnError(e){this._actions.onError({error:e})}_raiseSelectionChanged(e){this._actions.onSelectionChanged(e)}_raiseFocusedItemChanged(e){this._actions.onFocusedItemChanged(e)}_raiseSelectedItemOpened(e){this._actions.onSelectedItemOpened({fileItemInfo:e})}_raiseContextMenuShowing(e){this._actions.onContextMenuShowing(e)}_raiseItemListDataLoaded(){this._actions.onItemListDataLoaded()}_onDataLoaded(){var e;this._raiseItemListDataLoaded(),null===(e=this._refreshDeferred)||void 0===e||e.resolve()}_tryRaiseSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:a,currentDeselectedItemKeys:n}=e,s=this._findParentDirectoryItem(this.getSelectedItems());s&&this._deselectItem(s);var r=!this._hasParentDirectoryItem;(r=r||this._hasValidKeys(a)||this._hasValidKeys(n))&&(t=this._filterOutItemByPredicate(t,e=>e.fileItem.key===this._parentDirectoryItemKey),i=this._filterOutParentDirectory(i),o=this._filterOutParentDirectoryKey(o,!0),a=this._filterOutParentDirectoryKey(a,!0),n=this._filterOutParentDirectoryKey(n,!0),this._raiseSelectionChanged({selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:a,currentDeselectedItemKeys:n}))}_onFocusedItemChanged(e){this._focusedItemKey!==e.itemKey&&(this._focusedItemKey=e.itemKey,this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_resetFocus(){}_getItemThumbnail(e){var t=this.option("getItemThumbnail");return t?t(e):{thumbnail:""}}_getItemThumbnailContainer(e){var{thumbnail:t,cssClass:i}=this._getItemThumbnail(e),o=Object(xe.a)(t).addClass(this._getItemThumbnailCssClass());return i&&o.addClass(i),o}_getItemThumbnailCssClass(){return""}_getItemSelector(){}_onItemDblClick(e){}_isDesktop(){return"desktop"===Te.a.real().deviceType}_showContextMenu(e,t,i,o){this._contextMenu.showAt(e,t,i,o)}get _contextMenu(){return this.option("contextMenu")}_findParentDirectoryItem(e){for(var t=0;t<e.length;t++){var i=e[t];if(this._isParentDirectoryItem(i))return i}return null}_getFileItemsForContextMenu(e){var t=this.getSelectedItems();return this._isParentDirectoryItem(e)&&t.push(e),t}_isParentDirectoryItem(e){return e.fileItem.isParentFolder}_hasValidKeys(e){return e.length>1||1===e.length&&e[0]!==this._parentDirectoryItemKey}_filterOutParentDirectory(e,t){return this._filterOutItemByPredicate(e,e=>e.key===this._parentDirectoryItemKey,t)}_filterOutParentDirectoryKey(e,t){return this._filterOutItemByPredicate(e,e=>e===this._parentDirectoryItemKey,t)}_filterOutItemByPredicate(e,t,i){for(var o=e,a=-1,n=0;n<e.length;n++)if(t(e[n])){a=n;break}return-1!==a&&(i&&(o=[...e]),o.splice(a,1)),o}_isMultipleSelectionMode(){return"multiple"===this.option("selectionMode")}_deselectItem(e){}_setSelectedItemKeys(e){}_setFocusedItemKey(e){}_createDataSource(){return{store:new je.a({key:"fileItem.key",load:this._getItems.bind(this)})}}getSelectedItems(){}clearSelection(){}selectItem(){}}var Be=ke,Ue={thumbnail:{caption:"",calculateSortValue:"isDirectory",width:36,alignment:"center",cssClass:"dx-filemanager-details-item-is-directory"},name:{caption:l.a.format("dxFileManager-listDetailsColumnCaptionName")},dateModified:{caption:l.a.format("dxFileManager-listDetailsColumnCaptionDateModified"),width:110,hidingPriority:1},size:{caption:l.a.format("dxFileManager-listDetailsColumnCaptionFileSize"),width:90,alignment:"right",hidingPriority:0},isParentFolder:{caption:"isParentFolder",visible:!1,sortIndex:0,sortOrder:"asc"}};var $e=class extends Be{_initMarkup(){this._itemCount=0,this._focusedItem=null,this._hasParentDirectoryItem=!1,this._parentDirectoryItemKey=null,this._selectAllCheckBox=null,this._selectAllCheckBoxUpdating=!1,this.$element().addClass("dx-filemanager-details"),this._createFilesView(),this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),super._initMarkup()}_createFilesView(){var e=Object(o.a)("<div>").appendTo(this.$element()),t=this._isMultipleSelectionMode()?"multiple":"none";this._filesView=this._createComponent(e,Ee.a,{dataSource:this._createDataSource(),hoverStateEnabled:!0,selection:{mode:t,showCheckBoxesMode:this._isDesktop()?"onClick":"none"},selectedRowKeys:this.option("selectedItemKeys"),focusedRowKey:this.option("focusedItemKey"),focusedRowEnabled:!0,allowColumnResizing:!0,scrolling:{mode:"virtual"},sorting:{mode:"single",showSortIndexes:!1},loadPanel:{shading:!0},showColumnLines:!1,showRowLines:!1,columnHidingEnabled:!1,columns:this._createColumns(),onEditorPreparing:this._onEditorPreparing.bind(this),onRowPrepared:this._onRowPrepared.bind(this),onContextMenuPreparing:this._onContextMenuPreparing.bind(this),onSelectionChanged:this._onFilesViewSelectionChanged.bind(this),onFocusedRowChanged:this._onFilesViewFocusedRowChanged.bind(this),onOptionChanged:this._onFilesViewOptionChanged.bind(this)})}_createColumns(){var e=this.option("detailColumns");e=(e=e.slice(0)).map(e=>{var t=e;return Object(n.o)(e)&&(t={dataField:e}),this._getPreparedColumn(t)});var t=this.option("customizeDetailColumns");return Object(n.h)(t)&&(e=t(e)),e.push(this._getPreparedColumn({dataField:"isParentFolder"})),e.forEach(e=>this._updateColumnDataField(e)),e}_getPreparedColumn(e){var t={},i="";if(this._isDefaultColumn(e.dataField)){var o=Object(a.a)(!0,{},Ue[e.dataField]);switch(i=o.cssClass||"",e.dataField){case"thumbnail":o.cellTemplate=this._createThumbnailColumnCell.bind(this),o.calculateSortValue="fileItem.".concat(o.calculateSortValue);break;case"name":o.cellTemplate=this._createNameColumnCell.bind(this),o.caption=l.a.format("dxFileManager-listDetailsColumnCaptionName");break;case"size":o.calculateCellValue=this._calculateSizeColumnCellValue.bind(this),o.caption=l.a.format("dxFileManager-listDetailsColumnCaptionFileSize"),o.calculateSortValue=e=>e.fileItem.isDirectory?-1:e.fileItem.size;break;case"dateModified":o.caption=l.a.format("dxFileManager-listDetailsColumnCaptionDateModified")}Object(a.a)(!0,t,o)}return j(t,e,["alignment","caption","dataField","dataType","hidingPriority","sortIndex","sortOrder","visible","visibleIndex","width"]),e.cssClass&&(i="".concat(i," ").concat(e.cssClass)),i&&(t.cssClass=i),t}_updateColumnDataField(e){var t=this._isDefaultColumn(e.dataField)?"":"dataItem.";return e.dataField="fileItem."+t+e.dataField,e}_isDefaultColumn(e){return!!Ue[e]}_onFileItemActionButtonClick(e){var{component:t,element:i,event:o}=e;o.stopPropagation();var a=t.$element().closest(this._getItemSelector()),n=a.data("item");this._selectItem(n);var s={itemData:n,itemElement:a,isActionButton:!0},r=this._getFileItemsForContextMenu(n);this._showContextMenu(r,i,o,s),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}_getItemThumbnailCssClass(){return"dx-filemanager-details-item-thumbnail"}_getItemSelector(){return".".concat("dx-data-row")}_onItemDblClick(e){var t=Object(o.a)(e.currentTarget).data("item");this._raiseSelectedItemOpened(t)}_isAllItemsSelected(){var e=this._hasParentDirectoryItem?this._itemCount-1:this._itemCount,t=this._filesView.option("selectedRowKeys");return!!t.length&&(t.length>=e||void 0)}_onEditorPreparing(e){var{component:t,command:i,row:o,parentType:a,editorOptions:n}=e;this._filesView||(this._filesView=t),"select"===i&&o?this._isParentDirectoryItem(o.data)&&(n.disabled=!0):"headerRow"===a&&(n.onInitialized=e=>{var{component:t}=e;this._selectAllCheckBox=t},n.value=this._isAllItemsSelected(),n.onValueChanged=e=>this._onSelectAllCheckBoxValueChanged(e))}_onSelectAllCheckBoxValueChanged(e){var{event:t,previousValue:i,value:o}=e;t?this._isAllItemsSelected()!==o&&(o?this._filesView.selectAll():this._filesView.deselectAll(),t.preventDefault()):i&&!this._selectAllCheckBoxUpdating&&this._selectAllCheckBox&&this._selectAllCheckBox.option("value",i)}_onRowPrepared(e){var{rowType:t,rowElement:i,data:a}=e;if("data"===t){var n=Object(o.a)(i);n.data("item",a),this._isParentDirectoryItem(a)&&n.addClass("dx-filemanager-parent-directory-item")}}_onContextMenuPreparing(e){if(this._isDesktop()){var t=null,i={};e.row&&"data"===e.row.rowType&&(i=e.row.data,this._selectItem(i),t=this._getFileItemsForContextMenu(i));var o=Object(a.a)({},{targetElement:"content"===e.target&&Object(n.d)(e.row)?this._filesView.getRowElement(e.rowIndex):void 0,itemData:i,options:this._contextMenu.option(),event:e.event,isActionButton:!1,cancel:!1});this._raiseContextMenuShowing(o),e.items=o.cancel?[]:this._contextMenu.createContextMenuItems(t,null,i)}}_onFilesViewSelectionChanged(e){var{component:t,selectedRowsData:i,selectedRowKeys:o,currentSelectedRowKeys:a,currentDeselectedRowKeys:n}=e;this._filesView=this._filesView||t,this._selectAllCheckBox&&(this._selectAllCheckBoxUpdating=!0,this._selectAllCheckBox.option("value",this._isAllItemsSelected()),this._selectAllCheckBoxUpdating=!1);var s=i.map(e=>e.fileItem);this._tryRaiseSelectionChanged({selectedItemInfos:i,selectedItems:s,selectedItemKeys:o,currentSelectedItemKeys:a,currentDeselectedItemKeys:n})}_onFilesViewFocusedRowChanged(e){var t,i;this._isMultipleSelectionMode()||this._selectItemSingleSelection(null===(i=e.row)||void 0===i?void 0:i.data);var o=(null===(t=e.row)||void 0===t?void 0:t.data.fileItem)||null;this._onFocusedItemChanged({item:o,itemKey:null==o?void 0:o.key,itemElement:e.rowElement})}_onFilesViewOptionChanged(e){var{fullName:t}=e;t.indexOf("sortOrder")>-1&&this._filesView.columnOption("isParentFolder",{sortOrder:"asc",sortIndex:0})}_resetFocus(){this._setFocusedItemKey(void 0)}_createThumbnailColumnCell(e,t){this._getItemThumbnailContainer(t.data).appendTo(e)}_createNameColumnCell(e,t){var i=Object(o.a)("<div>"),a=Object(o.a)("<span>").text(t.data.fileItem.name).addClass("dx-filemanager-details-item-name"),n=Object(o.a)("<div>").append(a,i).addClass("dx-filemanager-details-item-name-wrapper");Object(o.a)(e).append(n),this._createComponent(i,Me,{onClick:e=>this._onFileItemActionButtonClick(e)})}_calculateSizeColumnCellValue(e){return e.fileItem.isDirectory?"":T(e.fileItem.size)}_selectItem(e){(this._isMultipleSelectionMode()?this._selectItemMultipleSelection:this._selectItemSingleSelection).call(this,e)}_deselectItem(e){this._filesView.deselectRows([e.fileItem.key])}_selectItemSingleSelection(e){if(!this._focusedItem||!e||this._focusedItem.fileItem.key!==e.fileItem.key){var t=this._focusedItem;this._focusedItem=e;var i=[];t&&i.push(t.fileItem.key);var o=[],a=[];e&&!this._isParentDirectoryItem(e)&&(o.push(e.fileItem),a.push(e.fileItem.key)),this._raiseSelectionChanged({selectedItems:o,selectedItemKeys:a,currentSelectedItemKeys:[...a],currentDeselectedItemKeys:i})}}_selectItemMultipleSelection(e){var{fileItem:t}=e;if(!this._filesView.isRowSelected(t.key)){var i=this._filesView.getController("selection").isSelectionWithCheckboxes();this._filesView.selectRows([t.key],i)}}_setSelectedItemKeys(e){this._filesView.option("selectedRowKeys",e)}_setFocusedItemKey(e){var t;null===(t=this._filesView)||void 0===t||t.option("focusedRowKey",e)}clearSelection(){this._isMultipleSelectionMode()?this._filesView.clearSelection():this._filesView.option("focusedRowIndex",-1)}refresh(e){var t={dataSource:this._createDataSource()};return e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&(Object(n.d)(e.focusedItemKey)?t.focusedRowKey=e.focusedItemKey:t.focusedRowIndex=-1),this._filesView.option(t),this._refreshDeferred=new s.a,this._refreshDeferred.promise()}getSelectedItems(){return this._isMultipleSelectionMode()?this._filesView.getSelectedRowsData():this._focusedItem&&!this._isParentDirectoryItem(this._focusedItem)?[this._focusedItem]:[]}},Ve=i("c3XC"),Re=i("+dKZ"),Le=i("dCj/"),Ne=i("hjKj"),Ke=i("Z6Ap"),ze=i("DaY9"),He=i("pC4B"),We=Object(Ae.a)(Le.a.name,"dxFileManagerThumbnailsListBox");class qe extends ze.a{_initMarkup(){this._initActions(),this._lockFocusedItemProcessing=!1,this.$element().addClass("dx-filemanager-thumbnails-view-port"),this._renderScrollView(),this._renderItemsContainer(),this._createScrollViewControl(),super._initMarkup(),this.onFocusedItemChanged=this._onFocusedItemChanged.bind(this),this._layoutUtils=new Ze(this._scrollView,this.$element(),this._$itemContainer,this.itemElements().first()),this._syncFocusedItemKey()}_initActions(){this._actions={onItemEnterKeyPressed:this._createActionByOption("onItemEnterKeyPressed"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged")}}_initTemplates(){super._initTemplates(),this._itemThumbnailTemplate=this.option("itemThumbnailTemplate"),this._getTooltipText=this.option("getTooltipText"),this._templateManager.addDefaultTemplates({item:new Ne.a(function(e,t,i){var o=this._getDefaultItemTemplate(i,e);e.append(o)}.bind(this),["fileItem"],this.option("integrationOptions.watchMethod"))})}_createScrollViewControl(){this._scrollView||(this._scrollView=this._createComponent(this._$scrollView,Ke.default,{scrollByContent:!0,scrollByThumb:!0,useKeyboard:!1,showScrollbar:"onHover"}))}_renderScrollView(){this._$scrollView||(this._$scrollView=Object(o.a)("<div>").appendTo(this.$element()))}_renderItemsContainer(){this._$itemContainer||(this._$itemContainer=Object(o.a)("<div>").addClass("dx-filemanager-thumbnails-container").appendTo(this._$scrollView))}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_supportedKeys(){return Object(a.a)(super._supportedKeys(),{upArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(-1,!1,e)},downArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(1,!1,e)},home(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(0,!0,e)},end(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(this._getItemsLength()-1,!0,e)},pageUp(e){this._beforeKeyProcessing(e),this._processPageChange(!0,e)},pageDown(e){this._beforeKeyProcessing(e),this._processPageChange(!1,e)},enter(e){this._beforeKeyProcessing(e),this._actions.onItemEnterKeyPressed(this._getFocusedItem())},A(e){this._beforeKeyProcessing(e),Object(Ae.i)(e)&&this.selectAll()}})}_beforeKeyProcessing(e){e.preventDefault(),this._layoutUtils.reset()}_processArrowKeys(e,t,i){var o=this._getFocusedItem();if(o){if(!t){var a=this._layoutUtils.getLayoutModel();if(!a)return;e*=a.itemPerRowCount}var n=this._getIndexByItem(o)+e;this._focusItemByIndex(n,!0,i)}}_processHomeEndKeys(e,t,i){this._focusItemByIndex(e,t,i)}_processPageChange(e,t){var i=this._getFocusedItem();if(i){var o=this._layoutUtils.getLayoutModel();if(o){var a=this._layoutUtils.createItemLayoutModel(this._getIndexByItem(i)),n=e?o.rowPerPageRate:-o.rowPerPageRate,s=a.itemRowIndex-n,r=(e?Math.ceil:Math.floor)(s)*o.itemPerRowCount+a.itemColumnIndex;r<0?r=0:r>=this._getItemsLength()&&(r=this._getItemsLength()-1),this._focusItemByIndex(r,!0,t)}}}_processLongTap(e){var t=this._closestItemElement(Object(o.a)(e.target)),i=this._getIndexByItemElement(t);this._selection.changeItemSelection(i,{control:!0})}_attachEventHandlers(){"multiple"===this.option("selectionMode")&&_.a.on(this._itemContainer(),We,".".concat(this._itemContentClass()),e=>{this._processLongTap(e),e.stopPropagation()}),_.a.on(this._itemContainer(),"mousedown selectstart",e=>{e.shiftKey&&e.preventDefault()})}_detachEventHandlers(){_.a.off(this._itemContainer(),We),_.a.off(this._itemContainer(),"mousedown selectstart")}_itemContainer(){return this._$itemContainer}_itemClass(){return"dx-filemanager-thumbnails-item"}_itemDataKey(){return"dxFileManagerItemData"}_getDefaultItemTemplate(e,t){t.attr("title",this._getTooltipText(e));var i=this._itemThumbnailTemplate(e),a=Object(o.a)("<div>").addClass("dx-filemanager-thumbnails-item-spacer"),n=Object(o.a)("<div>").addClass("dx-filemanager-thumbnails-item-name").text(e.fileItem.name);t.append(i,a,n)}_itemSelectHandler(e){var t={};"multiple"===this.option("selectionMode")&&(this._isPreserveSelectionMode||(this._isPreserveSelectionMode=Object(Ae.i)(e)||e.shiftKey),t={control:this._isPreserveSelectionMode,shift:e.shiftKey});var i=this._getIndexByItemElement(e.currentTarget);this._selection.changeItemSelection(i,t)}_initSelectionModule(){super._initSelectionModule();var e=Object(a.a)(this._selection.options,{selectedKeys:this.option("selectedItemKeys"),onSelectionChanged:e=>{this.option("selectedItems",this._getItemsByKeys(e.selectedItemKeys,e.selectedItems)),this._updateSelectedItems(e)}});this._selection=new He.a(e)}_updateSelectedItems(e){var t=e.addedItemKeys,i=e.removedItemKeys;if(this._rendered&&(t.length||i.length)){var o=this._selectionChangePromise;if(!this._rendering){var a,n=[],r=[];this._editStrategy.beginCache();for(var l=0;l<i.length;l++)a=this._getIndexByKey(i[l]),r.push(a),this._removeSelection(a);for(var d=0;d<t.length;d++)a=this._getIndexByKey(t[d]),n.push(a),this._addSelection(a);this._editStrategy.endCache(),this._updateSelection(n,r)}Object(s.c)(o).done(()=>this._fireSelectionChangeEvent(e))}}_fireSelectionChangeEvent(e){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})(e)}_updateSelection(e,t){0===this.getSelectedItems().length&&(this._isPreserveSelectionMode=!1)}_normalizeSelectedItems(){var e=this._getKeysByItems(this.option("selectedItems")),t=this._selection.getSelectedItemKeys();return this._compareKeys(t,e)||this._selection.setSelection(e),(new s.a).resolve().promise()}_focusOutHandler(){}_getItems(){return this.option("items")||[]}_getItemsLength(){return this._getItems().length}_getIndexByItemElement(e){return this._editStrategy.getNormalizedIndex(e)}_getItemByIndex(e){return this._getItems()[e]}_getFocusedItem(){return this.getItemByItemElement(this.option("focusedElement"))}_focusItem(e,t){this.option("focusedElement",this.getItemElementByItem(e)),t&&this._layoutUtils.scrollToItem(this._getIndexByItem(e))}_focusItemByIndex(e,t,i){if(e>=0&&e<this._getItemsLength()){var o=this._getItemByIndex(e);this._focusItem(o,t,i)}}_syncFocusedItemKey(){this._syncFocusedItemKeyDeferred||(this._syncFocusedItemKeyDeferred=new s.a);var e=this._syncFocusedItemKeyDeferred;if(this._dataSource&&this._dataSource.isLoading())return e.promise();var t=this.option("focusedItemKey");if(Object(n.d)(t)){var i=this.option("items"),o=Object(f.a)(i,e=>this.keyOf(e)===t);o?(this._focusItem(o,!0),e.resolve()):(this.option("focusedItemKey",void 0),e.reject())}else e.resolve();return this._syncFocusedItemKeyDeferred=null,e.promise()}_onFocusedItemChanged(){var e=this._getFocusedItem(),t=this.keyOf(e);t!==this.option("focusedItemKey")&&(this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",t),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_raiseFocusedItemChanged(e){var t={item:e,itemElement:this.option("focusedElement")};this._actions.onFocusedItemChanged(t)}_changeItemSelection(e,t){if(this.isItemSelected(e)!==t){var i=this.getItemElementByItem(e),o=this._getIndexByItemElement(i);this._selection.changeItemSelection(o,{control:this._isPreserveSelectionMode})}}_chooseSelectOption(){return"selectedItemKeys"}getSelectedItems(){return this._selection.getSelectedItems()}getItemElementByItem(e){return this._editStrategy.getItemElement(e)}getItemByItemElement(e){return this._getItemByIndex(this._getIndexByItemElement(e))}selectAll(){"multiple"===this.option("selectionMode")&&(this._selection.selectAll(),this._isPreserveSelectionMode=!0)}selectItem(e){this._changeItemSelection(e,!0)}deselectItem(e){this._changeItemSelection(e,!1)}clearSelection(){this._selection.deselectAll()}_optionChanged(e){switch(e.name){case"items":this._layoutUtils&&this._layoutUtils.updateItems(this.itemElements().first()),super._optionChanged(e);break;case"focusedItemKey":if(this._lockFocusedItemProcessing)break;Object(n.d)(e.value)?this._syncFocusedItemKey().done(()=>{var e=this._getFocusedItem();this._raiseFocusedItemChanged(e)}):(this.option("focusedElement",null),this._raiseFocusedItemChanged(null));break;case"onItemEnterKeyPressed":case"onFocusedItemChanged":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}}class Ze{constructor(e,t,i,o){this._layoutModel=null,this._scrollView=e,this._$viewPort=t,this._$itemContainer=i,this._$item=o}updateItems(e){this._$item=e}reset(){this._layoutModel=null}getLayoutModel(){return this._layoutModel||(this._layoutModel=this._createLayoutModel()),this._layoutModel}_createLayoutModel(){if(!this._$item)return null;var e=Object(Re.i)(this._$item,!0);if(0===e)return null;var t=Object(Re.h)(this._$item,!0),i=Object(Re.f)(this._$itemContainer),o=Object(Re.e)(this._$viewPort),a=this._scrollView.scrollTop();return{itemWidth:e,itemHeight:t,viewPortWidth:i,viewPortHeight:o,viewPortScrollTop:a,viewPortScrollBottom:a+o,itemPerRowCount:Math.floor(i/e),rowPerPageRate:o/t}}createItemLayoutModel(e){var t=this.getLayoutModel();if(!t)return null;var i=Math.floor(e/t.itemPerRowCount),o=e%t.itemPerRowCount,a=i*t.itemHeight;return{itemRowIndex:i,itemColumnIndex:o,itemTop:a,itemBottom:a+t.itemHeight}}scrollToItem(e){var t=this.getLayoutModel();if(t){var i=Math.floor(e/t.itemPerRowCount)*t.itemHeight,o=i+t.itemHeight,a=t.viewPortScrollTop;i<t.viewPortScrollTop?a=i:o>t.viewPortScrollBottom&&(a=o-t.viewPortHeight),this._scrollView.scrollTo(a)}}}var Ge=qe;var Je=class extends Be{_initMarkup(){super._initMarkup(),this.$element().addClass("dx-filemanager-thumbnails");var e=Object(Ae.a)(Ve.a,"dxFileManager_thumbnails");_.a.on(this.$element(),e,this._onContextMenu.bind(this)),this._createItemList()}_createItemList(){var e=this._isMultipleSelectionMode()?"multiple":"single",t=Object(o.a)("<div>").appendTo(this.$element());this._itemList=this._createComponent(t,Ge,{dataSource:this._createDataSource(),selectionMode:e,selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),activeStateEnabled:!0,hoverStateEnabled:!0,loopItemFocus:!1,focusStateEnabled:!0,onItemEnterKeyPressed:this._tryOpen.bind(this),itemThumbnailTemplate:this._getItemThumbnailContainer.bind(this),getTooltipText:this._getTooltipText.bind(this),onSelectionChanged:this._onItemListSelectionChanged.bind(this),onFocusedItemChanged:this._onItemListFocusedItemChanged.bind(this)})}_onContextMenu(e){if(e.preventDefault(),e.stopPropagation(),this._isDesktop()){var t=null,i=Object(o.a)(e.target).closest(this._getItemSelector()),a=null;i.length>0&&(a=this._itemList.getItemByItemElement(i),this._itemList.selectItem(a),t=this._getFileItemsForContextMenu(a));var n={itemData:a,itemElement:i.length?i:void 0};this._showContextMenu(t,e.target,e,n)}}_getItemThumbnailCssClass(){return"dx-filemanager-thumbnails-item-thumbnail"}_getItemSelector(){return".".concat("dx-filemanager-thumbnails-item")}_getTooltipText(e){var t=e.fileItem;if(t.tooltipText)return t.tooltipText;var i="".concat(t.name,"\r\n");return t.isDirectory||(i+="".concat(l.a.format("dxFileManager-listThumbnailsTooltipTextSize"),": ").concat(T(t.size),"\r\n")),i+="".concat(l.a.format("dxFileManager-listThumbnailsTooltipTextDateModified"),": ").concat(t.dateModified)}_onItemDblClick(e){var t=Object(o.a)(e.currentTarget),i=this._itemList.getItemByItemElement(t);this._tryOpen(i)}_tryOpen(e){e&&this._raiseSelectedItemOpened(e)}_getItemsInternal(){return super._getItemsInternal().then(e=>{var t=new s.a;return setTimeout(()=>t.resolve(e)),t.promise()})}_disableDragging(){return!1}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{focusStateEnabled:!0})}_onItemListSelectionChanged(e){var{addedItemKeys:t,removedItemKeys:i}=e,o=this.getSelectedItems(),a=o.map(e=>e.fileItem),n=a.map(e=>e.key);this._tryRaiseSelectionChanged({selectedItemInfos:o,selectedItems:a,selectedItemKeys:n,currentSelectedItemKeys:t,currentDeselectedItemKeys:i})}_onItemListFocusedItemChanged(e){var{item:t,itemElement:i}=e;this._isMultipleSelectionMode()||this._selectItemSingleSelection(t);var o=(null==t?void 0:t.fileItem)||null;this._onFocusedItemChanged({item:o,itemKey:null==o?void 0:o.key,itemElement:i||void 0})}_setSelectedItemKeys(e){this._itemList.option("selectedItemKeys",e)}_setFocusedItemKey(e){this._itemList.option("focusedItemKey",e)}refresh(e){var t={dataSource:this._createDataSource()};return e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&(t.focusedItemKey=e.focusedItemKey),e&&Object.prototype.hasOwnProperty.call(e,"selectedItemKeys")&&(t.selectedItemKeys=e.selectedItemKeys),this._itemList.option(t),this._refreshDeferred=new s.a,this._refreshDeferred.promise()}_deselectItem(e){var t=this._itemList.getItemElementByItem(e);this._itemList.unselectItem(t)}_selectItemSingleSelection(e){e?this._itemList.selectItem(e):this._itemList.clearSelection()}clearSelection(){this._itemList.clearSelection()}getSelectedItems(){return this._itemList.getSelectedItems()}},Xe=i("4ivh"),Ye=(i("fS3q"),{showNavPane:{location:"before"},create:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},upload:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},refresh:{location:"after",showText:"inMenu",cssClass:"dx-filemanager-toolbar-has-large-icon",compactMode:{showText:"inMenu",locateInMenu:"auto"}},switchView:{location:"after"},download:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},move:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},copy:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},rename:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},delete:{location:"before",compactMode:{showText:"inMenu"}},clearSelection:{location:"after",locateInMenu:"never",compactMode:{showText:"inMenu"}},separator:{location:"before"}}),Qe=["visible","location","locateInMenu","disabled","showText"],et=["accessKey","elementAttr","height","hint","icon","stylingMode","tabIndex","text","width"],tt=["separator","switchView"],it={default:"dx-filemanager-i dx-filemanager-i-refresh",progress:"dx-filemanager-i dx-filemanager-i-progress",success:"dx-filemanager-i dx-filemanager-i-done",error:"dx-filemanager-i dx-filemanager-i-danger"};class ot extends c.a{_init(){super._init(),this._generalToolbarVisible=!0,this._refreshItemState={message:"",status:"default"}}_initMarkup(){this._createItemClickedAction(),this._$viewSwitcherPopup=Object(o.a)("<div>").addClass("dx-filemanager-view-switcher-popup"),this._generalToolbar=this._createToolbar(this.option("generalItems"),!this._generalToolbarVisible),this._fileToolbar=this._createToolbar(this.option("fileItems"),this._generalToolbarVisible),this._$viewSwitcherPopup.appendTo(this.$element()),this.$element().addClass("dx-filemanager-toolbar dx-filemanager-general-toolbar")}_render(){super._render();var e=this._getVisibleToolbar();this._checkCompactMode(e)}_clean(){delete this._commandManager,delete this._itemClickedAction,delete this._$viewSwitcherPopup,delete this._generalToolbar,delete this._fileToolbar,super._clean()}_dimensionChanged(e){if(!e||"height"!==e){var t=this._getVisibleToolbar();this._checkCompactMode(t)}}_getVisibleToolbar(){return this._generalToolbarVisible?this._generalToolbar:this._fileToolbar}_createToolbar(e,t){var i=this._getPreparedItems(e),a=Object(o.a)("<div>").appendTo(this.$element()),n=this._createComponent(a,Xe.default,{items:i,visible:!t,onItemClick:e=>this._raiseItemClicked(e)});return n.compactMode=!1,n}_getPreparedItems(e){return e=e.map(e=>{var t=e;Object(n.o)(e)&&(t={name:e});var i=t.name,o=this._configureItemByCommandName(i,t);return o.originalItemData=e,"separator"!==i&&this._setItemVisibleAvailable(o),o}),this._updateSeparatorsVisibility(e),e}_updateSeparatorsVisibility(e,t){var i=!1,o=this._getMenuItems(t),a={before:!1,center:!1,after:!1},n={before:this._getItemsInGroup(e,o,"before"),center:this._getItemsInGroup(e,o,"center"),after:this._getItemsInGroup(e,o,"after")};return e.forEach((e,t)=>{var s=e.location;if("separator"===e.name){var r=a[s]&&this._groupHasItemsAfter(n[s]);e.visible!==r&&(i=!0,e.visible=r),a[s]=!1}else this._isItemInMenu(o,e)||(a[s]=a[s]||e.visible),n[s].shift()}),t&&i&&t.repaint(),i}_getMenuItems(e){return(e?e._getMenuItems():[]).map(e=>e.originalItemData)}_isItemInMenu(e,t){return!!e.length&&"never"!==Object(r.g)(t.locateInMenu,"never")&&-1!==e.indexOf(t.originalItemData)}_getItemsInGroup(e,t,i){return e.filter(e=>e.location===i&&!this._isItemInMenu(t,e))}_groupHasItemsAfter(e){for(var t=0;t<e.length;t++)if("separator"!==e[t].name&&e[t].visible)return!0;return!1}_configureItemByCommandName(e,t){var i,o={},s=this._commandManager.getCommandByName(e);switch(s&&(o=this._createCommandItem(s)),e){case"separator":o=this._createSeparatorItem();break;case"switchView":o=this._createViewModeItem()}if(this._isDefaultItem(e)){var l=Ye[e];Object(a.a)(!0,o,l);var d=o.cssClass||"";j(o,t,Qe),Object(n.d)(t.options)&&j(o.options,t.options,et),j(o.options,t,["text","icon"]),t.cssClass&&(d="".concat(d," ").concat(t.cssClass)),d&&(o.cssClass=d),Object(n.d)(t.visible)||(o._autoHide=!0),"dxButton"===o.widget&&("inMenu"!==o.showText||Object(n.d)(o.options.hint)||(o.options.hint=o.options.text),o.compactMode&&!Object(n.d)(o.options.hint)&&this._configureHintForCompactMode(o))}else Object(a.a)(!0,o,t),o.widget||(o.widget="dxButton"),"dxButton"===o.widget&&!o.compactMode&&!o.showText&&o.options&&o.options.icon&&o.options.text&&(o.compactMode={showText:"inMenu"});return e&&!o.name&&Object(a.a)(o,{name:e}),o.location=Object(r.g)(o.location,"before"),Object(n.d)(null===(i=o.options)||void 0===i?void 0:i.stylingMode)||("dxButton"===o.widget&&Object(a.a)(!0,o,{options:{stylingMode:"text"}}),"dxSelectBox"===o.widget&&Object(a.a)(!0,o,{options:{stylingMode:"filled"}})),o}_isDefaultItem(e){return!!Ye[e]}_createCommandItem(e){return{widget:"dxButton",options:{text:e.text,hint:e.hint,commandText:e.text,icon:e.icon,stylingMode:"text",onClick:t=>this._executeCommand(e)}}}_createSeparatorItem(){return{template:(e,t,i)=>{Object(o.a)(i).addClass("dx-filemanager-toolbar-separator-item")}}}_createViewModeItem(){var e=["details","thumbnails"].map(e=>{var{text:t,icon:i}=this._commandManager.getCommandByName(e);return{name:e,text:t,icon:i}}),t="thumbnails"===this.option("itemViewMode")?1:0;return{cssClass:"dx-filemanager-toolbar-viewmode-item",widget:"dxDropDownButton",options:{items:e,keyExpr:"name",selectedItemKey:this.option("itemViewMode"),displayExpr:" ",hint:e[t].text,stylingMode:"text",showArrowIcon:!1,useSelectMode:!0,dropDownOptions:{container:this._$viewSwitcherPopup},onItemClick:e=>this._executeCommand(e.itemData.name)}}}_configureHintForCompactMode(e){e.options.hint="",e.compactMode.options=e.compactMode.options||{},e.compactMode.options.hint=e.options.text}_checkCompactMode(e){e.compactMode&&this._toggleCompactMode(e,!1);var t=this._toolbarHasItemsOverflow(e);e.compactMode!==t?(e.compactMode||this._toggleCompactMode(e,t),e.compactMode=t):e.compactMode&&this._toggleCompactMode(e,!0)}_toolbarHasItemsOverflow(e){return Object(Re.l)(e.$element())<e._getItemsWidth()}_toggleCompactMode(e,t){var i=!1,o=e.option("items");o.forEach(e=>{if(e.compactMode){var o=null;t?(e.saved=this._getCompactModeOptions(e,e._available),o=e.compactMode):o=e.saved;var n=this._getCompactModeOptions(o,e._available);Object(a.a)(!0,e,n),i=!0}}),(i=this._updateSeparatorsVisibility(o)||i)&&e.repaint(),this._updateSeparatorsVisibility(o,e)}_getCompactModeOptions(e,t){var{showText:i,locateInMenu:o,options:a}=e;return{visible:t,showText:Object(r.g)(i,"always"),locateInMenu:Object(r.g)(o,"never"),options:{hint:null==a?void 0:a.hint}}}_ensureAvailableCommandsVisible(e){var t=!1,i=e.option("items");i.forEach(e=>{if("separator"!==e.name){var i=e._available;this._setItemVisibleAvailable(e),e._available!==i&&(t=!0)}}),(t=this._updateSeparatorsVisibility(i)||t)&&e.repaint(),this._updateSeparatorsVisibility(i,e)}_setItemVisibleAvailable(e){var t,i=null===(t=e.originalItemData)||void 0===t?void 0:t.visible;e._available=this._isToolbarItemAvailable(e),e.visible=Object(n.d)(i)?i:e._available}_fileToolbarHasEffectiveItems(){return this._fileToolbar.option("items").some(e=>this._isFileToolbarItemAvailable(e))}_executeCommand(e){this._commandManager.executeCommand(e)}_isToolbarItemAvailable(e){return this._isDefaultItem(e.name)&&e._autoHide?"refresh"===e.name?this._generalToolbarVisible||!!this._isRefreshVisibleInFileToolbar:tt.indexOf(e.name)>-1||this._isCommandAvailable(e.name):Object(r.g)(e.visible,!0)}_isFileToolbarItemAvailable(e){var{name:t,visible:i}=e;return!this._isDefaultItem(t)&&Object(r.g)(i,!0)||"clearSelection"!==t&&"refresh"!==t&&this._isCommandAvailable(t)}_isCommandAvailable(e){return this._commandManager.isCommandAvailable(e,this.option("contextItems"))}_updateItemInToolbar(e,t,i){e.beginUpdate();for(var o=e.option("items"),a=0;a<o.length;a++){if(o[a].name===t){e.option("items[".concat(a,"]"),i);break}}e.endUpdate()}_raiseItemClicked(e){var t=Object(a.a)(!0,{},e);t.itemData=e.itemData.originalItemData,this._itemClickedAction(t)}_createItemClickedAction(){this._itemClickedAction=this._createActionByOption("onItemClick")}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{commandManager:null,generalItems:[],fileItems:[],contextItems:[],itemViewMode:"details",onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":case"itemViewMode":case"generalItems":case"fileItems":this.repaint();break;case"contextItems":this._update();break;case"onItemClick":this._itemClickedAction=this._createActionByOption(t);break;default:super._optionChanged(e)}}updateItemPermissions(){this.repaint(),this._restoreRefreshItemState()}_restoreRefreshItemState(){this.updateRefreshItem(this._refreshItemState.message,this._refreshItemState.status)}updateRefreshItem(e,t){var i=null,o=l.a.format("dxFileManager-commandRefresh"),n="inMenu";this._isRefreshVisibleInFileToolbar=!1,this._refreshItemState={message:e,status:t},"default"===t?i={options:{icon:it.default}}:(i={options:{icon:it[t]}},this._isRefreshVisibleInFileToolbar=!0,o=e,n="always");var s=Object(a.a)({},i,{visible:this._isRefreshVisibleInFileToolbar});this._applyRefreshItemOptions(i,s),this._refreshItemTextTimeout=this._updateRefreshItemText("progress"===t,o,n)}_updateRefreshItemText(e,t,i){var o={showText:i,options:{text:t}};return e?setTimeout(()=>{this._applyRefreshItemOptions(o),this._refreshItemTextTimeout=void 0},500):(this._refreshItemTextTimeout&&clearTimeout(this._refreshItemTextTimeout),void this._applyRefreshItemOptions(o))}_applyRefreshItemOptions(e,t){t||(t=Object(a.a)({},e)),this._updateItemInToolbar(this._generalToolbar,"refresh",e),this._updateItemInToolbar(this._fileToolbar,"refresh",t)}_update(){var e=0===this.option("contextItems").length||!this._fileToolbarHasEffectiveItems();this._generalToolbarVisible!==e&&(this._generalToolbar.option("visible",e),this._fileToolbar.option("visible",!e),this._generalToolbarVisible=e,this.$element().toggleClass("dx-filemanager-general-toolbar",e),this.$element().toggleClass("dx-filemanager-file-toolbar",!e));var t=this._getVisibleToolbar();this._ensureAvailableCommandsVisible(t),this._checkCompactMode(t)}get _commandManager(){return this.option("commandManager")}}var at=ot,nt=i("oHs6"),st=i("EuXN"),rt=i("MtyI"),lt=i("Ss0b"),dt=rt.a.inherit({_getDefaultOptions:function(){return Object(a.a)(this.callBase(),{min:0,max:100,value:0})},_initMarkup:function(){this.$element().addClass("dx-trackbar"),this._renderWrapper(),this._renderContainer(),this._renderRange(),this._renderValue(),this._setRangeStyles(),this.callBase()},_render:function(){this.callBase(),this._setRangeStyles(this._rangeStylesConfig())},_renderWrapper:function(){this._$wrapper=Object(o.a)("<div>").addClass("dx-trackbar-wrapper").appendTo(this.$element())},_renderContainer:function(){this._$bar=Object(o.a)("<div>").addClass("dx-trackbar-container").appendTo(this._$wrapper)},_renderRange:function(){this._$range=Object(o.a)("<div>").addClass("dx-trackbar-range").appendTo(this._$bar)},_renderValue:function(){var e=this.option("value"),t=this.option("min"),i=this.option("max");if(!(t>i)){if(e<t)return this.option("value",t),void(this._currentRatio=0);if(e>i)return this.option("value",i),void(this._currentRatio=1);var o=t===i?0:(e-t)/(i-t);!this._needPreventAnimation&&this._setRangeStyles({width:100*o+"%"}),this.setAria({valuemin:this.option("min"),valuemax:i,valuenow:e}),this._currentRatio=o}},_rangeStylesConfig:function(){return{width:100*this._currentRatio+"%"}},_setRangeStyles:function(e){lt.a.stop(this._$range),e?!this._needPreventAnimation&&Object(p.f)()&&lt.a.animate(this._$range,{type:"custom",duration:100,to:e}):this._$range.css({width:0})},_optionChanged:function(e){switch(e.name){case"value":this._renderValue(),this.callBase(e);break;case"max":case"min":this._renderValue();break;default:this.callBase(e)}},_dispose:function(){lt.a.stop(this._$range),this.callBase()}});Object(d.a)("dxTrackBar",dt);var ct=dt.inherit({_getDefaultOptions:function(){return Object(a.a)(this.callBase(),{value:0,statusFormat:function(e){return"Progress: "+Math.round(100*e)+"%"},showStatus:!0,onComplete:null,activeStateEnabled:!1,statusPosition:"bottom left",_animatingSegmentCount:0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(e){return"android"===e.platform},options:{_animatingSegmentCount:2}}])},_initMarkup:function(){this._renderStatus(),this._createCompleteAction(),this.callBase(),this.$element().addClass("dx-progressbar"),this._$wrapper.addClass("dx-progressbar-wrapper"),this._$bar.addClass("dx-progressbar-container"),this.setAria("role","progressbar"),Object(o.a)("<div>").addClass("dx-progressbar-range-container").appendTo(this._$wrapper).append(this._$bar),this._$range.addClass("dx-progressbar-range"),this._toggleStatus(this.option("showStatus"))},_useTemplates:function(){return!1},_createCompleteAction:function(){this._completeAction=this._createActionByOption("onComplete")},_renderStatus:function(){this._$status=Object(o.a)("<div>").addClass("dx-progressbar-status")},_renderIndeterminateState:function(){this._$segmentContainer=Object(o.a)("<div>").addClass("dx-progressbar-animating-container");for(var e=this.option("_animatingSegmentCount"),t=0;t<e;t++)Object(o.a)("<div>").addClass("dx-progressbar-animating-segment").addClass("dx-progressbar-animating-segment-"+(t+1)).appendTo(this._$segmentContainer);this._$segmentContainer.appendTo(this._$wrapper)},_toggleStatus:function(e){var t=this.option("statusPosition").split(" ");e?"top"===t[0]||"left"===t[0]?this._$status.prependTo(this._$wrapper):this._$status.appendTo(this._$wrapper):this._$status.detach(),this._togglePositionClass()},_togglePositionClass:function(){var e=this.option("statusPosition").split(" ");this._$wrapper.removeClass("dx-position-top-left dx-position-top-right dx-position-bottom-left dx-position-bottom-right dx-position-left dx-position-right");var t="dx-position-"+e[0];e[1]&&(t+="-"+e[1]),this._$wrapper.addClass(t)},_toggleIndeterminateState:function(e){e?(this._renderIndeterminateState(),this._$bar.toggle(!1)):(this._$bar.toggle(!0),this._$segmentContainer.remove(),delete this._$segmentContainer)},_renderValue:function(){var e=this.option("value"),t=this.option("max");e||0===e?(this._$segmentContainer&&this._toggleIndeterminateState(!1),e===t&&this._completeAction(),this.callBase(),this._setStatus()):this._toggleIndeterminateState(!0)},_setStatus:function(){var e=this.option("statusFormat"),t=(e=Object(n.h)(e)?e.bind(this):function(e){return e})(this._currentRatio,this.option("value"));this._$status.text(t)},_dispose:function(){this._$status.remove(),this.callBase()},_optionChanged:function(e){switch(e.name){case"statusFormat":this._setStatus();break;case"showStatus":this._toggleStatus(e.value);break;case"statusPosition":this._toggleStatus(this.option("showStatus"));break;case"onComplete":this._createCompleteAction();break;case"_animatingSegmentCount":break;default:this.callBase(e)}}});Object(d.a)("dxProgressBar",ct);var ht=ct,ut="".concat("dx-filemanager-progress-panel","-container"),pt="".concat("dx-filemanager-progress-panel","-title"),mt="".concat("dx-filemanager-progress-panel","-title-text"),_t="".concat("dx-filemanager-progress-panel","-close-button"),gt="".concat("dx-filemanager-progress-panel","-infos-container"),ft="".concat("dx-filemanager-progress-panel","-separator"),It="".concat("dx-filemanager-progress-panel","-info"),vt="".concat("dx-filemanager-progress-panel","-common"),Ct="".concat("dx-filemanager-progress-panel","-info-with-details"),bt="".concat("dx-filemanager-progress-panel","-details"),yt="".concat("dx-filemanager-progress-box","-error"),xt="".concat("dx-filemanager-progress-box","-without-close-button"),Dt="".concat("dx-filemanager-progress-box","-image"),St="".concat("dx-filemanager-progress-box","-wrapper"),Ot="".concat("dx-filemanager-progress-box","-common"),Mt="".concat("dx-filemanager-progress-box","-progress-bar"),Ft="".concat("dx-filemanager-progress-box","-close-button");class wt extends c.a{_initMarkup(){super._initMarkup(),this._initActions(),this._operationCount=0,this.$element().addClass("dx-filemanager-progress-panel");var e=Object(o.a)("<div>").appendTo(this.$element()),t=Object(o.a)("<div>").addClass(ut).appendTo(e);this._scrollView=this._createComponent(e,Ke.default,{scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onScroll"});var i=Object(o.a)("<div>").addClass(pt).appendTo(t);Object(o.a)("<div>").text(l.a.format("dxFileManager-notificationProgressPanelTitle")).addClass(mt).appendTo(i);var a=Object(o.a)("<div>").addClass(_t).appendTo(i);this._createComponent(a,Se.default,{icon:"close",stylingMode:"text",onClick:()=>this._raisePanelClosed()}),this._$infosContainer=Object(o.a)("<div>").addClass(gt).appendTo(t),this._renderEmptyListText()}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{onOperationClosed:null,onOperationCanceled:null,onOperationItemCanceled:null,onPanelClosed:null})}_initActions(){this._actions={onOperationClosed:this._createActionByOption("onOperationClosed"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled"),onPanelClosed:this._createActionByOption("onPanelClosed")}}_optionChanged(e){var t=e.name;switch(t){case"test":break;case"onOperationClosed":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}addOperation(e,t,i){this._operationCount?Object(o.a)("<div>").addClass(ft).prependTo(this._$infosContainer):this._$infosContainer.empty(),this._operationCount++;var a={customCloseHandling:t,allowProgressAutoUpdate:Object(r.g)(i,!0)},n=Object(o.a)("<div>").addClass(It).prependTo(this._$infosContainer);a.$info=n;var s=Object(o.a)("<div>").addClass(vt).appendTo(n);return a.common=this._createProgressBox(s,{commonText:e,showCloseButton:!0,showCloseButtonAlways:t,onCloseButtonClick:()=>this._closeOperation(a)}),a}addOperationDetails(e,t,i){e.$info.addClass(Ct);var a=Object(o.a)("<div>").addClass(bt).appendTo(e.$info);e.details=t.map((t,o)=>(t.info=e,this._createDetailsItem(a,t,o,!1,i)))}_createDetailsItem(e,t,i,a,n){var s=Object(o.a)("<div>").appendTo(e);return-1!==i&&s.addClass("dx-card"),this._createProgressBox(s,{commonText:t.commonText,imageUrl:t.imageUrl,skipProgressBox:a,showCloseButton:n,showCloseButtonAlways:n,onCloseButtonClick:()=>this._cancelOperationItem(t,i)})}completeOperationItem(e,t,i){e.allowProgressAutoUpdate&&this.updateOperationItemProgress(e,t,100,i),this._setCloseButtonVisible(e.details[t],!1)}updateOperationItemProgress(e,t,i,o){(this.updateOperationCommonProgress(e,o),e.details)&&e.details[t].progressBar.option("value",i)}updateOperationCommonProgress(e,t){var i;null===(i=e.common.progressBar)||void 0===i||i.option("value",t)}completeOperation(e,t,i,o){e.completed=!0,e.common.$commonText.text(t),i?this._removeProgressBar(e.common):e.allowProgressAutoUpdate&&this.updateOperationCommonProgress(e,100),o&&this._setProgressBarText(e.common,o),this._setCloseButtonVisible(e.common,!0)}completeSingleOperationWithError(e,t){var i,o=null===(i=e.details)||void 0===i?void 0:i[0];e.completed=!0,this._renderOperationError(o||e.common,t),this._setCloseButtonVisible(e.common,!0),o&&this._setCloseButtonVisible(o,!1)}addOperationDetailsError(e,t,i){var o=e.details[t];this._renderOperationError(o,i),this._setCloseButtonVisible(o,!1)}_renderError(e,t,i){Object(o.a)("<div>").text(i).addClass(yt).appendTo(e)}_renderEmptyListText(){this._$infosContainer.text(l.a.format("dxFileManager-notificationProgressPanelEmptyListText"))}_renderOperationError(e,t){this._removeProgressBar(e),this._renderError(e.$wrapper,e.$commonText,t)}_removeProgressBar(e){e.progressBar&&(e.progressBar.dispose(),e.progressBar.$element().remove(),e.progressBar=null)}_createProgressBox(e,t){e.addClass("dx-filemanager-progress-box"),t.showCloseButtonAlways||e.addClass(xt),t.imageUrl&&Object(xe.a)(t.imageUrl).addClass(Dt).appendTo(e);var i=Object(o.a)("<div>").addClass(St).appendTo(e),a=Object(o.a)("<div>").addClass(Ot).text(t.commonText).appendTo(i),n=null;if(!t.skipProgressBox){var s=Object(o.a)("<div>").addClass(Mt).appendTo(i);n=this._createComponent(s,ht,{min:0,max:100,width:"100%",validationMessageMode:"always",statusFormat:(e,t)=>this._getStatusString(e,t)})}var r=null;if(t.showCloseButton){var l=Object(o.a)("<div>").addClass(Ft).appendTo(e);r=this._createComponent(l,Se.default,{icon:"dx-filemanager-i dx-filemanager-i-cancel",stylingMode:"text",visible:t.showCloseButtonAlways,onClick:t.onCloseButtonClick})}return{$commonText:a,progressBar:n,$element:e,$wrapper:i,closeButton:r}}_setCloseButtonVisible(e,t){e.closeButton&&(e.$element.toggleClass(xt,!t),e.closeButton.option("visible",t))}_setProgressBarText(e,t){e.progressBar.option("statusFormat",()=>t)}_closeOperation(e){e.customCloseHandling&&!e.completed?(this._raiseOperationCanceled(e),this._setCloseButtonVisible(e.common,!1),e.details.forEach(e=>this._displayClosedOperationItem(e))):(this._raiseOperationClosed(e),e.$info.next(".".concat(ft)).remove(),e.$info.remove(),this._operationCount--,this._operationCount||this._renderEmptyListText())}_cancelOperationItem(e,t){this._raiseOperationItemCanceled(e,t);var i=e.info.details[t];this._displayClosedOperationItem(i)}_displayClosedOperationItem(e){this._setProgressBarText(e,l.a.format("dxFileManager-notificationProgressPanelOperationCanceled")),this._setCloseButtonVisible(e,!1)}_getStatusString(e,t){return 1===e?l.a.format("Done"):Math.round(100*e)+"%"}_raiseOperationClosed(e){this._actions.onOperationClosed({info:e})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_raisePanelClosed(){this._actions.onPanelClosed()}}var Et=wt,Pt="".concat("dx-filemanager-progress-box","-error"),At="".concat("dx-filemanager-progress-box","-image"),Tt="".concat("dx-filemanager-progress-box","-wrapper"),jt="".concat("dx-filemanager-progress-box","-common"),kt="default",Bt="progress",Ut="error",$t="success";class Vt{constructor(e){var{onActionProgressStatusChanged:t,isActual:i}=e;this._id=(new V.a).toString(),this._isActual=i||!1,this._actionProgressStatus=kt,this._raiseActionProgress=t}getId(){return this._id}isActual(){return this._isActual}createErrorDetailsProgressBox(e,t,i){var o=this._createDetailsItem(e,t);this.renderError(o.$wrapper,i)}renderError(e,t){Object(o.a)("<div>").text(t).addClass(Pt).appendTo(e)}isActionProgressStatusDefault(){return this._actionProgressStatus===kt}_createDetailsItem(e,t){var i=Object(o.a)("<div>").appendTo(e);return this._createProgressBox(i,{commonText:t.commonText,imageUrl:t.imageUrl})}_createProgressBox(e,t){e.addClass("dx-filemanager-progress-box"),t.imageUrl&&Object(xe.a)(t.imageUrl).addClass(At).appendTo(e);var i=Object(o.a)("<div>").addClass(Tt).appendTo(e);return{$commonText:Object(o.a)("<div>").addClass(jt).text(t.commonText).appendTo(i),$element:e,$wrapper:i}}}class Rt extends Vt{addOperation(){return{__operationInfoManager:this._id}}addOperationDetails(){}updateOperationItemProgress(){}completeOperationItem(){}completeOperation(){}completeSingleOperationWithError(){}addOperationDetailsError(){}handleDimensionChanged(){return!1}ensureProgressPanelCreated(){}tryHideActionProgress(){this._updateActionProgress("",kt)}updateActionProgressStatus(){this._updateActionProgress("",kt)}_updateActionProgress(e,t){t!==kt&&t!==Bt||(this._actionProgressStatus=t,this._raiseActionProgress(e,t))}hasNoOperations(){return!0}get _operationInProgressCount(){return 0}set _operationInProgressCount(e){}get _failedOperationCount(){return 0}set _failedOperationCount(e){}}class Lt extends Vt{constructor(e){super(e),this._failedOperationCount=0,this._operationInProgressCount=0}addOperation(e,t,i){this._operationInProgressCount++;var o=this._progressPanel.addOperation(e,t,i);return o.__operationInfoManager=this._id,this._updateActionProgress(e,Bt),o}addOperationDetails(e,t,i){this._progressPanel.addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,o){this._progressPanel.updateOperationItemProgress(e,t,i,o)}completeOperationItem(e,t,i){this._progressPanel.completeOperationItem(e,t,i)}finishOperation(e,t){this._progressPanel.updateOperationCommonProgress(e,t)}completeOperation(e,t,i,o){this._operationInProgressCount--,i&&this._failedOperationCount++,this._progressPanel.completeOperation(e,t,i,o)}completeSingleOperationWithError(e,t){this._progressPanel.completeSingleOperationWithError(e,t.detailErrorText),this._notifyError(t)}addOperationDetailsError(e,t){this._progressPanel.addOperationDetailsError(e,t.itemIndex,t.detailErrorText),this._notifyError(t)}handleDimensionChanged(){return this._progressPanel&&this._progressPanel.$element().detach(),!0}ensureProgressPanelCreated(e,t){if(this._progressPanel)this._progressPanel.$element().appendTo(e);else{var i=Object(o.a)("<div>").appendTo(e),n=this._getProgressPanelComponent();this._progressPanel=new n(i,Object(a.a)({},t,{onOperationClosed:e=>{var{info:t}=e;return this._onProgressPanelOperationClosed(t)}}))}}_getProgressPanelComponent(){return Et}_onProgressPanelOperationClosed(e){e.hasError&&(this._failedOperationCount--,this.tryHideActionProgress())}tryHideActionProgress(){this.hasNoOperations()&&this._updateActionProgress("",kt)}updateActionProgressStatus(e){if(e){var t=0===this._failedOperationCount?$t:Ut;this._updateActionProgress("",t)}}_notifyError(e){var t=this.hasNoOperations()?kt:Ut;this._updateActionProgress(e.commonErrorText,t)}_updateActionProgress(e,t){this._actionProgressStatus=t,this._raiseActionProgress(e,t)}hasNoOperations(){return 0===this._operationInProgressCount&&0===this._failedOperationCount}get _operationInProgressCount(){return this._operationInProgressCountInternal}set _operationInProgressCount(e){this._operationInProgressCountInternal=e}get _failedOperationCount(){return this._failedOperationCountInternal}set _failedOperationCount(e){this._failedOperationCountInternal=e}}var Nt=Object(p.d)(),Kt="".concat("dx-filemanager-notification","-drawer"),zt="".concat(Kt,"-panel"),Ht="".concat("dx-filemanager-notification","-popup"),Wt="".concat("dx-filemanager-notification","-popup-error"),qt="".concat("dx-filemanager-notification","-common"),Zt="".concat("dx-filemanager-notification","-separator"),Gt="".concat("dx-filemanager-notification","-details"),Jt="".concat("dx-filemanager-notification","-common-no-item");class Xt extends c.a{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=this._isSmallScreen(),this._managerMap={},this._notificationManagerStubId=null,this._setNotificationManager();var e=this.option("progressPanelContainer"),t=Object(o.a)("<div>").addClass(Kt).appendTo(e);Object(o.a)("<div>").addClass(zt).appendTo(t);var i=Object(a.a)({opened:!1,position:"right",template:e=>this._ensureProgressPanelCreated(e)},this._getProgressDrawerAdaptiveOptions());this._progressDrawer=this._createComponent(t,st.a,i);var s=t.find(".".concat(zt)).first(),r=this.option("contentTemplate");Object(n.h)(r)&&r(s,this)}_setNotificationManager(e){if(e=Object(a.a)({onActionProgressStatusChanged:this._raiseActionProgress.bind(this)},e),!this._notificationManagerStubId){var t=new Rt(e);this._notificationManagerStubId=t.getId(),this._managerMap[this._notificationManagerStubId]=t}if(!this._isProgressDrawerDisabled()){var i=this._getProgressManagerComponent();e.isActual=!0;var o=new i(e);this._managerMap[o.getId()]=o}}_getNotificationManager(e){var t=(null==e?void 0:e.__operationInfoManager)||this._getActualNotificationManagerId();return this._managerMap[t]||this._managerMap[this._notificationManagerStubId]}_clearManagerMap(){var e=this._managerMap[this._notificationManagerStubId];delete this._managerMap,this._managerMap={[this._notificationManagerStubId]:e}}_getActualNotificationManagerId(){return Object.keys(this._managerMap).filter(e=>this._managerMap[e].isActual())[0]}tryShowProgressPanel(){var e=new s.a,t=this._getNotificationManager();return t.isActionProgressStatusDefault()||this._isProgressDrawerOpened()||this._isProgressDrawerDisabled()?e.resolve().promise():(setTimeout(()=>{this._progressDrawer.show().done(e.resolve),this._hidePopup(),t.tryHideActionProgress()}),e.promise())}addOperation(e,t,i){return this._getNotificationManager().addOperation(e,t,i)}addOperationDetails(e,t,i){this._getNotificationManager(e).addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,o){this._getNotificationManager(e).updateOperationItemProgress(e,t,i,o)}completeOperationItem(e,t,i){this._getNotificationManager(e).completeOperationItem(e,t,i)}finishOperation(e,t){this._getNotificationManager(e).finishOperation(e,t)}completeOperation(e,t,i,o){var a=this._getNotificationManager(e);i||this._showPopup(t),a.completeOperation(e,t,i,o),this._isProgressDrawerOpened()&&a.hasNoOperations()?a.tryHideActionProgress():a.updateActionProgressStatus(e)}completeSingleOperationWithError(e,t){this._getNotificationManager(e).completeSingleOperationWithError(e,t),this._showPopupError(t)}addOperationDetailsError(e,t){this._getNotificationManager(e).addOperationDetailsError(e,t),this._showPopupError(t)}_hideProgressPanel(){setTimeout(()=>this._progressDrawer.hide())}_isSmallScreen(){return!!Object(p.f)()&&Object(Re.l)(Nt)<=1e3}_dimensionChanged(e){e&&"height"===e||this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;if((this._isInAdaptiveState=this._isSmallScreen(),e!==this._isInAdaptiveState&&this._progressDrawer)&&this._getNotificationManager().handleDimensionChanged()){var t=this._getProgressDrawerAdaptiveOptions();this._progressDrawer.option(t)}}_getProgressDrawerAdaptiveOptions(){return this._isInAdaptiveState?{openedStateMode:"overlap",shading:!0,closeOnOutsideClick:!0}:{openedStateMode:"shrink",shading:!1,closeOnOutsideClick:!1}}_ensureProgressPanelCreated(e){this._getNotificationManager().ensureProgressPanelCreated(e,{onOperationCanceled:e=>{var{info:t}=e;return this._raiseOperationCanceled(t)},onOperationItemCanceled:e=>{var{item:t,itemIndex:i}=e;return this._raiseOperationItemCanceled(t,i)},onPanelClosed:()=>this._hideProgressPanel()})}_getProgressManagerComponent(){return Lt}_isProgressDrawerDisabled(){return!this.option("showProgressPanel")}_isProgressDrawerOpened(){return this._progressDrawer.option("opened")}_hidePopup(e){(this.option("showNotificationPopup")||e)&&this._getNotificationPopup().hide()}_showPopup(e,t){!this._isProgressDrawerOpened()&&this.option("showNotificationPopup")&&(this._getNotificationPopup().$wrapper().toggleClass(Wt,!!t),this._getNotificationPopup().option("contentTemplate",e),this._getNotificationPopup().option("visible")||this._getNotificationPopup().show())}_showPopupError(e){if(this.option("showNotificationPopup")){var t=this._getNotificationManager(),i=Object(o.a)("<div>"),a=Object(o.a)("<div>").addClass(qt).text(e.commonErrorText),n=Object(o.a)("<div>").addClass(Zt);Object(o.a)("<div>").appendTo(n);var s=Object(o.a)("<div>").addClass(Gt);e.item?t.createErrorDetailsProgressBox(s,e.item,e.detailErrorText):(a.addClass(Jt),t.renderError(s,e.detailErrorText)),i.append(a,n,s),this._showPopup(i,!0)}}_getNotificationPopup(){if(!this._notificationPopup){var e=Object(o.a)("<div>").addClass(Ht).appendTo(this.$element());this._notificationPopup=this._createComponent(e,nt.default,{container:this.$element(),width:"auto",height:"auto",showTitle:!1,dragEnabled:!1,shading:!1,visible:!1,closeOnOutsideClick:!0,animation:{duration:0},position:{my:"right top",at:"right top",of:this.option("positionTarget"),offset:"-10 -5"},_wrapperClassExternal:Ht})}return this._notificationPopup}_raiseActionProgress(e,t){this._actions.onActionProgress({message:e,status:t})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_initActions(){this._actions={onActionProgress:this._createActionByOption("onActionProgress"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled")}}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{progressPanelContainer:null,contentTemplate:null,onActionProgress:null,onOperationCanceled:null,onOperationItemCanceled:null,showProgressPanel:!0,showNotificationPopup:!0})}_optionChanged(e){var t=e.name;switch(t){case"progressPanelContainer":case"contentTemplate":break;case"showProgressPanel":this._setNotificationManager(),this._getNotificationManager().updateActionProgressStatus(),e.value||(this._hideProgressPanel(),this._clearManagerMap()),this._progressDrawer.repaint();break;case"showNotificationPopup":e.value||this._hidePopup(!0);break;case"onActionProgress":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}}var Yt=i("lXBL"),Qt=i("VABh");class ei extends c.a{_initMarkup(){var e;super._initMarkup(),this._createOnClosedAction();var t=this._getDialogOptions(),i=Object(o.a)("<div>").addClass("dx-filemanager-dialog-popup").appendTo(this.$element());t.popupCssClass&&i.addClass(t.popupCssClass);var a={showTitle:!0,title:t.title,visible:!1,closeOnOutsideClick:!0,copyRootClassesToWrapper:!0,_ignoreCopyRootClassesToWrapperDeprecation:!0,contentTemplate:this._createContentTemplate.bind(this),toolbarItems:[{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:t.buttonText,onClick:this._applyDialogChanges.bind(this)}},{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:l.a.format("dxFileManager-dialogButtonCancel"),onClick:this._closeDialog.bind(this)}}],onInitialized:e=>{var{component:t}=e;t.registerKeyHandler("enter",this._applyDialogChanges.bind(this))},onHidden:this._onPopupHidden.bind(this),onShown:this._onPopupShown.bind(this),_wrapperClassExternal:"".concat("dx-filemanager-dialog-popup"," ").concat(null!==(e=t.popupCssClass)&&void 0!==e?e:"")};Object(n.d)(t.height)&&(a.height=t.height),Object(n.d)(t.maxHeight)&&(a.maxHeight=t.maxHeight),this._popup=this._createComponent(i,nt.default,a)}show(){this._dialogResult=null,this._popup.show()}_getDialogOptions(){return{title:"Title",buttonText:"ButtonText",contentCssClass:"",popupCssClass:""}}_createContentTemplate(e){this._$contentElement=Object(o.a)("<div>").appendTo(e).addClass("dx-filemanager-dialog");var t=this._getDialogOptions().contentCssClass;t&&this._$contentElement.addClass(t)}_getDialogResult(){return null}_applyDialogChanges(){var e=this._getDialogResult();e&&(this._dialogResult=e,this._closeDialog())}_closeDialog(){this._popup.hide()}_onPopupHidden(){this._onClosedAction({dialogResult:this._dialogResult})}_onPopupShown(){}_createOnClosedAction(){this._onClosedAction=this._createActionByOption("onClosed")}_setTitle(e){this._popup.option("title",e)}_setApplyButtonOptions(e){this._popup.option("toolbarItems[0].options",e)}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{onClosed:null})}_optionChanged(e){switch(e.name){case"onClosed":this._createOnPathChangedAction();break;default:super._optionChanged(e)}}}var ti=ei;var ii=class extends ti{show(e){e=e||"",this._nameTextBox?this._nameTextBox.option("value",e):this._initialNameValue=e,super.show()}_onPopupShown(){if(this._nameTextBox){var e=this._nameTextBox._input();e.length&&e[0].select(),this._nameTextBox.focus()}}_getDialogOptions(){return Object(a.a)(super._getDialogOptions(),{title:this.option("title"),buttonText:this.option("buttonText"),contentCssClass:"dx-filemanager-dialog-name-editor",popupCssClass:"dx-filemanager-dialog-name-editor-popup"})}_createContentTemplate(e){super._createContentTemplate(e),this._nameTextBox=this._createComponent(Object(o.a)("<div>"),Qt.default,{value:this._initialNameValue,onEnterKey:()=>this._hasCompositionJustEnded&&this._applyDialogChanges(),onKeyDown:e=>this._checkCompositionEnded(e)}),this._$contentElement.append(this._nameTextBox.$element())}_checkCompositionEnded(e){var{event:t}=e;this._hasCompositionJustEnded=229!==t.which}_getDialogResult(){var e=this._nameTextBox.option("value");return e?{name:e}:null}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{title:"",buttonText:""})}};var oi=class extends ti{show(){var e;this._setSelectedDirInfo(null),null===(e=this._filesTreeView)||void 0===e||e.refresh(),super.show()}switchToCopyDialog(e){this._targetItemInfos=e,this._setTitle(l.a.format("dxFileManager-dialogDirectoryChooserCopyTitle")),this._setApplyButtonOptions({text:l.a.format("dxFileManager-dialogDirectoryChooserCopyButtonText"),disabled:!0})}switchToMoveDialog(e){this._targetItemInfos=e,this._setTitle(l.a.format("dxFileManager-dialogDirectoryChooserMoveTitle")),this._setApplyButtonOptions({text:l.a.format("dxFileManager-dialogDirectoryChooserMoveButtonText"),disabled:!0})}_getDialogOptions(){return Object(a.a)(super._getDialogOptions(),{contentCssClass:"dx-filemanager-dialog-folder-chooser",popupCssClass:"dx-filemanager-dialog-folder-chooser-popup"})}_createContentTemplate(e){super._createContentTemplate(e),this._filesTreeView=this._createComponent(Object(o.a)("<div>"),we,{getDirectories:this.option("getDirectories"),getCurrentDirectory:()=>this._getDialogSelectedDirectory(),onDirectoryClick:e=>this._onFilesTreeViewDirectoryClick(e),onFilesTreeViewContentReady:()=>this._toggleUnavailableLocationsDisabled(!0)}),this._$contentElement.append(this._filesTreeView.$element())}_getDialogResult(){var e=this._getDialogSelectedDirectory();return e?{folder:e}:e}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{getItems:null})}_getDialogSelectedDirectory(){return this._selectedDirectoryInfo}_onFilesTreeViewDirectoryClick(e){var{itemData:t}=e;this._setSelectedDirInfo(t),this._filesTreeView.updateCurrentDirectory()}_setSelectedDirInfo(e){this._selectedDirectoryInfo=e,this._setApplyButtonOptions({disabled:!e})}_onPopupShown(){this._toggleUnavailableLocationsDisabled(!0),super._onPopupShown()}_onPopupHidden(){this._toggleUnavailableLocationsDisabled(!1),super._onPopupHidden()}_toggleUnavailableLocationsDisabled(e){if(this._filesTreeView){var t=this._getLocationsToProcess(e);this._filesTreeView.toggleDirectoryExpandedStateRecursive(t.locationsToExpand[0],e).then(()=>this._filesTreeView.toggleDirectoryLineExpandedState(t.locationsToCollapse,!e).then(()=>t.locationKeysToDisable.forEach(t=>this._filesTreeView.toggleNodeDisabledState(t,e))))}}_getLocationsToProcess(e){var t={},i={};this._targetItemInfos.forEach(e=>{e.parentDirectory&&(t[e.parentDirectory.getInternalKey()]=e.parentDirectory),e.fileItem.isDirectory&&(i[e.getInternalKey()]=e)});var o=k(t),a=k(i);return{locationsToExpand:e?o.values:[],locationsToCollapse:e?a.values:[],locationKeysToDisable:o.keys.concat(...a.keys)}}};var ai=class extends ti{show(e){var{itemName:t,itemCount:i}=e,o=1===i?l.a.format("dxFileManager-dialogDeleteItemSingleItemConfirmation",t):l.a.format("dxFileManager-dialogDeleteItemMultipleItemsConfirmation",i);this._$text?this._$text.text(o):this._initialText=o,super.show()}_getDialogOptions(){return Object(a.a)(super._getDialogOptions(),{title:l.a.format("dxFileManager-dialogDeleteItemTitle"),buttonText:l.a.format("dxFileManager-dialogDeleteItemButtonText"),contentCssClass:"dx-filemanager-dialog-delete-item",popupCssClass:"dx-filemanager-dialog-delete-item-popup",height:"auto",maxHeight:"80vh"})}_createContentTemplate(e){super._createContentTemplate(e),this._$text=Object(o.a)("<div>").text(this._initialText).appendTo(this._$contentElement),this._createComponent(this._$contentElement,Ke.default,{width:"100%",height:"100%"})}_getDialogResult(){return{}}};var ni=class{constructor(e,t){this._$element=e,this._options=t;var i={onClosed:this._options.onDialogClosed,rtlEnabled:this._options.rtlEnabled},n=Object(o.a)("<div>").appendTo(this._$element);this._chooseDirectoryDialog=new oi(n,Object(a.a)(i,this._options.chooseDirectoryDialog));var s=Object(o.a)("<div>").appendTo(this._$element);this._renameItemDialog=new ii(s,Object(a.a)(i,{title:l.a.format("dxFileManager-dialogRenameItemTitle"),buttonText:l.a.format("dxFileManager-dialogRenameItemButtonText")}));var r=Object(o.a)("<div>").appendTo(this._$element);this._createItemDialog=new ii(r,Object(a.a)(i,{title:l.a.format("dxFileManager-dialogCreateDirectoryTitle"),buttonText:l.a.format("dxFileManager-dialogCreateDirectoryButtonText")}));var d=Object(o.a)("<div>").appendTo(this._$element);this._deleteItemDialog=new ai(d,i)}getCopyDialog(e){return this._chooseDirectoryDialog.switchToCopyDialog(e),this._chooseDirectoryDialog}getMoveDialog(e){return this._chooseDirectoryDialog.switchToMoveDialog(e),this._chooseDirectoryDialog}getRenameItemDialog(){return this._renameItemDialog}getCreateItemDialog(){return this._createItemDialog}getDeleteItemDialog(){return this._deleteItemDialog}updateDialogRtl(e){[this._chooseDirectoryDialog,this._renameItemDialog,this._createItemDialog,this._deleteItemDialog].forEach(t=>{t.option("rtlEnabled",e)})}},si=i("EZme"),ri=i("6SE/"),li=Object(p.d)(),di=()=>!!li.FormData;class ci extends rt.a{_supportedKeys(){var e=e=>{e.preventDefault();var t=this._selectButton.$element();_.a.trigger(t,ri.a)};return Object(a.a)(super._supportedKeys(),{space:e,enter:e})}_setOptionsByReference(){super._setOptionsByReference(),Object(a.a)(this._optionsByReference,{value:!0})}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{chunkSize:0,value:[],selectButtonText:l.a.format("dxFileUploader-selectFile"),uploadButtonText:l.a.format("dxFileUploader-upload"),labelText:l.a.format("dxFileUploader-dropFile"),name:"files[]",multiple:!1,accept:"",uploadUrl:"/",allowCanceling:!0,showFileList:!0,progress:0,dialogTrigger:void 0,dropZone:void 0,readyToUploadMessage:l.a.format("dxFileUploader-readyToUpload"),uploadedMessage:l.a.format("dxFileUploader-uploaded"),uploadFailedMessage:l.a.format("dxFileUploader-uploadFailedMessage"),uploadAbortedMessage:l.a.format("dxFileUploader-uploadAbortedMessage"),uploadMode:"instantly",uploadMethod:"POST",uploadHeaders:{},uploadCustomData:{},onBeforeSend:null,onUploadStarted:null,onUploaded:null,onFilesUploaded:null,onProgress:null,onUploadError:null,onUploadAborted:null,onDropZoneEnter:null,onDropZoneLeave:null,allowedFileExtensions:[],maxFileSize:0,minFileSize:0,inputAttr:{},invalidFileExtensionMessage:l.a.format("dxFileUploader-invalidFileExtension"),invalidMaxFileSizeMessage:l.a.format("dxFileUploader-invalidMaxFileSize"),invalidMinFileSizeMessage:l.a.format("dxFileUploader-invalidMinFileSize"),extendSelection:!0,validationMessageMode:"always",uploadFile:null,uploadChunk:null,abortUpload:null,validationMessageOffset:{h:0,v:0},hoverStateEnabled:!0,useNativeInputClick:!1,useDragOver:!0,nativeDropSupported:!0,_uploadButtonType:"normal"})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>"desktop"===Te.a.real().deviceType&&!Te.a.isSimulator(),options:{focusStateEnabled:!0}},{device:[{platform:"android"}],options:{validationMessageOffset:{v:0}}},{device:()=>"desktop"!==Te.a.real().deviceType,options:{useDragOver:!1}},{device:()=>!di(),options:{uploadMode:"useForm"}},{device:()=>"desktop"!==Te.a.real().deviceType,options:{nativeDropSupported:!1}},{device:()=>Object(C.d)(),options:{_uploadButtonType:"default"}}])}_initOptions(e){var t="labelText"in e;super._initOptions(e),t||this._shouldDragOverBeRendered()||this.option("labelText","")}_init(){super._init(),this._initFileInput(),this._initLabel(),this._setUploadStrategy(),this._createFiles(),this._createBeforeSendAction(),this._createUploadStartedAction(),this._createUploadedAction(),this._createFilesUploadedAction(),this._createProgressAction(),this._createUploadErrorAction(),this._createUploadAbortedAction(),this._createDropZoneEnterAction(),this._createDropZoneLeaveAction()}_setUploadStrategy(){var e=null;if(this.option("chunkSize")>0){var t=this.option("uploadChunk");e=t&&Object(n.h)(t)?new _i(this):new mi(this)}else{var i=this.option("uploadFile");e=i&&Object(n.h)(i)?new Ii(this):new fi(this)}this._uploadStrategy=e}_initFileInput(){this._isCustomClickEvent=!1,this._$fileInput||(this._$fileInput=Object(o.a)("<input>").attr("type","file"),_.a.on(this._$fileInput,"change",this._inputChangeHandler.bind(this)),_.a.on(this._$fileInput,"click",e=>(e.stopPropagation(),this._resetInputValue(),this.option("useNativeInputClick")||this._isCustomClickEvent))),this._$fileInput.prop({multiple:this.option("multiple"),accept:this.option("accept"),tabIndex:-1})}_inputChangeHandler(){if(!this._doPreventInputChange){var e=this._$fileInput.val().replace(/^.*\\/,""),t=this._$fileInput.prop("files");if(!t||t.length||"useForm"===this.option("uploadMode")){var i=t?this._getFiles(t):[{name:e}];this._changeValue(i),"instantly"===this.option("uploadMode")&&this._uploadFiles()}}}_shouldFileListBeExtended(){return"useForm"!==this.option("uploadMode")&&this.option("extendSelection")&&this.option("multiple")}_changeValue(e){var t=this._shouldFileListBeExtended()?this.option("value").slice():[];this.option("value",t.concat(e))}_getFiles(e){var t=[];return Object(Y.a)(e,(e,i)=>t.push(i)),t}_getFile(e){var t=Object(n.i)(e)?this.option("value")[e]:e;return this._files.filter(e=>e.value===t)[0]}_initLabel(){this._$inputLabel||(this._$inputLabel=Object(o.a)("<div>")),this._updateInputLabelText()}_updateInputLabelText(){var e=this._isInteractionDisabled()?"":this.option("labelText");this._$inputLabel.text(e)}_focusTarget(){return this.$element().find(".dx-fileuploader-button")}_getSubmitElement(){return this._$fileInput}_initMarkup(){super._initMarkup(),this.$element().addClass("dx-fileuploader"),this._renderWrapper(),this._renderInputWrapper(),this._renderSelectButton(),this._renderInputContainer(),this._renderUploadButton(),this._preventRecreatingFiles=!0,this._activeDropZone=null}_render(){this._preventRecreatingFiles=!1,this._attachDragEventHandlers(this._$inputWrapper),this._attachDragEventHandlers(this.option("dropZone")),this._renderFiles(),super._render()}_createFileProgressBar(e){e.progressBar=this._createProgressBar(e.value.size),e.progressBar.$element().appendTo(e.$file),this._initStatusMessage(e),this._ensureCancelButtonInitialized(e)}_setStatusMessage(e,t){setTimeout(()=>{this.option("showFileList")&&e.$statusMessage&&(e.$statusMessage.text(t),e.$statusMessage.css("display",""),e.progressBar.$element().remove())},400)}_getUploadAbortedStatusMessage(){return"instantly"===this.option("uploadMode")?this.option("uploadAbortedMessage"):this.option("readyToUploadMessage")}_createFiles(){var e=this.option("value");!this._files||0!==e.length&&this._shouldFileListBeExtended()||(this._preventFilesUploading(this._files),this._files=null),this._files||(this._files=[]),Object(Y.a)(e.slice(this._files.length),(e,t)=>{var i=this._createFile(t);this._validateFile(i),this._files.push(i)})}_preventFilesUploading(e){e.forEach(e=>this._uploadStrategy.abortUpload(e))}_validateFile(e){e.isValidFileExtension=this._validateFileExtension(e),e.isValidMinSize=this._validateMinFileSize(e),e.isValidMaxSize=this._validateMaxFileSize(e)}_validateFileExtension(e){var t=this.option("allowedFileExtensions"),i=this.option("accept"),o=this._getAllowedFileTypes(i),a=e.value.name.substring(e.value.name.lastIndexOf(".")).toLowerCase();if(0!==i.length&&!this._isFileTypeAllowed(e.value,o))return!1;if(0===t.length)return!0;for(var n=0;n<t.length;n++)if(a===t[n].toLowerCase())return!0;return!1}_validateMaxFileSize(e){var t=e.value.size,i=this.option("maxFileSize");return!(i>0)||t<=i}_validateMinFileSize(e){var t=e.value.size,i=this.option("minFileSize");return!(i>0)||t>=i}_createBeforeSendAction(){this._beforeSendAction=this._createActionByOption("onBeforeSend",{excludeValidators:["readOnly"]})}_createUploadStartedAction(){this._uploadStartedAction=this._createActionByOption("onUploadStarted",{excludeValidators:["readOnly"]})}_createUploadedAction(){this._uploadedAction=this._createActionByOption("onUploaded",{excludeValidators:["readOnly"]})}_createFilesUploadedAction(){this._filesUploadedAction=this._createActionByOption("onFilesUploaded",{excludeValidators:["readOnly"]})}_createProgressAction(){this._progressAction=this._createActionByOption("onProgress",{excludeValidators:["readOnly"]})}_createUploadAbortedAction(){this._uploadAbortedAction=this._createActionByOption("onUploadAborted",{excludeValidators:["readOnly"]})}_createUploadErrorAction(){this._uploadErrorAction=this._createActionByOption("onUploadError",{excludeValidators:["readOnly"]})}_createDropZoneEnterAction(){this._dropZoneEnterAction=this._createActionByOption("onDropZoneEnter")}_createDropZoneLeaveAction(){this._dropZoneLeaveAction=this._createActionByOption("onDropZoneLeave")}_createFile(e){return{value:e,loadedSize:0,onProgress:Object(si.default)(),onAbort:Object(si.default)(),onLoad:Object(si.default)(),onError:Object(si.default)(),onLoadStart:Object(si.default)(),isValidFileExtension:!0,isValidMaxSize:!0,isValidMinSize:!0,isValid(){return this.isValidFileExtension&&this.isValidMaxSize&&this.isValidMinSize},isInitialized:!1}}_resetFileState(e){e.isAborted=!1,e.uploadStarted=!1,e.isStartLoad=!1,e.loadedSize=0,e.chunksData=void 0,e.request=void 0}_renderFiles(){var e,t=this.option("value");this._$filesContainer?this._shouldFileListBeExtended()&&0!==t.length||this._$filesContainer.empty():this._$filesContainer=Object(o.a)("<div>").addClass("dx-fileuploader-files-container").appendTo(this._$content);var i=this.option("showFileList");i&&Object(Y.a)(this._files,(e,t)=>{t.$file||this._renderFile(t)}),this.$element().toggleClass("dx-fileuploader-show-file-list",i),this._toggleFileUploaderEmptyClassName(),this._updateFileNameMaxWidth(),null===(e=this._validationMessage)||void 0===e||e.repaint()}_renderFile(e){var t=e.value,i=Object(o.a)("<div>").addClass("dx-fileuploader-file-container").appendTo(this._$filesContainer);this._renderFileButtons(e,i),e.$file=Object(o.a)("<div>").addClass("dx-fileuploader-file").appendTo(i);var a=Object(o.a)("<div>").addClass("dx-fileuploader-file-info").appendTo(e.$file);e.$statusMessage=Object(o.a)("<div>").addClass("dx-fileuploader-file-status-message").appendTo(e.$file),Object(o.a)("<div>").addClass("dx-fileuploader-file-name").text(t.name).appendTo(a),Object(n.d)(t.size)&&Object(o.a)("<div>").addClass("dx-fileuploader-file-size").text(this._getFileSize(t.size)).appendTo(a),e.isValid()?e.$statusMessage.text(this.option("readyToUploadMessage")):(e.isValidFileExtension||e.$statusMessage.append(this._createValidationElement("invalidFileExtensionMessage")),e.isValidMaxSize||e.$statusMessage.append(this._createValidationElement("invalidMaxFileSizeMessage")),e.isValidMinSize||e.$statusMessage.append(this._createValidationElement("invalidMinFileSizeMessage")),i.addClass("dx-fileuploader-invalid"))}_createValidationElement(e){return Object(o.a)("<span>").text(this.option(e))}_updateFileNameMaxWidth(){var e=this.option("allowCanceling")&&"useForm"!==this.option("uploadMode")?1:0,t="useButtons"===this.option("uploadMode")?1:0,i=Object(Re.l)(this._$filesContainer.find(".dx-fileuploader-file-container").first())||Object(Re.l)(this._$filesContainer),o=this._$filesContainer.find(".dx-fileuploader-button-container").eq(0),a=Object(Re.l)(o)*(e+t),n=this._$filesContainer.find(".dx-fileuploader-file-size").eq(0),s=n.text();n.text("1000 Mb");var r=Object(Re.l)(n);n.text(s),this._$filesContainer.find(".dx-fileuploader-file-name").css("maxWidth",i-a-r)}_renderFileButtons(e,t){var i=this._getCancelButton(e);i&&t.append(i);var o=this._getUploadButton(e);o&&t.append(o)}_getCancelButton(e){return"useForm"===this.option("uploadMode")?null:(e.cancelButton=this._createComponent(Object(o.a)("<div>").addClass("dx-fileuploader-button dx-fileuploader-cancel-button"),Se.default,{onClick:()=>this._removeFile(e),icon:"close",visible:this.option("allowCanceling"),disabled:this.option("readOnly"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")}),Object(o.a)("<div>").addClass("dx-fileuploader-button-container").append(e.cancelButton.$element()))}_getUploadButton(e){return e.isValid()&&"useButtons"===this.option("uploadMode")?(e.uploadButton=this._createComponent(Object(o.a)("<div>").addClass("dx-fileuploader-button dx-fileuploader-upload-button"),Se.default,{onClick:()=>this._uploadFile(e),icon:"upload",hoverStateEnabled:this.option("hoverStateEnabled")}),e.onLoadStart.add(()=>e.uploadButton.option({visible:!1,disabled:!0})),e.onAbort.add(()=>e.uploadButton.option({visible:!0,disabled:!1})),Object(o.a)("<div>").addClass("dx-fileuploader-button-container").append(e.uploadButton.$element())):null}_removeFile(e){var t;null===(t=e.$file)||void 0===t||t.parent().remove(),this._files.splice(Object(f.d)(e,this._files),1);var i=this.option("value").slice();i.splice(Object(f.d)(e.value,i),1),this._preventRecreatingFiles=!0,this.option("value",i),this._preventRecreatingFiles=!1,this._toggleFileUploaderEmptyClassName(),this._resetInputValue(!0)}removeFile(e){if("useForm"!==this.option("uploadMode")&&Object(n.d)(e)){var t=this._getFile(e);t&&(t.uploadStarted&&this._preventFilesUploading([t]),this._removeFile(t))}}_toggleFileUploaderEmptyClassName(){this.$element().toggleClass("dx-fileuploader-empty",!this._files.length||this._hasInvalidFile(this._files))}_hasInvalidFile(e){for(var t=0;t<e.length;t++)if(!e[t].isValid())return!0;return!1}_getFileSize(e){for(var t=0,i=[l.a.format("dxFileUploader-bytes"),l.a.format("dxFileUploader-kb"),l.a.format("dxFileUploader-Mb"),l.a.format("dxFileUploader-Gb")],o=i.length-1;t<o&&e>=1024;)e/=1024,t++;return Math.round(e)+" "+i[t]}_renderSelectButton(){var e=Object(o.a)("<div>").addClass("dx-fileuploader-button").appendTo(this._$inputWrapper);this._selectButton=this._createComponent(e,Se.default,{text:this.option("selectButtonText"),focusStateEnabled:!1,integrationOptions:{},disabled:this.option("readOnly"),hoverStateEnabled:this.option("hoverStateEnabled")}),this._selectFileDialogHandler=this._selectButtonClickHandler.bind(this),"desktop"===Te.a.real().deviceType?this._selectButton.option("onClick",this._selectFileDialogHandler):this._attachSelectFileDialogHandler(this._selectButton.$element()),this._attachSelectFileDialogHandler(this.option("dialogTrigger"))}_selectButtonClickHandler(){if(!this.option("useNativeInputClick")){if(this._isInteractionDisabled())return!1;this._isCustomClickEvent=!0,_.a.trigger(this._$fileInput,"click"),this._isCustomClickEvent=!1}}_attachSelectFileDialogHandler(e){Object(n.d)(e)&&(this._detachSelectFileDialogHandler(e),_.a.on(Object(o.a)(e),"click",this._selectFileDialogHandler))}_detachSelectFileDialogHandler(e){Object(n.d)(e)&&_.a.off(Object(o.a)(e),"click",this._selectFileDialogHandler)}_renderUploadButton(){if("useButtons"===this.option("uploadMode")){var e=Object(o.a)("<div>").addClass("dx-fileuploader-button").addClass("dx-fileuploader-upload-button").appendTo(this._$content);this._uploadButton=this._createComponent(e,Se.default,{text:this.option("uploadButtonText"),onClick:this._uploadButtonClickHandler.bind(this),type:this.option("_uploadButtonType"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")})}}_uploadButtonClickHandler(){this._uploadFiles()}_shouldDragOverBeRendered(){return!this.option("readOnly")&&("useForm"!==this.option("uploadMode")||this.option("nativeDropSupported"))}_isInteractionDisabled(){return this.option("readOnly")||this.option("disabled")}_renderInputContainer(){this._$inputContainer=Object(o.a)("<div>").addClass("dx-fileuploader-input-container").appendTo(this._$inputWrapper),this._$fileInput.addClass("dx-fileuploader-input"),this._renderInput();var e="dx-fileuploader-input-label-".concat(new V.a);this._$inputLabel.attr("id",e).addClass("dx-fileuploader-input-label").appendTo(this._$inputContainer),this.setAria("labelledby",e,this._$fileInput)}_renderInput(){this.option("useNativeInputClick")?this._selectButton.option("template",this._selectButtonInputTemplate.bind(this)):(this._$fileInput.appendTo(this._$inputContainer),this._selectButton.option("template","content")),this._applyInputAttributes(this.option("inputAttr"))}_selectButtonInputTemplate(e,t){var i=Object(o.a)(t),a=Object(o.a)("<span>").addClass("dx-button-text").text(e.text);return i.append(a).append(this._$fileInput),i}_renderInputWrapper(){this._$inputWrapper=Object(o.a)("<div>").addClass("dx-fileuploader-input-wrapper").appendTo(this._$content)}_detachDragEventHandlers(e){Object(n.d)(e)&&_.a.off(Object(o.a)(e),Object(Ae.a)("",this.NAME))}_attachDragEventHandlers(e){var t=e!==this._$inputWrapper;Object(n.d)(e)&&this._shouldDragOverBeRendered()&&(this._detachDragEventHandlers(e),e=Object(o.a)(e),_.a.on(e,Object(Ae.a)("dragenter",this.NAME),this._dragEnterHandler.bind(this,t)),_.a.on(e,Object(Ae.a)("dragover",this.NAME),this._dragOverHandler.bind(this,t)),_.a.on(e,Object(Ae.a)("dragleave",this.NAME),this._dragLeaveHandler.bind(this,t)),_.a.on(e,Object(Ae.a)("drop",this.NAME),this._dropHandler.bind(this,t)))}_applyInputAttributes(e){this._$fileInput.attr(e)}_useInputForDrop(){return this.option("nativeDropSupported")&&"useForm"===this.option("uploadMode")}_getDropZoneElement(e,t){var i=e?Array.from(Object(o.a)(this.option("dropZone"))):[this._$inputWrapper];return(i=i.map(e=>Object(o.a)(e).get(0)))[i.indexOf(t.currentTarget)]}_dragEnterHandler(e,t){if(this.option("disabled"))return!1;this._useInputForDrop()||t.preventDefault();var i=this._getDropZoneElement(e,t);Object(n.d)(i)&&null===this._activeDropZone&&this.isMouseOverElement(t,i,!1)&&(this._activeDropZone=i,this._tryToggleDropZoneActive(!0,e,t))}_dragOverHandler(e,t){if(this._useInputForDrop()||t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy",!e){var i=this._getDropZoneElement(!1,t);null===this._activeDropZone&&this.isMouseOverElement(t,i,!1)&&this._dragEnterHandler(!1,t),null!==this._activeDropZone&&this._shouldRaiseDragLeave(t,!1)&&this._dragLeaveHandler(!1,t)}}_dragLeaveHandler(e,t){this._useInputForDrop()||t.preventDefault(),null!==this._activeDropZone&&this._shouldRaiseDragLeave(t,e)&&(this._tryToggleDropZoneActive(!1,e,t),this._activeDropZone=null)}_shouldRaiseDragLeave(e,t){return!this.isMouseOverElement(e,this._activeDropZone,!t)}_tryToggleDropZoneActive(e,t,i){var o=e?"addClass":"removeClass";this[e?"_dropZoneEnterAction":"_dropZoneLeaveAction"]({event:i,dropZoneElement:this._activeDropZone}),t||this.$element()[o]("dx-fileuploader-dragover")}_dropHandler(e,t){if(this._activeDropZone=null,e||this.$element().removeClass("dx-fileuploader-dragover"),!(this._useInputForDrop()||e&&this._isInteractionDisabled())){t.preventDefault();var i=t.originalEvent.dataTransfer.files,o=this._getFiles(i);!this.option("multiple")&&o.length>1||(this._changeValue(o),"instantly"===this.option("uploadMode")&&this._uploadFiles())}}_areAllFilesLoaded(){return this._files.every(e=>!e.isValid()||e._isError||e._isLoaded||e.isAborted)}_handleAllFilesUploaded(){this._recalculateProgress(),this._areAllFilesLoaded()&&this._filesUploadedAction()}_getAllowedFileTypes(e){return e.length?e.split(",").map(e=>e.trim()):[]}_isFileTypeAllowed(e,t){for(var i=0,o=t.length;i<o;i++){var a=t[i];if("."===a[0]){if(a=a.replace(".","\\."),e.name.match(new RegExp(a+"$","i")))return!0}else if(a=a.replace(new RegExp("\\*","g"),""),e.type.match(new RegExp(a,"i")))return!0}return!1}_renderWrapper(){var e=Object(o.a)("<div>").addClass("dx-fileuploader-wrapper").appendTo(this.$element()),t=Object(o.a)("<div>").addClass("dx-fileuploader-container").appendTo(e);this._$content=Object(o.a)("<div>").addClass("dx-fileuploader-content").appendTo(t)}_clean(){this._$fileInput.detach(),delete this._$filesContainer,this._detachSelectFileDialogHandler(this.option("dialogTrigger")),this._detachDragEventHandlers(this.option("dropZone")),this._files&&this._files.forEach(e=>{e.$file=null,e.$statusMessage=null}),super._clean()}abortUpload(e){if("useForm"!==this.option("uploadMode"))if(Object(n.d)(e)){var t=this._getFile(e);t&&this._preventFilesUploading([t])}else this._preventFilesUploading(this._files)}upload(e){if("useForm"!==this.option("uploadMode"))if(Object(n.d)(e)){var t=this._getFile(e);t&&di()&&this._uploadFile(t)}else this._uploadFiles()}_uploadFiles(){di()&&Object(Y.a)(this._files,(e,t)=>this._uploadFile(t))}_uploadFile(e){this._uploadStrategy.upload(e)}_updateProgressBar(e,t){e.progressBar&&e.progressBar.option({value:t.loaded,showStatus:!0}),this._progressAction({file:e.value,segmentSize:t.currentSegmentSize,bytesLoaded:t.loaded,bytesTotal:t.total,event:t.event,request:e.request})}_updateTotalProgress(e,t){var i=0;Object(n.d)(e)&&(this._files.length>0&&this._areAllFilesLoaded()&&0===e&&0===t?i=this._getProgressValue(1):e&&(i=this._getProgressValue(t/e))),this.option("progress",i),this._setLoadedSize(t)}_getProgressValue(e){return Math.floor(100*e)}_initStatusMessage(e){e.$statusMessage.css("display","none")}_ensureCancelButtonInitialized(e){if(!e.isInitialized){e.cancelButton.option("onClick",()=>{this._preventFilesUploading([e]),this._removeFile(e)});var t=()=>{setTimeout(()=>{e.cancelButton.option({visible:!1})},400)};e.onLoad.add(t),e.onError.add(t)}}_createProgressBar(e){return this._createComponent(Object(o.a)("<div>"),ht,{value:void 0,min:0,max:e,statusFormat:e=>this._getProgressValue(e)+"%",showStatus:!1,statusPosition:"right"})}_getTotalFilesSize(){return this._totalFilesSize||(this._totalFilesSize=0,Object(Y.a)(this._files,(e,t)=>{this._totalFilesSize+=t.value.size})),this._totalFilesSize}_getTotalLoadedFilesSize(){return this._totalLoadedFilesSize||(this._totalLoadedFilesSize=0,Object(Y.a)(this._files,(e,t)=>{this._totalLoadedFilesSize+=t.loadedSize})),this._totalLoadedFilesSize}_setLoadedSize(e){this._totalLoadedFilesSize=e}_recalculateProgress(){this._totalFilesSize=0,this._totalLoadedFilesSize=0,this._updateTotalProgress(this._getTotalFilesSize(),this._getTotalLoadedFilesSize())}isMouseOverElement(e,t,i){if(!t)return!1;var o=i?parseFloat(li.getComputedStyle(t,":before").height):0,a=i?parseFloat(li.getComputedStyle(t,":after").height):0,n=Object(Re.g)(t).left,s=Object(Re.g)(t).top+o,r=t.offsetWidth,l=t.offsetHeight-o-a,d=this._getEventX(e),c=this._getEventY(e);return d>=n&&d<n+r&&c>=s&&c<s+l}_getEventX(e){return Object(Ae.m)(e)?this._getTouchEventX(e):e.clientX+this._getDocumentScrollLeft()}_getEventY(e){return Object(Ae.m)(e)?this._getTouchEventY(e):e.clientY+this._getDocumentScrollTop()}_getTouchEventX(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageX:0}_getTouchEventY(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageY:0}_getDocumentScrollTop(){var e=m.default.getDocument();return e.documentElement.scrollTop||e.body.scrollTop}_getDocumentScrollLeft(){var e=m.default.getDocument();return e.documentElement.scrollLeft||e.body.scrollLeft}_updateReadOnlyState(){var e=this.option("readOnly");this._selectButton.option("disabled",e),this._files.forEach(t=>{var i;return null===(i=t.cancelButton)||void 0===i?void 0:i.option("disabled",e)}),this._updateInputLabelText(),this._attachDragEventHandlers(this._$inputWrapper)}_updateHoverState(){var e,t,i=this.option("hoverStateEnabled");null===(e=this._selectButton)||void 0===e||e.option("hoverStateEnabled",i),null===(t=this._uploadButton)||void 0===t||t.option("hoverStateEnabled",i),this._files.forEach(e=>{var t,o;null===(t=e.uploadButton)||void 0===t||t.option("hoverStateEnabled",i),null===(o=e.cancelButton)||void 0===o||o.option("hoverStateEnabled",i)})}_optionChanged(e){var{name:t,value:i,previousValue:o}=e;switch(t){case"height":case"width":this._updateFileNameMaxWidth(),super._optionChanged(e);break;case"value":!i.length&&this._$fileInput.val(""),this._preventRecreatingFiles||(this._createFiles(),this._renderFiles()),this._recalculateProgress(),super._optionChanged(e);break;case"name":this._initFileInput(),super._optionChanged(e);break;case"accept":this._initFileInput();break;case"multiple":this._initFileInput(),e.value||this.reset();break;case"readOnly":this._updateReadOnlyState(),super._optionChanged(e);break;case"disabled":this._updateInputLabelText(),super._optionChanged(e);break;case"selectButtonText":this._selectButton.option("text",i);break;case"uploadButtonText":this._uploadButton&&this._uploadButton.option("text",i);break;case"_uploadButtonType":this._uploadButton&&this._uploadButton.option("type",i);break;case"dialogTrigger":this._detachSelectFileDialogHandler(o),this._attachSelectFileDialogHandler(i);break;case"dropZone":this._detachDragEventHandlers(o),this._attachDragEventHandlers(i);break;case"maxFileSize":case"minFileSize":case"allowedFileExtensions":case"invalidFileExtensionMessage":case"invalidMaxFileSizeMessage":case"invalidMinFileSizeMessage":case"readyToUploadMessage":case"uploadedMessage":case"uploadFailedMessage":case"uploadAbortedMessage":this._invalidate();break;case"labelText":this._updateInputLabelText();break;case"showFileList":this._preventRecreatingFiles||this._renderFiles();break;case"uploadFile":case"uploadChunk":case"chunkSize":this._setUploadStrategy();break;case"abortUpload":case"uploadUrl":case"progress":case"uploadMethod":case"uploadHeaders":case"uploadCustomData":case"extendSelection":break;case"hoverStateEnabled":this._updateHoverState(),super._optionChanged(e);break;case"allowCanceling":case"uploadMode":this.reset(),this._invalidate();break;case"onBeforeSend":this._createBeforeSendAction();break;case"onUploadStarted":this._createUploadStartedAction();break;case"onUploaded":this._createUploadedAction();break;case"onFilesUploaded":this._createFilesUploadedAction();break;case"onProgress":this._createProgressAction();break;case"onUploadError":this._createUploadErrorAction();break;case"onUploadAborted":this._createUploadAbortedAction();break;case"onDropZoneEnter":this._createDropZoneEnterAction();break;case"onDropZoneLeave":this._createDropZoneLeaveAction();break;case"useNativeInputClick":this._renderInput();break;case"useDragOver":this._attachDragEventHandlers(this._$inputWrapper);break;case"nativeDropSupported":this._invalidate();break;case"inputAttr":this._applyInputAttributes(this.option(t));break;default:super._optionChanged(e)}}_resetInputValue(e){("useForm"!==this.option("uploadMode")||e)&&(this._doPreventInputChange=!0,this._$fileInput.val(""),this._doPreventInputChange=!1)}reset(){this.option("value",[])}}class hi{constructor(e,t){this.file=e,this.chunkSize=t,this.index=0}read(){if(!this.file)return null;var e=this.createBlobResult(this.file,this.index,this.chunkSize);return e.isCompleted&&(this.file=null),this.index++,e}createBlobResult(e,t,i){var o=t*i;return{blob:this.sliceFile(e,o,i),index:t,isCompleted:o+i>=e.size}}sliceFile(e,t,i){return e.slice?e.slice(t,t+i):e.webkitSlice?e.webkitSlice(t,t+i):null}}class ui{constructor(e){this.fileUploader=e}upload(e){e.isInitialized&&e.isAborted&&this.fileUploader._resetFileState(e),e.isValid()&&!e.uploadStarted&&(this._prepareFileBeforeUpload(e),this._uploadCore(e))}abortUpload(e){if(!(e._isError||e._isLoaded||e.isAborted)&&e.uploadStarted&&(e.isAborted=!0,e.request&&e.request.abort(),this._isCustomCallback("abortUpload"))){var t=this.fileUploader.option("abortUpload"),i=this._createUploadArgument(e),o=null;try{var a=t(e.value,i);o=Object(s.b)(a)}catch(e){o=(new s.a).reject(e).promise()}o.done(()=>e.onAbort.fire()).fail(t=>this._handleFileError(e,t))}}_beforeSend(e,t){var i=this._createUploadArgument(t);this.fileUploader._beforeSendAction({request:e,file:t.value,uploadInfo:i}),t.request=e}_createUploadArgument(e){}_uploadCore(e){}_isCustomCallback(e){var t=this.fileUploader.option(e);return t&&Object(n.h)(t)}_handleProgress(e,t){e._isError||(e._isProgressStarted=!0,this._handleProgressCore(e,t))}_handleProgressCore(e,t){}_handleFileError(e,t){e._isError=!0,e.onError.fire(t)}_prepareFileBeforeUpload(e){var t;e.$file&&(null===(t=e.progressBar)||void 0===t||t.dispose(),this.fileUploader._createFileProgressBar(e));e.isInitialized||(e.onLoadStart.add(this._onUploadStarted.bind(this,e)),e.onLoad.add(this._onLoadedHandler.bind(this,e)),e.onError.add(this._onErrorHandler.bind(this,e)),e.onAbort.add(this._onAbortHandler.bind(this,e)),e.onProgress.add(this._onProgressHandler.bind(this,e)),e.isInitialized=!0)}_shouldHandleError(e,t){return(this._isStatusError(t.status)||!e._isProgressStarted)&&!e.isAborted}_isStatusError(e){return 400<=e&&e<500||500<=e&&e<600}_onUploadStarted(e,t){e.uploadStarted=!0,this.fileUploader._uploadStartedAction({file:e.value,event:t,request:e.request})}_onAbortHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader._getUploadAbortedStatusMessage()};this.fileUploader._uploadAbortedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onErrorHandler(e,t){var i={file:e.value,event:void 0,request:e.request,error:t,message:this.fileUploader.option("uploadFailedMessage")};this.fileUploader._uploadErrorAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onLoadedHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader.option("uploadedMessage")};e._isLoaded=!0,this.fileUploader._uploadedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onProgressHandler(e,t){if(e){var i=this.fileUploader._getTotalFilesSize(),o=this.fileUploader._getTotalLoadedFilesSize(),a=Math.min(t.loaded,e.value.size),n=a-e.loadedSize;e.loadedSize=a,this.fileUploader._updateTotalProgress(i,o+n),this.fileUploader._updateProgressBar(e,this._getLoadedData(a,t.total,n,t))}}_getLoadedData(e,t,i,o){return{loaded:e,total:t,currentSegmentSize:i}}_extendFormData(e){var t=this.fileUploader.option("uploadCustomData");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&Object(n.d)(t[i])&&e.append(i,t[i])}}class pi extends ui{constructor(e){super(e),this.chunkSize=this.fileUploader.option("chunkSize")}_uploadCore(e){var t=e.value,i={name:t.name,loadedBytes:0,type:t.type,blobReader:new hi(t,this.chunkSize),guid:new V.a,fileSize:t.size,count:this._getFileChunksCount(t),customData:{}};e.chunksData=i,this._sendChunk(e,i)}_getFileChunksCount(e){return 0===e.size?1:Math.ceil(e.size/this.chunkSize)}_sendChunk(e,t){var i=t.blobReader.read();t.currentChunk=i,i&&this._sendChunkCore(e,t,i).done(()=>{e.isAborted||(t.loadedBytes+=i.blob.size,e.onProgress.fire({loaded:t.loadedBytes,total:e.value.size}),i.isCompleted&&e.onLoad.fire(),setTimeout(()=>this._sendChunk(e,t)))}).fail(t=>{this._shouldHandleError(e,t)&&this._handleFileError(e,t)})}_sendChunkCore(e,t,i){}_tryRaiseStartLoad(e){e.isStartLoad||(e.isStartLoad=!0,e.onLoadStart.fire())}_getEvent(e){return null}_createUploadArgument(e){return this._createChunksInfo(e.chunksData)}_createChunksInfo(e){return{bytesUploaded:e.loadedBytes,chunkCount:e.count,customData:e.customData,chunkBlob:e.currentChunk.blob,chunkIndex:e.currentChunk.index}}}class mi extends pi{_sendChunkCore(e,t,i){return X.a.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:t=>this._beforeSend(t,e),upload:{onprogress:t=>this._handleProgress(e,t),onloadstart:()=>this._tryRaiseStartLoad(e),onabort:()=>e.onAbort.fire()},data:this._createFormData({fileName:t.name,blobName:this.fileUploader.option("name"),blob:i.blob,index:i.index,count:t.count,type:t.type,guid:t.guid,size:t.fileSize})})}_createFormData(e){var t=new li.FormData;return t.append(e.blobName,e.blob),t.append("chunkMetadata",JSON.stringify({FileName:e.fileName,Index:e.index,TotalCount:e.count,FileSize:e.size,FileType:e.type,FileGuid:e.guid})),this._extendFormData(t),t}}class _i extends pi{_sendChunkCore(e,t){this._tryRaiseStartLoad(e);var i=this._createChunksInfo(t),o=this.fileUploader.option("uploadChunk");try{var a=o(e.value,i);return Object(s.b)(a)}catch(e){return(new s.a).reject(e).promise()}}_shouldHandleError(e,t){return!0}}class gi extends ui{_uploadCore(e){e.loadedSize=0,this._uploadFile(e).done(()=>{e.isAborted||e.onLoad.fire()}).fail(t=>{this._shouldHandleError(e,t)&&this._handleFileError(e,t)})}_uploadFile(e){}_handleProgressCore(e,t){e.onProgress.fire(t)}_getLoadedData(e,t,i,o){var a=super._getLoadedData(e,t,i,o);return a.event=o,a}}class fi extends gi{_uploadFile(e){return X.a.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:t=>this._beforeSend(t,e),upload:{onprogress:t=>this._handleProgress(e,t),onloadstart:()=>e.onLoadStart.fire(),onabort:()=>e.onAbort.fire()},data:this._createFormData(this.fileUploader.option("name"),e.value)})}_createFormData(e,t){var i=new li.FormData;return i.append(e,t,t.name),this._extendFormData(i),i}}class Ii extends gi{_uploadFile(e){e.onLoadStart.fire();var t=this.fileUploader.option("uploadFile");try{var i=t(e.value,t=>{var i={loaded:t,total:e.value.size};this._handleProgress(e,i)});return Object(s.b)(i)}catch(e){return(new s.a).reject(e).promise()}}_shouldHandleError(e,t){return!0}}Object(d.a)("dxFileUploader",ci);var vi=ci;class Ci extends c.a{_initMarkup(){this._initActions(),this.$element().addClass("dx-filemanager-fileuploader"),this._uploaderInfos=[],this._createInternalFileUploader(),this._createDropZonePlaceholder(),this._setDropZonePlaceholderVisible(!1),super._initMarkup()}_createInternalFileUploader(){var e=this._getController().chunkSize,t=Object(o.a)("<div>").appendTo(this.$element()),i=this._createComponent(t,vi,{name:"file",multiple:!0,showFileList:!1,activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,labelText:"",readyToUploadMessage:"",accept:"*",chunkSize:e,dropZone:this.option("dropZone"),onValueChanged:e=>this._onFileUploaderValueChanged(e),onProgress:e=>this._onFileUploaderProgress(e),onUploaded:e=>this._onFileUploaderUploaded(e),onFilesUploaded:e=>this._onFileUploaderAllFilesUploaded(e),onUploadAborted:e=>this._onFileUploaderUploadAborted(e),onUploadError:e=>this._onFileUploaderUploadError(e),onDropZoneEnter:()=>this._setDropZonePlaceholderVisible(!0),onDropZoneLeave:()=>this._setDropZonePlaceholderVisible(!1)});i.option({uploadChunk:(e,t)=>this._fileUploaderUploadChunk(i,e,t),abortUpload:(e,t)=>this._fileUploaderAbortUpload(i,e,t)}),i._shouldRaiseDragLeaveBase=i._shouldRaiseDragLeave,i._shouldRaiseDragLeave=e=>this._shouldRaiseDragLeave(e,i);var a={fileUploader:i};this._uploaderInfos.push(a)}tryUpload(){var e=this._findAndUpdateAvailableUploaderInfo();e&&e.fileUploader._selectButtonClickHandler()}cancelUpload(e){this._cancelUpload(e)}cancelFileUpload(e,t){this._cancelUpload(e,t)}_cancelUpload(e,t){var{fileUploader:i}=this._findUploaderInfoBySessionId(e);i.abortUpload(t)}_fileUploaderUploadChunk(e,t,i){var{session:o,fileIndex:a}=this._findSessionByFile(e,t),n=o.controller;return i.fileIndex=a,n.uploadFileChunk(t,i)}_fileUploaderAbortUpload(e,t,i){var{session:o,fileIndex:a}=this._findSessionByFile(e,t),n=o.controller;return i.fileIndex=a,n.abortFileUpload(t,i)}_onFileUploaderValueChanged(e){var{component:t,value:i}=e;if(0!==i.length){var o=i.slice(),a=this._findUploaderInfo(t);this._uploadFiles(a,o),setTimeout(()=>{this._findAndUpdateAvailableUploaderInfo()||this._createInternalFileUploader()})}}_onFileUploaderProgress(e){var{component:t,file:i,bytesLoaded:o,bytesTotal:a}=e,{session:n,fileIndex:s}=this._findSessionByFile(t,i),r=0!==a?o/a:1,l=t.option("progress")/100,d={sessionId:n.id,fileIndex:s,commonValue:l,fileValue:r};this._raiseUploadProgress(d)}_onFileUploaderAllFilesUploaded(e){var{component:t}=e,{session:i}=this._findSessionByFile(t,t._files[0].value);this._raiseUploadFinished({sessionId:i.id,commonValue:t.option("progress")/100})}_onFileUploaderUploaded(e){var{component:t,file:i}=e;this._getDeferredForFile(t,i).resolve()}_onFileUploaderUploadAborted(e){var{component:t,file:i}=e;this._getDeferredForFile(t,i).resolve({canceled:!0})}_onFileUploaderUploadError(e){var{component:t,file:i,error:o}=e;this._getDeferredForFile(t,i).reject(o)}_createDropZonePlaceholder(){this._$dropZonePlaceholder=Object(o.a)("<div>").addClass("dx-filemanager-fileuploader-dropzone-placeholder").appendTo(this.option("dropZonePlaceholderContainer"))}_adjustDropZonePlaceholder(){var e=this.option("dropZone");if(Object(p.f)()&&0!==e.length){var t=parseFloat(this._$dropZonePlaceholder.css("borderTopWidth")),i=parseFloat(this._$dropZonePlaceholder.css("borderLeftWidth")),o=this.option("dropZonePlaceholderContainer"),a=parseFloat(o.css("borderBottomWidth")),n=parseFloat(o.css("borderLeftWidth")),s=Object(Re.e)(o),r=o.offset(),l=e.offset();this._$dropZonePlaceholder.css({top:l.top-r.top-s-a,left:l.left-r.left-n}),Object(Re.o)(this._$dropZonePlaceholder,e.get(0).offsetHeight-2*t),Object(Re.r)(this._$dropZonePlaceholder,e.get(0).offsetWidth-2*i)}}_setDropZonePlaceholderVisible(e){e?(this._adjustDropZonePlaceholder(),this._$dropZonePlaceholder.css("display","")):this._$dropZonePlaceholder.css("display","none")}_shouldRaiseDragLeave(e,t){return t.isMouseOverElement(e,this.option("splitterElement"))||t._shouldRaiseDragLeaveBase(e,!0)}_uploadFiles(e,t){this._setDropZonePlaceholderVisible(!1);var i=(new V.a).toString(),o=this._getController(),a=t.map(()=>new s.a),n={id:i,controller:o,files:t,deferreds:a};e.session=n;var r={sessionId:i,deferreds:a,files:t};return this._raiseUploadSessionStarted(r),A(a).always(()=>setTimeout(()=>{e.fileUploader.reset(),e.session=null}))}_getDeferredForFile(e,t){var{session:i,fileIndex:o}=this._findSessionByFile(e,t);return i.deferreds[o]}_findSessionByFile(e,t){var i=this._findUploaderInfo(e).session,o=i.files.indexOf(t);return{session:i,fileIndex:o}}_findUploaderInfoBySessionId(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t],o=i.session;if(o&&o.id===e)return i}return null}_findAndUpdateAvailableUploaderInfo(){for(var e,t=null,i=0;i<this._uploaderInfos.length;i++){var o=this._uploaderInfos[i];o.fileUploader.option("dropZone",""),t||o.session||(t=o)}return null===(e=t)||void 0===e||e.fileUploader.option("dropZone",this.option("dropZone")),t}_findUploaderInfo(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t];if(i.fileUploader===e)return i}return null}_getController(){return this.option("getController")()}_raiseUploadSessionStarted(e){this._actions.onUploadSessionStarted({sessionInfo:e})}_raiseUploadProgress(e){this._actions.onUploadProgress(e)}_raiseUploadFinished(e){this._actions.onUploadFinished(e)}_initActions(){this._actions={onUploadSessionStarted:this._createActionByOption("onUploadSessionStarted"),onUploadProgress:this._createActionByOption("onUploadProgress"),onUploadFinished:this._createActionByOption("onUploadFinished")}}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{getController:null,onUploadSessionStarted:null,onUploadProgress:null,onUploadFinished:null,splitterElement:null})}_optionChanged(e){var t=e.name;switch(t){case"getController":this.repaint();break;case"onUploadSessionStarted":case"onUploadProgress":case"onUploadFinished":this._actions[t]=this._createActionByOption(t);break;case"dropZone":this._findAndUpdateAvailableUploaderInfo(),this._adjustDropZonePlaceholder();break;case"dropZonePlaceholderContainer":this._$dropZonePlaceholder.detach(),this._$dropZonePlaceholder.appendTo(e.value);break;case"splitterElement":break;default:super._optionChanged(e)}}}var bi=Ci,yi=(e,t)=>{switch(e){case W.NoAccess:return l.a.format("dxFileManager-errorNoAccess");case W.FileExists:return l.a.format("dxFileManager-errorFileExistsFormat",t);case W.FileNotFound:return l.a.format("dxFileManager-errorFileNotFoundFormat",t);case W.DirectoryExists:return l.a.format("dxFileManager-errorDirectoryExistsFormat",t);case W.DirectoryNotFound:return l.a.format("dxFileManager-errorDirectoryNotFoundFormat",t);case W.WrongFileExtension:return l.a.format("dxFileManager-errorWrongFileExtension");case W.MaxFileSizeExceeded:return l.a.format("dxFileManager-errorMaxFileSizeExceeded");case W.InvalidSymbols:return l.a.format("dxFileManager-errorInvalidSymbols")}return l.a.format("dxFileManager-errorDefault")};class xi extends c.a{_initMarkup(){super._initMarkup(),this._initActions(),this._controller=this.option("controller"),this._controller.on("EditActionStarting",this._onEditActionStarting.bind(this)),this._controller.on("EditActionResultAcquired",this._onEditActionResultAcquired.bind(this)),this._controller.on("EditActionItemError",this._onEditActionItemError.bind(this)),this._controller.on("EditActionError",this._onEditActionError.bind(this)),this._controller.on("CompleteEditActionItem",this._onCompleteEditActionItem.bind(this)),this._controller.on("CompleteEditAction",this._onCompleteEditAction.bind(this)),this._model=this.option("model"),this._uploadOperationInfoMap={},this._dialogManager=new ni(this.$element(),{chooseDirectoryDialog:{provider:this._controller._fileProvider,getDirectories:this._controller.getDirectories.bind(this._controller),getCurrentDirectory:this._controller.getCurrentDirectory.bind(this._controller)},rtlEnabled:this.option("rtlEnabled"),onDialogClosed:this._onDialogClosed.bind(this)}),this._fileUploader=this._createFileUploader();var e=this.option("notificationControl");e&&this._initNotificationControl(e),this._createMetadataMap()}_initNotificationControl(e){this._notificationControl=e,this._notificationControl.option({onOperationCanceled:e=>{var{info:t}=e;return this._onCancelUploadSession(t)},onOperationItemCanceled:e=>{var{item:t,itemIndex:i}=e;return this._onCancelFileUpload(t,i)}})}_getFileUploaderComponent(){return bi}_createFileUploader(){var e=Object(o.a)("<div>").appendTo(this.$element());return this._createComponent(e,this._getFileUploaderComponent(),{getController:this._getFileUploaderController.bind(this),dropZonePlaceholderContainer:this.option("uploadDropZonePlaceholderContainer"),onUploadSessionStarted:e=>this._onUploadSessionStarted(e),onUploadProgress:e=>this._onUploadProgress(e),onUploadFinished:e=>this._onUploadFinished(e)})}setUploaderDropZone(e){this._fileUploader.option("dropZone",e)}setUploaderSplitterElement(e){this._fileUploader.option("splitterElement",e)}_getFileUploaderController(){var e=this.uploadDirectoryInfo.fileItem;return{chunkSize:this._controller.getFileUploadChunkSize(),uploadFileChunk:(t,i)=>this._controller.uploadFileChunk(t,i,e),abortFileUpload:(t,i)=>this._controller.abortFileUpload(t,i,e)}}_createMetadataMap(){this._metadataMap={create:{action:e=>this._tryCreate(e),affectsAllItems:!0,singleItemProcessingMessage:l.a.format("dxFileManager-editingCreateSingleItemProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingCreateSingleItemSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingCreateSingleItemErrorMessage"),commonErrorMessage:l.a.format("dxFileManager-editingCreateCommonErrorMessage")},rename:{action:e=>this._tryRename(e),singleItemProcessingMessage:l.a.format("dxFileManager-editingRenameSingleItemProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingRenameSingleItemSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingRenameSingleItemErrorMessage"),commonErrorMessage:l.a.format("dxFileManager-editingRenameCommonErrorMessage")},delete:{action:e=>this._tryDelete(e),singleItemProcessingMessage:l.a.format("dxFileManager-editingDeleteSingleItemProcessingMessage"),multipleItemsProcessingMessage:l.a.format("dxFileManager-editingDeleteMultipleItemsProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingDeleteSingleItemSuccessMessage"),multipleItemsSuccessMessage:l.a.format("dxFileManager-editingDeleteMultipleItemsSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingDeleteSingleItemErrorMessage"),multipleItemsErrorMessage:l.a.format("dxFileManager-editingDeleteMultipleItemsErrorMessage"),commonErrorMessage:l.a.format("dxFileManager-editingDeleteCommonErrorMessage")},move:{action:e=>this._tryMove(e),singleItemProcessingMessage:l.a.format("dxFileManager-editingMoveSingleItemProcessingMessage"),multipleItemsProcessingMessage:l.a.format("dxFileManager-editingMoveMultipleItemsProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingMoveSingleItemSuccessMessage"),multipleItemsSuccessMessage:l.a.format("dxFileManager-editingMoveMultipleItemsSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingMoveSingleItemErrorMessage"),multipleItemsErrorMessage:l.a.format("dxFileManager-editingMoveMultipleItemsErrorMessage"),commonErrorMessage:l.a.format("dxFileManager-editingMoveCommonErrorMessage")},copy:{action:e=>this._tryCopy(e),singleItemProcessingMessage:l.a.format("dxFileManager-editingCopySingleItemProcessingMessage"),multipleItemsProcessingMessage:l.a.format("dxFileManager-editingCopyMultipleItemsProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingCopySingleItemSuccessMessage"),multipleItemsSuccessMessage:l.a.format("dxFileManager-editingCopyMultipleItemsSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingCopySingleItemErrorMessage"),multipleItemsErrorMessage:l.a.format("dxFileManager-editingCopyMultipleItemsErrorMessage"),commonErrorMessage:l.a.format("dxFileManager-editingCopyCommonErrorMessage")},upload:{action:e=>this._tryUpload(e),allowCancel:!0,allowItemProgress:!0,singleItemProcessingMessage:l.a.format("dxFileManager-editingUploadSingleItemProcessingMessage"),multipleItemsProcessingMessage:l.a.format("dxFileManager-editingUploadMultipleItemsProcessingMessage"),singleItemSuccessMessage:l.a.format("dxFileManager-editingUploadSingleItemSuccessMessage"),multipleItemsSuccessMessage:l.a.format("dxFileManager-editingUploadMultipleItemsSuccessMessage"),singleItemErrorMessage:l.a.format("dxFileManager-editingUploadSingleItemErrorMessage"),multipleItemsErrorMessage:l.a.format("dxFileManager-editingUploadMultipleItemsErrorMessage"),canceledMessage:l.a.format("dxFileManager-editingUploadCanceledMessage")},download:{action:e=>this._download(e),singleItemProcessingMessage:"",multipleItemsProcessingMessage:"",singleItemErrorMessage:l.a.format("dxFileManager-editingDownloadSingleItemErrorMessage"),multipleItemsErrorMessage:l.a.format("dxFileManager-editingDownloadMultipleItemsErrorMessage")},getItemContent:{action:e=>this._getItemContent(e)},getItems:{singleItemProcessingMessage:"",singleItemErrorMessage:l.a.format("dxFileManager-errorDirectoryOpenFailed"),commonErrorMessage:l.a.format("dxFileManager-errorDirectoryOpenFailed")}}}getCommandActions(){var e={};return Object(Y.a)(this._metadataMap,t=>{Object.prototype.hasOwnProperty.call(this._metadataMap,t)&&(e[t]=e=>this._executeAction(t,e))}),e}_executeAction(e,t){var i=this._metadataMap[e];return i?i.action(t):null}_onCancelUploadSession(e){this._fileUploader.cancelUpload(e.uploadSessionId)}_onCancelFileUpload(e,t){this._fileUploader.cancelFileUpload(e.info.uploadSessionId,t)}_onUploadProgress(e){var{sessionId:t,fileIndex:i,commonValue:o,fileValue:a}=e,{operationInfo:n}=this._uploadOperationInfoMap[t];this._notificationControl.updateOperationItemProgress(n,i,100*a,100*o)}_onUploadFinished(e){var{sessionId:t,commonValue:i}=e,{operationInfo:o}=this._uploadOperationInfoMap[t];this._notificationControl.finishOperation(o,100*i),this._scheduleUploadSessionDisposal(t,"uploader")}_onUploadSessionStarted(e){var{sessionInfo:t}=e;this._controller.processUploadSession(t,this.uploadDirectoryInfo)}_onEditActionStarting(e){var t=this._metadataMap[e.name],i=new Di(t,e.itemInfos,e.directory),o=this._notificationControl.addOperation(i.processingMessage,t.allowCancel,!t.allowItemProgress);switch(Object(a.a)(e.customData,{context:i,operationInfo:o}),e.name){case"upload":var n=e.customData.sessionInfo.sessionId;o.uploadSessionId=n,this._uploadOperationInfoMap[n]={operationInfo:o};break;case"rename":e.customData.context.itemNewName=e.customData.itemNewName}}_onEditActionResultAcquired(e){var{context:t,operationInfo:i}=e.customData;t.singleRequest=e.singleRequest;var o=t.itemInfos.map(e=>this._getItemProgressDisplayInfo(e));this._notificationControl.addOperationDetails(i,o,t.actionMetadata.allowCancel)}_onEditActionError(e,t){var{context:i,operationInfo:o}=e.customData;i.singleRequest=e.singleRequest,this._handleActionError(o,i,t),this._completeAction(o,i)}_onEditActionItemError(e,t){var{context:i,operationInfo:o}=e.customData;this._handleActionError(o,i,t)}_onCompleteEditActionItem(e,t){var{context:i,operationInfo:o}=e.customData;t.result&&t.result.canceled||(i.completeOperationItem(t.index),this._notificationControl.completeOperationItem(o,t.index,i.commonProgress))}_onCompleteEditAction(e){var{context:t,operationInfo:i}=e.customData;this._completeAction(i,t),"upload"===e.name&&this._scheduleUploadSessionDisposal(e.customData.sessionInfo.sessionId,"controller")}_scheduleUploadSessionDisposal(e,t){Object(n.d)(this._uploadOperationInfoMap[e].requester)&&this._uploadOperationInfoMap[e].requester!==t?delete this._uploadOperationInfoMap[e]:this._uploadOperationInfoMap[e].requester=t}_tryCreate(e){var t=e&&e[0]||this._getCurrentDirectory(),i=l.a.format("dxFileManager-newDirectoryName");return this._showDialog(this._dialogManager.getCreateItemDialog(),i).then(e=>{var{name:i}=e;return this._controller.createDirectory(t,i)})}_tryRename(e){var t=e&&e[0]||this._model.getMultipleSelectedItems()[0];return t?this._showDialog(this._dialogManager.getRenameItemDialog(),t.fileItem.name).then(e=>{var{name:i}=e;return this._controller.renameItem(t,i)}):(new s.a).reject().promise()}_tryDelete(e){if(0===(e=e||this._model.getMultipleSelectedItems()).length)return(new s.a).reject().promise();var t=e[0].fileItem.name,i=e.length;return this._showDialog(this._dialogManager.getDeleteItemDialog(),{itemName:t,itemCount:i}).then(()=>this._controller.deleteItems(e))}_tryMove(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new s.a).reject().promise():this._showDialog(this._dialogManager.getMoveDialog(e)).then(t=>{var{folder:i}=t;return this._controller.moveItems(e,i)})}_tryCopy(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new s.a).reject().promise():this._showDialog(this._dialogManager.getCopyDialog(e)).then(t=>{var{folder:i}=t;return this._controller.copyItems(e,i)})}_tryUpload(e){this._uploadDirectoryInfo=null==e?void 0:e[0],this._fileUploader.tryUpload()}_download(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new s.a).reject().promise():this._controller.downloadItems(e)}_getItemContent(e){return e=e||this._model.getMultipleSelectedItems(),this._controller.getItemContent(e)}_completeAction(e,t){this._notificationControl.completeOperation(e,t.completionMessage,!t.success,t.statusText),t.hasModifiedItems()&&this._raiseOnSuccess(t.onlyFiles)}_handleActionError(e,t,i){e.hasError=!0,t.singleRequest?this._handleSingleRequestActionError(e,t,i):this._handleMultipleRequestActionError(e,t,i)}_handleSingleRequestActionError(e,t,i){var o=t.getItemForSingleRequestError(),a=t.getItemName(i.errorCode),n=this._getErrorText(i,o,a);t.processSingleRequestError(n);var s=this._getOperationErrorInfo(t);this._notificationControl.completeSingleOperationWithError(e,s),t.multipleItems&&this._raiseOnSuccess(t.onlyFiles)}_handleMultipleRequestActionError(e,t,i){var o=t.getItemForMultipleRequestError(i.index),a=t.getItemName(i.errorCode,i.index),n=this._getErrorText(i,o,a);t.processMultipleRequestError(i.index,n);var s=this._getOperationErrorInfo(t);this._notificationControl.addOperationDetailsError(e,s)}_getOperationErrorInfo(e){var t=e.errorState.currentDetailError;return{commonErrorText:e.errorState.commonErrorText,item:t.itemInfo?this._getItemProgressDisplayInfo(t.itemInfo):null,itemIndex:t.itemIndex,detailErrorText:t.errorText}}_getErrorText(e,t,i){var o=e.errorText||yi(e.errorCode,i),a={fileSystemItem:null==t?void 0:t.fileItem,errorCode:e.errorCode,errorText:o};return this._raiseOnError(a),a.errorText}_getItemProgressDisplayInfo(e){return{commonText:e.fileItem.name,imageUrl:this._getItemThumbnail(e)}}_showDialog(e,t){return this._dialogDeferred=new s.a,e.show(t),this._dialogDeferred.promise()}_onDialogClosed(e){var t=e.dialogResult;t?this._dialogDeferred.resolve(t):this._dialogDeferred.reject()}updateDialogRtl(e){this._dialogManager.updateDialogRtl(e)}_getItemThumbnail(e){var t=this.option("getItemThumbnail");if(!t)return null;var i=t(e);return i?i.thumbnail:null}_initActions(){this._actions={onSuccess:this._createActionByOption("onSuccess"),onError:this._createActionByOption("onError")}}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{model:{getMultipleSelectedItems:null},notificationControl:null,getItemThumbnail:null,onSuccess:null,onError:null})}_optionChanged(e){var t=e.name;switch(t){case"model":this.repaint();break;case"notificationControl":this._initNotificationControl(e.value);break;case"getItemThumbnail":break;case"uploadDropZonePlaceholderContainer":this._fileUploader.option("dropZonePlaceholderContainer",e.value);break;case"onSuccess":case"onError":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_raiseOnSuccess(e){this._actions.onSuccess({updatedOnlyFiles:e})}_raiseOnError(e){this._actions.onError(e)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}get uploadDirectoryInfo(){return this._uploadDirectoryInfo||this._getCurrentDirectory()}}class Di{constructor(e,t,i){this._actionMetadata=e,this._itemInfos=t,this._onlyFiles=!this._actionMetadata.affectsAllItems&&this._itemInfos.every(e=>!e.fileItem.isDirectory),this._items=this._itemInfos.map(e=>e.fileItem),this._multipleItems=this._items.length>1,this._location=i.getDisplayName(),this._singleRequest=!0,this._completedItems=[],this._commonProgress=0,this._errorState={failedCount:0},this._itemNewName=""}completeOperationItem(e){if(this._singleRequest)this._completedItems=[...this._items];else{var t=this._items[e];this._completedItems.push(t)}this._actionMetadata.allowItemProgress||(this._commonProgress=this._completedItems.length/this._items.length*100)}processSingleRequestError(e){this._errorState.failedCount=1,this._errorState.commonErrorText=this._multipleItems?this._actionMetadata.commonErrorMessage:this._actionMetadata.singleItemErrorMessage;var t=this._multipleItems?-1:1,i=this.getItemForSingleRequestError();this._setCurrentDetailError(t,i,e)}processMultipleRequestError(e,t){this._errorState.failedCount++,this._errorState.commonErrorText=this._errorState.failedCount>1?Object(Yt.b)(this._actionMetadata.multipleItemsErrorMessage,this._errorState.failedCount):this._actionMetadata.singleItemErrorMessage;var i=this.getItemForMultipleRequestError(e);this._setCurrentDetailError(e,i,t)}hasModifiedItems(){return this._hasCompletedItems()||this._singleRequest&&!this.success&&this._multipleItems}getItemForSingleRequestError(){return this._multipleItems?null:this._itemInfos[0]}getItemForMultipleRequestError(e){return this._itemInfos[e]}getItemName(e,t){var i=this.singleRequest?this.getItemForSingleRequestError():this.getItemForMultipleRequestError(t),o=null==i?void 0:i.fileItem.name;return this.itemNewName&&this._isItemExistsErrorCode(e)&&(o=this.itemNewName),o}_isItemExistsErrorCode(e){return e===W.DirectoryExists||e===W.FileExists}_setCurrentDetailError(e,t,i){this._errorState.currentDetailError={itemIndex:e,itemInfo:t,errorText:i}}_hasCompletedItems(){return this._completedItems.length>0}get actionMetadata(){return this._actionMetadata}get itemInfos(){return this._itemInfos}get itemNewName(){return this._itemNewName}set itemNewName(e){this._itemNewName=e}get errorState(){return this._errorState}get singleRequest(){return this._singleRequest}set singleRequest(e){this._singleRequest=e}get multipleItems(){return this._multipleItems}get onlyFiles(){return this._onlyFiles}get processingMessage(){return this._multipleItems?Object(Yt.b)(this._actionMetadata.multipleItemsProcessingMessage,this._items.length,this._location):Object(Yt.b)(this._actionMetadata.singleItemProcessingMessage,this._location)}get successMessage(){return this._hasCompletedItems()?this._multipleItems?Object(Yt.b)(this._actionMetadata.multipleItemsSuccessMessage,this._completedItems.length,this._location):Object(Yt.b)(this._actionMetadata.singleItemSuccessMessage,this._location):this._multipleItems?Object(Yt.b)(this._actionMetadata.multipleItemsErrorMessage,this._items.length):this._actionMetadata.singleItemErrorMessage}get completionMessage(){return this.success?this.successMessage:this.errorState.commonErrorText}get statusText(){return this.success&&!this._hasCompletedItems()?this._actionMetadata.canceledMessage:void 0}get commonProgress(){return this._commonProgress}get success(){return!this._errorState.failedCount}}var Si=xi,Oi=i("R7+b");class Mi extends c.a{_init(){super._init(),this._currentDirectory=null}_initMarkup(){super._initMarkup(),this._initActions(),this._currentDirectory&&this._renderMenu(),this.$element().addClass("dx-filemanager-breadcrumbs")}setCurrentDirectory(e){this._areDirsEqual(this._currentDirectory,e)||(this._currentDirectory=e,this.repaint())}_renderMenu(){var e=Object(o.a)("<div>").appendTo(this.$element());this._menu=this._createComponent(e,Oi.a,{dataSource:this._getMenuItems(),onItemClick:this._onItemClick.bind(this),onItemRendered:this._onItemRendered.bind(this)})}_getMenuItems(){var e=this._getParentDirsLine(),t=[{icon:"arrowup",directory:this._currentDirectory.parentDirectory,isPathItem:!0,cssClass:"dx-filemanager-breadcrumbs-parent-folder-item"},{text:"",cssClass:"dx-filemanager-breadcrumbs-separator-item"}];return e.forEach((i,o)=>{t.push({text:i.getDisplayName(),directory:i,isPathItem:!0}),o!==e.length-1&&t.push({icon:"spinnext",cssClass:"dx-filemanager-breadcrumbs-path-separator-item"})}),t}_onItemClick(e){var{itemData:t}=e;if(t.isPathItem){var i=t.directory;this._areDirsEqual(i,this._currentDirectory)||this._raiseCurrentDirectoryChanged(i)}}_onItemRendered(e){var{itemElement:t,itemData:i}=e;i.cssClass&&Object(o.a)(t).addClass(i.cssClass)}_getParentDirsLine(){for(var e=this._currentDirectory,t=[];e;)t.unshift(e),e=e.parentDirectory;return t}_areDirsEqual(e,t){return e&&t&&e===t&&e.fileItem.key===t.fileItem.key}_initActions(){this._actions={onCurrentDirectoryChanging:this._createActionByOption("onCurrentDirectoryChanging")}}_raiseCurrentDirectoryChanged(e){this._actions.onCurrentDirectoryChanging({currentDirectory:e})}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{rootFolderDisplayName:"Files",onCurrentDirectoryChanging:null})}_optionChanged(e){var t=e.name;switch(t){case"rootFolderDisplayName":this.repaint();break;case"onCurrentDirectoryChanging":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}}var Fi=Mi,wi=Object(p.d)(),Ei="".concat("dx-splitter","-wrapper"),Pi="".concat("dx-splitter","-inactive"),Ai="".concat("dx-splitter","-border"),Ti="".concat("dx-splitter","-initial");class ji extends c.a{_init(){super._init();var e=(new V.a).toString();this.SPLITTER_POINTER_DOWN_EVENT_NAME=Object(Ae.a)(I.a.down,"dxSplitterResizing"+e),this.SPLITTER_POINTER_MOVE_EVENT_NAME=Object(Ae.a)(I.a.move,"dxSplitterResizing"+e),this.SPLITTER_POINTER_UP_EVENT_NAME=Object(Ae.a)(I.a.up,"dxSplitterResizing"+e)}_initMarkup(){super._initMarkup(),this._initActions(),this._$container=this.option("container"),this._$leftElement=this.option("leftElement"),this._$rightElement=this.option("rightElement"),this.$element().addClass(Ei).addClass(Ti),this._$splitterBorder=Object(o.a)("<div>").addClass(Ai).appendTo(this.$element()),this._$splitter=Object(o.a)("<div>").addClass("dx-splitter").addClass(Pi).appendTo(this._$splitterBorder)}_initActions(){this._actions={onApplyPanelSize:this._createActionByOption("onApplyPanelSize"),onActiveStateChanged:this._createActionByOption("onActiveStateChanged")}}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_attachEventHandlers(){var e=m.default.getDocument();_.a.on(this._$splitterBorder,this.SPLITTER_POINTER_DOWN_EVENT_NAME,this._onMouseDownHandler.bind(this)),_.a.on(e,this.SPLITTER_POINTER_MOVE_EVENT_NAME,this._onMouseMoveHandler.bind(this)),_.a.on(e,this.SPLITTER_POINTER_UP_EVENT_NAME,this._onMouseUpHandler.bind(this))}_detachEventHandlers(){var e=m.default.getDocument();_.a.off(this._$splitterBorder,this.SPLITTER_POINTER_DOWN_EVENT_NAME),_.a.off(e,this.SPLITTER_POINTER_MOVE_EVENT_NAME),_.a.off(e,this.SPLITTER_POINTER_UP_EVENT_NAME)}_dimensionChanged(e){e&&"height"===e||(this._containerWidth=this._$container.get(0).clientWidth,this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_onMouseDownHandler(e){e.preventDefault(),this._offsetX=e.pageX-this._$splitterBorder.offset().left<=this._getSplitterBorderWidth()?e.pageX-this._$splitterBorder.offset().left:0,this._containerWidth=this._$container.get(0).clientWidth,this.$element().removeClass(Ti),this._toggleActive(!0),this._setSplitterPositionLeft({needUpdatePanels:!0})}_onMouseMoveHandler(e){this._isSplitterActive&&this._setSplitterPositionLeft({splitterPositionLeft:this._getNewSplitterPositionLeft(e),needUpdatePanels:!0})}_onMouseUpHandler(){this._isSplitterActive&&(this._leftPanelPercentageWidth=null,this._toggleActive(!1),this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_getNewSplitterPositionLeft(e){var t=e.pageX-this._getContainerLeftOffset()-this._offsetX;return t=Math.max(0-this._getSplitterOffset(),t),t=Math.min(this._containerWidth-this._getSplitterOffset()-this._getSplitterWidth(),t)}_getContainerLeftOffset(){var e=this._$container.offset().left;if(wi){var t=wi.getComputedStyle(this._$container.get(0));e+=(parseFloat(t.paddingLeft)||0)+(parseFloat(t.borderLeftWidth)||0)}return e}_getSplitterOffset(){return(this._getSplitterBorderWidth()-this._getSplitterWidth())/2}_getSplitterWidth(){return this._$splitter.get(0).clientWidth}_getSplitterBorderWidth(){return this._$splitterBorder.get(0).clientWidth}_getLeftPanelWidth(){return this._$leftElement.get(0).clientWidth}getSplitterBorderElement(){return this._$splitterBorder}_toggleActive(e){this.$element().toggleClass(Pi,!e),this._$splitter.toggleClass(Pi,!e),this._isSplitterActive=e,this._actions.onActiveStateChanged({isActive:e})}toggleDisabled(e){this.$element().toggleClass("dx-state-disabled",e),this._$splitter.toggleClass("dx-state-disabled",e)}isSplitterMoved(){return!this.$element().hasClass(Ti)}disableSplitterCalculation(e){this._isSplitterCalculationDisabled=e}_setSplitterPositionLeft(){var{splitterPositionLeft:e=null,needUpdatePanels:t=!1,usePercentagePanelsWidth:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(e=e||this._getLeftPanelWidth()-this._getSplitterOffset())+this._getSplitterOffset(),a=this._containerWidth-o;this._isSplitterCalculationDisabled||this.$element().css("left",e),this._leftPanelPercentageWidth=this._leftPanelPercentageWidth||this._convertToPercentage(o);var n=this._convertToPercentage(this._containerWidth-this._convertToPixels(this._leftPanelPercentageWidth));t&&this._actions.onApplyPanelSize({leftPanelWidth:i?"".concat(this._leftPanelPercentageWidth,"%"):o,rightPanelWidth:i?"".concat(n,"%"):a})}_optionChanged(e){switch(e.name){case"initialLeftPanelWidth":this._leftPanelPercentageWidth=this._convertToPercentage(e.value),this._dimensionChanged();break;case"leftElement":this.repaint();break;case"onActiveStateChanged":case"onApplyPanelSize":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}_convertToPercentage(e){return e/this._$container.get(0).clientWidth*100}_convertToPixels(e){return e/100*this._$container.get(0).clientWidth}}var ki=Object(p.d)();class Bi extends c.a{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=!1;var e=Object(o.a)("<div>").appendTo(this.$element());Object(o.a)("<div>").addClass("dx-filemanager-adaptivity-drawer-panel").appendTo(e),this._drawer=this._createComponent(e,st.a),this._drawer.option({opened:!0,template:this._createDrawerTemplate.bind(this)}),Object(o.a)(this._drawer.content()).addClass("dx-drawer-panel-content-initial");var t=e.find(".".concat("dx-filemanager-adaptivity-drawer-panel")).first(),i=this.option("contentTemplate");Object(n.h)(i)&&i(t),this._updateDrawerMaxSize()}_createDrawerTemplate(e){this.option("drawerTemplate")(e),this._splitter=this._createComponent("<div>",ji,{container:this.$element(),leftElement:Object(o.a)(this._drawer.content()),rightElement:Object(o.a)(this._drawer.viewContent()),onApplyPanelSize:this._onApplyPanelSize.bind(this),onActiveStateChanged:this._onActiveStateChanged.bind(this)}),this._splitter.$element().appendTo(e),this._splitter.disableSplitterCalculation(!0)}_render(){super._render(),this._checkAdaptiveState()}_onApplyPanelSize(e){Object(p.f)()&&(this._splitter.isSplitterMoved()?(Object(o.a)(this._drawer.content()).removeClass("dx-drawer-panel-content-initial"),this._setDrawerWidth(e.leftPanelWidth)):this._setDrawerWidth(""))}_onActiveStateChanged(e){var{isActive:t}=e;this._splitter.disableSplitterCalculation(!t),!t&&this._splitter.$element().css("left","auto")}_setDrawerWidth(e){Object(o.a)(this._drawer.content()).css("width",e),this._updateDrawerMaxSize(),this._drawer.resizeViewContent()}_updateDrawerMaxSize(){this._drawer.option("maxSize",this._drawer.getRealPanelWidth())}_dimensionChanged(e){e&&"height"===e||this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;this._isInAdaptiveState=this._isSmallScreen(),e!==this._isInAdaptiveState&&(this.toggleDrawer(!this._isInAdaptiveState,!0),Object(o.a)(this._drawer.content()).toggleClass("dx-drawer-panel-content-adaptive",this._isInAdaptiveState),this._raiseAdaptiveStateChanged(this._isInAdaptiveState)),this._isInAdaptiveState&&this._isDrawerOpened()&&this._updateDrawerMaxSize()}_isSmallScreen(){return Object(Re.l)(ki)<=573}_isDrawerOpened(){return this._drawer.option("opened")}_initActions(){this._actions={onAdaptiveStateChanged:this._createActionByOption("onAdaptiveStateChanged")}}_raiseAdaptiveStateChanged(e){this._actions.onAdaptiveStateChanged({enabled:e})}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{drawerTemplate:null,contentTemplate:null,onAdaptiveStateChanged:null})}_optionChanged(e){var t=e.name;switch(t){case"drawerTemplate":case"contentTemplate":this.repaint();break;case"onAdaptiveStateChanged":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}isInAdaptiveState(){return this._isInAdaptiveState}toggleDrawer(e,t){this._updateDrawerMaxSize(),this._drawer.option("animationEnabled",!t),this._drawer.toggle(e);var i=this._isDrawerOpened()&&!this.isInAdaptiveState();this._splitter.toggleDisabled(!i)}getSplitterElement(){return this._splitter.getSplitterBorderElement().get(0)}}var Ui=Bi,$i=i("zvzf"),Vi=i("JyGS"),Ri="navPane",Li="itemView";class Ni extends c.a{_initTemplates(){}_init(){super._init(),this._initActions(),this._providerUpdateDeferred=null,this._lockCurrentPathProcessing=!1,this._wasRendered=!1,this._controller=new me({currentPath:this.option("currentPath"),currentPathKeys:this.option("currentPathKeys"),rootText:this.option("rootFolderName"),fileProvider:this.option("fileSystemProvider"),allowedFileExtensions:this.option("allowedFileExtensions"),uploadMaxFileSize:this.option("upload").maxFileSize,uploadChunkSize:this.option("upload").chunkSize,onInitialized:this._onControllerInitialized.bind(this),onDataLoading:this._onDataLoading.bind(this),onSelectedDirectoryChanged:this._onSelectedDirectoryChanged.bind(this),onPathPotentiallyChanged:this._checkPathActuality.bind(this),editingEvents:this._actions.editing})}_initMarkup(){super._initMarkup(),this._firstItemViewLoad=!0,this._lockSelectionProcessing=!1,this._lockFocusedItemProcessing=!1,this._itemKeyToFocus=void 0,this._loadedWidgets=[],this._commandManager=new fe(this.option("permissions")),this.$element().addClass("dx-filemanager"),this._wasRendered?this._prepareToLoad():this._wasRendered=!0,this._createNotificationControl(),this._initCommandManager()}_createNotificationControl(){var e=Object(o.a)("<div>").addClass("dx-filemanager-notification-container").appendTo(this.$element());this._notificationControl=this._createComponent(e,Xt,{progressPanelContainer:this.$element(),contentTemplate:(e,t)=>this._createWrapper(e,t),onActionProgress:e=>this._onActionProgress(e),positionTarget:".".concat("dx-filemanager-container"),showProgressPanel:this.option("notifications.showPanel"),showNotificationPopup:this.option("notifications.showPopup")})}_createWrapper(e,t){this._$wrapper=Object(o.a)("<div>").addClass("dx-filemanager-wrapper").appendTo(e),this._createEditing(t);var i=Object(o.a)("<div>").appendTo(this._$wrapper);this._toolbar=this._createComponent(i,at,{commandManager:this._commandManager,generalItems:this.option("toolbar.items"),fileItems:this.option("toolbar.fileSelectionItems"),itemViewMode:this.option("itemView").mode,onItemClick:e=>this._actions.onToolbarItemClick(e)}),this._createAdaptivityControl()}_createAdaptivityControl(){var e=Object(o.a)("<div>").addClass("dx-filemanager-container").appendTo(this._$wrapper);this._adaptivityControl=this._createComponent(e,Ui,{drawerTemplate:e=>this._createFilesTreeView(e),contentTemplate:e=>this._createItemsPanel(e),onAdaptiveStateChanged:e=>this._onAdaptiveStateChanged(e)}),this._editing.setUploaderSplitterElement(this._adaptivityControl.getSplitterElement())}_createEditing(e){var t=Object(o.a)("<div>").addClass("dx-filemanager-editing-container").appendTo(this.$element());this._editing=this._createComponent(t,Si,{controller:this._controller,model:{getMultipleSelectedItems:this._getSelectedItemInfos.bind(this)},getItemThumbnail:this._getItemThumbnailInfo.bind(this),notificationControl:e,uploadDropZonePlaceholderContainer:this.$element(),rtlEnabled:this.option("rtlEnabled"),onSuccess:e=>{var{updatedOnlyFiles:t}=e;return this._redrawComponent(t)},onError:e=>this._onEditingError(e)})}_createItemsPanel(e){this._$itemsPanel=Object(o.a)("<div>").addClass("dx-filemanager-items-panel").appendTo(e),this._createBreadcrumbs(this._$itemsPanel),this._createItemView(this._$itemsPanel),this._updateUploadDropZone()}_updateUploadDropZone(){var e=this._commandManager.isCommandAvailable("upload")?this._$itemsPanel:Object(o.a)();this._editing.setUploaderDropZone(e)}_createFilesTreeView(e){this._filesTreeViewContextMenu=this._createContextMenu(!1,Ri);var t=Object(o.a)("<div>").addClass("dx-filemanager-dirs-panel").appendTo(e);this._filesTreeView=this._createComponent(t,we,{storeExpandedState:!0,contextMenu:this._filesTreeViewContextMenu,getDirectories:this.getDirectories.bind(this),getCurrentDirectory:this._getCurrentDirectory.bind(this),onDirectoryClick:e=>{var{itemData:t}=e;return this._setCurrentDirectory(t)},onItemListDataLoaded:()=>this._tryEndLoading(Ri)}),this._filesTreeView.updateCurrentDirectory()}_createItemView(e,t){this._itemViewContextMenu=this._createContextMenu(!0,Li);var i=this.option("itemView"),a={selectionMode:this.option("selectionMode"),selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),contextMenu:this._itemViewContextMenu,getItems:this._getItemViewItems.bind(this),onError:e=>{var{error:t}=e;return this._showError(t)},onSelectionChanged:this._onItemViewSelectionChanged.bind(this),onFocusedItemChanged:this._onItemViewFocusedItemChanged.bind(this),onSelectedItemOpened:this._onSelectedItemOpened.bind(this),onContextMenuShowing:e=>this._onContextMenuShowing(Li,e),onItemListItemsLoaded:()=>this._tryEndLoading(Li),getItemThumbnail:this._getItemThumbnailInfo.bind(this),customizeDetailColumns:this.option("customizeDetailColumns"),detailColumns:this.option("itemView.details.columns")},n=Object(o.a)("<div>").appendTo(e),s="thumbnails"===(t=t||i.mode)?Je:$e;this._itemView=this._createComponent(n,s,a)}_createBreadcrumbs(e){var t=Object(o.a)("<div>").appendTo(e);this._breadcrumbs=this._createComponent(t,Fi,{rootFolderDisplayName:this.option("rootFolderName"),onCurrentDirectoryChanging:e=>{var{currentDirectory:t}=e;return this._setCurrentDirectory(t,!0)}}),this._breadcrumbs.setCurrentDirectory(this._getCurrentDirectory())}_createContextMenu(e,t){var i=Object(o.a)("<div>").appendTo(this._$wrapper);return this._createComponent(i,ye,{commandManager:this._commandManager,items:this.option("contextMenu.items"),onItemClick:e=>this._actions.onContextMenuItemClick(e),onContextMenuShowing:e=>this._onContextMenuShowing(t,e),isolateCreationItemCommands:e,viewArea:t})}_initCommandManager(){var e=Object(a.a)(this._editing.getCommandActions(),{refresh:()=>this._refreshAndShowProgress(),thumbnails:()=>this.option("itemView.mode","thumbnails"),details:()=>this.option("itemView.mode","details"),clearSelection:()=>this._clearSelection(),showNavPane:()=>this._adaptivityControl.toggleDrawer()});this._commandManager.registerActions(e)}_onItemViewSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:a,currentDeselectedItemKeys:n}=e;this._lockSelectionProcessing=!0,this.option("selectedItemKeys",o),this._lockSelectionProcessing=!1,this._actions.onSelectionChanged({selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:a,currentDeselectedItemKeys:n}),this._updateToolbar(t)}_onItemViewFocusedItemChanged(e){this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._actions.onFocusedItemChanged({item:e.item,itemElement:e.itemElement})}_onAdaptiveStateChanged(e){var{enabled:t}=e;this._commandManager.setCommandEnabled("showNavPane",t),this._updateToolbar()}_onActionProgress(e){var{message:t,status:i}=e;this._toolbar.updateRefreshItem(t,i),this._updateToolbar()}_onEditingError(e){var t=j({},e,["errorCode","errorText","fileSystemItem"]);this._actions.onErrorOccurred(t),e.errorText=t.errorText}_refreshAndShowProgress(){return this._prepareToLoad(),Object(s.c)(this._notificationControl.tryShowProgressPanel(),this._controller.refresh()).then(()=>this._filesTreeView.refresh())}_isAllWidgetsLoaded(){return 2===this._loadedWidgets.length&&-1!==this._loadedWidgets.indexOf(Ri)&&-1!==this._loadedWidgets.indexOf(Li)}_tryEndLoading(e){this._loadedWidgets.push(e),this._isAllWidgetsLoaded()&&this._controller.endSingleLoad()}_prepareToLoad(){this._loadedWidgets=[],this._controller.startSingleLoad()}_updateToolbar(e){var t=e||this._getSelectedItemInfos();this._toolbar.option("contextItems",Object(r.g)(t,[]))}_switchView(e){this._disposeWidget(this._itemView.option("contextMenu")),this._disposeWidget(this._itemView),this._createItemView(this._$itemsPanel,e),this._toolbar.option({itemViewMode:e})}_disposeWidget(e){e.dispose(),e.$element().remove()}_clearSelection(){this._itemView.clearSelection()}_showError(e){this._showNotification(e,!1)}_showNotification(e,t){P({message:e,width:450},t?"success":"error",5e3)}_redrawComponent(e){this._itemView.refresh().then(()=>!e&&this._filesTreeView.refresh())}_getItemViewItems(){var e=this.option("itemView").showFolders,t=this._controller.getCurrentItems(!e);return this._updateToolbarWithSelectionOnFirstLoad(t),this.option("itemView.showParentFolder")&&(t=Object(s.c)(t).then(e=>this._getPreparedItemViewItems(e))),t}_updateToolbarWithSelectionOnFirstLoad(e){if(this._firstItemViewLoad){this._firstItemViewLoad=!1;var t=this.option("selectedItemKeys");t.length>0&&Object(s.c)(e).done(e=>{var i=((e,t)=>{var i={};t.forEach(e=>{i[e]=null}),e.forEach(e=>{var t=e.fileItem.key;Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=e)});var o=[];return t.forEach(e=>{var t=i[e];t&&o.push(t)}),o})(e,t);i.length>0&&this._updateToolbar(i)})}}_getPreparedItemViewItems(e){var t=this._getCurrentDirectory();if(t.fileItem.isRoot())return e;var i=t.fileItem.createClone();i.isParentFolder=!0,i.name="..",i.relativeName="..",i.key="".concat("[*DXPDK*]$40F96F03-FBD8-43DF-91BE-F55F4B8BA871$").concat(t.fileItem.key);var o=[...e];return o.unshift({fileItem:i,icon:"parentfolder"}),o}_onContextMenuShowing(e,t){var i,o=j({},t,["targetElement","cancel","event"]);o=Object(a.a)(o,{viewArea:e,fileSystemItem:null===(i=t.itemData)||void 0===i?void 0:i.fileItem,_isActionButton:t.isActionButton}),this._actions.onContextMenuShowing(o),t.cancel=Object(r.g)(o.cancel,!1)}_getItemThumbnailInfo(e){var t=this.option("customizeThumbnail"),i=Object(n.h)(t)?t(e.fileItem):e.fileItem.thumbnail;return i?{thumbnail:i,cssClass:"dx-filemanager-item-custom-thumbnail"}:{thumbnail:e.icon}}_getDefaultOptions(){return Object(a.a)(super._getDefaultOptions(),{fileSystemProvider:null,currentPath:"",currentPathKeys:[],rootFolderName:l.a.format("dxFileManager-rootDirectoryName"),selectionMode:"multiple",selectedItemKeys:[],focusedItemKey:void 0,toolbar:{items:["showNavPane","create","upload","switchView",{name:"separator",location:"after"},"refresh"],fileSelectionItems:["download","separator","move","copy","rename","separator","delete","clearSelection",{name:"separator",location:"after"},"refresh"]},contextMenu:{items:["create","upload","rename","move","copy","delete","refresh","download"]},itemView:{details:{columns:["thumbnail","name","dateModified","size"]},mode:"details",showFolders:!0,showParentFolder:!0},customizeThumbnail:null,customizeDetailColumns:null,onContextMenuItemClick:null,onContextMenuShowing:null,onCurrentDirectoryChanged:null,onSelectedFileOpened:null,onSelectionChanged:null,onFocusedItemChanged:null,onToolbarItemClick:null,onErrorOccurred:null,onDirectoryCreating:null,onDirectoryCreated:null,onItemRenaming:null,onItemRenamed:null,onItemDeleting:null,onItemDeleted:null,onItemCopying:null,onItemCopied:null,onItemMoving:null,onItemMoved:null,onFileUploading:null,onFileUploaded:null,onItemDownloading:null,allowedFileExtensions:[],upload:{maxFileSize:0,chunkSize:2e5},permissions:Object(a.a)({},ge),notifications:{showPanel:!0,showPopup:!0}})}option(e,t){var i=Object($i.f)(e,t),o=arguments.length<2&&"object"!==Object(n.q)(e),a=e=>Object(n.d)(i[e]),r=e=>{if(!a(e))return!1;var t=this.option(e),o=i[e];return!Object(Vi.a)(t,o)};return!o&&a("fileSystemProvider")&&(this._providerUpdateDeferred=new s.a,(r("currentPath")||r("currentPathKeys"))&&(this._lockCurrentPathProcessing=!0)),super.option(...arguments)}_optionChanged(e){var t=e.name;switch(t){case"currentPath":var i=()=>(this._lockCurrentPathProcessing=!1,this._controller.setCurrentPath(e.value));this._lockCurrentPathProcessing=!0,this._providerUpdateDeferred?this._providerUpdateDeferred.then(i):i();break;case"currentPathKeys":var o=()=>(this._lockCurrentPathProcessing=!1,this._controller.setCurrentPathByKeys(e.value));this._lockCurrentPathProcessing=!0,this._providerUpdateDeferred?this._providerUpdateDeferred.then(o):o();break;case"selectedItemKeys":!this._lockSelectionProcessing&&this._itemView&&this._itemView.option("selectedItemKeys",e.value);break;case"focusedItemKey":!this._lockFocusedItemProcessing&&this._itemView&&this._itemView.option("focusedItemKey",e.value);break;case"rootFolderName":this._controller.setRootText(e.value),this._invalidate();break;case"fileSystemProvider":this._lockCurrentPathProcessing||(this._providerUpdateDeferred=new s.a);var a=this._lockCurrentPathProcessing?void 0:this.option("currentPathKeys");this._controller.updateProvider(e.value,a).then(()=>this._providerUpdateDeferred.resolve()).always(()=>{this._providerUpdateDeferred=null,this.repaint()});break;case"allowedFileExtensions":this._controller.setAllowedFileExtensions(e.value),this._invalidate();break;case"upload":this._controller.setUploadOptions(this.option("upload")),this._invalidate();break;case"permissions":this._commandManager.updatePermissions(this.option("permissions")),this._filesTreeViewContextMenu.tryUpdateVisibleContextMenu(),this._itemViewContextMenu.tryUpdateVisibleContextMenu(),this._toolbar.updateItemPermissions(),this._updateUploadDropZone();break;case"selectionMode":case"customizeThumbnail":case"customizeDetailColumns":this._invalidate();break;case"itemView":"itemView.mode"===e.fullName?this._switchView(e.value):this._invalidate();break;case"toolbar":var n={};"toolbar"===e.fullName&&(e.value.items&&(n.generalItems=e.value.items),e.value.fileSelectionItems&&(n.fileItems=e.value.fileSelectionItems)),0===e.fullName.indexOf("toolbar.items")&&(n.generalItems=this.option("toolbar.items")),0===e.fullName.indexOf("toolbar.fileSelectionItems")&&(n.fileItems=this.option("toolbar.fileSelectionItems")),this._toolbar.option(n);break;case"contextMenu":if("contextMenu"===e.fullName&&e.value.items||0===e.fullName.indexOf("contextMenu.items")){var r=this.option("contextMenu.items");this._filesTreeViewContextMenu.option("items",r),this._itemViewContextMenu.option("items",r)}break;case"notifications":this._notificationControl.option("showProgressPanel",this.option("notifications.showPanel")),this._notificationControl.option("showNotificationPopup",this.option("notifications.showPopup"));break;case"onContextMenuItemClick":case"onContextMenuShowing":case"onCurrentDirectoryChanged":case"onSelectedFileOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onToolbarItemClick":case"onErrorOccurred":this._actions[t]=this._createActionByOption(t);break;case"onDirectoryCreating":case"onDirectoryCreated":case"onItemRenaming":case"onItemRenamed":case"onItemDeleting":case"onItemDeleted":case"onItemCopying":case"onItemCopied":case"onItemMoving":case"onItemMoved":case"onFileUploading":case"onFileUploaded":case"onItemDownloading":this._actions.editing[t]=this._createActionByOption(t);break;case"rtlEnabled":this._editing.updateDialogRtl(e.value),super._optionChanged(e);break;default:super._optionChanged(e)}}_initActions(){this._actions={onContextMenuItemClick:this._createActionByOption("onContextMenuItemClick"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onCurrentDirectoryChanged:this._createActionByOption("onCurrentDirectoryChanged"),onSelectedFileOpened:this._createActionByOption("onSelectedFileOpened"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onToolbarItemClick:this._createActionByOption("onToolbarItemClick"),onErrorOccurred:this._createActionByOption("onErrorOccurred"),editing:{onDirectoryCreating:this._createActionByOption("onDirectoryCreating"),onDirectoryCreated:this._createActionByOption("onDirectoryCreated"),onItemRenaming:this._createActionByOption("onItemRenaming"),onItemRenamed:this._createActionByOption("onItemRenamed"),onItemDeleting:this._createActionByOption("onItemDeleting"),onItemDeleted:this._createActionByOption("onItemDeleted"),onItemCopying:this._createActionByOption("onItemCopying"),onItemCopied:this._createActionByOption("onItemCopied"),onItemMoving:this._createActionByOption("onItemMoving"),onItemMoved:this._createActionByOption("onItemMoved"),onFileUploading:this._createActionByOption("onFileUploading"),onFileUploaded:this._createActionByOption("onFileUploaded"),onItemDownloading:this._createActionByOption("onItemDownloading")}}}executeCommand(e){return this._commandManager.executeCommand(e)}_setCurrentDirectory(e,t){this._controller.setCurrentDirectory(e,t)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}_onControllerInitialized(e){var{controller:t}=e;this._controller=this._controller||t,this._syncToCurrentDirectory()}_onDataLoading(e){var{operation:t}=e,i=null;"navigation"===t&&(i={focusedItemKey:this._itemKeyToFocus,selectedItemKeys:this.option("selectedItemKeys")},this._itemKeyToFocus=void 0),this._itemView.refresh(i)}_onSelectedDirectoryChanged(){var e=this._getCurrentDirectory();this._syncToCurrentDirectory(),this._actions.onCurrentDirectoryChanged({directory:e.fileItem})}_syncToCurrentDirectory(){var e=this._getCurrentDirectory();this._filesTreeView&&this._filesTreeView.updateCurrentDirectory(),this._breadcrumbs&&this._breadcrumbs.setCurrentDirectory(e),this._checkPathActuality()}_checkPathActuality(){if(!this._lockCurrentPathProcessing){var e=this._controller.getCurrentPath(),t=this._controller.getCurrentPathKeys(),i={};this.option("currentPath")!==e&&(i.currentPath=e),Object(r.h)(this.option("currentPathKeys"),t)||(i.currentPathKeys=t),Object(n.e)(i)||this.option(i)}}getDirectories(e,t){return this._controller.getDirectories(e,t)}_getSelectedItemInfos(){return this._itemView?this._itemView.getSelectedItems():[]}refresh(){return this.executeCommand("refresh")}getCurrentDirectory(){var e=this._getCurrentDirectory();return e&&e.fileItem||null}getSelectedItems(){return this._getSelectedItemInfos().map(e=>e.fileItem)}_onSelectedItemOpened(e){var{fileItemInfo:t}=e,i=t.fileItem;if(i.isDirectory){i.isParentFolder&&(this._itemKeyToFocus=this._getCurrentDirectory().fileItem.key);var o=i.isParentFolder?this._getCurrentDirectory().parentDirectory:t;this._setCurrentDirectory(o),o&&this._filesTreeView.toggleDirectoryExpandedState(o.parentDirectory,!0)}else this._actions.onSelectedFileOpened({file:i})}}Object(d.a)("dxFileManager",Ni);var Ki=Ni;t.default=Ki},ADaq:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return l})),i.d(t,"f",(function(){return d}));var o=i("sUSw"),a="/",n=e=>{var t=e.lastIndexOf(".");return-1!==t?e.substr(t):""},s=e=>{var t=e.lastIndexOf(a);return-1!==t?e.substr(t+a.length):e},r=(e,t)=>{if(!e||"/"===e)return[];for(var i=[],o="",n=0;n<e.length;n++){var s=e.charAt(n);if(s===a){var r=e.charAt(n+1);r!==a&&(o&&(i.push(o),o=""),s=r),n++}o+=s}if(o&&i.push(o),t)for(var c=0;c<i.length;c++)i[c]=d(0===c?"":i[c-1],l(i[c]));return i},l=function(e){return e.replace(/\//g,"//")},d=function(){var e="";return Object(o.a)(arguments,(t,i)=>{i&&(e&&(e+=a),e+=i)}),e}},E6yd:function(e,t,i){"use strict";var o=i("a8dJ"),a=i("v5W6"),n=i("t66f"),s=i("hpbx");class r extends s.a{constructor(e){super(e=Object(o.g)(e,{})),this._hasSubDirsGetter=Object(n.a)(e.hasSubDirectoriesExpr||"hasSubDirectories"),this._getItemsFunction=this._ensureFunction(e.getItems,()=>[]),this._renameItemFunction=this._ensureFunction(e.renameItem),this._createDirectoryFunction=this._ensureFunction(e.createDirectory),this._deleteItemFunction=this._ensureFunction(e.deleteItem),this._moveItemFunction=this._ensureFunction(e.moveItem),this._copyItemFunction=this._ensureFunction(e.copyItem),this._uploadFileChunkFunction=this._ensureFunction(e.uploadFileChunk),this._abortFileUploadFunction=this._ensureFunction(e.abortFileUpload),this._downloadItemsFunction=this._ensureFunction(e.downloadItems),this._getItemsContentFunction=this._ensureFunction(e.getItemsContent)}getItems(e){var t=e.getFullPathInfo();return this._executeActionAsDeferred(()=>this._getItemsFunction(e),!0).then(e=>this._convertDataObjectsToFileItems(e,t))}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemFunction(e,t))}createDirectory(e,t){return this._executeActionAsDeferred(()=>this._createDirectoryFunction(e,t))}deleteItems(e){return e.map(e=>this._executeActionAsDeferred(()=>this._deleteItemFunction(e)))}moveItems(e,t){return e.map(e=>this._executeActionAsDeferred(()=>this._moveItemFunction(e,t)))}copyItems(e,t){return e.map(e=>this._executeActionAsDeferred(()=>this._copyItemFunction(e,t)))}uploadFileChunk(e,t,i){return this._executeActionAsDeferred(()=>this._uploadFileChunkFunction(e,t,i))}abortFileUpload(e,t,i){return this._executeActionAsDeferred(()=>this._abortFileUploadFunction(e,t,i))}downloadItems(e){return this._executeActionAsDeferred(()=>this._downloadItemsFunction(e))}getItemsContent(e){return this._executeActionAsDeferred(()=>this._getItemsContentFunction(e))}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return"boolean"!=typeof t||t}_getKeyExpr(e){return e.keyExpr||"key"}_ensureFunction(e,t){return t=t||o.n,Object(a.h)(e)?e:t}}t.a=r},VKCK:function(e,t,i){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DxUpload=t.DxToolbarItem=t.DxToolbar=t.DxPermissions=t.DxNotifications=t.DxItemView=t.DxItem=t.DxFileSelectionItem=t.DxDetails=t.DxContextMenuItem=t.DxContextMenu=t.DxColumn=t.DxFileManager=void 0;var a=o(i("+sxU")),n=i("J9oI"),s=i("J9oI"),r=n.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,allowedFileExtensions:Array,contextMenu:Object,currentPath:String,currentPathKeys:Array,customizeDetailColumns:Function,customizeThumbnail:Function,disabled:Boolean,elementAttr:Object,fileSystemProvider:{},focusedItemKey:String,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,itemView:Object,notifications:Object,onContentReady:Function,onContextMenuItemClick:Function,onContextMenuShowing:Function,onCurrentDirectoryChanged:Function,onDirectoryCreated:Function,onDirectoryCreating:Function,onDisposing:Function,onErrorOccurred:Function,onFileUploaded:Function,onFileUploading:Function,onFocusedItemChanged:Function,onInitialized:Function,onItemCopied:Function,onItemCopying:Function,onItemDeleted:Function,onItemDeleting:Function,onItemDownloading:Function,onItemMoved:Function,onItemMoving:Function,onItemRenamed:Function,onItemRenaming:Function,onOptionChanged:Function,onSelectedFileOpened:Function,onSelectionChanged:Function,onToolbarItemClick:Function,permissions:Object,rootFolderName:String,rtlEnabled:Boolean,selectedItemKeys:Array,selectionMode:String,tabIndex:Number,toolbar:Object,upload:Object,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:allowedFileExtensions":null,"update:contextMenu":null,"update:currentPath":null,"update:currentPathKeys":null,"update:customizeDetailColumns":null,"update:customizeThumbnail":null,"update:disabled":null,"update:elementAttr":null,"update:fileSystemProvider":null,"update:focusedItemKey":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:itemView":null,"update:notifications":null,"update:onContentReady":null,"update:onContextMenuItemClick":null,"update:onContextMenuShowing":null,"update:onCurrentDirectoryChanged":null,"update:onDirectoryCreated":null,"update:onDirectoryCreating":null,"update:onDisposing":null,"update:onErrorOccurred":null,"update:onFileUploaded":null,"update:onFileUploading":null,"update:onFocusedItemChanged":null,"update:onInitialized":null,"update:onItemCopied":null,"update:onItemCopying":null,"update:onItemDeleted":null,"update:onItemDeleting":null,"update:onItemDownloading":null,"update:onItemMoved":null,"update:onItemMoving":null,"update:onItemRenamed":null,"update:onItemRenaming":null,"update:onOptionChanged":null,"update:onSelectedFileOpened":null,"update:onSelectionChanged":null,"update:onToolbarItemClick":null,"update:permissions":null,"update:rootFolderName":null,"update:rtlEnabled":null,"update:selectedItemKeys":null,"update:selectionMode":null,"update:tabIndex":null,"update:toolbar":null,"update:upload":null,"update:visible":null,"update:width":null},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=a.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={contextMenu:{isCollectionItem:!1,optionName:"contextMenu"},itemView:{isCollectionItem:!1,optionName:"itemView"},notifications:{isCollectionItem:!1,optionName:"notifications"},permissions:{isCollectionItem:!1,optionName:"permissions"},toolbar:{isCollectionItem:!1,optionName:"toolbar"},upload:{isCollectionItem:!1,optionName:"upload"}}}});t.DxFileManager=r;var l=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:alignment":null,"update:caption":null,"update:cssClass":null,"update:dataField":null,"update:dataType":null,"update:hidingPriority":null,"update:sortIndex":null,"update:sortOrder":null,"update:visible":null,"update:visibleIndex":null,"update:width":null},props:{alignment:String,caption:String,cssClass:String,dataField:String,dataType:String,hidingPriority:Number,sortIndex:Number,sortOrder:String,visible:Boolean,visibleIndex:Number,width:[Number,String]}});t.DxColumn=l,l.$_optionName="columns",l.$_isCollectionItem=!0;var d=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:items":null},props:{items:Array}});t.DxContextMenu=d,d.$_optionName="contextMenu",d.$_expectedChildren={contextMenuItem:{isCollectionItem:!0,optionName:"items"},item:{isCollectionItem:!0,optionName:"items"}};var c=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:beginGroup":null,"update:closeMenuOnClick":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:items":null,"update:name":null,"update:selectable":null,"update:selected":null,"update:template":null,"update:text":null,"update:visible":null},props:{beginGroup:Boolean,closeMenuOnClick:Boolean,disabled:Boolean,html:String,icon:String,items:Array,name:String,selectable:Boolean,selected:Boolean,template:{},text:String,visible:Boolean}});t.DxContextMenuItem=c,c.$_optionName="items",c.$_isCollectionItem=!0;var h=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:columns":null},props:{columns:Array}});t.DxDetails=h,h.$_optionName="details",h.$_expectedChildren={column:{isCollectionItem:!0,optionName:"columns"}};var u=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:cssClass":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:locateInMenu":null,"update:location":null,"update:menuItemTemplate":null,"update:name":null,"update:options":null,"update:showText":null,"update:template":null,"update:text":null,"update:visible":null,"update:widget":null},props:{cssClass:String,disabled:Boolean,html:String,icon:String,locateInMenu:String,location:String,menuItemTemplate:{},name:String,options:{},showText:String,template:{},text:String,visible:Boolean,widget:String}});t.DxFileSelectionItem=u,u.$_optionName="fileSelectionItems",u.$_isCollectionItem=!0;var p=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:beginGroup":null,"update:closeMenuOnClick":null,"update:cssClass":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:items":null,"update:locateInMenu":null,"update:location":null,"update:menuItemTemplate":null,"update:name":null,"update:options":null,"update:selectable":null,"update:selected":null,"update:showText":null,"update:template":null,"update:text":null,"update:visible":null,"update:widget":null},props:{beginGroup:Boolean,closeMenuOnClick:Boolean,cssClass:String,disabled:Boolean,html:String,icon:String,items:Array,locateInMenu:String,location:String,menuItemTemplate:{},name:String,options:{},selectable:Boolean,selected:Boolean,showText:String,template:{},text:String,visible:Boolean,widget:String}});t.DxItem=p,p.$_optionName="items",p.$_isCollectionItem=!0;var m=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:details":null,"update:mode":null,"update:showFolders":null,"update:showParentFolder":null},props:{details:Object,mode:String,showFolders:Boolean,showParentFolder:Boolean}});t.DxItemView=m,m.$_optionName="itemView",m.$_expectedChildren={details:{isCollectionItem:!1,optionName:"details"}};var _=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:showPanel":null,"update:showPopup":null},props:{showPanel:Boolean,showPopup:Boolean}});t.DxNotifications=_,_.$_optionName="notifications";var g=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:copy":null,"update:create":null,"update:delete":null,"update:download":null,"update:move":null,"update:rename":null,"update:upload":null},props:{copy:Boolean,create:Boolean,delete:Boolean,download:Boolean,move:Boolean,rename:Boolean,upload:Boolean}});t.DxPermissions=g,g.$_optionName="permissions";var f=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:fileSelectionItems":null,"update:items":null},props:{fileSelectionItems:Array,items:Array}});t.DxToolbar=f,f.$_optionName="toolbar",f.$_expectedChildren={fileSelectionItem:{isCollectionItem:!0,optionName:"fileSelectionItems"},item:{isCollectionItem:!0,optionName:"items"},toolbarItem:{isCollectionItem:!0,optionName:"items"}};var I=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:cssClass":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:locateInMenu":null,"update:location":null,"update:menuItemTemplate":null,"update:name":null,"update:options":null,"update:showText":null,"update:template":null,"update:text":null,"update:visible":null,"update:widget":null},props:{cssClass:String,disabled:Boolean,html:String,icon:String,locateInMenu:String,location:String,menuItemTemplate:{},name:String,options:{},showText:String,template:{},text:String,visible:Boolean,widget:String}});t.DxToolbarItem=I,I.$_optionName="items",I.$_isCollectionItem=!0;var v=s.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:chunkSize":null,"update:maxFileSize":null},props:{chunkSize:Number,maxFileSize:Number}});t.DxUpload=v,v.$_optionName="upload",t.default=r},hpbx:function(e,t,i){"use strict";var o=i("t66f"),a=i("a8dJ"),n=i("7Cjx"),s=i("sUSw"),r=i("v5W6"),l=i("zAdP"),d=i("lU5B");t.a=class{constructor(e){e=Object(a.g)(e,{}),this._keyGetter=Object(o.a)(this._getKeyExpr(e)),this._nameGetter=Object(o.a)(this._getNameExpr(e)),this._isDirGetter=Object(o.a)(this._getIsDirExpr(e)),this._sizeGetter=Object(o.a)(this._getSizeExpr(e)),this._dateModifiedGetter=Object(o.a)(this._getDateModifiedExpr(e)),this._thumbnailGetter=Object(o.a)(e.thumbnailExpr||"thumbnail")}getItems(e){return[]}renameItem(e,t){}createDirectory(e,t){}deleteItems(e){}moveItems(e,t){}copyItems(e,t){}uploadFileChunk(e,t,i){}abortFileUpload(e,t,i){}downloadItems(e){}getItemsContent(e){}getFileUploadChunkSize(){return 2e5}_convertDataObjectsToFileItems(e,t){var i=[];return Object(s.a)(e,(e,o)=>{var a=this._createFileItem(o,t);i.push(a)}),i}_createFileItem(e,t){var i=this._keyGetter(e),o=new d.a(t,this._nameGetter(e),!!this._isDirGetter(e),i);return o.size=this._sizeGetter(e),void 0===o.size&&(o.size=0),o.dateModified=n.a.deserializeDate(this._dateModifiedGetter(e)),void 0===o.dateModified&&(o.dateModified=new Date),o.isDirectory&&(o.hasSubDirectories=this._hasSubDirs(e)),i||(o.key=o.relativeName),o.thumbnail=this._thumbnailGetter(e)||"",o.dataItem=e,o}_hasSubDirs(e){return!0}_getKeyExpr(e){return e.keyExpr||this._defaultKeyExpr}_defaultKeyExpr(e){if(2!==arguments.length)return Object.prototype.hasOwnProperty.call(e,"__KEY__")?e.__KEY__:null;e.__KEY__=arguments[1]}_getNameExpr(e){return e.nameExpr||"name"}_getIsDirExpr(e){return e.isDirectoryExpr||"isDirectory"}_getSizeExpr(e){return e.sizeExpr||"size"}_getDateModifiedExpr(e){return e.dateModifiedExpr||"dateModified"}_executeActionAsDeferred(e,t){var i=new l.a;try{var o=e();Object(r.m)(o)?Object(l.b)(o).done(e=>i.resolve(t&&e||void 0)).fail(e=>i.reject(e)):i.resolve(t&&o||void 0)}catch(e){return i.reject(e)}return i.promise()}}},lU5B:function(e,t,i){"use strict";var o=i("v5W6"),a=i("ADaq");class n{constructor(){(Object(o.o)(arguments[0])?this._publicCtor:this._internalCtor).apply(this,arguments)}_internalCtor(e,t,i,o){this.name=t||"",this.pathInfo=e&&[...e]||[],this.parentPath=this._getPathByPathInfo(this.pathInfo),this.relativeName=Object(a.f)(this.parentPath,t),this.key=o||this._getPathByPathInfo(this.getFullPathInfo(),!0),this.path=Object(a.f)(this.parentPath,t),this.pathKeys=this.pathInfo.map(e=>{var{key:t}=e;return t}),this.isRoot()||this.pathKeys.push(this.key),this._initialize(i)}_publicCtor(e,t,i){this.path=e||"",this.pathKeys=i||[];for(var o=[],n=Object(a.e)(e,!0),s=0;s<n.length-1;s++){var r=n[s],l={key:this.pathKeys[s]||r,name:Object(a.d)(r)};o.push(l)}this.pathInfo=o,this.relativeName=e,this.name=Object(a.d)(e),this.key=this.pathKeys.length?this.pathKeys[this.pathKeys.length-1]:e,this.parentPath=n.length>1?n[n.length-2]:"",this._initialize(t)}_initialize(e){this.isDirectory=!!e,this.size=0,this.dateModified=new Date,this.thumbnail="",this.tooltipText=""}getFullPathInfo(){var e=[...this.pathInfo];return this.isRoot()||e.push({key:this.key,name:this.name}),e}isRoot(){return""===this.path}getFileExtension(){return this.isDirectory?"":Object(a.c)(this.name)}equals(e){return e&&this.key===e.key}createClone(){var e=new n(this.pathInfo,this.name,this.isDirectory,this.key);return e.key=this.key,e.size=this.size,e.dateModified=this.dateModified,e.thumbnail=this.thumbnail,e.tooltipText=this.tooltipText,e.hasSubDirectories=this.hasSubDirectories,e.dataItem=this.dataItem,e}_getPathByPathInfo(e,t){return e.map(e=>t?Object(a.b)(e.name):e.name).join(a.a)}}t.a=n}}]);