(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"+65d":function(t,e,o){"use strict";o("cA9T")},Bked:function(t,e,o){"use strict";o.r(e);var a=o("L2JU"),i=o("fBN2"),s=o("e+zl"),n=o("F9O+"),r=o("0B6u"),l=o("uJsO"),u=o("rkWJ");function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?p(Object(o),!0).forEach((function(e){m(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function m(t,e,o){return(e=function(t){var e=function(t,e){if("object"!==d(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var a=o.call(t,e||"default");if("object"!==d(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===d(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var f={components:{SendCommentPopup:i.a,UserDetailPopup:s.a,EditProfilePopup:n.a,ChangeAvatarPopup:r.a,ChangePinPopup:l.a,ChangePasswordPopup:u.a},data:function(){return{isLoading:!0,formData:{}}},mounted:function(){"#detail"===this.$route.hash&&this.detailInfoClick()},computed:c(c({},Object(a.c)("Auth",["name","code","phone","email","avatar","level"])),{},{popup:function(){return this.$refs.popup.instance}}),methods:c(c(c({},Object(a.b)("Auth",["clearData"])),Object(a.b)("User.profile",["fetch","save","delete"])),{},{onSubmit:function(){var t=this;this.$refs.editProfileForm.$refs.form.instance.validate().isValid&&(this.popup.option("toolbarItems[0].options.disabled",!0),this.save(this.formData).then((function(){t.popup.hide(),t.$toasted.success(t.$mt.messages.success.saved)})))},cloneDeepData:function(){this.formData=this.$mf.cloneDeep(this.profile),this.isLoading=!1},validateBirthday:function(t){return moment(t.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn:function(t){return moment(t.value).isBefore(moment().subtract(1,"day"))},detailInfoClick:function(){var t=this;this.$refs.userDetailPopup.show({getUser:function(){return t.fetch()}})},onDeleteClick:function(){var t=this;this.$bus.emit("checkPin",(function(){t.delete().then((function(e){e&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),t.clearData(),t.$router.push({name:"login"}))}))}))}})},v=(o("+65d"),o("KHd+")),h=Object(v.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"profile-page"},[e("h2",{staticClass:"content-block"},[t._v("\n        "+t._s(t.$t("user.profile.title"))+"\n    ")]),t._v(" "),e("div",{staticClass:"content-block dx-card responsive-paddings"},[e("DxToolbar",{attrs:{items:[{visible:!!t.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:t.$t("buttons.back"),onClick:function(){t.$router.push({name:t.$route.query.redirect})}}},{visible:t.level<5,location:"before",widget:"dxButton",cssClass:"guiding-step-2b",options:{icon:"far fa-user-edit small",hint:t.$t("components.editProfile.title"),onClick:function(){return t.$refs.editProfilePopup.show()}}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:t.$t("components.changeAvatar.title"),onClick:function(){return t.$refs.changeAvatarPopup.show()}}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:t.$t("components.changePin.title"),onClick:function(){return t.$refs.changePinPopup.show()}}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:t.$t("components.changePassword.title"),onClick:function(){return t.$refs.changePasswordPopup.show()}}}]}}),t._v(" "),e("div",{staticClass:"info"},[e("div",{staticClass:"avatar"},[e("Photoswipe",{on:{opened:t.$mf.pushPhotoswipeToHistoryState,close:t.$mf.popRouteHistoryState}},[e("img",{directives:[{name:"pswp",rawName:"v-pswp",value:t.avatar,expression:"avatar"}],attrs:{src:t.avatar,alt:t.$appName}})])],1),t._v(" "),e("div",{staticClass:"personal"},[e("div",[e("span",[t._v(t._s(t.$t("models.user.name"))+":")]),t._v(" "),e("span",{staticClass:"name"},[t._v(t._s(t.name))])]),t._v(" "),e("div",[e("span",[t._v(t._s(t.$t("models.user.code"))+":")]),t._v(" "),e("span",[t._v(t._s(t.code))])]),t._v(" "),t.phone?e("div",[e("span",[t._v(t._s(t.$t("models.user.phone"))+":")]),t._v(" "),e("span",[t._v(t._s(t._f("phone")(t.phone)))])]):t._e(),t._v(" "),e("div",[e("span",[t._v(t._s(t.$t("models.user.email"))+":")]),t._v(" "),e("span",[t._v(t._s(t.email))])]),t._v(" "),e("DxButton",{staticClass:"detail",attrs:{width:"170",type:"default","styling-mode":"outlined",text:t.$t("user.profile.detailInfo")},on:{click:t.detailInfoClick}})],1)])],1),t._v(" "),e("div",{staticClass:"content-block dx-card responsive-paddings change"},[e("div",{staticClass:"title"},[t._v("\n            "+t._s(t.$t("user.profile.changeRequest.title"))+"\n        ")]),t._v(" "),e("div",{staticClass:"content"},[e("div",[t._v(t._s(t.$t("user.profile.changeRequest.desctiption")))]),t._v(" "),e("DxButton",{attrs:{text:t.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained"},on:{click:function(e){return t.$refs.sendCommentPopup.show()}}})],1)]),t._v(" "),e("div",{staticClass:"content-block dx-card responsive-paddings delete"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("user.profile.delete.title")))]),t._v(" "),e("div",{staticClass:"content"},[e("div",[t._v(t._s(t.$t("user.profile.delete.desctiption")))]),t._v(" "),e("DxButton",{attrs:{text:t.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained"},on:{click:t.onDeleteClick}})],1)]),t._v(" "),e("SendCommentPopup",{ref:"sendCommentPopup"}),t._v(" "),e("UserDetailPopup",{ref:"userDetailPopup"}),t._v(" "),e("EditProfilePopup",{ref:"editProfilePopup"}),t._v(" "),e("ChangeAvatarPopup",{ref:"changeAvatarPopup"}),t._v(" "),e("ChangePinPopup",{ref:"changePinPopup"}),t._v(" "),e("ChangePasswordPopup",{ref:"changePasswordPopup"})],1)}),[],!1,null,null,null);e.default=h.exports},"F9O+":function(t,e,o){"use strict";var a=o("L2JU"),i=o("Ztyd"),s=o("uPXb"),n=o.n(s);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach((function(e){d(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function d(t,e,o){return(e=function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var a=o.call(t,e||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var p={components:{DxForm:i.DxForm,DxItem:i.DxItem,DxTextArea:n.a},data:function(){return{isLoading:!1,formData:null,banks:[],validationRules:{name:[{type:"required",message:this.$t("models.user.name")+this.$mt.validations.required},{type:"stringLength",max:50,message:this.$t("models.user.validations.name")}],sex:[{type:"required",message:this.$t("models.user.sex")+this.$mt.validations.required}],birthday:[{type:"required",message:this.$t("models.user.birthday")+this.$mt.validations.required},{type:"custom",validationCallback:this.validateBirthday,message:this.$t("models.user.validations.birthday")}],idNumber:[{type:"required",message:this.$t("models.user.idNumber")+this.$mt.validations.required},{type:"async",validationCallback:this.validateDuplicateIdNumber,message:this.$t("models.user.idNumber")+this.$mt.validations.duplicate}],idIssuedOn:[{type:"required",message:this.$t("models.user.idIssuedOn")+this.$mt.validations.required},{type:"custom",validationCallback:this.validateIdIssuedOn,message:this.$t("models.user.validations.idIssuedOn")}],phone:[{type:"required",message:this.$t("models.user.phone")+this.$mt.validations.required},{type:"async",validationCallback:this.validateDuplicatePhone,message:this.$t("models.user.phone")+this.$mt.validations.duplicate}],email:[{type:"required",message:this.$t("models.user.email")+this.$mt.validations.required},{type:"email",message:this.$t("models.user.email")+this.$mt.validations.email},{type:"async",validationCallback:this.validateDuplicateEmail,message:this.$t("models.user.email")+this.$mt.validations.duplicate}],address:[{type:"required",message:this.$t("models.user.address")+this.$mt.validations.required},{type:"stringLength",max:100,message:this.$t("models.user.validations.address")}],bankAccount:{bankName:[{type:"required",message:this.$t("models.user.bankName")+this.$mt.validations.required}],accountName:[{type:"required",message:this.$t("models.user.accountName")+this.$mt.validations.required}],accountNumber:[{type:"required",message:this.$t("models.user.accountNumber")+this.$mt.validations.required},{type:"numeric",message:this.$t("models.user.accountNumber")+this.$mt.validations.numeric}]}}}},computed:u(u({},Object(a.c)("User.profile",["profile"])),{},{popup:function(){return this.$refs.popup.instance},form:function(){return this.$refs.form.instance}}),methods:u(u({},Object(a.b)("User.profile",["fetch","save","validateDuplicateEmail","validateDuplicateIdNumber","validateDuplicatePhone"])),{},{show:function(){var t=this;this.isLoading=!0,this.popup.show(),this.fetch().then((function(){t.formData=t.$mf.cloneDeep(t.profile),setTimeout((function(){return t.form.getEditor("name").focus()}),500),t.$mf.getBanks().then((function(e){return t.banks=e})),t.isLoading=!1})),this.$mf.pushPopupToHistoryState((function(){return t.popup.hide()}))},onSubmit:function(){var t=this;this.$bus.emit("checkPin",(function(){t.save(t.formData).then((function(e){e&&t.popup.hide()}))}))},validateBirthday:function(t){return moment(t.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn:function(t){return moment(t.value).isBefore(moment().subtract(1,"day"))},saveClick:function(){this.form.getButton("submit").element().click()}})},c=o("KHd+"),m=Object(c.a)(p,(function(){var t=this,e=t._self._c;return e("div",[e("DxPopup",{ref:"popup",attrs:{showCloseButton:!0,fullScreen:!!t.$devices.phone,"show-title":!0,title:t.$t("components.editProfile.title"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:t.$t("buttons.save"),onClick:function(){return t.form.getButton("submit").element().click()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:t.$t("buttons.cancel"),onClick:function(){return t.popup.hide()}}}]},on:{hiding:t.$mf.popRouteHistoryState},scopedSlots:t._u([{key:"content",fn:function(){return[e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("button",{ref:"submit",staticClass:"display-none"}),t._v(" "),e("DxForm",{ref:"form",staticClass:"profile-form",attrs:{"form-data":t.formData,labelMode:"floating","col-count":2,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[e("DxItem",{attrs:{"item-type":"group",caption:t.$t("models.user.groups.personalInfo")}},[e("DxItem",{attrs:{"data-field":"name","validation-rules":t.validationRules.name,label:{text:t.$t("models.user.name")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"sex","editor-type":"dxSelectBox","editor-options":{searchEnabled:!1,items:t.$mf.getSexList(),displayExpr:"name",valueExpr:"value",placeholder:t.$t("titles.dxSelectPlacehoder")},"validation-rules":t.validationRules.sex,label:{text:t.$t("models.user.sex")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"birthday","editor-type":"dxDateBox","editor-options":{dateSerializationFormat:t.$mc.DX_SERVER_DATE_FORMAT,showClearButton:"true",useMaskBehavior:"true"},"validation-rules":t.validationRules.birthday,label:{text:t.$t("models.user.birthday")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group",caption:t.$t("models.user.groups.idInfo")}},[e("DxItem",{attrs:{"data-field":"identity.number",editorOptions:{mask:"000000000000"},"validation-rules":t.validationRules.idNumber,label:{text:t.$t("models.user.idNumber")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"identity.issued_on","editor-type":"dxDateBox","editor-options":{dateSerializationFormat:t.$mc.DX_SERVER_DATE_FORMAT,showClearButton:"true",useMaskBehavior:"true"},"validation-rules":t.validationRules.idIssuedOn,label:{text:t.$t("models.user.idIssuedOn")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"",editorOptions:{value:t.$mt.idIssuedAtValue,readOnly:!0},label:{text:t.$t("models.user.idIssuedAt")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group","col-span":2,"col-count":2,caption:t.$t("models.user.groups.contactInfo")}},[e("DxItem",{attrs:{"data-field":"phone",editorOptions:{mask:"0000.000.000"},"validation-rules":t.validationRules.phone,label:{text:t.$t("models.user.phone")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"email","validation-rules":t.validationRules.email,label:{text:t.$t("models.user.email")}}}),t._v(" "),e("DxItem",{attrs:{"col-span":2,"data-field":"address","editor-type":"dxTextArea","validation-rules":t.validationRules.address,label:{text:t.$t("models.user.address")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group","col-span":2,"col-count":2,caption:t.$t("models.user.groups.bankInfo")}},[e("DxItem",{attrs:{"data-field":"bank_account.bank_name","editor-type":"dxSelectBox","editor-options":{searchEnabled:!0,items:t.banks,displayExpr:"short_name",searchExpr:"short_name",valueExpr:"short_name",placeholder:t.$t("titles.dxSelectPlacehoder")},"validation-rules":t.validationRules.bankAccount.bankName,label:{text:t.$t("models.user.bankName")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"bank_account.account_number","validation-rules":t.validationRules.bankAccount.accountNumber,label:{text:t.$t("models.user.accountNumber")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"bank_account.account_name","editor-type":"dxTextBox","editor-options":{inputAttr:{style:"text-transform: uppercase"}},"validation-rules":t.validationRules.bankAccount.accountName,label:{text:t.$t("models.user.accountName")}}})],1),t._v(" "),e("DxItem",{attrs:{name:"submit",cssClass:"display-none","item-type":"button","button-options":{useSubmitBehavior:!0}}})],1),t._v(" "),e("DxLoadPanel",{attrs:{position:{of:".profile-form"},visible:t.isLoading,shading:!1}})],1)]},proxy:!0}])})],1)}),[],!1,null,null,null);e.a=m.exports},Y3PJ:function(t,e,o){(t.exports=o("I1BE")(!1)).push([t.i,".profile-page .info{display:flex}.profile-page .info .avatar{float:left;height:170px;width:170px;margin-right:20px;background-size:contain;background-repeat:no-repeat;background-position:50%;background-color:#fff;overflow:hidden;border-radius:50%;border:2px solid rgba(0,0,0,.1)}.profile-page .info .avatar img{height:170px;display:block;margin:0 auto}.profile-page .info .personal>div{display:flex}.profile-page .info .personal>div>span:first-child{color:#b3b3b3;width:110px}.profile-page .info .personal>div>span:last-child{font-size:18px}.profile-page .info .personal>div>span:last-child.name{font-weight:700}.profile-page .info .personal .detail{margin-top:20px}.profile-page .info .personal .detail .dx-button-text{text-transform:none!important}.profile-page .dx-card .title{font-size:18px;margin-bottom:20px}.profile-page .dx-card .content{display:flex;justify-content:space-between;align-items:center}.profile-page .dx-card .content .dx-button{margin-left:20px;flex:0 0 180px}.profile-page .delete{border:2px solid red}.profile-page .delete .title{color:red}body[screen-size=small] .profile-page .info{flex-direction:column}body[screen-size=small] .profile-page .info .avatar{margin:0 auto 30px}",""])},cA9T:function(t,e,o){var a=o("Y3PJ");"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};o("aET+")(a,i);a.locals&&(t.exports=a.locals)},"e+zl":function(t,e,o){"use strict";var a=o("Ztyd"),i=o("uPXb"),s=o.n(i),n={components:{DxForm:a.DxForm,DxItem:a.DxItem,DxTab:a.DxTab,DxTextArea:s.a},data:function(){return{isLoading:!1,formData:{url_documents:[]}}},computed:{popup:function(){return this.$refs.popup.instance},hasConfirmedDocs:function(){return this.formData.url_documents.length>0}},methods:{show:function(t){var e=this,o=t.user,a=t.getUser;o?(this.popup.option("title","".concat(this.$t("admin.users.detailUser")," #").concat(o.code)),this.formData=o,this.popup.show()):(this.popup.option("title",this.$t("admin.users.detailUser")),this.popup.show(),this.isLoading=!0,a().then((function(t){e.formData=t,e.isLoading=!1}))),this.$mf.pushPopupToHistoryState((function(){return e.popup.hide()}))}}},r=o("KHd+"),l=Object(r.a)(n,(function(){var t=this,e=t._self._c;return e("DxPopup",{ref:"popup",attrs:{showCloseButton:!0,fullScreen:!!t.$devices.phone,"show-title":!0},on:{hiding:t.$mf.popRouteHistoryState},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",[e("DxForm",{ref:"form",staticClass:"user-detail-form",attrs:{"form-data":t.formData,"col-count":2,"read-only":!0,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[e("DxItem",{attrs:{"item-type":"group",caption:t.$t("models.user.groups.personalInfo")}},[e("DxItem",{attrs:{"data-field":"name",label:{text:t.$t("models.user.name")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"sex","editor-type":"dxSelectBox","editor-options":{items:t.$mf.getSexList(),displayExpr:"name",valueExpr:"value"},label:{text:t.$t("models.user.sex")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"birthday","editor-type":"dxDateBox",label:{text:t.$t("models.user.birthday")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group",caption:t.$t("models.user.groups.idInfo")}},[e("DxItem",{attrs:{"data-field":"identity.number",label:{text:t.$t("models.user.idNumber")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"identity.issued_on","editor-type":"dxDateBox",label:{text:t.$t("models.user.idIssuedOn")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"",editorOptions:{value:t.$mt.idIssuedAtValue},label:{text:t.$t("models.user.idIssuedAt")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group","col-span":2,"col-count":2,caption:t.$t("models.user.groups.contactInfo")}},[e("DxItem",{attrs:{"data-field":"phone",editorOptions:{mask:t.formData.phone?"0000.000.000":null},label:{text:t.$t("models.user.phone")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"email",label:{text:t.$t("models.user.email")}}}),t._v(" "),e("DxItem",{attrs:{"col-span":2,"data-field":"address",label:{text:t.$t("models.user.address")}}})],1),t._v(" "),e("DxItem",{attrs:{"item-type":"group","col-span":2,caption:t.$t("models.user.groups.bankInfo")}},[e("DxItem",{attrs:{"data-field":"bank_account.bank_name",label:{text:t.$t("models.user.bankName")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"bank_account.account_number",label:{text:t.$t("models.user.accountNumber")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"bank_account.account_name",label:{text:t.$t("models.user.accountName")}}})],1),t._v(" "),e("DxItem",{attrs:{visible:t.hasConfirmedDocs,"item-type":"group","col-span":2,caption:t.$t("models.user.groups.confirmDocuments")}},[e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("Photoswipe",{on:{opened:t.$mf.pushPhotoswipeToHistoryState,close:t.$mf.popRouteHistoryState}},t._l(t.formData.url_documents,(function(o,a){return e("div",{key:a},[e("img",{directives:[{name:"pswp",rawName:"v-pswp",value:o.file,expression:"image.file"}],attrs:{src:o.file,alt:t.$appName}})])})),0)]},proxy:!0}])})],1)],1),t._v(" "),e("DxLoadPanel",{attrs:{position:{of:".user-detail-form"},visible:t.isLoading,shading:!1}})],1)]},proxy:!0}])})}),[],!1,null,null,null);e.a=l.exports}}]);