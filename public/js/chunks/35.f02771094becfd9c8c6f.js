(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"0TQy":function(t,e,n){"use strict";var o=n("wMWa"),i={components:{DxTagBox:n.n(o).a},props:{width:{type:Number,default:function(){return 300}},height:{type:Number,default:function(){return 400}},value:{type:Array,default:function(){return[]}},onValueChanged:{type:Function,default:function(){return function(){}}},dataSource:{type:Array,default:function(){return[]}},dataGridComponent:{type:Object,default:function(){}}},data:function(){return{currentValue:this.value}},methods:{onSelectionChanged:function(){this.dataGridComponent.updateDimensions()}}},a=n("KHd+"),r=Object(a.a)(i,(function(){var t=this;return(0,t._self._c)("DxTagBox",{attrs:{"data-source":t.dataSource,value:t.currentValue,"show-selection-controls":!0,"max-displayed-tags":3,"show-multi-tag-only":!1,"on-value-changed":function(e){return t.onValueChanged(e.value)},"on-selection-changed":t.onSelectionChanged,"search-enabled":!0,dropDownOptions:{width:t.width,height:t.height}}})}),[],!1,null,"4e06e37a",null);e.a=r.exports},jyy7:function(t,e,n){"use strict";n.r(e);var o=n("L2JU"),i=n("0TQy"),a=n("0woa");function r(){return{roles:[],permissions:[]}}var s={namespaced:!0,state:r,getters:{roles:function(t){return t.roles},permissions:function(t){return t.permissions}},actions:{validateDuplicateName:function(t,e){var n=t.state,o=(t.rootGetters,n.roles.find((function(t){return t.id===e.data.id})));return o&&e.value==o.name?Promise.resolve(!0):new Promise((function(t,n){axios.post("settings/roles/validate-duplicate-name",{name:e.value},{noLoading:!0}).then((function(e){t(e.data)}))}))},fetch:function(t){var e=t.commit;t.dispatch,t.getters,t.state,t.rootGetters;return new Promise((function(t,n){axios.get("settings/roles").then((function(n){e("setState",n.data),t()}))}))},save:function(t,e){t.commit;var n=t.dispatch;t.getters,t.state,t.rootGetters;return new Promise((function(t,o){axios.post("settings/roles",{changes:e.changes}).then((function(e){t(),n("fetch")}))}))},resetState:function(t){(0,t.commit)("resetState")}},mutations:{setState:function(t,e){t.roles=e.roles,t.permissions=e.permissions},resetState:function(t){t=Object.assign(t,{roles:[],permissions:[]})}}};function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==l(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m={components:{ListTagBox:i.a,DxDataGrid:a.DxDataGrid,DxColumn:a.DxColumn},data:function(){return{gridData:null,calculateFilterExpression:function(t,e,n){return"search"===n&&"string"==typeof t?[this.dataField,"contains",t]:function(e){return-1!==(e.permissions||[]).indexOf(t)}},validationRules:{name:[{type:"required",message:this.$t("settings.roles.name")+this.$mt.validations.required},{type:"async",validationCallback:this.validateDuplicateName,message:this.$t("settings.roles.name")+this.$mt.validations.duplicate}],permissions:[{type:"required",message:this.$t("settings.roles.permission")+this.$mt.validations.required}]}}},beforeCreate:function(){this.$store.registerModule("Settings.roles",s)},created:function(){this.fetch()},destroyed:function(){this.$store.unregisterModule("Settings.roles")},watch:{roles:function(){this.cloneDeepData()}},computed:c(c({},Object(o.c)("Settings.roles",["roles","permissions"])),{},{dataGrid:function(){return this.$refs.dataGrid.instance}}),methods:c(c({},Object(o.b)("Settings.roles",["fetch","save","validateDuplicateName","resetState"])),{},{onSave:function(t){var e=this;this.$bus.emit("checkPin",(function(){return e.save(t)}))},cloneDeepData:function(){this.gridData=this.$mf.cloneDeep(this.roles)},cellTemplate:function(t,e){var n=(e.value||[]).map((function(t){return e.column.lookup.calculateCellValue(t)})).join(", ");t.textContent=n||"Â ",t.title=n},onValueChanged:function(t,e){e.setValue(t),e.component.updateDimensions()}})},p=n("KHd+"),f=Object(p.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"settings-page"},[e("h2",{staticClass:"content-block"},[t._v("\n        "+t._s(t.$t("settings.roles.title"))+"\n    ")]),t._v(" "),e("div",{staticClass:"content-block dx-card responsive-paddings"},[e("DxDataGrid",{ref:"dataGrid",attrs:{"data-source":t.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,mode:"batch",startEditAction:"dblClick"}},on:{contentReady:function(e){return t.$mf.dataGridPreload(t.gridData,t.dataGrid)},saved:t.onSave},scopedSlots:t._u([{key:"tagBoxEditor",fn:function(n){var o=n.data;return[e("ListTagBox",{attrs:{width:300,height:400,value:o.value,"on-value-changed":function(e){return t.onValueChanged(e,o)},"data-source":t.permissions,"data-grid-component":o.component}})]}},{key:"commandCellTemplate",fn:function(n){var o=n.data;return[e("DxToolbar",{attrs:{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:t.$t("buttons.delete"),text:t.$t("buttons.delete"),onClick:function(){t.dataGrid.deleteRow(o.rowIndex)}}}]}})]}}])},[e("DxColumn",{attrs:{fixed:!0,width:35,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:t.$t("titles.commandHeaderTitleShort")}}),t._v(" "),e("DxColumn",{attrs:{"data-field":"name","header-filter":{allowSearch:!0},caption:t.$t("settings.roles.name"),"validation-rules":t.validationRules.name}}),t._v(" "),e("DxColumn",{attrs:{"allow-sorting":!1,"data-field":"permissions","cell-template":t.cellTemplate,"calculate-filter-expression":t.calculateFilterExpression,"header-filter":{allowSearch:!0},"edit-cell-template":"tagBoxEditor",caption:t.$t("settings.roles.permission"),"validation-rules":t.validationRules.permissions,lookup:{dataSource:t.permissions}}})],1)],1)])}),[],!1,null,"45d2bb58",null);e.default=f.exports}}]);