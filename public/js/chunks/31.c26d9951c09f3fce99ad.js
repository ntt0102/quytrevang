(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"2z4B":function(t,e,r){"use strict";r("mAM7")},Y7df:function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.r(e);var i=r("L2JU"),s=r("Ztyd"),a=r.n(s),u=r("lFqG"),l=r.n(u);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==m(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===m(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var d={components:{DxForm:a.a,DxItem:s.DxItem,DxDropDownButton:l.a},data:function(){return{passwordMode:!0,loggedinUsers:[],formData:{username:null,password:null,rememberMe:!1,avatar:null,name:null},validationRules:{username:[{type:"required",message:this.$t("models.user.username")+this.$mt.validations.required}],password:[{type:"required",message:this.$t("models.user.password")+this.$mt.validations.required}]}}},created:function(){this.loggedinUsers=this.getLoggedinUsersCookie(),this.loggedinUsers.length>0&&(this.loggedinUsers.reverse(),this.formData=f(f({},this.formData),this.loggedinUsers[0]))},mounted:function(){var t=this;this.$devices.phone&&this.formData.webauthn?this.fingerPrintClick():setTimeout((function(){return t.form.getEditor(t.formData.name?"password":"username").focus()}),500)},computed:{form:function(){return this.$refs.form.instance}},methods:f(f({},Object(i.b)("Auth",["login","setState","loginWebAuthn"])),{},{onSubmit:function(){var t=this;this.login(this.formData).then((function(e){var r=e.isOk,n=e.isMaintenance,o=e.user;return t.responseProcess(r,n,o)}))},fingerPrintClick:function(){var t=this;if(this.formData.username){var e={},r=this.formData.username.includes("@")?"email":"phone";e[r]=this.formData.username,e.username=r,e.routeAction="assert",this.loginWebAuthn(e).then((function(e){var r=e.isOk,n=e.isMaintenance,o=e.user;return t.responseProcess(r,n,o)})).catch((function(){return t.$toasted.show(t.$t("messages.warning.unregisteredFingerPrint"))}))}else this.$toasted.show(this.$t("messages.warning.fingerUsernameEmpty"))},responseProcess:function(t,e,r){if(t)if(this.setLoggedinUsersCookie(r),e)this.$router.push({name:"settings",hash:"#command"});else{var n=this.$route.query,o=n.redirect?n.redirect:"overview";delete n.redirect,this.$router.push({name:o,query:n,hash:this.$route.hash})}},onCreateAccountClick:function(){this.$router.push({name:"create-account"})},viewPasswordClick:function(){this.form.itemOption("password",{editorOptions:{mode:this.passwordMode?"text":"password",buttons:[{options:{icon:this.passwordMode?"far fa-eye-slash":"far fa-eye",onClick:this.viewPasswordClick},name:"btPw",location:"after"}]}}),this.passwordMode=!this.passwordMode},getLoggedinUsersCookie:function(){return this.$cookies.isKey(this.$mc.LOGGEDIN_USERS_COOKIE_NAME)?this.$cookies.get(this.$mc.LOGGEDIN_USERS_COOKIE_NAME):[]},setLoggedinUsersCookie:function(t){var e=this.getLoggedinUsersCookie();(e=e.filter((function(e){return e.username!=t.username}))).push(t),e=e.slice(-5),this.$cookies.set(this.$mc.LOGGEDIN_USERS_COOKIE_NAME,e,"1y")},onItemClick:function(t){var e=this;t.itemData.username?(this.formData=f(f({},this.formData),t.itemData),this.$devices.phone&&t.itemData.webauthn?this.fingerPrintClick():setTimeout((function(){return e.form.getEditor("password").focus()}),500)):(this.formData.username=null,this.formData.name=null,this.formData.avatar=null,setTimeout((function(){return e.form.getEditor("username").focus()}),500))}})},g=(r("2z4B"),r("KHd+")),h=Object(g.a)(d,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("auth.login.title")))])]),t._v(" "),e("div",{staticClass:"login-form"},[t.formData.name?e("div",{staticClass:"user"},[e("Photoswipe",{on:{opened:t.$mf.pushPhotoswipeToHistoryState,close:t.$mf.popRouteHistoryState}},[e("img",{directives:[{name:"pswp",rawName:"v-pswp",value:t.formData.avatar,expression:"formData.avatar"}],staticClass:"avatar",attrs:{alt:t.$appName,src:t.formData.avatar}})]),t._v(" "),e("DxDropDownButton",{attrs:{"split-button":!0,"use-select-mode":!1,items:[].concat(n(t.loggedinUsers),[{name:t.$t("auth.login.anotherAccount")}]),text:t.formData.name,"display-expr":"name","key-expr":"username",itemTemplate:"itemTemplate",dropDownOptions:{minWidth:260,wrapperAttr:{class:"login-users-popup"}}},on:{"item-click":t.onItemClick},scopedSlots:t._u([{key:"itemTemplate",fn:function(r){var n=r.data;return[e("div",{staticStyle:{display:"flex","align-items":"center"}},[n.avatar?e("img",{staticStyle:{width:"30px","border-radius":"50%","margin-right":"5px"},attrs:{alt:t.$appName,src:n.avatar}}):t._e(),t._v(" "),e("span",{staticStyle:{"font-size":"16px",padding:"5px"}},[t._v(t._s(n.name))])])]}}],null,!1,2383316716)})],1):t._e(),t._v(" "),e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("DxForm",{ref:"form",attrs:{"form-data":t.formData,labelMode:"floating"}},[e("DxItem",{attrs:{visible:!t.formData.name,"data-field":"username","editor-type":"dxTextBox","validation-rules":t.validationRules.username,label:{text:t.$t("models.user.username")}}}),t._v(" "),e("DxItem",{attrs:{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:t.viewPasswordClick},name:"btPw",location:"after"}]},"validation-rules":t.validationRules.password,label:{text:t.$t("models.user.password")}}}),t._v(" "),e("DxItem",{attrs:{"data-field":"rememberMe","editor-type":"dxCheckBox","editor-options":{text:t.$t("auth.login.rememberMe"),elementAttr:{class:"form-text"}},label:{visible:!1}}}),t._v(" "),e("DxItem",{attrs:{"item-type":"button","button-options":{width:"100%",type:"default",text:t.$t("auth.login.submit"),useSubmitBehavior:!0}}})],1)],1),t._v(" "),e("div",{staticClass:"fingerprint"},[e("DxButton",{attrs:{icon:"../../../images/fingerprint.png"},on:{click:t.fingerPrintClick}})],1),t._v(" "),e("DxForm",[e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"link"},[e("RouterLink",{attrs:{to:{name:"reset-password"}}},[t._v(t._s(t.$t("auth.login.forgotPassword")))])],1)]},proxy:!0}])}),t._v(" "),e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"create-account"},[e("span",[t._v(t._s(t.$t("auth.login.haveNotAccount")))]),t._v(" "),e("span",{staticClass:"link"},[e("RouterLink",{attrs:{to:{name:"create-account"}}},[t._v(t._s(t.$t("auth.login.createAccount")))])],1)])]},proxy:!0}])})],1)],1)])}),[],!1,null,null,null);e.default=h.exports},kvSw:function(t,e,r){(e=t.exports=r("I1BE")(!1)).push([t.i,".login-form .user{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.login-form .user .avatar{width:50px;margin-bottom:10px;border-radius:50%}.login-form .dx-field-item:not(.dx-field-item-has-group):not(.dx-field-item-has-tabs):not(.dx-first-row):not(.dx-label-v-align){padding-top:10px}.login-form .link{text-align:center;font-size:16px;font-style:normal}.login-form .link a{text-decoration:none}.login-form .create-account{text-align:center}.login-form .form-text{margin:10px 0;color:hsla(0,0%,100%,.7)}.login-form .dx-button-text{display:inline;vertical-align:middle}.login-form .dx-button-submit-input{display:none}.login-form .fa-eye,.login-form .fa-eye-slash{font-size:18px}.login-form .fingerprint{text-align:center;margin-top:7px;margin-bottom:20px}.login-form .fingerprint .dx-button{width:57px;height:57px;border-radius:5px!important}.login-form .fingerprint .dx-button .dx-button-content{width:56px;height:56px}.login-form .fingerprint .dx-button .dx-icon{width:55px;height:55px;margin-top:-5px;margin-left:-5px}.login-users-popup .dx-overlay-content{background:#4d4d5c}.login-users-popup .dx-overlay-content .dx-list-item-content{padding:5px 5px 5px 10px}",""]),e.locals={baseAccent:"#ff5722"}},mAM7:function(t,e,r){var n=r("kvSw");"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(t.exports=n.locals)}}]);