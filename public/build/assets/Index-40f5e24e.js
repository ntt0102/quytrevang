import{C as v,bl as $,T as C,B as r,f as n,g as p,h as o,j as s,t,p as _,o as d}from"./app-bc7a04b5.js";import{U as k}from"./UserDetailPopup-d5352567.js";import b from"./EditProfilePopup-aca5bcd6.js";import D from"./ChangeAvatarPopup-cc40fdce.js";import w from"./ChangePinPopup-0e57c9dd.js";import y from"./ChangePasswordPopup-2778d0fe.js";const B={components:{SendCommentPopup:$,UserDetailPopup:k,EditProfilePopup:b,ChangeAvatarPopup:D,ChangePinPopup:w,ChangePasswordPopup:y},data(){return{isLoading:!0,formData:{}}},mounted(){this.$route.hash==="#detail"&&this.detailInfoClick()},computed:{...C("Auth",["name","code","phone","email","avatar","level"]),popup(){return this.$refs.popup.instance}},methods:{...r("Auth",["clearData"]),...r("User.profile",["fetch","save","delete"]),onSubmit(){this.$refs.editProfileForm.$refs.form.instance.validate().isValid&&(this.popup.option("toolbarItems[0].options.disabled",!0),this.save(this.formData).then(()=>{this.popup.hide(),this.$toasted.success(this.$mt.messages.success.saved)}))},cloneDeepData(){this.formData=this.$mf.cloneDeep(this.profile),this.isLoading=!1},validateBirthday(e){return moment(e.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn(e){return moment(e.value).isBefore(moment().subtract(1,"day"))},detailInfoClick(){this.$refs.userDetailPopup.show({getUser:()=>this.fetch()})},onDeleteClick(){this.$bus.emit("checkPin",()=>{this.delete().then(e=>{e&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),this.clearData(),this.$router.push({name:"login"}))})})}}},A={class:"profile-page"},I={class:"content-block dx-card responsive-paddings"},U={class:"info"},q=o("div",{class:"avatar"},null,-1),S={class:"personal"},E={class:"name"},T={key:0},V={class:"content-block dx-card responsive-paddings change"},L={class:"title"},N={class:"content"},O={class:"content-block dx-card responsive-paddings delete"},R={class:"title"},G={class:"content"};function W(e,a,j,F,M,l){const u=n("DxToolbar"),i=n("DxButton"),c=n("SendCommentPopup"),m=n("UserDetailPopup"),f=n("EditProfilePopup"),h=n("ChangeAvatarPopup"),P=n("ChangePinPopup"),g=n("ChangePasswordPopup");return d(),p("div",A,[o("div",I,[s(u,{items:[{visible:!!e.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>{e.$router.push({name:e.$route.query.redirect})}}},{visible:e.level<5,location:"before",widget:"dxButton",cssClass:"guiding-step-2b",options:{icon:"far fa-user-edit small",hint:e.$t("components.editProfile.title"),onClick:()=>e.$refs.editProfilePopup.show()}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:e.$t("components.changeAvatar.title"),onClick:()=>e.$refs.changeAvatarPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:e.$t("components.changePin.title"),onClick:()=>e.$refs.changePinPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:e.$t("components.changePassword.title"),onClick:()=>e.$refs.changePasswordPopup.show()}}]},null,8,["items"]),o("div",U,[q,o("div",S,[o("div",null,[o("span",null,t(e.$t("models.user.name"))+":",1),o("span",E,t(e.name),1)]),o("div",null,[o("span",null,t(e.$t("models.user.code"))+":",1),o("span",null,t(e.code),1)]),e.phone?(d(),p("div",T,[o("span",null,t(e.$t("models.user.phone"))+":",1),o("span",null,t(e.phone|e.phone),1)])):_("",!0),o("div",null,[o("span",null,t(e.$t("models.user.email"))+":",1),o("span",null,t(e.email),1)]),s(i,{width:"170",class:"detail",type:"default","styling-mode":"outlined",text:e.$t("user.profile.detailInfo"),onClick:l.detailInfoClick},null,8,["text","onClick"])])])]),o("div",V,[o("div",L,t(e.$t("user.profile.changeRequest.title")),1),o("div",N,[o("div",null,t(e.$t("user.profile.changeRequest.desctiption")),1),s(i,{text:e.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained",onClick:a[0]||(a[0]=z=>e.$refs.sendCommentPopup.show())},null,8,["text"])])]),o("div",O,[o("div",R,t(e.$t("user.profile.delete.title")),1),o("div",G,[o("div",null,t(e.$t("user.profile.delete.desctiption")),1),s(i,{text:e.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained",onClick:l.onDeleteClick},null,8,["text","onClick"])])]),s(c,{ref:"sendCommentPopup"},null,512),s(m,{ref:"userDetailPopup"},null,512),s(f,{ref:"editProfilePopup"},null,512),s(h,{ref:"changeAvatarPopup"},null,512),s(P,{ref:"changePinPopup"},null,512),s(g,{ref:"changePasswordPopup"},null,512)])}const Z=v(B,[["render",W]]);export{Z as default};
