import{u as Je,b as Qe,c as et,i as j,r as g,d as tt,e as T,x as st,w as ot,f as it,g as lt,j as P,h as f,l as U,z as x,A as $,E as D,C as at,G as R,v as rt,o as nt,H as ct}from"./app-17d91261.js";import dt from"./ColorPicker-e83a0a4c.js";import{c as pt}from"./lightweight-charts.esm.development-03366bac.js";import{_ as X}from"./select-box-388a339a.js";const mt={class:"content-block dx-card responsive-paddings"},ut=["title"],ft=["title"],ht=["title"],gt=["title"],vt=["title"],yt=["title"],bt=["title"],kt=["title"],wt=["title"],Ct=["title"],Lt=["title"],St=["title"],Tt=["title"],Pt=["title"],xt=["src"],_t={__name:"Index",setup($t){const H={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.25,bottom:.35}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!1,rightOffset:20,minBarSpacing:.01},watermark:{visible:!0,fontSize:50,horzAlign:"center",vertAlign:"center",color:"rgba(171, 71, 188, 0.2)"}},c=Je(),I=Qe(),{t:h}=et(),Z=j("devices"),p=j("mf"),y=g(null),z=g(null),G=g(null),J=g(null),Q=g(null),w=g(null),F=g(null),E=g(null),_=g(null),V=g(null),O=g(null),ee=g(null);let e={chart:{},series:{},data:{ohlc:[],price:[],cash:[]},tools:{lines:[],target:{A:{},B:{},X:{},Y:{},Z:{}},uplps:{P1:{},P2:{},C1:{},C2:{}},downlps:{P1:{},P2:{},C1:{},C2:{}},rr:{EP:{},SL:{},TP:{}},range:[]},fundSize:0,losePerOrder:0,crosshair:{},isCashDraw:!1,isOnlyLoadData:!1,showNewsInfo:!1};const r=tt({symbol:I.query.symbol??"VNINDEX",timeframe:"D",symbolKind:null,symbolKinds:[{text:h("trading.stock.symbolList.hose"),value:"hose"},{text:h("trading.stock.symbolList.nh"),value:"nh"},{text:h("trading.stock.symbolList.ck"),value:"ck"},{text:h("trading.stock.symbolList.filterCash"),value:"f_cash"},{text:h("trading.stock.symbolList.filterMix"),value:"f_mix"},{text:h("trading.stock.symbolList.watch"),value:"watch"},{text:h("trading.stock.symbolList.hold"),value:"hold"},{text:h("trading.stock.symbolList.hnx"),value:"hnx"}],color:"#F44336",showColorPicker:!1,isFullscreen:!1,showTradingView:!1});r.symbolKind=I.query.list??"hose";const te=T(()=>`https://chart.vps.com.vn/tv/?symbol=${r.symbol}`),W=T(()=>c.state.tradingStock.symbols.watch.includes(r.symbol)),se=T(()=>c.state.tradingStock.symbols[r.symbolKind]),oe=T(()=>c.state.tradingStock.chart.dividend?" dividend":"");c.dispatch("tradingStock/getSymbols"),st(()=>{e.chart=pt(z.value,H),e.chart.subscribeCrosshairMove(le),e.chart.subscribeCustomPriceLineDragged(ae),e.series.range=e.chart.addHistogramSeries({priceScaleId:"range",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1}),e.series.events=e.chart.addHistogramSeries({priceScaleId:"events",scaleMargins:{top:.96,bottom:0},lastValueVisible:!1,priceLineVisible:!1}),e.series.vnindex=e.chart.addLineSeries({priceScaleId:"vnindex",scaleMargins:{top:.05,bottom:.76},color:"aqua",priceFormat:{minMove:.01},lastValueVisible:!1}),e.series.cash=e.chart.addLineSeries({priceScaleId:"cash",scaleMargins:{top:.66,bottom:.05},color:"yellow",priceFormat:{type:"volume",minMove:1},lastValueVisible:!1}),e.series.ohlc=e.chart.addCandlestickSeries({upColor:"#42946C",downColor:"#BC3E4A",borderVisible:!1,wickUpColor:"#42946C",wickDownColor:"#BC3E4A",priceFormat:{minMove:.01}}),e.series.price=e.chart.addLineSeries({color:"#CCCCCC",priceFormat:{minMove:.01},lastValueVisible:!1,priceLineVisible:!1}),new ResizeObserver(re).observe(y.value),document.addEventListener("fullscreenchange",ne),c.dispatch("tradingStock/initChart",{symbol:r.symbol,timeframe:r.timeframe,vnindex:!0}).then(t=>{e.series.vnindex.setData(t.chart.vnindex),e.tools.range=t.range,e.series.range.setData(t.range),e.fundSize=t.fundSize,e.losePerOrder=t.losePerOrder})}),ot(()=>c.state.tradingStock.chart,()=>{e.isOnlyLoadData||(me(),fe()),he()});function C(t){t.preventDefault(),t.stopPropagation()}function ie(t){w.value.classList.contains("selected")?ke():F.value.classList.contains("selected")?Le():E.value.classList.contains("selected")?K():_.value.classList.contains("selected")?Y():V.value.classList.contains("selected")?Ve():O.value.classList.contains("selected")?Me():ze(),C(t)}function le(t){if(t.time){let o=t.seriesPrices.get(e.series.price);e.crosshair.time=t.time,e.crosshair.price=o}else Z.phone||(e.crosshair.time=null,e.crosshair.price=null);t.point!=null&&(e.crosshair.x=t.point.x,e.crosshair.y=t.point.y)}function ae(t){let o=t.customPriceLine,s=o.options();s.price=B(s.price);const i=+t.fromPriceString;switch(+s.price,s.lineType){case"line":c.dispatch("tradingStock/drawTools",{isRemove:!1,symbol:r.symbol,name:s.lineType,points:[i],data:[s]}),w.value.classList.remove("selected");break;case"target":if(p.isSet(e.tools.target.B)){let l={isRemove:!1,symbol:r.symbol,name:"target",points:[],data:[]},a;const n=+e.tools.target.A.options().price,u=+e.tools.target.B.options().price-n;s.point=="A"&&(a="A",l.points.push(a),l.data.push(e.tools.target[a].options())),a="B",e.tools.target[a].applyOptions({title:(100*u/n).toFixed(1)+"%"}),l.points.push(a),l.data.push(e.tools.target[a].options()),a="X",e.tools.target[a].applyOptions({price:+(n-.5*u).toFixed(2),title:(100*-.5*u/n).toFixed(1)+"%"}),l.points.push(a),l.data.push(e.tools.target[a].options()),a="Y",e.tools.target[a].applyOptions({price:+(n-u).toFixed(2),title:(100*-u/n).toFixed(1)+"%"}),l.points.push(a),l.data.push(e.tools.target[a].options()),a="Z",e.tools.target[a].applyOptions({price:+(n-2*u).toFixed(2),title:(100*-2*u/n).toFixed(1)+"%"}),l.points.push(a),l.data.push(e.tools.target[a].options()),c.dispatch("tradingStock/drawTools",l)}break;case"rr":if(p.isSet(e.tools.rr.TP)){let l={isRemove:!1,symbol:r.symbol,name:"rr",points:[],data:[]},a;const n=+e.tools.rr.EP.options().price,d=+e.tools.rr.SL.options().price,u=+e.tools.rr.TP.options().price,v=d-n,m=u-n;if(m/v>0)return o.applyOptions({price:i}),!1;const b=Math.abs(m)/Math.abs(v),k=v/n*100,Ze=m/n*100,Ge=(e.fundSize*e.losePerOrder/Math.abs(k)/(n*1e3)).toFixed(0);a="EP",e.tools.rr[a].applyOptions({title:`[V=${Ge}] RR=${b.toFixed(1)}`}),l.points.push(a),l.data.push(e.tools.rr[a].options()),a="SL",e.tools.rr[a].applyOptions({title:`SL=${k.toFixed(1)}%`}),l.points.push(a),l.data.push(e.tools.rr[a].options()),a="TP",e.tools.rr[a].applyOptions({title:`TP=${Ze.toFixed(1)}%`}),l.points.push(a),l.data.push(e.tools.rr[a].options()),c.dispatch("tradingStock/drawTools",l)}break}}function re(){y.value&&(e.chart.resize(y.value.offsetWidth,y.value.offsetHeight),y.value.classList.contains("fullscreen")&&(document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"))}function ne(){y.value&&(document.fullscreenElement?(r.isFullscreen=!0,y.value.classList.add("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"):(r.isFullscreen=!1,y.value.classList.remove("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="unset",document.querySelector(".header-component").style.visibility="unset",document.querySelector(".sc-launcher").style.visibility="unset",document.querySelector(".dx-drawer-content").style.transform="translate(0px, 0px)"))}function ce(){R(`${h("trading.stock.removeFilterList")}?`,h("titles.confirm")).then(t=>{if(t){const o=c.state.tradingStock.symbols[r.symbolKind];let s=o.findIndex(l=>l==r.symbol);s=s==o.length-1?0:s+1;const i={symbol:r.symbol,name:r.symbolKind};c.dispatch("tradingStock/removeFilterList",i).then(()=>r.symbol=o[s])}})}function de(){if(!r.symbol)return!1;const t={symbol:r.symbol,add:!W.value};c.dispatch("tradingStock/addWatchlist",t)}function pe(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function me(){N(!1),A(!1),L(!1),L(!1,!0),S(!1),S(!1,!0),M(!1),ue()}function ue(){const t=c.state.tradingStock.chart.tools;for(const[o,s]of Object.entries(t))switch(o){case"line":Object.values(s).forEach(i=>e.tools.lines.push(e.series.price.createPriceLine(i)));break;case"target":Object.entries(s).forEach(([i,l])=>e.tools.target[i]=e.series.price.createPriceLine(l));break;case"rr":Object.entries(s).forEach(([i,l])=>e.tools.rr[i]=e.series.price.createPriceLine(l));break;default:o.includes("uplps")?Object.entries(s).forEach(([i,l])=>e.tools.uplps[i]=e.series[i.includes("P")?"price":"cash"].createPriceLine(l)):o.includes("downlps")&&Object.entries(s).forEach(([i,l])=>e.tools.downlps[i]=e.series[i.includes("P")?"price":"cash"].createPriceLine(l));break}}function fe(){e.series.events.setData(c.state.tradingStock.chart.events)}function he(){e.data=c.state.tradingStock.chart.data,e.series.ohlc.setData(e.data.ohlc),e.series.price.setData(e.data.price),e.series.cash.setData(e.data.cash),e.chart.applyOptions({watermark:{text:r.symbol}})}function ge(t){r.showTradingView=!r.showTradingView}function ve(t){r.showColorPicker=!r.showColorPicker}function ye(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o||t.target.classList.add("selected")}function be(t){N(),t.target.classList.remove("selected")}function ke(t=null,o=!1,s=!1){const i="line";t||(t=B(q(e.crosshair.y)));const l=e.tools.lines.length;if(e.tools.lines=e.tools.lines.filter(a=>{const n=a.options(),d=n.type=t==+n.price;return d&&(e.series.price.removePriceLine(a),c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:i,point:t})),!d}),e.tools.lines.length==l&&!s||o){const a={lineType:i,price:t,color:r.color,lineWidth:1,lineStyle:1,draggable:!0};e.tools.lines.push(e.series.price.createPriceLine(a)),c.dispatch("tradingStock/drawTools",{isRemove:!1,symbol:r.symbol,name:i,points:[t],data:[a]})}w.value.classList.remove("selected")}function N(t=!0){e.tools.lines.length>0&&(console.log("removeLineTool"),e.tools.lines.forEach(o=>e.series.price.removePriceLine(o)),e.tools.lines=[],t&&c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:"line",point:null}))}function we(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o||(t.target.classList.add("selected"),A())}function Ce(t){A(),t.target.classList.remove("selected")}function Le(){const t="target",o=q(e.crosshair.y);let s={lineType:t,price:o,lineWidth:1,lineStyle:1,draggable:!0},i={isRemove:!1,symbol:r.symbol,name:t,points:[],data:[]};if(p.isSet(e.tools.target.A)){const l=+e.tools.target.A.options().price,a=o-l;s.point="B",s.title=(100*a/l).toFixed(1)+"%",s.color="#FF9800",e.tools.target[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s)),s.point="X",s.price=+(l-.5*a).toFixed(2),s.title=(100*-.5*a/l).toFixed(1)+"%",s.color="#2196F3",e.tools.target[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s)),s.point="Y",s.price=+(l-a).toFixed(2),s.title=(100*-a/l).toFixed(1)+"%",s.color="#673AB7",e.tools.target[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s)),s.point="Z",s.price=+(l-2*a).toFixed(2),s.title=(100*-2*a/l).toFixed(1)+"%",s.color="#673AB7",e.tools.target[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s)),F.value.classList.remove("selected")}else s.point="A",s.title="0",s.color="#FF9800",e.tools.target[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s));c.dispatch("tradingStock/drawTools",i)}function A(t=!0){p.isSet(e.tools.target.A)&&(e.series.price.removePriceLine(e.tools.target.A),p.isSet(e.tools.target.B)&&(e.series.price.removePriceLine(e.tools.target.B),e.series.price.removePriceLine(e.tools.target.X),e.series.price.removePriceLine(e.tools.target.Y),e.series.price.removePriceLine(e.tools.target.Z)),e.tools.target={A:{},B:{},X:{},Y:{},Z:{}}),t&&c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:"target"})}function Se(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o?K():t.target.classList.add("selected")}function Te(t){L(),t.target.classList.remove("selected")}function K(){let t,o;const s=e.isCashDraw?"cash":"price",i=e.isCashDraw?"C":"P";p.isSet(e.tools.uplps[`${i}1`])?(t=+e.tools.uplps[`${i}1`].options().startTime,o=e.crosshair.time,L(!1)):t=e.crosshair.time;const{value1:l,value2:a}=Pe(t,o);let n={lineWidth:1,lineStyle:1,color:"#009688",draggable:!1},d={isRemove:!1,symbol:r.symbol,name:`${s}uplps`,points:[],data:[]};n.startTime=t,n.price=l,n.title=`${i}1`,e.tools.uplps[n.title]=e.series[s].createPriceLine(n),d.points.push(n.title),d.data.push(p.cloneDeep(n)),n.price=a,n.title=`${i}2`,e.tools.uplps[n.title]=e.series[s].createPriceLine(n),d.points.push(n.title),d.data.push(p.cloneDeep(n)),c.dispatch("tradingStock/drawTools",d),E.value.classList.remove("selected")}function Pe(t,o){let s,i,l,a=0,n=0;const d=e.data[e.isCashDraw?"cash":"price"];for(let u=0;u<d.length;u++){const v=d[u].time;if(v<t)continue;if(o&&v>o)break;const m=d[u].value;if(s==null&&(s=m,i=m,l=m),m>l)a>n&&(i=l,n=a),l=m,a=0;else if(m<l){const b=+(l-m).toFixed(2);b>a&&(a=b)}if(m<s&&n>0)break}return{value1:+(i-n).toFixed(2),value2:+(l-n).toFixed(2)}}function L(t=!0,o=!1){const s=e.isCashDraw||o,i=s?"cash":"price",l=s?"C":"P",a=`${l}1`,n=`${l}2`;p.isSet(e.tools.uplps[a])&&(e.series[i].removePriceLine(e.tools.uplps[a]),e.series[i].removePriceLine(e.tools.uplps[n])),e.tools.uplps[a]={},e.tools.uplps[n]={},t&&c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:`${i}uplps`})}function xe(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o?Y():t.target.classList.add("selected")}function $e(t){S(),t.target.classList.remove("selected")}function Y(){let t,o;const s=e.isCashDraw?"cash":"price",i=e.isCashDraw?"C":"P";p.isSet(e.tools.downlps[`${i}1`])?(t=+e.tools.downlps[`${i}1`].options().startTime,o=e.crosshair.time,S()):t=e.crosshair.time;const{value1:l,value2:a}=De(t,o);let n={lineWidth:1,lineStyle:1,color:"#E91E63",draggable:!1},d={isRemove:!1,symbol:r.symbol,name:`${s}downlps`,points:[],data:[]};n.startTime=t,n.price=l,n.title=`${i}1`,e.tools.downlps[n.title]=e.series[s].createPriceLine(n),d.points.push(n.title),d.data.push(p.cloneDeep(n)),n.price=a,n.title=`${i}2`,e.tools.downlps[n.title]=e.series[s].createPriceLine(n),d.points.push(n.title),d.data.push(p.cloneDeep(n)),c.dispatch("tradingStock/drawTools",d),_.value.classList.remove("selected")}function De(t,o){let s,i,l,a=0,n=0;const d=e.data[e.isCashDraw?"cash":"price"];for(let u=0;u<d.length;u++){const v=d[u].time;if(v<t)continue;if(o&&v>o)break;const m=d[u].value;if(s==null&&(s=m,i=m,l=m),m<l)a<n&&(i=l,n=a),l=m,a=0;else if(m>l){const b=+(l-m).toFixed(2);b<a&&(a=b)}if(m>s&&n<0)break}return{value1:+(i-n).toFixed(2),value2:+(l-n).toFixed(2)}}function S(t=!0,o=!1){const s=e.isCashDraw||o,i=s?"cash":"price",l=s?"C":"P",a=`${l}1`,n=`${l}2`;p.isSet(e.tools.downlps[a])&&(e.series[i].removePriceLine(e.tools.downlps[a]),e.series[i].removePriceLine(e.tools.downlps[n])),e.tools.downlps[a]={},e.tools.downlps[n]={},t&&c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:`${i}downlps`})}function Re(t){t.target.classList.contains("selected")?(t.target.classList.remove("selected"),e.isCashDraw=!1):(t.target.classList.add("selected"),e.isCashDraw=!0)}function Fe(t){e.isCashDraw=!1,t.target.classList.remove("selected")}function Ee(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o||(t.target.classList.add("selected"),M())}function _e(t){M(),t.target.classList.remove("selected")}function Ve(){const t="rr",o=q(e.crosshair.y);let s={lineType:t,price:o,lineWidth:1,lineStyle:1,draggable:!0},i={isRemove:!1,symbol:r.symbol,name:t,points:[],data:[]};if(p.isSet(e.tools.rr.EP)){const l=+e.tools.rr.EP.options().price;if(p.isSet(e.tools.rr.SL)){const n=+e.tools.rr.SL.options().price-l,d=o-l;if(d/n>0)return!1;const u=d/l*100;s.point="TP",s.title=`TP=${u.toFixed(1)}%`,s.color="lime",e.tools.rr[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s));const v=n/l*100,m=(e.fundSize*e.losePerOrder/Math.abs(v)/(l*1e3)).toFixed(0),b=Math.abs(d)/Math.abs(n),k="EP";e.tools.rr[k].applyOptions({title:`[V=${m}] RR=${b.toFixed(1)}`}),i.points.push(k),i.data.push(e.tools.rr[k].options()),V.value.classList.remove("selected")}else{const a=(o-l)/l*100;s.point="SL",s.title=`SL=${a.toFixed(1)}%`,s.color="red",e.tools.rr[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s))}}else s.point="EP",s.title="RR=",s.color="yellow",e.tools.rr[s.point]=e.series.price.createPriceLine(s),i.points.push(s.point),i.data.push(p.cloneDeep(s));c.dispatch("tradingStock/drawTools",i)}function M(t=!0){p.isSet(e.tools.rr.EP)&&(e.series.price.removePriceLine(e.tools.rr.EP),p.isSet(e.tools.rr.SL)&&(e.series.price.removePriceLine(e.tools.rr.SL),p.isSet(e.tools.rr.TP)&&e.series.price.removePriceLine(e.tools.rr.TP))),e.tools.rr={EP:{},SL:{},TP:{}},t&&c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:r.symbol,name:"rr"})}function Oe(t){r.showColorPicker=!1;const o=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(s=>s.classList.remove("selected")),o||t.target.classList.add("selected")}function Ae(t){qe(),t.target.classList.remove("selected")}function Me(){let t={isRemove:!1,symbol:"ALL",name:"range",points:[],data:[]},o={time:e.crosshair.time,value:1};e.tools.range.length>0?(o.color="red",e.tools.range[1]=o,t.points.push(1),O.value.classList.remove("selected")):(o.color="aqua",e.tools.range[0]=o,t.points.push(0)),e.series.range.setData(e.tools.range),t.data.push(o),c.dispatch("tradingStock/drawTools",t)}function qe(){e.tools.range=[],e.series.range.setData([]),c.dispatch("tradingStock/drawTools",{isRemove:!0,symbol:"ALL",name:"range"})}function Be(t){t.target.classList.contains("selected")?(t.target.classList.remove("selected"),e.showNewsInfo=!1):(t.target.classList.add("selected"),e.showNewsInfo=!0)}function Ie(t){e.showNewsInfo=!1,t.target.classList.remove("selected")}function ze(){if(e.showNewsInfo){const t=c.state.tradingStock.chart.events.find(o=>o.time==e.crosshair.time);if(p.isSet(t)){const o=t.title.split("|");let s=`
                <div>${h("trading.stock.date")} ${moment.unix(t.time).format("DD/MM/YYYY")}:</div>
                <div>&nbsp;</div>
                `;o.forEach(i=>{s+=`<div>${i}</div>`}),ct(s,h("trading.stock.event"))}}}function q(t,o="price"){return B(e.series[o].coordinateToPrice(t))}function B(t){return t?+ +t.toFixed(2):0}function We(t){if(!r.symbol)return!1;e.isOnlyLoadData=!1,c.dispatch("tradingStock/getChartData",{symbol:r.symbol,timeframe:r.timeframe,vnindex:!1})}function Ne(){e.isOnlyLoadData=!0,c.dispatch("tradingStock/getChartData",{symbol:r.symbol,timeframe:r.timeframe,vnindex:!0}).then(t=>e.series.vnindex.setData(t))}function Ke(){e.isOnlyLoadData=!0,c.dispatch("tradingStock/getChartData",{symbol:r.symbol,timeframe:r.timeframe,vnindex:!1})}function Ye(t){const o=c.state.tradingStock.symbols[r.symbolKind];let s=o.findIndex(i=>i==r.symbol);s=s==o.length-1?0:s+1,r.symbol=o[s]}function je(t){r.symbolKind=t.value}function Ue(){R(`${h("trading.stock.cloneSymbols")}?`,h("titles.confirm")).then(t=>{t&&c.dispatch("tradingStock/cloneSymbols")})}function Xe(){R(`${h("trading.stock.deleteWatchList")}?`,h("titles.confirm")).then(t=>{t&&c.dispatch("tradingStock/deleteWatchlist")})}function He(){e.tools.range.length==2?R(`${h("trading.stock.filterSymbols")}?`,h("titles.confirm")).then(t=>{if(t){const o={from:e.tools.range[0].time,to:e.tools.range[1].time,timeframe:r.timeframe,name:r.symbolKind};c.dispatch("tradingStock/filterSymbols",o)}}):rt.error(h("trading.stock.rangeWarning"))}return(t,o)=>{const s=it("DxToolbar");return nt(),lt("div",mt,[P(s,{items:[{visible:t.$mf.isSet(t.$route.query),location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:t.$t("buttons.back"),onClick:()=>t.$router.go(-1)}},{location:"before",widget:"dxSelectBox",options:{width:"130px",dataSource:r.symbolKinds,valueExpr:"value",displayExpr:"text",value:r.symbolKind,hint:t.$t("trading.stock.symbolKind"),onValueChanged:je}},{location:"after",widget:"dxButton",options:{icon:"far fa-list small",hint:t.$t("trading.stock.cloneSymbols"),onClick:Ue}},{location:"after",widget:"dxButton",options:{icon:"far fa-folder-times small",hint:t.$t("trading.stock.deleteWatchList"),onClick:Xe}},{location:"after",widget:"dxButton",options:{icon:"far fa-filter small",hint:t.$t("trading.stock.filterSymbols"),onClick:He}}]},null,8,["items"]),f("div",{class:"stock-container",ref_key:"chartContainerRef",ref:y,onClick:ie,onContextmenu:C},[f("div",{class:"chart-wrapper",ref_key:"chartRef",ref:z},[f("div",{class:"area data-area",onClick:C},[P(U(X),{width:t.$screen.getScreenSizeInfo.isXSmall?"140px":"130px","data-source":se.value,"search-enabled":!0,"show-clear-button":!0,"element-attr":{class:`command symbol-select ${oe.value}`},modelValue:r.symbol,"onUpdate:modelValue":o[0]||(o[0]=i=>r.symbol=i),onValueChanged:We},null,8,["width","data-source","element-attr","modelValue"]),P(U(X),{width:"60px","data-source":["D","W","M"],"element-attr":{class:"command timeframe-select"},modelValue:r.timeframe,"onUpdate:modelValue":o[1]||(o[1]=i=>r.timeframe=i),onValueChanged:Ne},null,8,["modelValue"]),f("div",{class:"command",title:t.$t("trading.stock.reload"),onClick:Ke,onContextmenu:Ye},[f("i",{class:x(`far fa-sync-alt ${t.$store.state.tradingStock.isChartLoading?"fa-spin":""}`)},null,2)],40,ut),$(f("div",{class:x("command far fa-times"),title:t.$t("trading.stock.removeFilterList"),onClick:ce},null,8,ft),[[D,r.symbolKind.includes("f_")]]),$(f("div",{ref:"addWatchlistToolRef",class:x(`command far fa-${W.value?"minus-circle":"plus-circle"}`),title:t.$t("trading.stock.addWatchlist"),onClick:de},null,10,ht),[[D,!!r.symbol]])]),f("div",{class:"area tool-area",onClick:C},[f("div",{ref_key:"fullscreenToolRef",ref:G,class:x(`command far fa-${r.isFullscreen?"compress":"expand"}`),title:t.$t("trading.stock.fullscreen"),onClick:pe},null,10,gt),f("div",{ref_key:"tradingviewRef",ref:J,class:"command far fa-chart-bar",title:t.$t("trading.stock.tradingview"),onClick:ge},null,8,vt),f("div",{ref_key:"colorToolRef",ref:Q,class:"color command far fa-palette",style:at({color:r.color}),title:t.$t("trading.stock.tools.color"),onClick:ve},[$(P(dt,{class:"color-picker",modelValue:r.color,"onUpdate:modelValue":o[2]||(o[2]=i=>r.color=i)},null,8,["modelValue"]),[[D,r.showColorPicker]])],12,yt),f("div",{ref_key:"lineToolRef",ref:w,class:"command far fa-horizontal-rule",title:t.$t("trading.stock.tools.line"),onClick:ye,onContextmenu:be},null,40,bt),f("div",{ref_key:"uplpsToolRef",ref:E,class:"command far fa-arrow-up",title:t.$t("trading.stock.tools.uplps"),onClick:Se,onContextmenu:Te},null,40,kt),f("div",{ref:"cashToolRef",class:"command drawless far fa-dot-circle",title:t.$t("trading.stock.tools.cash"),onClick:Re,onContextmenu:Fe},null,40,wt),f("div",{ref_key:"downlpsToolRef",ref:_,class:"command far fa-arrow-down",title:t.$t("trading.stock.tools.downlps"),onClick:xe,onContextmenu:$e},null,40,Ct),f("div",{ref_key:"targetToolRef",ref:F,class:"command far fa-flag-checkered",title:t.$t("trading.stock.tools.target"),onClick:we,onContextmenu:Ce},null,40,Lt),f("div",{ref_key:"rrToolRef",ref:V,class:"command far fa-line-height",title:t.$t("trading.stock.tools.rr"),onClick:Ee,onContextmenu:_e},null,40,St),f("div",{ref_key:"rangeToolRef",ref:O,class:"command far fa-grip-lines-vertical",title:t.$t("trading.stock.tools.range"),onClick:Oe,onContextmenu:Ae},null,40,Tt),f("div",{ref:"eventsToolRef",class:"command drawless far fa-map-marker-exclamation",title:t.$t("trading.stock.tools.events"),onClick:Be,onContextmenu:Ie},null,40,Pt)]),$(f("iframe",{ref_key:"tradingviewChartRef",ref:ee,class:"tradingview-chart",src:te.value},null,8,xt),[[D,r.showTradingView]])],512)],544)])}}};export{_t as default};
