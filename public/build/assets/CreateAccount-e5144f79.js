import{_ as v,Q as y,R as _,dJ as $,b as x,c as b,d,t as o,e as t,w as i,i as g,r as c,o as A,h as r}from"./app-950811ac.js";const R={components:{DxForm:y,DxItem:_,VueRecaptcha:$},data(){return{passwordMode:!0,siteKey:"6LcjtyobAAAAAEEEa6vHHPQZU9Nf_SoaXBRsCRr5",isReCaptchaVerified:!1,formData:{name:null,email:null,password:null,password_confirmation:null},validationRules:{name:[{type:"required",message:this.$t("models.user.name")+this.$mt.validations.required},{type:"stringLength",max:50,message:this.$t("models.user.validations.name")}],email:[{type:"required",message:this.$t("models.user.email")+this.$mt.validations.required},{type:"email",message:this.$t("models.user.email")+this.$mt.validations.email},{type:"async",validationCallback:this.validateDuplicateEmail,message:this.$t("models.user.email")+this.$mt.validations.duplicate}],password:[{type:"required",message:this.$t("models.user.password")+this.$mt.validations.required}],confirmPassword:[{type:"required",message:this.$t("models.user.password")+this.$mt.validations.required},{type:"compare",comparisonTarget:this.passwordComparison,message:this.$t("models.user.password")+this.$mt.validations.match}]}}},mounted(){setTimeout(()=>this.form.getEditor("name").focus(),500),this.$mf.includeScript("on",{src:"https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit",id:"recaptcha"})},destroyed(){this.$mf.includeScript("off","recaptcha")},computed:{form:function(){return this.$refs.form.instance}},methods:{...x("Auth",["createAccount","validateDuplicateEmail"]),onSubmit(){this.checkSpam(this.formData.email).then(e=>{e&&(this.isReCaptchaVerified?this.createAccount(this.formData).then(n=>{n&&this.$router.push({name:this.$route.query.redirect||"overview"})}):this.$toasted.show(this.$t("messages.warning.unVerifiedReCaptcha")))})},passwordComparison(){return this.formData.password},viewPasswordClick(){this.form.itemOption("password",{editorOptions:{mode:this.passwordMode?"text":"password",buttons:[{options:{icon:this.passwordMode?"far fa-eye-slash":"far fa-eye",onClick:this.viewPasswordClick},name:"btPw",location:"after"}]}}),this.form.itemOption("password_confirmation",{editorOptions:{mode:this.passwordMode?"text":"password"}}),this.passwordMode=!this.passwordMode},onVerify(e){this.isReCaptchaVerified=!0},onExpired(){this.isReCaptchaVerified=!1},checkSpam(e){return new Promise((n,p)=>{fetch(`https://api.stopforumspam.org/api?email=${e}`).then(l=>l.text()).then(l=>{let a=l.substring(l.lastIndexOf("<appears>")+9,l.lastIndexOf("</appears>"));n(a==="no")})})}}},C={class:"header"},k={class:"title"},D={class:"policy-info"},V={class:"recaptcha-container"},E={class:"login-link"};function S(e,n,p,l,a,m){const s=c("DxItem"),u=c("RouterLink"),h=c("VueRecaptcha"),f=c("DxForm");return A(),b("div",null,[d("div",C,[d("div",k,o(e.$t("auth.createAccount.title")),1)]),d("form",{class:"create-account-form",onSubmit:n[0]||(n[0]=g((...w)=>m.onSubmit&&m.onSubmit(...w),["prevent"]))},[t(f,{ref:"form","form-data":a.formData,labelMode:"floating"},{default:i(()=>[t(s,{"data-field":"name","editor-type":"dxTextBox","validation-rules":a.validationRules.name,label:{text:e.$t("models.user.name")}},null,8,["validation-rules","label"]),t(s,{"data-field":"email","editor-type":"dxTextBox","editor-options":{mode:"email"},"validation-rules":a.validationRules.email,label:{text:e.$t("models.user.email")}},null,8,["validation-rules","label"]),t(s,{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:m.viewPasswordClick},name:"password",location:"after"}]},"validation-rules":a.validationRules.password,label:{text:e.$t("models.user.password")}},null,8,["editor-options","validation-rules","label"]),t(s,{name:"password_confirmation","data-field":"password_confirmation","editor-type":"dxTextBox","editor-options":{mode:"password"},"validation-rules":a.validationRules.confirmPassword,label:{text:e.$t("models.user.confirmPassword")}},null,8,["validation-rules","label"]),t(s,null,{default:i(()=>[d("div",D,[r(o(e.$t("auth.createAccount.policy"))+" ",1),t(u,{to:{name:"policy",hash:"#terms"}},{default:i(()=>[r(o(e.$t("policy.terms.title")),1)]),_:1}),r(o(e.$t("auth.createAccount.and")),1),t(u,{to:{name:"policy",hash:"#privacy"}},{default:i(()=>[r(o(e.$t("policy.privacy.title")),1)]),_:1}),r(o(e.$t("auth.createAccount.our")),1)])]),_:1}),t(s,null,{default:i(()=>[d("div",V,[t(h,{ref:"recaptcha",theme:"dark",size:"compact",onVerify:m.onVerify,onExpired:m.onExpired,sitekey:a.siteKey},null,8,["onVerify","onExpired","sitekey"])])]),_:1}),t(s,{"item-type":"button","button-options":{width:"100%",type:"default",text:e.$t("auth.createAccount.submit"),useSubmitBehavior:!0}},null,8,["button-options"]),t(s,null,{default:i(()=>[d("div",E,[r(o(e.$t("auth.createAccount.haveAccount"))+" ",1),t(u,{to:{name:"login"}},{default:i(()=>[r(o(e.$t("auth.createAccount.login")),1)]),_:1})])]),_:1})]),_:1},8,["form-data"])],32)])}const B=v(R,[["render",S]]);export{B as default};
