import{W as B,T as F,k as h,V as b,_ as E,X as N,m as M,b as O,f as v,w as s,r as d,o as p,e as c,d as e,c as k,t as i,g,i as V}from"./app-a035c6a8.js";import{_ as A}from"./radio-group-5a1559e0.js";const I=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));var n={};const $=F(I);/*!
 * devextreme-vue
 * Version: 22.2.6
 * Build date: Tue Apr 18 2023
 *
 * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var P=h&&h.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});n.DxOptions=n.DxFormat=n.DxButton=n.DxNumberBox=void 0;var K=P($),R=b,m=b,f=R.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,buttons:Array,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,format:[Object,Function,String],height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},invalidValueMessage:String,isValid:Boolean,label:String,labelMode:String,max:Number,min:Number,mode:String,name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,showClearButton:Boolean,showSpinButtons:Boolean,step:Number,stylingMode:String,tabIndex:Number,text:String,useLargeSpinButtons:Boolean,validationError:{},validationErrors:Array,validationMessageMode:String,validationMessagePosition:String,validationStatus:String,value:Number,valueChangeEvent:String,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:buttons":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:format":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:invalidValueMessage":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:max":null,"update:min":null,"update:mode":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showClearButton":null,"update:showSpinButtons":null,"update:step":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:useLargeSpinButtons":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationMessagePosition":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},model:{prop:"value",event:"update:value"},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=K.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={button:{isCollectionItem:!0,optionName:"buttons"},format:{isCollectionItem:!1,optionName:"format"}}}});n.DxNumberBox=f;var r=m.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:location":null,"update:name":null,"update:options":null},props:{location:String,name:String,options:Object}});n.DxButton=r;r.$_optionName="buttons";r.$_isCollectionItem=!0;r.$_expectedChildren={options:{isCollectionItem:!1,optionName:"options"}};var S=m.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:currency":null,"update:formatter":null,"update:parser":null,"update:precision":null,"update:type":null,"update:useCurrencyAccountingStyle":null},props:{currency:String,formatter:Function,parser:Function,precision:Number,type:String,useCurrencyAccountingStyle:Boolean}});n.DxFormat=S;S.$_optionName="format";var _=m.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:bindingOptions":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:icon":null,"update:onClick":null,"update:onContentReady":null,"update:onDisposing":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rtlEnabled":null,"update:stylingMode":null,"update:tabIndex":null,"update:template":null,"update:text":null,"update:type":null,"update:useSubmitBehavior":null,"update:validationGroup":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,bindingOptions:Object,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,icon:String,onClick:Function,onContentReady:Function,onDisposing:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onOptionChanged:Function,rtlEnabled:Boolean,stylingMode:String,tabIndex:Number,template:{},text:String,type:String,useSubmitBehavior:Boolean,validationGroup:String,visible:Boolean,width:[Function,Number,String]}});n.DxOptions=_;_.$_optionName="options";var j=n.default=f;const G={components:{DxRadioGroup:A,DxNumberBox:j,DxValidator:N},data(){return{formData:{},contract:{}}},mounted(){},computed:{...M("User.contract",["principalMin","holdWeeksMin"]),popup(){return this.$refs.popup.instance},isDurationOk(){return this.contract.hold_days/7<this.holdWeeksMin}},methods:{...O("User.contract",["withdrawingContract"]),show(t){this.popup.option("title",`${this.$t("components.withdrawingContract.title")} #${t.code}`),this.contract=t,this.formData={radio:"all",advance:t.total},this.popup.show(),this.$mf.pushPopupToHistoryState(()=>this.popup.hide())},saveClick(){this.$refs.submit.click()},onSubmit(){this.$bus.emit("checkPin",async()=>{this.withdrawingContract({id:this.contract.id,advance:this.formData.advance}).then(t=>{t&&this.popup.hide()})})},onHiding(){this.$mf.popRouteHistoryState()},onRadioChanged(t){t.value=="all"?this.formData.advance=this.contract.total:(setTimeout(()=>this.$refs.numberBox.instance.focus(),0),this.formData.advance=0)},validateAdvance(t){return t.value>=.1*this.principalMin&&this.contract.total-t.value>=this.principalMin}}},W={ref:"submit",class:"display-none"},z={key:0,class:"duration-fail"},H=e("i",{class:"far fa-exclamation-triangle"},null,-1),U={class:"dx-fieldset"},T={class:"dx-field"},L={class:"dx-field-label text-dark"},X={class:"dx-field-value"},q={class:"dx-field"},J={class:"dx-field-label text-dark"},Q={class:"dx-field-value"},Y={class:"dx-field"},Z={class:"dx-field-label text-dark"},tt={class:"dx-field-value"};function et(t,l,nt,at,o,a){const C=d("DxRadioGroup"),x=d("DxValidator"),y=d("DxNumberBox"),w=d("DxScrollView"),D=d("DxPopup");return p(),v(D,{ref:"popup",showCloseButton:!0,fullScreen:!!t.$screen.getScreenSizeInfo.isXSmall,"show-title":!0,wrapperAttr:{class:"withdrawing-contract-popup"},toolbarItems:[{disabled:a.isDurationOk,toolbar:"bottom",location:"after",widget:"dxButton",options:{text:t.$t("components.withdrawingContract.withdrawButton"),onClick:a.saveClick}}],onHiding:a.onHiding},{content:s(()=>[c(w,null,{default:s(()=>[e("form",{onSubmit:l[2]||(l[2]=V((...u)=>a.onSubmit&&a.onSubmit(...u),["prevent"]))},[e("button",W,null,512),a.isDurationOk?(p(),k("div",z,[H,e("span",null,i(t.$t("components.withdrawingContract.validateDuration").replace("{weeks}",t.holdWeeksMin)),1)])):g("",!0),e("div",U,[e("div",T,[e("div",L,i(t.$t("components.withdrawingContract.duration"))+": ",1),e("div",X,[e("div",null,i(o.contract.duration),1)])]),e("div",q,[e("div",J,i(t.$t("components.withdrawingContract.availableBalances"))+": ",1),e("div",Q,i(o.contract.total|t.currency),1)]),e("div",Y,[e("div",Z,i(t.$t("components.withdrawingContract.withdrawalAmount"))+": ",1),e("div",tt,[c(C,{items:[{text:t.$t("components.withdrawingContract.all"),value:"all"},{text:t.$t("components.withdrawingContract.other"),value:"other"}],"display-expr":"text","value-expr":"value",modelValue:o.formData.radio,"onUpdate:modelValue":l[0]||(l[0]=u=>o.formData.radio=u),disabled:a.isDurationOk,onValueChanged:a.onRadioChanged},null,8,["items","modelValue","disabled","onValueChanged"]),o.formData.radio=="other"?(p(),v(y,{key:0,ref:"numberBox",modelValue:o.formData.advance,"onUpdate:modelValue":l[1]||(l[1]=u=>o.formData.advance=u),format:"#,##0 â‚«"},{default:s(()=>[c(x,{"validation-rules":[{type:"custom",validationCallback:a.validateAdvance,message:t.$t("components.withdrawingContract.validateAdvance").replace("{min}",t.$options.filters.currency(.1*t.principalMin)).replace("{max}",t.$options.filters.currency(o.contract.total-t.principalMin))}]},null,8,["validation-rules"])]),_:1},8,["modelValue"])):g("",!0)])])])],32)]),_:1})]),_:1},8,["fullScreen","toolbarItems","onHiding"])}const it=E(G,[["render",et]]);export{it as default};
