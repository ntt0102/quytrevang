import{a7 as I,L as A,N as _,O as V,u as R,r as y,a as j,c as b,p as B,f,_ as K,h as P,k as q,m as z,o as h,e as g,d as n,b as U,t as u,q as w,g as C,a8 as W,v as G}from"./app-BeSVQYvw.js";import{D as L}from"./radio-group-Dlkw6ePg.js";const T=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}));var a={};const H=A(T);/*!
 * devextreme-vue
 * Version: 22.2.12
 * Build date: Mon Apr 29 2024
 *
 * Copyright (c) 2012 - 2024 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var F;function J(){if(F)return a;F=1;var S=a&&a.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(a,"__esModule",{value:!0}),a.DxOptions=a.DxFormat=a.DxButton=a.DxNumberBox=void 0;var c=S(H),i=_(),d=_(),s=i.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,buttons:Array,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,format:[Object,Function,String],height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},invalidValueMessage:String,isValid:Boolean,label:String,labelMode:String,max:Number,min:Number,mode:String,name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,showClearButton:Boolean,showSpinButtons:Boolean,step:Number,stylingMode:String,tabIndex:Number,text:String,useLargeSpinButtons:Boolean,validationError:{},validationErrors:Array,validationMessageMode:String,validationMessagePosition:String,validationStatus:String,value:Number,valueChangeEvent:String,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:buttons":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:format":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:invalidValueMessage":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:max":null,"update:min":null,"update:mode":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showClearButton":null,"update:showSpinButtons":null,"update:step":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:useLargeSpinButtons":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationMessagePosition":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},model:{prop:"value",event:"update:value"},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=c.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={button:{isCollectionItem:!0,optionName:"buttons"},format:{isCollectionItem:!1,optionName:"format"}}}});a.DxNumberBox=s;var o=d.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:location":null,"update:name":null,"update:options":null},props:{location:String,name:String,options:Object}});a.DxButton=o,o.$_optionName="buttons",o.$_isCollectionItem=!0,o.$_expectedChildren={options:{isCollectionItem:!1,optionName:"options"}};var r=d.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:currency":null,"update:formatter":null,"update:parser":null,"update:precision":null,"update:type":null,"update:useCurrencyAccountingStyle":null},props:{currency:String,formatter:Function,parser:Function,precision:Number,type:String,useCurrencyAccountingStyle:Boolean}});a.DxFormat=r,r.$_optionName="format";var e=d.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:bindingOptions":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:icon":null,"update:onClick":null,"update:onContentReady":null,"update:onDisposing":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rtlEnabled":null,"update:stylingMode":null,"update:tabIndex":null,"update:template":null,"update:text":null,"update:type":null,"update:useSubmitBehavior":null,"update:validationGroup":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,bindingOptions:Object,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,icon:String,onClick:Function,onContentReady:Function,onDisposing:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onOptionChanged:Function,rtlEnabled:Boolean,stylingMode:String,tabIndex:Number,template:{},text:String,type:String,useSubmitBehavior:Boolean,validationGroup:String,visible:Boolean,width:[Function,Number,String]}});return a.DxOptions=e,e.$_optionName="options",a.default=s,a}var Q=J();const X=V(Q),Y={ref:"submitRef",class:"display-none"},Z={key:0,class:"duration-fail"},tt=n("i",{class:"far fa-exclamation-triangle"},null,-1),et={class:"dx-fieldset"},nt={class:"dx-field"},at={class:"dx-field-label text-dark"},ot={class:"dx-field-value"},lt={class:"dx-field"},ut={class:"dx-field-label text-dark"},it={class:"dx-field-value"},dt={class:"dx-field"},rt={class:"dx-field-label text-dark"},st={class:"dx-field-value"},mt={__name:"WithdrawingContractPopup",setup(S,{expose:c}){const i=P(),{t:d}=R(),s=q("bus"),o=y(null),r=y(null),e=j({formData:{},contract:{}}),l=b(()=>i.state.userContract.principalMin),x=b(()=>i.state.userContract.holdWeeksMin),m=b(()=>e.contract.hold_days/7<x.value);function D(t){o.value.option("title",`${d("components.withdrawingContract.title")} #${t.code}`),e.contract=t,e.formData={radio:"all",advance:t.total},o.value.show()}function E(){s.emit("checkPin",async()=>{i.dispatch("userContract/ withdrawingContract",{id:e.contract.id,advance:e.formData.advance}).then(t=>{t&&o.value.hide()})})}function N(t){t.value=="all"?e.formData.advance=e.contract.total:(setTimeout(()=>r.value.instance.focus(),0),e.formData.advance=0)}function $(t){return t.value>=.1*l.value&&e.contract.total-t.value>=l.value}function O(){}function M(){}return c({show:D}),(t,p)=>{const k=z("DxScrollView");return h(),B(K,{ref_key:"popupRef",ref:o,class:"withdrawing-contract-popup",toolbarItems:[{disabled:m.value,toolbar:"bottom",location:"after",widget:"dxButton",options:{text:t.$t("components.withdrawingContract.withdrawButton"),onClick:()=>t.$refs.submitRef.click()}}],onShown:O,onHidden:M},{default:f(()=>[g(k,null,{default:f(()=>[n("form",{onSubmit:G(E,["prevent"])},[n("button",Y,null,512),m.value?(h(),U("div",Z,[tt,n("span",null,u(t.$t("components.withdrawingContract.validateDuration",[x.value])),1)])):w("",!0),n("div",et,[n("div",nt,[n("div",at,u(t.$t("components.withdrawingContract.duration"))+": ",1),n("div",ot,[n("div",null,u(e.contract.duration),1)])]),n("div",lt,[n("div",ut,u(t.$t("components.withdrawingContract.availableBalances"))+": ",1),n("div",it,u(t.$filters.currency(e.contract.total)),1)]),n("div",dt,[n("div",rt,u(t.$t("components.withdrawingContract.withdrawalAmount"))+": ",1),n("div",st,[g(C(L),{items:[{text:t.$t("components.withdrawingContract.all"),value:"all"},{text:t.$t("components.withdrawingContract.other"),value:"other"}],"display-expr":"text","value-expr":"value",modelValue:e.formData.radio,"onUpdate:modelValue":p[0]||(p[0]=v=>e.formData.radio=v),disabled:m.value,onValueChanged:N},null,8,["items","modelValue","disabled"]),e.formData.radio=="other"?(h(),B(C(X),{key:0,ref_key:"numberBoxRef",ref:r,modelValue:e.formData.advance,"onUpdate:modelValue":p[1]||(p[1]=v=>e.formData.advance=v),format:"#,##0 â‚«"},{default:f(()=>[g(C(W),{"validation-rules":[{type:"custom",validationCallback:$,message:t.$t("components.withdrawingContract.validateAdvance").replace("{min}",t.$filters.currency(.1*l.value)).replace("{max}",t.$filters.currency(e.contract.total-l.value))}]},null,8,["validation-rules"])]),_:1},8,["modelValue"])):w("",!0)])])])],32)]),_:1})]),_:1},8,["toolbarItems"])}}};export{mt as default};
