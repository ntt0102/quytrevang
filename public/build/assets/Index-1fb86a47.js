import{y as Ae,u as De,b as qe,c as Be,i as U,r as b,d as Ve,e as Me,x as Xe,w as W,g as Ye,h as g,B as X,C as je,A as $e,E as ze,G as H,j as Ne,o as Ie}from"./app-e80b0066.js";import{_ as Ue}from"./spinner-40be0a1e.js";import We from"./ColorPicker-7e17c0bd.js";import{c as He}from"./lightweight-charts.esm.development-03366bac.js";class Ge{constructor(){this.create()}create(){return new Promise((x,C)=>{const L=indexedDB.open("orderChart",1);L.onupgradeneeded=u=>{this.store=u.target.result,this.store.createObjectStore("line",{keyPath:"price"}),this.store.createObjectStore("ruler",{keyPath:"point"}),this.store.createObjectStore("pattern1",{keyPath:"point"}),this.store.createObjectStore("uplps",{keyPath:"title"}),this.store.createObjectStore("downlps",{keyPath:"title"}),x()},L.onsuccess=u=>{this.store=u.target.result,x()},L.onerror=()=>{location.reload(),C()}})}get(x){var C=this.store;return new Promise(function(u,v){var k=C.transaction(x,"readonly");if(Array.isArray(x)){var S=x.map(T=>k.objectStore(T)),_=S.map(L);Promise.all(_).then(T=>u(T))}else{var E=k.objectStore(x);L(E).then(T=>u(T))}});function L(u){return new Promise(function(v,k){const S=u.getAll();S.onsuccess=_=>v(_.target.result),S.onerror=()=>k()})}}set(x,C){const L=this.store.transaction(x,"readwrite").objectStore(x);Array.isArray(C)?C.length>0&&C.forEach(u=>L.put(u)):L.put(C)}clear(x){var C=this.store;return new Promise(function(L,u){const v=C.transaction(x,"readwrite").objectStore(x).clear();v.onsuccess=()=>{L()},v.onerror=k=>{console.error(`Error to empty Object Store: ${x}`),u()}})}}const o=new Ge;const Ze={class:"content-block dx-card responsive-paddings"},Je={class:"area data-area"},Ke=["title"],Qe={class:"area tool-area"},et=["title"],tt=["title"],rt=["title"],it=["title"],ot=["title"],st=["title"],lt=["title"],nt=["title"],ct=["src"],at={__name:"Index",setup(G){const x={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.05,bottom:.4}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!1,rightOffset:20,minBarSpacing:.01},watermark:{visible:!0,fontSize:50,horzAlign:"center",vertAlign:"center",color:"rgba(171, 71, 188, 0.2)"}},C=De();qe(),Be();const L=U("devices"),u=U("mf"),v=b(null),k=b(null),S=b(null),_=b(null),E=b(null),T=b(null),Z=b(null),R=b(null),A=b(null),D=b(null),q=b(null),B=b(null),J=b(null);let e={chart:{},series:{},data:{whitespace:[],original:[],price:[],cash:[]},order:{side:0,entry:{},tp:{},sl:{}},lines:[],ruler:{l0:{},ln1:{},l1:{},l2:{},l3:{},l4:{},pointCount:0},target:{A:{},B:{},C:{},D:{}},pattern1:{A:{},B:{},C:{},X1:{},X2:{},Y1:{},Y2:{}},pattern2:{O:{}},uplps:{P1:{},P2:{},C1:{},C2:{}},downlps:{P1:{},P2:{},C1:{},C2:{}},box:[],alerts:[],crosshair:{},shark:null,loadWhitespace:!0,interval:null,interval60:null,websocket:null,isAutoOrdering:!1,socketStop:!1,volumeMax:0,socketRefreshTime:moment()};const p=Ve({symbol:"VNINDEX",isFullscreen:!1,color:"#F44336",showColorPicker:!1,showTradingView:!1}),K=Me(()=>`https://chart.vps.com.vn/tv/?symbol=${p.symbol}`);o.create(),Xe(()=>{e.chart=He(k.value,x),v.value.addEventListener("click",ee),v.value.addEventListener("contextmenu",Q),e.chart.subscribeCrosshairMove(te),e.chart.subscribeCustomPriceLineDragged(re),e.series.cash=e.chart.addLineSeries({priceScaleId:"cash",scaleMargins:{top:.61,bottom:.01},color:"yellow",priceFormat:{minMove:1},lastValueVisible:!1}),e.series.ohlc=e.chart.addCandlestickSeries({upColor:"#26a69a",downColor:"#ef5350",borderVisible:!1,wickUpColor:"#26a69a",wickDownColor:"#ef5350",priceFormat:{minMove:.01}}),e.series.price=e.chart.addLineSeries({color:"#CCCCCC",priceFormat:{minMove:.01},lastValueVisible:!1,priceLineVisible:!1}),new ResizeObserver(ie).observe(v.value),document.addEventListener("fullscreenchange",oe),C.dispatch("tradingStock/getChartData",p.symbol).then(()=>{le()})}),W(()=>C.state.tradingStock.chartData,ne),W(()=>C.state.tradingStock.isChartLoading,r=>{_.value.style.display=r?"block":"none"});function Q(r){r.preventDefault()}function ee(){R.value.classList.contains("selected")?O():A.value.classList.contains("selected")?ve():D.value.classList.contains("selected")?xe():q.value.classList.contains("selected")?$():B.value.classList.contains("selected")&&N()}function te(r){if(r.time){let t=r.seriesPrices.get(e.series.price);e.crosshair.time=r.time,e.crosshair.price=t}else L.phone||(e.crosshair.time=null,e.crosshair.price=null);r.point!=null&&(e.crosshair.x=r.point.x,e.crosshair.y=r.point.y)}function re(r){let t=r.customPriceLine,s=t.options();s.price=M(s.price);const c=+r.fromPriceString,n=s.price;switch(s.lineType){case"line":o.set("line",{price:c,removed:!0}),o.set("line",s),R.value.classList.remove("selected");break;case"ruler":switch(s.point){case"l0":if(o.set("ruler",s),e.ruler.pointCount==2){const P=+e.ruler.l1.options().title,Te=+(n-P).toFixed(1);e.ruler.ln1.applyOptions({price:Te}),o.set("ruler",e.ruler.ln1.options());const _e=+(n+P).toFixed(1);e.ruler.l1.applyOptions({price:_e}),o.set("ruler",e.ruler.l1.options());const Oe=+(n+P*2).toFixed(1);e.ruler.l2.applyOptions({price:Oe}),o.set("ruler",e.ruler.l2.options());const Re=+(n+P*3).toFixed(1);e.ruler.l3.applyOptions({price:Re}),o.set("ruler",e.ruler.l3.options());const Ee=+(n+P*4).toFixed(1);e.ruler.l4.applyOptions({price:Ee}),o.set("ruler",e.ruler.l4.options())}break;case"ln1":const l=+e.ruler.l0.options().price,i=n-l;t.applyOptions({title:i.toFixed(1)}),o.set("ruler",t.options()),e.ruler.l1.applyOptions({title:(-i).toFixed(1),price:+(l-i).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(-i*2).toFixed(1),price:+(l-i*2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(-i*3).toFixed(1),price:+(l-i*3).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(-i*4).toFixed(1),price:+(l-i*4).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l1":const a=+e.ruler.l0.options().price,d=n-a;t.applyOptions({title:d.toFixed(1)}),o.set("ruler",t.options()),e.ruler.ln1.applyOptions({title:(-d).toFixed(1),price:+(a-d).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l2.applyOptions({title:(d*2).toFixed(1),price:+(a+d*2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(d*3).toFixed(1),price:+(a+d*3).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(d*4).toFixed(1),price:+(a+d*4).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l2":const y=+e.ruler.l0.options().price,h=n-y;t.applyOptions({title:h.toFixed(1)}),o.set("ruler",t.options()),e.ruler.ln1.applyOptions({title:(-h*.5).toFixed(1),price:+(y-h*.5).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(h*.5).toFixed(1),price:+(y+h*.5).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l3.applyOptions({title:(h*1.5).toFixed(1),price:+(y+h*1.5).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(h*2).toFixed(1),price:+(y+h*2).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l3":const F=+e.ruler.l0.options().price,w=n-F;t.applyOptions({title:w.toFixed(1)}),o.set("ruler",t.options()),e.ruler.ln1.applyOptions({title:(-w/3).toFixed(1),price:+(F-w/3).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(w/3).toFixed(1),price:+(F+w/3).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(w*2/3).toFixed(1),price:+(F+w*2/3).toFixed(1)}),o.set("ruler",e.ruler.l2.options());break;case"l4":const f=+e.ruler.l0.options().price,m=n-f;t.applyOptions({title:m.toFixed(1)}),o.set("ruler",t.options()),e.ruler.ln1.applyOptions({title:(-m/4).toFixed(1),price:+(f-m/4).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(m/4).toFixed(1),price:+(f+m/4).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(m/2).toFixed(1),price:+(f+m/2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(m*3/4).toFixed(1),price:+(f+m*3/4).toFixed(1)}),o.set("ruler",e.ruler.l3.options());break}break;case"pattern1":if(u.isSet(e.pattern1.C)){const l=+e.pattern1.A.options().price,a=+e.pattern1.B.options().price-l;e.pattern1.B.applyOptions({title:a.toFixed(1)}),o.set("pattern1",e.pattern1.B.options()),e.pattern1.C.applyOptions({price:+(l+.5*a).toFixed(1),title:(.5*a).toFixed(1)}),o.set("pattern1",e.pattern1.C.options()),e.pattern1.X1.applyOptions({price:+(l-.375*a).toFixed(1),title:(-.375*a).toFixed(1)}),o.set("pattern1",e.pattern1.X1.options()),e.pattern1.X2.applyOptions({price:+(l-.5*a).toFixed(1),title:(-.5*a).toFixed(1)}),o.set("pattern1",e.pattern1.X2.options()),e.pattern1.Y1.applyOptions({price:+(l-a).toFixed(1),title:-a.toFixed(1)}),o.set("pattern1",e.pattern1.Y1.options()),e.pattern1.Y2.applyOptions({price:+(l-2*a).toFixed(1),title:(-2*a).toFixed(1)}),o.set("pattern1",e.pattern1.Y2.options())}break}}function ie(){v.value&&(e.chart.resize(v.value.offsetWidth,v.value.offsetHeight),v.value.classList.contains("fullscreen")&&(document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"))}function oe(){v.value&&(document.fullscreenElement?(p.isFullscreen=!0,v.value.classList.add("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"):(p.isFullscreen=!1,v.value.classList.remove("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="unset",document.querySelector(".header-component").style.visibility="unset",document.querySelector(".sc-launcher").style.visibility="unset",document.querySelector(".dx-drawer-content").style.transform="translate(0px, 0px)"))}function se(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function le(){return new Promise(async r=>{(await o.get("line")).forEach(i=>{i.removed||e.lines.push(e.series.price.createPriceLine(i))});const s=await o.get("ruler");s.length>0&&(e.ruler.pointCount=s.length>1?2:1,s.forEach(i=>{e.ruler[i.point]=e.series.price.createPriceLine(i)}));const c=await o.get("pattern1");c.length>0&&c.forEach(i=>{e.pattern1[i.point]=e.series.price.createPriceLine(i)});const n=await o.get("uplps");n.length>0&&n.forEach(i=>{e.uplps[i.title]=e.series[i.title.includes("P")?"price":"cash"].createPriceLine(i)});const l=await o.get("downlps");l.length>0&&l.forEach(i=>{e.downlps[i.title]=e.series[i.title.includes("P")?"price":"cash"].createPriceLine(i)}),r()})}function ne(){e.data=C.state.tradingStock.chartData,e.series.ohlc.setData(e.data.ohlc),e.series.price.setData(e.data.price),e.series.cash.setData(e.data.cash),e.chart.applyOptions({watermark:{text:p.symbol}}),S.value.blur()}function ce(r){p.showTradingView=!p.showTradingView,r.stopPropagation()}function ae(r){p.showColorPicker=!p.showColorPicker,r.stopPropagation()}function pe(r){u.isSet(e.pattern1.X)&&(O(+e.pattern1.X.options().price),O(+e.pattern1.Y.options().price),O(+e.pattern1.Z.options().price),O(+e.pattern1.T.options().price)),r.preventDefault(),r.stopPropagation()}function de(r){p.showColorPicker=!1;const t=r.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(s=>s.classList.remove("selected")),t||r.target.classList.add("selected"),r.stopPropagation()}function ue(r){fe(),r.target.classList.remove("selected"),r.preventDefault(),r.stopPropagation()}function O(r=null,t=!1,s=!1){const c="line";r||(r=M(V(e.crosshair.y)));const n=e.lines.length;if(e.lines=e.lines.filter(l=>{const i=l.options(),a=i.type=r==+i.price;return a&&(e.series.price.removePriceLine(l),o.set("line",{price:r,removed:!0})),!a}),e.lines.length==n&&!s||t){const l={lineType:c,price:r,color:p.color,lineWidth:1,lineStyle:1,draggable:!0};e.lines.push(e.series.price.createPriceLine(l)),o.set("line",l)}R.value.classList.remove("selected")}function fe(){e.lines.forEach(r=>e.series.price.removePriceLine(r)),e.lines=[],o.clear("line")}function me(r){p.showColorPicker=!1;const t=r.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(s=>s.classList.remove("selected")),t||(r.target.classList.add("selected"),Y()),r.stopPropagation()}function he(r){Y(),r.target.classList.remove("selected"),r.preventDefault(),r.stopPropagation()}function ve(){const r=V(e.crosshair.y);let t={lineType:"ruler",price:r,lineWidth:1,lineStyle:1,draggable:!0};if(e.ruler.pointCount==0)t.point="l0",t.color="#F44336",t.title="0",e.ruler[t.point]=e.series.price.createPriceLine(t),e.ruler.pointCount++,o.set("ruler",t);else{const s=+e.ruler.l0.options().price,c=r-s;t.point="l1",t.color="#FF9800",t.title=c.toFixed(1),e.ruler[t.point]=e.series.price.createPriceLine(t),o.set("ruler",t);const n=-c;t.point="ln1",t.color="#FF9800",t.title=n.toFixed(1),t.price=+(s+n).toFixed(1),e.ruler[t.point]=e.series.price.createPriceLine(t),o.set("ruler",t);const l=2*c;t.point="l2",t.color="#FFEB3B",t.title=l.toFixed(1),t.price=+(s+l).toFixed(1),e.ruler[t.point]=e.series.price.createPriceLine(t),o.set("ruler",t);const i=3*c;t.point="l3",t.color="#4CAF50",t.title=i.toFixed(1),t.price=+(s+i).toFixed(1),e.ruler[t.point]=e.series.price.createPriceLine(t),o.set("ruler",t);const a=4*c;t.point="l4",t.color="#009688",t.title=a.toFixed(1),t.price=+(s+a).toFixed(1),e.ruler[t.point]=e.series.price.createPriceLine(t),o.set("ruler",t),e.ruler.pointCount++,A.value.classList.remove("selected")}}function Y(){e.ruler.pointCount>0&&(e.series.price.removePriceLine(e.ruler.l0),e.ruler.pointCount>1&&(e.series.price.removePriceLine(e.ruler.ln1),e.series.price.removePriceLine(e.ruler.l1),e.series.price.removePriceLine(e.ruler.l2),e.series.price.removePriceLine(e.ruler.l3),e.series.price.removePriceLine(e.ruler.l4)),e.ruler={l0:{},ln1:{},l1:{},l2:{},l3:{},l4:{},pointCount:0},o.clear("ruler"))}function ye(r){p.showColorPicker=!1;const t=r.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(s=>s.classList.remove("selected")),t||(r.target.classList.add("selected"),j()),r.stopPropagation()}function Pe(r){j(),r.target.classList.remove("selected"),r.preventDefault(),r.stopPropagation()}function xe(){const r=V(e.crosshair.y);let t={lineType:"pattern1",price:r,lineWidth:1,lineStyle:1,draggable:!0};if(u.isSet(e.pattern1.A)){const s=+e.pattern1.A.options().price,c=r-s;t.point="B",t.title=c.toFixed(1),t.color="#FF9800",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),t.point="C",t.price=+(s+.5*c).toFixed(1),t.title=(.5*c).toFixed(1),t.color="#FF9800",t.draggable=!1,e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),t.point="X1",t.price=+(s-.375*c).toFixed(1),t.title=(-.375*c).toFixed(1),t.color="#2196F3",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),t.point="X2",t.price=+(s-.5*c).toFixed(1),t.title=(-.5*c).toFixed(1),t.color="#2196F3",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),t.point="Y1",t.price=+(s-c).toFixed(1),t.title=-c.toFixed(1),t.color="#673AB7",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),t.point="Y2",t.price=+(s-2*c).toFixed(1),t.title=(-2*c).toFixed(1),t.color="#673AB7",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t),D.value.classList.remove("selected")}else t.point="A",t.title="0",t.color="#FF9800",e.pattern1[t.point]=e.series.price.createPriceLine(t),o.set("pattern1",t)}function j(){u.isSet(e.pattern1.A)&&(e.series.price.removePriceLine(e.pattern1.A),u.isSet(e.pattern1.B)&&(e.series.price.removePriceLine(e.pattern1.B),e.series.price.removePriceLine(e.pattern1.C),e.series.price.removePriceLine(e.pattern1.X1),e.series.price.removePriceLine(e.pattern1.X2),e.series.price.removePriceLine(e.pattern1.Y1),e.series.price.removePriceLine(e.pattern1.Y2)),e.pattern1={A:{},B:{},C:{},X1:{},X2:{},Y1:{},Y2:{}},o.clear("pattern1"))}function Ce(r){p.showColorPicker=!1;const t=r.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(s=>s.classList.remove("selected")),t?$():r.target.classList.add("selected"),r.stopPropagation()}function Fe(r){z(),r.target.classList.remove("selected"),r.preventDefault(),r.stopPropagation()}function $(){let r,t;u.isSet(e.uplps.P1)?(r=+e.uplps.P1.options().startTime,t=e.crosshair.time,z()):r=e.crosshair.time;const{price1:s,price2:c,cash1:n,cash2:l}=ge(r,t);let i={lineWidth:1,lineStyle:1,color:"#009688",draggable:!1};i.startTime=r,i.price=s,i.title="P1",e.uplps[i.title]=e.series.price.createPriceLine(i),o.set("uplps",i),i.price=c,i.title="P2",e.uplps[i.title]=e.series.price.createPriceLine(i),o.set("uplps",i),i.price=n,i.title="C1",e.uplps[i.title]=e.series.cash.createPriceLine(i),o.set("uplps",i),i.price=l,i.title="C2",e.uplps[i.title]=e.series.cash.createPriceLine(i),o.set("uplps",i),q.value.classList.remove("selected")}function ge(r,t){let s,c,n,l=0,i=0,a,d,y=0,h=0;for(let F=0;F<e.data.price.length;F++){const w=e.data.price[F].time;if(w<r)continue;if(t&&w>t)break;const f=e.data.price[F].value,m=e.data.cash[F].value;if(s==null&&(s=f,c=f,n=f,a=m,d=m),f>n)l>i&&(c=n,i=l),n=f,l=0;else if(f<n){const P=+(n-f).toFixed(1);P>l&&(l=P)}if(f<s&&i>0)break;if(m>d)y>h&&(a=d,h=y),d=m,y=0;else if(m<d){const P=+(d-m).toFixed(1);P>y&&(y=P)}}return{price1:+(c-i).toFixed(2),price2:+(n-i).toFixed(2),cash1:+(a-h).toFixed(0),cash2:+(d-h).toFixed(0)}}function z(){u.isSet(e.uplps.P1)&&(e.series.price.removePriceLine(e.uplps.P1),e.series.price.removePriceLine(e.uplps.P2)),u.isSet(e.uplps.C1)&&(e.series.cash.removePriceLine(e.uplps.C1),e.series.cash.removePriceLine(e.uplps.C2)),e.uplps={P1:{},P2:{},C1:{},C2:{}},o.clear("uplps")}function Le(r){p.showColorPicker=!1;const t=r.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(s=>s.classList.remove("selected")),t?N():r.target.classList.add("selected"),r.stopPropagation()}function we(r){I(),r.target.classList.remove("selected"),r.preventDefault(),r.stopPropagation()}function N(){let r,t;u.isSet(e.downlps.P1)?(r=+e.downlps.P1.options().startTime,t=e.crosshair.time,I()):r=e.crosshair.time;const{price1:s,price2:c,cash1:n,cash2:l}=be(r,t);let i={lineWidth:1,lineStyle:1,color:"#E91E63",draggable:!1};i.startTime=r,i.price=s,i.title="P1",e.downlps[i.title]=e.series.price.createPriceLine(i),o.set("downlps",i),i.price=c,i.title="P2",e.downlps[i.title]=e.series.price.createPriceLine(i),o.set("downlps",i),i.price=n,i.title="C1",e.downlps[i.title]=e.series.cash.createPriceLine(i),o.set("downlps",i),i.price=l,i.title="C2",e.downlps[i.title]=e.series.cash.createPriceLine(i),o.set("downlps",i),B.value.classList.remove("selected")}function be(r,t){let s,c,n,l=0,i=0,a,d,y=0,h=0;for(let F=0;F<e.data.price.length;F++){const w=e.data.price[F].time;if(w<r)continue;if(t&&w>t)break;const f=e.data.price[F].value,m=e.data.cash[F].value;if(s==null&&(s=f,c=f,n=f,a=m,d=m),f<n)l<i&&(c=n,i=l),n=f,l=0;else if(f>n){const P=+(n-f).toFixed(1);P<l&&(l=P)}if(f>s&&i<0)break;if(m<d)y<h&&(a=d,h=y),d=m,y=0;else if(m>d){const P=+(d-m).toFixed(1);P<y&&(y=P)}}return{price1:+(c-i).toFixed(1),price2:+(n-i).toFixed(1),cash1:+(a-h).toFixed(1),cash2:+(d-h).toFixed(1)}}function I(){u.isSet(e.downlps.P1)&&(e.series.price.removePriceLine(e.downlps.P1),e.series.price.removePriceLine(e.downlps.P2)),u.isSet(e.downlps.C1)&&(e.series.cash.removePriceLine(e.downlps.C1),e.series.cash.removePriceLine(e.downlps.C2)),e.downlps={P1:{},P2:{},C1:{},C2:{}},o.clear("downlps")}function V(r,t="price"){return M(e.series[t].coordinateToPrice(r))}function M(r){return r?+ +r.toFixed(1):0}function ke(r){if(p.symbol=="")return!1;p.symbol=p.symbol.toUpperCase(),C.dispatch("tradingStock/getChartData",p.symbol)}function Se(r){r.target.select()}return(r,t)=>(Ie(),Ye("div",Ze,[g("div",{class:"order-chart-container",ref_key:"chartContainerRef",ref:v},[g("div",{class:"chart-wrapper",ref_key:"chartRef",ref:k},[g("div",Je,[X(g("input",{ref_key:"symbolRef",ref:S,type:"text",class:"command symbol-input",title:r.$t("trading.stock.symbol"),"onUpdate:modelValue":t[0]||(t[0]=s=>p.symbol=s),onChange:ke,onFocus:Se},null,40,Ke),[[je,p.symbol]]),g("img",{ref_key:"spinnerRef",ref:_,class:"command spinner",src:Ue},null,512)]),g("div",Qe,[g("div",{ref_key:"fullscreenToolRef",ref:E,class:$e(`command far fa-${p.isFullscreen?"compress":"expand"}`),title:r.$t("trading.orderChart.fullscreen"),onClick:se},null,10,et),g("div",{ref_key:"tradingviewRef",ref:T,class:"command far fa-chart-bar",title:r.$t("trading.orderChart.tradingview"),onClick:ce},null,8,tt),g("div",{ref_key:"colorToolRef",ref:Z,class:"color command far fa-palette",style:ze({color:p.color}),title:r.$t("trading.orderChart.colorTool"),onClick:ae,onContextmenu:pe},[X(Ne(We,{class:"color-picker",modelValue:p.color,"onUpdate:modelValue":t[1]||(t[1]=s=>p.color=s)},null,8,["modelValue"]),[[H,p.showColorPicker]])],44,rt),g("div",{ref_key:"lineToolRef",ref:R,class:"command far fa-horizontal-rule",title:r.$t("trading.orderChart.lineTool"),onClick:de,onContextmenu:ue},null,40,it),g("div",{ref_key:"pattern1ToolRef",ref:D,class:"command far fa-dot-circle",title:r.$t("trading.orderChart.pattern1Tool"),onClick:ye,onContextmenu:Pe},null,40,ot),g("div",{ref_key:"uplpsToolRef",ref:q,class:"command far fa-arrow-up",title:r.$t("trading.orderChart.uplpsTool"),onClick:Ce,onContextmenu:Fe},null,40,st),g("div",{ref_key:"downlpsToolRef",ref:B,class:"command far fa-arrow-down",title:r.$t("trading.orderChart.downlpsTool"),onClick:Le,onContextmenu:we},null,40,lt),g("div",{ref_key:"rulerToolRef",ref:A,class:"command far fa-line-height",title:r.$t("trading.orderChart.rulerTool"),onClick:me,onContextmenu:he},null,40,nt)]),X(g("iframe",{ref_key:"tradingviewChartRef",ref:J,class:"tradingview-chart",src:K.value},null,8,ct),[[H,p.showTradingView]])],512)],512)]))}},mt=Ae(at,[["__scopeId","data-v-8b9c54bc"]]);export{mt as default};
