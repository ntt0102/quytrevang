import{_ as g,Q as b,R as v,b as y,c as m,d as r,t as _,i as $,e,w as l,r as d,o as u,F as D,s as k,f as O}from"./app-8ef0f3dc.js";import{P as x}from"./PickImagePopup-59ededdc.js";import{a as P}from"./index-fb36e198.js";import"./FileManager-7663f193.js";import"./exporter-4f1d342d.js";import"./row_dragging-9fbcd02a.js";import"./dialog-21a07523.js";const I={components:{DxForm:b,DxItem:v,PickImagePopup:x},data(){return{formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:this.$t("settings.notification.receiver")+this.$mt.validations.required}],title:[{type:"required",message:this.$t("settings.notification.notificationTitle")+this.$mt.validations.required}],body:[{type:"required",message:this.$t("settings.notification.body")+this.$mt.validations.required}]}}},beforeCreate(){this.$store.registerModule("Settings",P)},created(){this.actionOptions=this.getActionsOptions(this.formData.actions),this.addActionOptions={icon:"add",text:this.$t("buttons.add"),onClick:()=>{this.formData.actions.push(""),this.actionOptions=this.getActionsOptions(this.formData.actions)}}},mounted(){this.formData.receiver=this.$route.query.codes||null,setTimeout(()=>this.form.getEditor("receiver").focus(),1e3)},destroyed(){this.$store.unregisterModule("Settings")},computed:{toolbar:function(){return this.$refs.toolbar.instance},form:function(){return this.$refs.form.instance}},methods:{...y("Settings",["sendNotification"]),onSubmit(){this.$bus.emit("checkPin",()=>{this.sendNotification(this.formData)})},getActionsOptions(t){let n=[];for(let a=0;a<t.length;a++)n.push(this.generateNewActionOptions(a));return n},generateNewActionOptions(t){return{placeholder:this.$t("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{this.formData.actions.splice(t,1),this.actionOptions=this.getActionsOptions(this.formData.actions)}}}]}}}},S={class:"settings-page"},A={class:"content-block"},q={class:"content-block dx-card responsive-paddings"};function N(t,n,a,w,o,p){const i=d("DxItem"),f=d("DxForm"),h=d("PickImagePopup");return u(),m("div",S,[r("h2",A,_(t.$t("settings.notification.title")),1),r("div",q,[r("div",null,[r("form",{class:"setting-notification-tab",onSubmit:n[0]||(n[0]=$((...s)=>p.onSubmit&&p.onSubmit(...s),["prevent"]))},[e(f,{ref:"form","form-data":o.formData,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0},{default:l(()=>[e(i,{"item-type":"group"},{default:l(()=>[e(i,{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:t.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>t.$router.push({name:"users",query:{selected:o.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":o.validationRules.receiver,label:{text:t.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),e(i,{"data-field":"title","validation-rules":o.validationRules.title,label:{text:t.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),e(i,{"data-field":"body","validation-rules":o.validationRules.body,label:{text:t.$t("settings.notification.body")}},null,8,["validation-rules","label"]),e(i,{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>t.$refs.pickImagePopup.show({clientPath:"notifications",callback:s=>o.formData.image=s})},name:"pickImage",location:"after"}]},label:{text:t.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),e(i,{"item-type":"group",caption:t.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[e(i,{"item-type":"group",name:"actions"},{default:l(()=>[(u(!0),m(D,null,k(o.actionOptions,(s,c)=>(u(),O(i,{key:"action"+(c+1),"data-field":"actions["+c+"]","editor-options":s,label:{text:t.$t("settings.notification.action.title")+" "+(c+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),e(i,{"item-type":"button","button-options":o.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),e(i,{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:t.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],32),e(h,{ref:"pickImagePopup"},null,512)])])])}const V=g(I,[["render",N],["__scopeId","data-v-825ce247"]]);export{V as default};
