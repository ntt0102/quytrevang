import{x as C,z as R,A as p,E as S,B as F,c as r,d as t,t as i,J as b,M as T,e as v,w as _,D as m,o,v as z}from"./app-6ea57162.js";import{a as N,D as P}from"./data-grid-b95a844e.js";/* empty css                                                            */import"./row_dragging-498caf99.js";import"./dialog-ac020704.js";import"./exporter-e3a8336b.js";const A={class:"overview-contracts"},B={class:"sum dx-card responsive-paddings content-block"},E={class:"title"},G={key:0,class:"currency"},V={key:1},U={class:"title"},j={key:0,class:"currency"},J={key:1},L={class:"title"},M={key:0,class:"currency interest"},O={key:1},q={class:"list content-block"},x=["onClick"],H={class:"responsive-paddings",style:{position:"relative"}},K={class:"info"},Q={class:"interest-rate"},W={class:"date"},X={class:"currency"},Y={class:"principal"},Z={class:"interest"},I=100,h=4,oe={__name:"Contracts",setup(ee){const d=C(),f=R("mf"),u=p(null),g=p(null),y=S(()=>d.state.auth.user.level),a=F({gridData:null,asset:null,principal:null,interest:null});let s={sum:{},interval:{},change:{},doneFlag:!1};d.dispatch("userContract/getContracts",!1).then(()=>{a.gridData=f.cloneDeep(d.state.userContract.contracts),k()});function w(e){e.rowType=="header"&&(e.rowElement.style.display="none")}function D(e){return`status-${e}`}function k(){s.sum=a.gridData.reduce((e,l)=>([2,3].includes(l.status)&&(e.principal+=l.principal,e.interest+=l.interest,e.asset+=l.total),e),{principal:0,interest:0,asset:0}),$(),s.interval=setInterval(()=>{c("principal"),c("interest"),c("asset"),s.doneFlag&&clearInterval(s.interval)},h)}function $(){let e=I/h;s.change={principal:s.sum.principal/e,interest:s.sum.interest/e,asset:s.sum.asset/e}}function c(e){a[e]<s.sum[e]-s.change[e]?(a[e]+=s.change[e],s.doneFlag=!1):(a[e]=s.sum[e],s.doneFlag=!0)}return(e,l)=>(o(),r("div",A,[t("div",B,[t("div",null,[t("div",E,i(e.$t("user.overview.assetSum")),1),a.asset!=null?(o(),r("div",G,i(e.$filters.currency(a.asset.toFixed(0))),1)):(o(),r("div",V,"-"))]),t("div",null,[t("div",U,i(e.$t("user.overview.principalSum")),1),a.principal!=null?(o(),r("div",j,i(e.$filters.currency(a.principal.toFixed(0))),1)):(o(),r("div",J,"-"))]),t("div",null,[t("div",L,i(e.$t("user.overview.interestSum")),1),a.interest!=null?(o(),r("div",M,i(e.$filters.currency(a.interest.toFixed(0),"+ ")),1)):(o(),r("div",O,"-"))])]),b(t("div",q,[v(m(P),{ref_key:"dataGridRef",ref:u,"data-source":a.gridData,"key-expr":"id","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate",onContentReady:l[0]||(l[0]=()=>e.$mf.dataGridPreload(a.gridData,u.value.instance)),onRowPrepared:w},{dataRowTemplate:_(({data:n})=>[t("tr",{role:"cell",class:"item",onClick:te=>g.value.show(n.data)},[t("td",null,[t("div",H,[t("div",{class:z(["status",D(n.data.status)])},null,2),t("div",K,[t("div",null,[t("span",null,"#"+i(n.data.code),1),t("span",Q,i(e.$filters.percentInterestRate(n.data.interest_rate)),1)]),t("div",W,[t("div",null,i(e.$filters.formatDate(n.data.paid_at))+" ~ "+i(e.$filters.formatDate(n.data.withdrawn_at))+" Â  ",1),t("div",null,"("+i(n.data.duration)+")",1)])]),t("div",X,[t("div",Y,i(e.$filters.currency(n.data.principal)),1),t("div",Z,i(e.$filters.currency(n.data.interest,"+ ")),1)])])])],8,x)]),default:_(()=>[v(m(N))]),_:1},8,["data-source"])],512),[[T,y.value>=6]])]))}};export{oe as default};
