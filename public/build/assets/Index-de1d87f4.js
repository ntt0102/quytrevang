import{_ as v,b9 as $,m as _,b as r,r as n,c as p,d as o,t,e as s,g as C,o as d}from"./app-1d96e4f7.js";import{U as k}from"./UserDetailPopup-10ba9ea3.js";import b from"./EditProfilePopup-d2f97f34.js";import D from"./ChangeAvatarPopup-6e4aa5da.js";import w from"./ChangePinPopup-d479085f.js";import y from"./ChangePasswordPopup-ace82e80.js";const B={components:{SendCommentPopup:$,UserDetailPopup:k,EditProfilePopup:b,ChangeAvatarPopup:D,ChangePinPopup:w,ChangePasswordPopup:y},data(){return{isLoading:!0,formData:{}}},mounted(){this.$route.hash==="#detail"&&this.detailInfoClick()},computed:{..._("Auth",["name","code","phone","email","avatar","level"]),popup(){return this.$refs.popup.instance}},methods:{...r("Auth",["clearData"]),...r("User.profile",["fetch","save","delete"]),onSubmit(){this.$refs.editProfileForm.$refs.form.instance.validate().isValid&&(this.popup.option("toolbarItems[0].options.disabled",!0),this.save(this.formData).then(()=>{this.popup.hide(),this.$toasted.success(this.$mt.messages.success.saved)}))},cloneDeepData(){this.formData=this.$mf.cloneDeep(this.profile),this.isLoading=!1},validateBirthday(e){return moment(e.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn(e){return moment(e.value).isBefore(moment().subtract(1,"day"))},detailInfoClick(){this.$refs.userDetailPopup.show({getUser:()=>this.fetch()})},onDeleteClick(){this.$bus.emit("checkPin",()=>{this.delete().then(e=>{e&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),this.clearData(),this.$router.push({name:"login"}))})})}}},A={class:"profile-page"},I={class:"content-block"},U={class:"content-block dx-card responsive-paddings"},q={class:"info"},S=o("div",{class:"avatar"},null,-1),E={class:"personal"},V={class:"name"},L={key:0},N={class:"content-block dx-card responsive-paddings change"},O={class:"title"},R={class:"content"},T={class:"content-block dx-card responsive-paddings delete"},G={class:"title"},W={class:"content"};function F(e,a,M,j,z,l){const c=n("DxToolbar"),i=n("DxButton"),u=n("SendCommentPopup"),m=n("UserDetailPopup"),f=n("EditProfilePopup"),h=n("ChangeAvatarPopup"),P=n("ChangePinPopup"),g=n("ChangePasswordPopup");return d(),p("div",A,[o("h2",I,t(e.$t("user.profile.title")),1),o("div",U,[s(c,{items:[{visible:!!e.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>{e.$router.push({name:e.$route.query.redirect})}}},{visible:e.level<5,location:"before",widget:"dxButton",cssClass:"guiding-step-2b",options:{icon:"far fa-user-edit small",hint:e.$t("components.editProfile.title"),onClick:()=>e.$refs.editProfilePopup.show()}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:e.$t("components.changeAvatar.title"),onClick:()=>e.$refs.changeAvatarPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:e.$t("components.changePin.title"),onClick:()=>e.$refs.changePinPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:e.$t("components.changePassword.title"),onClick:()=>e.$refs.changePasswordPopup.show()}}]},null,8,["items"]),o("div",q,[S,o("div",E,[o("div",null,[o("span",null,t(e.$t("models.user.name"))+":",1),o("span",V,t(e.name),1)]),o("div",null,[o("span",null,t(e.$t("models.user.code"))+":",1),o("span",null,t(e.code),1)]),e.phone?(d(),p("div",L,[o("span",null,t(e.$t("models.user.phone"))+":",1),o("span",null,t(e.phone|e.phone),1)])):C("",!0),o("div",null,[o("span",null,t(e.$t("models.user.email"))+":",1),o("span",null,t(e.email),1)]),s(i,{width:"170",class:"detail",type:"default","styling-mode":"outlined",text:e.$t("user.profile.detailInfo"),onClick:l.detailInfoClick},null,8,["text","onClick"])])])]),o("div",N,[o("div",O,t(e.$t("user.profile.changeRequest.title")),1),o("div",R,[o("div",null,t(e.$t("user.profile.changeRequest.desctiption")),1),s(i,{text:e.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained",onClick:a[0]||(a[0]=H=>e.$refs.sendCommentPopup.show())},null,8,["text"])])]),o("div",T,[o("div",G,t(e.$t("user.profile.delete.title")),1),o("div",W,[o("div",null,t(e.$t("user.profile.delete.desctiption")),1),s(i,{text:e.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained",onClick:l.onDeleteClick},null,8,["text","onClick"])])]),s(u,{ref:"sendCommentPopup"},null,512),s(m,{ref:"userDetailPopup"},null,512),s(f,{ref:"editProfilePopup"},null,512),s(h,{ref:"changeAvatarPopup"},null,512),s(P,{ref:"changePinPopup"},null,512),s(g,{ref:"changePasswordPopup"},null,512)])}const x=v(B,[["render",F]]);export{x as default};
