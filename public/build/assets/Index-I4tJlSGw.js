import T from"./Chart-Dv_w0qmn.js";import{h as x,u as I,k as W,r as t,c as R,a as F,w as q,o as w,p as b,f as D,d as P,v as G,e as u,g,D as L,z as B,_ as O,n as y,b as S,F as $,A as E,B as j,q as z,m as K}from"./app-CAZZVA7L.js";import"./lightweight-charts.esm.development-CUBcxq4C.js";const U={ref:"submitRef",class:"display-none"},J={__name:"SettingPopup",setup(k,{expose:a}){const f=x(),{t:o}=I(),r=W("mt"),n=t(null),s=t(null),p=R(()=>f.state.tradingDerivative.config),i=F({formData:{},validationRules:{tpDefault:[{type:"required",message:o("trading.derivative.settingPopup.tpDefault")+r.validations.required}],slDefault:[{type:"required",message:o("trading.derivative.settingPopup.slDefault")+r.validations.required}]}});q(p,d);function l(){n.value.show()}function h(){f.dispatch("tradingDerivative/setting",i.formData).then(c=>{c?n.value.hide():(d(p.value),e())})}function d(c){i.formData={tpDefault:c.tpDefault,slDefault:c.slDefault}}function e(){setTimeout(()=>{s.value.instance.getEditor("tpDefault").focus()},0)}function m(){d(p.value),e()}function v(){}return a({show:l}),(c,C)=>(w(),b(O,{ref_key:"popupRef",ref:n,width:300,height:260,class:"der-setting-popup",title:c.$t("trading.derivative.buttons.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:c.$t("buttons.save"),onClick:()=>c.$refs.submitRef.click()}}],onShown:m,onHidden:v},{default:D(()=>[P("form",{onSubmit:G(h,["prevent"])},[P("button",U,null,512),u(g(L),{ref_key:"formRef",ref:s,labelLocation:"left","form-data":i.formData},{default:D(()=>[u(g(B.DxItem),{name:"tpDefault","data-field":"tpDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":i.validationRules.tpDefault,label:{text:c.$t("trading.derivative.settingPopup.tpDefault")}},null,8,["validation-rules","label"]),u(g(B.DxItem),{name:"slDefault","data-field":"slDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":i.validationRules.slDefault,label:{text:c.$t("trading.derivative.settingPopup.slDefault")}},null,8,["validation-rules","label"])]),_:1},8,["form-data"])],32)]),_:1},8,["title","toolbarItems"]))}},Q={__name:"PendingOrdersPopup",emits:["closeAllOrders"],setup(k,{expose:a,emit:f}){const o=x(),r=f,n=R(()=>o.state.tradingDerivative.status.pendingOrders),s=t(null),p=[{field:"time",minWidth:100},{field:"type",minWidth:70},{field:"side",minWidth:90},{field:"volume",minWidth:70},{field:"price",minWidth:130}];function i(){s.value.show()}function l(){}function h(){}function d(){r("closeAllOrders")}return a({show:i}),(e,m)=>(w(),b(O,{ref_key:"popupRef",ref:s,class:"der-matched-orders-popup",title:e.$t("trading.derivative.pendingOrdersPopup.title"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:e.$t("trading.derivative.orderContext.closeAll"),onClick:d}}],onShown:l,onHidden:h},{default:D(()=>[u(g(y.DxDataGrid),{"data-source":n.value,"key-expr":"orderNo","show-borders":!0},{default:D(()=>[(w(),S($,null,E(p,v=>u(g(y.DxColumn),{"data-field":v.field,minWidth:v.minWidth,caption:e.$t(`trading.derivative.pendingOrdersPopup.${v.field}`)},null,8,["data-field","minWidth","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title","toolbarItems"]))}},X={__name:"MatchedOrdersPopup",setup(k,{expose:a}){const f=x(),o=t(null),r=t([]),n=[{field:"orderTime",minWidth:100},{field:"side",minWidth:100},{field:"volume",minWidth:100},{field:"matchVolume",minWidth:100},{field:"showPrice",minWidth:100},{field:"avgPrice",minWidth:100}];function s(){o.value.show()}function p(){f.dispatch("tradingDerivative/getMatchedOrders").then(l=>{r.value=l})}function i(){}return a({show:s}),(l,h)=>(w(),b(O,{ref_key:"popupRef",ref:o,class:"der-matched-orders-popup",title:l.$t("trading.derivative.matchedOrdersPopup.title"),onShown:p,onHidden:i},{default:D(()=>[u(g(y.DxDataGrid),{"data-source":r.value,"key-expr":"orderNo","show-borders":!0},{default:D(()=>[(w(),S($,null,E(n,d=>u(g(y.DxColumn),{"data-field":d.field,minWidth:d.minWidth,caption:l.$t(`trading.derivative.matchedOrdersPopup.${d.field}`)},null,8,["data-field","minWidth","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},Y={__name:"VpsOtpPopup",setup(k,{expose:a}){const f=x(),o=t(null),r=t(null),n=t(!1),s=t("");function p(){o.value.show(),setTimeout(i,500)}function i(){navigator.clipboard&&navigator.clipboard.readText().then(e=>{e=e.replace(/\s+/g,""),/^\d{6}$/.test(e)&&r.value.fillInput(e)})}function l(e){f.dispatch("tradingDerivative/loginVps",e).then(m=>{m&&o.value.hide(),r.value.clearInput()})}function h(){n.value=!0}function d(){n.value=!1}return a({show:p}),(e,m)=>(w(),b(O,{ref_key:"popupRef",ref:o,width:400,height:190,class:"vps-otp-popup",title:e.$t("trading.derivative.buttons.loginVps"),onShown:h,onHidden:d},{default:D(()=>[n.value?(w(),b(g(j),{key:0,ref_key:"otpInputRef",ref:r,value:s.value,"onUpdate:value":m[0]||(m[0]=v=>s.value=v),"input-classes":"otp-input",separator:"-","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",onOnComplete:l},null,8,["value"])):z("",!0)]),_:1},8,["title"]))}},Z={class:"derivative-page content-block dx-card responsive-paddings"},ie={__name:"Index",setup(k){const a=x(),{t:f}=I(),o=W("bus"),r=R(()=>a.state.tradingDerivative.config.source),n=t(null),s=t(null),p=t(null),i=t(null),l=t(null),h=t([{text:f("trading.derivative.buttons.downloadExport"),value:"download",icon:"far fa-cloud-arrow-down"},{text:f("trading.derivative.buttons.cloneExport"),value:"clone",icon:"far fa-file-export"}]),d=t([{name:"FIREANT",icon:"far fa-database small"},{name:"DNSE",icon:"far fa-database small"},{name:"VPS",icon:"far fa-database small"}]);function e(){s.value.show()}function m(){p.value.show()}function v(){i.value.show()}function c(){o.emit("checkPin",()=>a.dispatch("tradingDerivative/report"))}function C(){l.value.show()}function A(){o.emit("checkPin",()=>a.dispatch("tradingDerivative/export","download"))}function V({itemData:_}){o.emit("checkPin",()=>a.dispatch("tradingDerivative/export",_.value))}function M({item:{name:_}}){n.value.connectSocket(),a.dispatch("tradingDerivative/setSource",_)}function N(){n.value.closeAllOrders()}return(_,ee)=>{const H=K("DxToolbar");return w(),S($,null,[P("div",Z,[u(H,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-gear small",hint:_.$t("trading.derivative.buttons.setting"),onClick:e}},{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:_.$t("trading.derivative.buttons.report"),onClick:c}},{location:"before",widget:"dxDropDownButton",options:{splitButton:!0,items:h.value,displayExpr:"text",keyExpr:"value",icon:"far fa-cloud-arrow-down small",hint:_.$t("trading.derivative.buttons.downloadExport"),width:"60",dropDownOptions:{width:"160"},elementAttr:{class:"export"},onButtonClick:A,onItemClick:V}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:d.value,displayExpr:"name",keyExpr:"name",selectedItemKey:r.value,stylingMode:"text",useSelectMode:!0,width:"130",elementAttr:{class:"source"},onSelectionChanged:M}}]},null,8,["items"]),u(T,{ref_key:"chartRef",ref:n,onShowPendingOrders:m,onShowMatchedOrders:v,onShowVpsOtpPopup:C},null,512)]),u(J,{ref_key:"settingPopupRef",ref:s},null,512),u(Q,{ref_key:"pendingOrdersPopupRef",ref:p,onCloseAllOrders:N},null,512),u(X,{ref_key:"matchedOrdersPopupRef",ref:i},null,512),u(Y,{ref_key:"vpsOtpPopupRef",ref:l},null,512)],64)}}};export{ie as default};
