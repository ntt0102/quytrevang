import N from"./Chart-bpMd9aAr.js";import{h as x,u as B,k as C,r as t,c as I,a as T,w as F,o as w,p as b,f as _,d as y,v as H,e as c,g,D as q,z as P,_ as R,n as $,b as E,F as O,A,B as G,q as L,m as j}from"./app-CdIY67jA.js";import"./lightweight-charts.esm.development-BggISAd4.js";const z={ref:"submitRef",class:"display-none"},K={__name:"SettingPopup",setup(k,{expose:r}){const f=x(),{t:e}=B(),s=C("mt"),n=t(null),u=t(null),d=I(()=>f.state.tradingDerivative.config),a=T({formData:{},validationRules:{tpDefault:[{type:"required",message:e("trading.derivative.settingPopup.tpDefault")+s.validations.required}],slDefault:[{type:"required",message:e("trading.derivative.settingPopup.slDefault")+s.validations.required}]}});F(d,l);function p(){n.value.show()}function h(){f.dispatch("tradingDerivative/setting",a.formData).then(i=>{i?n.value.hide():(l(d.value),o())})}function l(i){a.formData={tpDefault:i.tpDefault,slDefault:i.slDefault}}function o(){setTimeout(()=>{u.value.instance.getEditor("tpDefault").focus()},0)}function v(){l(d.value),o()}function D(){}return r({show:p}),(i,S)=>(w(),b(R,{ref_key:"popupRef",ref:n,width:300,height:260,class:"der-setting-popup",title:i.$t("trading.derivative.buttons.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:i.$t("buttons.save"),onClick:()=>i.$refs.submitRef.click()}}],onShown:v,onHidden:D},{default:_(()=>[y("form",{onSubmit:H(h,["prevent"])},[y("button",z,null,512),c(g(q),{ref_key:"formRef",ref:u,labelLocation:"left","form-data":a.formData},{default:_(()=>[c(g(P.DxItem),{name:"tpDefault","data-field":"tpDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.tpDefault,label:{text:i.$t("trading.derivative.settingPopup.tpDefault")}},null,8,["validation-rules","label"]),c(g(P.DxItem),{name:"slDefault","data-field":"slDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.slDefault,label:{text:i.$t("trading.derivative.settingPopup.slDefault")}},null,8,["validation-rules","label"])]),_:1},8,["form-data"])],32)]),_:1},8,["title","toolbarItems"]))}},U={__name:"MatchedOrdersPopup",setup(k,{expose:r}){const f=x(),e=t(null),s=t([]),n=["orderTime","side","volume","matchVolume","showPrice","avgPrice"];function u(){e.value.show()}function d(){f.dispatch("tradingDerivative/getMatchedOrders").then(p=>{s.value=p})}function a(){}return r({show:u}),(p,h)=>(w(),b(R,{ref_key:"popupRef",ref:e,class:"der-matched-orders-popup",title:p.$t("trading.derivative.matchedOrders"),onShown:d,onHidden:a},{default:_(()=>[c(g($.DxDataGrid),{"data-source":s.value,"key-expr":"orderNo","show-borders":!0},{default:_(()=>[(w(),E(O,null,A(n,l=>c(g($.DxColumn),{"data-field":l,caption:p.$t(`trading.derivative.matchedOrdersPopup.${l}`)},null,8,["data-field","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},J={__name:"VpsOtpPopup",setup(k,{expose:r}){const f=x(),e=t(null),s=t(null),n=t(!1),u=t("");function d(){e.value.show(),setTimeout(a,500)}function a(){navigator.clipboard&&navigator.clipboard.readText().then(o=>{o=o.replace(/\s+/g,""),/^\d{6}$/.test(o)&&s.value.fillInput(o)})}function p(o){f.dispatch("tradingDerivative/loginVps",o).then(v=>{v&&e.value.hide(),s.value.clearInput()})}function h(){n.value=!0}function l(){n.value=!1}return r({show:d}),(o,v)=>(w(),b(R,{ref_key:"popupRef",ref:e,width:400,height:190,class:"vps-otp-popup",title:o.$t("trading.derivative.buttons.loginVps"),onShown:h,onHidden:l},{default:_(()=>[n.value?(w(),b(g(G),{key:0,ref_key:"otpInputRef",ref:s,value:u.value,"onUpdate:value":v[0]||(v[0]=D=>u.value=D),"input-classes":"otp-input",separator:"-","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",onOnComplete:p},null,8,["value"])):L("",!0)]),_:1},8,["title"]))}},Q={class:"derivative-page content-block dx-card responsive-paddings"},tt={__name:"Index",setup(k){const r=x(),{t:f}=B(),e=C("bus"),s=I(()=>r.state.tradingDerivative.config.source),n=t(null),u=t(null),d=t(null),a=t(null),p=t([{text:f("trading.derivative.buttons.downloadExport"),value:"download",icon:"far fa-cloud-arrow-down"},{text:f("trading.derivative.buttons.cloneExport"),value:"clone",icon:"far fa-file-export"}]),h=t([{name:"FIREANT",icon:"far fa-database small"},{name:"DNSE",icon:"far fa-database small"},{name:"VPS",icon:"far fa-database small"}]);function l(){u.value.show()}function o(){d.value.show()}function v(){e.emit("checkPin",()=>r.dispatch("tradingDerivative/report"))}function D(){a.value.show()}function i(){e.emit("checkPin",()=>r.dispatch("tradingDerivative/export","download"))}function S({itemData:m}){e.emit("checkPin",()=>r.dispatch("tradingDerivative/export",m.value))}function V({item:{name:m}}){n.value.connectSocket(),r.dispatch("tradingDerivative/setSource",m)}return(m,W)=>{const M=j("DxToolbar");return w(),E(O,null,[y("div",Q,[c(M,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-gear small",hint:m.$t("trading.derivative.buttons.setting"),onClick:l}},{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:m.$t("trading.derivative.buttons.report"),onClick:v}},{location:"before",widget:"dxButton",options:{icon:"far fa-arrow-right-to-arc small",hint:m.$t("trading.derivative.buttons.loginVps"),onClick:D}},{location:"before",widget:"dxDropDownButton",options:{splitButton:!0,items:p.value,displayExpr:"text",keyExpr:"value",icon:"far fa-cloud-arrow-down small",hint:m.$t("trading.derivative.buttons.downloadExport"),width:"60",dropDownOptions:{width:"160"},elementAttr:{class:"export"},onButtonClick:i,onItemClick:S}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:h.value,displayExpr:"name",keyExpr:"name",selectedItemKey:s.value,stylingMode:"text",useSelectMode:!0,width:"130",elementAttr:{class:"source"},onSelectionChanged:V}}]},null,8,["items"]),c(N,{ref_key:"chartRef",ref:n,onShowSetting:l,onShowMatchedOrders:o},null,512)]),c(K,{ref_key:"settingPopupRef",ref:u},null,512),c(U,{ref_key:"matchedOrdersPopupRef",ref:d},null,512),c(J,{ref_key:"vpsOtpPopupRef",ref:a},null,512)],64)}}};export{tt as default};
