import{u as R,r as c,a as q,p as N,f as n,_ as S,h as B,k as u,m as E,o as w,e as t,d as b,g as l,ab as s,v as O}from"./app-OuxDpqn6.js";import{i as v,s as _}from"./subDays-UWd6lC_f.js";import{s as A}from"./subYears-DDYq2gwH.js";/* empty css            */const C={ref:"submitRef",class:"display-none"},L={__name:"EditProfilePopup",setup(P,{expose:f}){const d=B(),{t:a}=R(),y=u("bus"),o=u("mt"),m=u("mf"),r=c(null),p=c(null),i=q({formData:null,banks:[],validationRules:{name:[{type:"required",message:a("models.user.name")+o.validations.required},{type:"stringLength",max:50,message:a("models.user.validations.name")}],sex:[{type:"required",message:a("models.user.sex")+o.validations.required}],birthday:[{type:"required",message:a("models.user.birthday")+o.validations.required},{type:"custom",validationCallback:g,message:a("models.user.validations.birthday")}],idNumber:[{type:"required",message:a("models.user.idNumber")+o.validations.required},{type:"async",validationCallback:e=>d.dispatch("userProfile/validateDuplicateIdNumber",e),message:a("models.user.idNumber")+o.validations.duplicate}],idIssuedOn:[{type:"required",message:a("models.user.idIssuedOn")+o.validations.required},{type:"custom",validationCallback:D,message:a("models.user.validations.idIssuedOn")}],phone:[{type:"required",message:a("models.user.phone")+o.validations.required},{type:"async",validationCallback:e=>d.dispatch("userProfile/validateDuplicatePhone",e),message:a("models.user.phone")+o.validations.duplicate}],email:[{type:"required",message:a("models.user.email")+o.validations.required},{type:"email",message:a("models.user.email")+o.validations.email},{type:"async",validationCallback:e=>d.dispatch("userProfile/validateDuplicateEmail",e),message:a("models.user.email")+o.validations.duplicate}],address:[{type:"required",message:a("models.user.address")+o.validations.required},{type:"stringLength",max:100,message:a("models.user.validations.address")}],bankAccount:{bankName:[{type:"required",message:a("models.user.bankName")+o.validations.required}],accountName:[{type:"required",message:a("models.user.accountName")+o.validations.required}],accountNumber:[{type:"required",message:a("models.user.accountNumber")+o.validations.required},{type:"numeric",message:a("models.user.accountNumber")+o.validations.numeric}]}}});function h(e){r.value.show(),i.formData=m.cloneDeep(e)}function x(){y.emit("checkPin",()=>{d.dispatch("userProfile/save",i.formData).then(e=>{e&&r.value.hide()})})}function g(e){return v(new Date(e.value),A(new Date,18))}function D(e){return v(new Date(e.value),_(new Date,1))}function k(){setTimeout(()=>p.value.instance.getEditor("name").focus(),500),m.getBanks().then(e=>i.banks=e)}function I(){}return f({show:h}),(e,T)=>{const $=E("DxScrollView");return w(),N(S,{ref_key:"popupRef",ref:r,title:e.$t("components.editProfile.title"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:e.$t("buttons.save"),onClick:()=>e.$refs.submitRef.click()}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:e.$t("buttons.cancel"),onClick:()=>r.value.hide()}}],onShown:k,onHidden:I},{default:n(()=>[t($,null,{default:n(()=>[b("form",{onSubmit:O(x,["prevent"])},[b("button",C,null,512),t(l(s.DxForm),{ref_key:"formRef",ref:p,"form-data":i.formData,labelMode:"floating","col-count":2,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:n(()=>[t(l(s.DxItem),{"item-type":"group",caption:e.$t("models.user.groups.personalInfo")},{default:n(()=>[t(l(s.DxItem),{"data-field":"name","validation-rules":i.validationRules.name,label:{text:e.$t("models.user.name")}},null,8,["validation-rules","label"]),t(l(s.DxItem),{"data-field":"sex","editor-type":"dxSelectBox","editor-options":{searchEnabled:!1,items:e.$mf.getSexList(),displayExpr:"name",valueExpr:"value",placeholder:e.$t("titles.dxSelectPlacehoder")},"validation-rules":i.validationRules.sex,label:{text:e.$t("models.user.sex")}},null,8,["editor-options","validation-rules","label"]),t(l(s.DxItem),{"data-field":"birthday","editor-type":"dxDateBox","editor-options":{dateSerializationFormat:e.$mc.DX_SERVER_DATE_FORMAT,showClearButton:"true",useMaskBehavior:"true"},"validation-rules":i.validationRules.birthday,label:{text:e.$t("models.user.birthday")}},null,8,["editor-options","validation-rules","label"])]),_:1},8,["caption"]),t(l(s.DxItem),{"item-type":"group",caption:e.$t("models.user.groups.idInfo")},{default:n(()=>[t(l(s.DxItem),{"data-field":"identity.number",editorOptions:{mask:"000000000000"},"validation-rules":i.validationRules.idNumber,label:{text:e.$t("models.user.idNumber")}},null,8,["validation-rules","label"]),t(l(s.DxItem),{"data-field":"identity.issued_on","editor-type":"dxDateBox","editor-options":{dateSerializationFormat:e.$mc.DX_SERVER_DATE_FORMAT,showClearButton:"true",useMaskBehavior:"true"},"validation-rules":i.validationRules.idIssuedOn,label:{text:e.$t("models.user.idIssuedOn")}},null,8,["editor-options","validation-rules","label"]),t(l(s.DxItem),{"data-field":"",editorOptions:{value:e.$mt.idIssuedAtValue,readOnly:!0},label:{text:e.$t("models.user.idIssuedAt")}},null,8,["editorOptions","label"])]),_:1},8,["caption"]),t(l(s.DxItem),{"item-type":"group","col-span":2,"col-count":2,caption:e.$t("models.user.groups.contactInfo")},{default:n(()=>[t(l(s.DxItem),{"data-field":"phone",editorOptions:{mask:"0000.000.000"},"validation-rules":i.validationRules.phone,label:{text:e.$t("models.user.phone")}},null,8,["validation-rules","label"]),t(l(s.DxItem),{"data-field":"email","validation-rules":i.validationRules.email,label:{text:e.$t("models.user.email")}},null,8,["validation-rules","label"]),t(l(s.DxItem),{"col-span":2,"data-field":"address","editor-type":"dxTextArea","validation-rules":i.validationRules.address,label:{text:e.$t("models.user.address")}},null,8,["validation-rules","label"])]),_:1},8,["caption"]),t(l(s.DxItem),{"item-type":"group","col-span":2,"col-count":2,caption:e.$t("models.user.groups.bankInfo")},{default:n(()=>[t(l(s.DxItem),{"data-field":"bank_account.bank_name","editor-type":"dxSelectBox","editor-options":{searchEnabled:!0,items:i.banks,displayExpr:"short_name",searchExpr:"short_name",valueExpr:"short_name",placeholder:e.$t("titles.dxSelectPlacehoder")},"validation-rules":i.validationRules.bankAccount.bankName,label:{text:e.$t("models.user.bankName")}},null,8,["editor-options","validation-rules","label"]),t(l(s.DxItem),{"data-field":"bank_account.account_number","validation-rules":i.validationRules.bankAccount.accountNumber,label:{text:e.$t("models.user.accountNumber")}},null,8,["validation-rules","label"]),t(l(s.DxItem),{"data-field":"bank_account.account_name","editor-type":"dxTextBox","editor-options":{inputAttr:{style:"text-transform: uppercase"}},"validation-rules":i.validationRules.bankAccount.accountName,label:{text:e.$t("models.user.accountName")}},null,8,["validation-rules","label"])]),_:1},8,["caption"])]),_:1},8,["form-data","label-location"])],32)]),_:1})]),_:1},8,["title","toolbarItems"])}}};export{L as default};
