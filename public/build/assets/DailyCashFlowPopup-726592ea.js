import{u as Ei,r as ue,d as Ii,f as Bi,n as Oi,k as de,_ as Wi,o as zi,j as Fi,h as fe,B as Ni,C as Hi}from"./app-1f0f8aae.js";var Ui={allowDownsampling:!0};function Yi(i,t){return t===void 0&&(t=Ui),new Xi(i,t)}var Xi=function(){function i(t,e){var r=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(a){return r._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=e,this._configureCanvas(),this._installResolutionListener()}return i.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(i.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),i.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(i.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(t==null)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),i.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},i.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter(function(e){return e!=t})},i.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},i.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach(function(e){return e.call(t)})},i.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(t==null)throw new Error("No window is associated with the canvas");var e=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+e+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},i.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},i.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},i.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},i}();/*!
 * @license
 * TradingView Lightweight Charts v3.8.0-dev+202305090356
 * Copyright (c) 2020 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */var me;(function(i){i[i.Simple=0]="Simple",i[i.WithSteps=1]="WithSteps"})(me||(me={}));var ge;(function(i){i[i.Solid=0]="Solid",i[i.Dotted=1]="Dotted",i[i.Dashed=2]="Dashed",i[i.LargeDashed=3]="LargeDashed",i[i.SparseDotted=4]="SparseDotted"})(ge||(ge={}));function q(i,t){var e,r=(e={},e[0]=[],e[1]=[i.lineWidth,i.lineWidth],e[2]=[2*i.lineWidth,2*i.lineWidth],e[3]=[6*i.lineWidth,6*i.lineWidth],e[4]=[i.lineWidth,4*i.lineWidth],e),a=r[t];i.setLineDash(a)}function _i(i,t,e,r){i.beginPath();var a=i.lineWidth%2?.5:0;i.moveTo(e,t+a),i.lineTo(r,t+a),i.stroke()}function qi(i,t,e,r){i.beginPath();var a=i.lineWidth%2?.5:0;i.moveTo(t+a,e),i.lineTo(t+a,r),i.stroke()}function Gi(i,t){i.save(),i.lineWidth%2&&i.translate(.5,.5),t(),i.restore()}function x(i,t){if(!i)throw new Error("Assertion failed"+(t?": "+t:""))}function E(i){if(i===void 0)throw new Error("Value is undefined");return i}function g(i){if(i===null)throw new Error("Value is null");return i}function nt(i){return g(E(i))}var ye={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function V(i){return i<0?0:i>255?255:Math.round(i)||0}function ni(i){return!(i<=0)&&!(i>0)||i<0?0:i>1?1:Math.round(i*1e4)/1e4}var ji=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,Ki=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,Zi=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,$i=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function Mt(i){i=i.toLowerCase(),i in ye&&(i=ye[i]);{var t=$i.exec(i)||Zi.exec(i);if(t)return[V(parseInt(t[1],10)),V(parseInt(t[2],10)),V(parseInt(t[3],10)),ni(t.length<5?1:parseFloat(t[4]))]}{var t=Ki.exec(i);if(t)return[V(parseInt(t[1],16)),V(parseInt(t[2],16)),V(parseInt(t[3],16)),1]}{var t=ji.exec(i);if(t)return[V(parseInt(t[1],16)*17),V(parseInt(t[2],16)*17),V(parseInt(t[3],16)*17),1]}throw new Error("Cannot parse color: ".concat(i))}function Qi(i){var t=.199,e=.687,r=.114;return t*i[0]+e*i[1]+r*i[2]}function Ji(i,t){if(i==="transparent")return i;var e=Mt(i),r=e[3];return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(t*r,")")}function Lt(i){var t=Mt(i);return{_internal_background:"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")"),_internal_foreground:Qi(t)>160?"black":"white"}}function tr(i,t,e){var r=Mt(i),a=r[0],_=r[1],n=r[2],s=r[3],o=Mt(t),l=o[0],p=o[1],v=o[2],h=o[3],c=[V(a+e*(l-a)),V(_+e*(p-_)),V(n+e*(v-n)),ni(s+e*(h-s))];return"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", ").concat(c[3],")")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qt=function(i,t){return Qt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])},Qt(i,t)};function w(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Qt(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var P=function(){return P=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])}return t},P.apply(this,arguments)};function er(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(i);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(i,r[a])&&(e[r[a]]=i[r[a]]);return e}function si(i,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,_;r<a;r++)(_||!(r in t))&&(_||(_=Array.prototype.slice.call(t,0,r)),_[r]=t[r]);return i.concat(_||Array.prototype.slice.call(t))}var M=function(){function i(){this._private__listeners=[]}return i.prototype.subscribe=function(t,e,r){var a={_internal_callback:t,_internal_linkedObject:e,_internal_singleshot:r===!0};this._private__listeners.push(a)},i.prototype.unsubscribe=function(t){var e=this._private__listeners.findIndex(function(r){return t===r._internal_callback});e>-1&&this._private__listeners.splice(e,1)},i.prototype.unsubscribeAll=function(t){this._private__listeners=this._private__listeners.filter(function(e){return e._internal_linkedObject!==t})},i.prototype._internal_fire=function(t,e){var r=si([],this._private__listeners,!0);this._private__listeners=this._private__listeners.filter(function(a){return!a._internal_singleshot}),r.forEach(function(a){return a._internal_callback(t,e)})},i.prototype._internal_hasListeners=function(){return this._private__listeners.length>0},i.prototype._internal_destroy=function(){this._private__listeners=[]},i}();function R(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0,a=t;r<a.length;r++){var _=a[r];for(var n in _)_[n]!==void 0&&(typeof _[n]!="object"||i[n]===void 0?i[n]=_[n]:R(i[n],_[n]))}return i}function O(i){return typeof i=="number"&&isFinite(i)}function pt(i){return typeof i=="number"&&i%1===0}function ee(i){return typeof i=="string"}function Ft(i){return typeof i=="boolean"}function L(i){var t=i;if(!t||typeof t!="object")return t;var e;Array.isArray(t)?e=[]:e={};var r,a;for(r in t)t.hasOwnProperty(r)&&(a=t[r],a&&typeof a=="object"?e[r]=L(a):e[r]=a);return e}function ir(i){return i!==null}function Tt(i){return i===null?void 0:i}var ie="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function G(i,t,e){return e!==void 0?e="".concat(e," "):e="",t===void 0&&(t=ie),"".concat(e).concat(i,"px ").concat(t)}var rr=function(){function i(t){this._private__rendererOptions={borderSize:1,tickLength:4,fontSize:NaN,font:"",fontFamily:"",color:"",paddingBottom:0,paddingInner:0,paddingOuter:0,paddingTop:0,baselineOffset:0},this._private__chartModel=t}return i.prototype.options=function(){var t=this._private__rendererOptions,e=this._private__fontSize(),r=this._private__fontFamily();return(t.fontSize!==e||t.fontFamily!==r)&&(t.fontSize=e,t.fontFamily=r,t.font=G(e,r),t.paddingTop=Math.floor(e/3.5),t.paddingBottom=t.paddingTop,t.paddingInner=Math.max(Math.ceil(e/2-t.tickLength/2),0),t.paddingOuter=Math.ceil(e/2+t.tickLength/2),t.baselineOffset=Math.round(e/10)),t.color=this._private__textColor(),this._private__rendererOptions},i.prototype._private__textColor=function(){return this._private__chartModel.options().layout.textColor},i.prototype._private__fontSize=function(){return this._private__chartModel.options().layout.fontSize},i.prototype._private__fontFamily=function(){return this._private__chartModel.options().layout.fontFamily},i}(),xt=function(){function i(){this._private__renderers=[]}return i.prototype._internal_setRenderers=function(t){this._private__renderers=t},i.prototype.draw=function(t,e,r,a){this._private__renderers.forEach(function(_){t.save(),_.draw(t,e,r,a),t.restore()})},i}(),ht=function(){function i(){}return i.prototype.draw=function(t,e,r,a){t.save(),t.scale(e,e),this._internal__drawImpl(t,r,a),t.restore()},i.prototype.drawBackground=function(t,e,r,a){t.save(),t.scale(e,e),this._internal__drawBackgroundImpl(t,r,a),t.restore()},i.prototype._internal__drawBackgroundImpl=function(t,e,r){},i}(),ar=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._internal__data=null,e}return t.prototype._internal_setData=function(e){this._internal__data=e},t.prototype._internal__drawImpl=function(e){if(!(this._internal__data===null||this._internal__data._internal_visibleRange===null)){var r=this._internal__data._internal_visibleRange,a=this._internal__data,_=function(n){e.beginPath();for(var s=r.to-1;s>=r.from;--s){var o=a._internal_items[s];e.moveTo(o.x,o.y),e.arc(o.x,o.y,n,0,Math.PI*2)}e.fill()};e.fillStyle=a._internal_backColor,_(a._internal_radius+2),e.fillStyle=a._internal_lineColor,_(a._internal_radius)}},t}(ht);function _r(){return{_internal_items:[{x:0,y:0,time:0,price:0}],_internal_lineColor:"",_internal_backColor:"",_internal_radius:0,_internal_visibleRange:null}}var nr={from:0,to:1},sr=function(){function i(t,e){this._private__compositeRenderer=new xt,this._private__markersRenderers=[],this._private__markersData=[],this._private__invalidated=!0,this._private__chartModel=t,this._private__crosshair=e,this._private__compositeRenderer._internal_setRenderers(this._private__markersRenderers)}return i.prototype.update=function(t){var e=this._private__chartModel.serieses();e.length!==this._private__markersRenderers.length&&(this._private__markersData=e.map(_r),this._private__markersRenderers=this._private__markersData.map(function(r){var a=new ar;return a._internal_setData(r),a}),this._private__compositeRenderer._internal_setRenderers(this._private__markersRenderers)),this._private__invalidated=!0},i.prototype.renderer=function(t,e,r){return this._private__invalidated&&(this._private__updateImpl(t),this._private__invalidated=!1),this._private__compositeRenderer},i.prototype._private__updateImpl=function(t){var e=this,r=this._private__chartModel.serieses(),a=this._private__crosshair.appliedIndex(),_=this._private__chartModel.timeScale();r.forEach(function(n,s){var o,l=e._private__markersData[s],p=n.markerDataAtIndex(a);if(p===null||!n.visible()){l._internal_visibleRange=null;return}var v=g(n.firstValue());l._internal_lineColor=p.backgroundColor,l._internal_radius=p.radius,l._internal_items[0].price=p.price,l._internal_items[0].y=n.priceScale().priceToCoordinate(p.price,v.value),l._internal_backColor=(o=p.borderColor)!==null&&o!==void 0?o:e._private__chartModel.backgroundColorAtYPercentFromTop(l._internal_items[0].y/t),l._internal_items[0].time=a,l._internal_items[0].x=_.indexToCoordinate(a),l._internal_visibleRange=nr})},i}(),or=function(){function i(t){this._private__data=t}return i.prototype.draw=function(t,e,r,a){if(this._private__data!==null){var _=this._private__data._internal_vertLine._internal_visible,n=this._private__data._internal_horzLine._internal_visible;if(!(!_&&!n)){t.save();var s=Math.round(this._private__data._internal_x*e),o=Math.round(this._private__data._internal_y*e),l=Math.ceil(this._private__data._internal_w*e),p=Math.ceil(this._private__data._internal_h*e);t.lineCap="butt",_&&s>=0&&(t.lineWidth=Math.floor(this._private__data._internal_vertLine._internal_lineWidth*e),t.strokeStyle=this._private__data._internal_vertLine._internal_color,t.fillStyle=this._private__data._internal_vertLine._internal_color,q(t,this._private__data._internal_vertLine._internal_lineStyle),qi(t,s,0,p)),n&&o>=0&&(t.lineWidth=Math.floor(this._private__data._internal_horzLine._internal_lineWidth*e),t.strokeStyle=this._private__data._internal_horzLine._internal_color,t.fillStyle=this._private__data._internal_horzLine._internal_color,q(t,this._private__data._internal_horzLine._internal_lineStyle),_i(t,o,0,l)),t.restore()}}},i}(),lr=function(){function i(t){this._private__invalidated=!0,this._private__rendererData={_internal_vertLine:{_internal_lineWidth:1,_internal_lineStyle:0,_internal_color:"",_internal_visible:!1},_internal_horzLine:{_internal_lineWidth:1,_internal_lineStyle:0,_internal_color:"",_internal_visible:!1},_internal_w:0,_internal_h:0,_internal_x:0,_internal_y:0},this._private__renderer=new or(this._private__rendererData),this._private__source=t}return i.prototype._internal_update=function(){this._private__invalidated=!0},i.prototype.renderer=function(t,e){return this._private__invalidated&&(this._private__updateImpl(),this._private__invalidated=!1),this._private__renderer},i.prototype._private__updateImpl=function(){var t=this._private__source.visible(),e=g(this._private__source.pane()),r=e.model().options().crosshair,a=this._private__rendererData;a._internal_horzLine._internal_visible=t&&this._private__source.horzLineVisible(e),a._internal_vertLine._internal_visible=t&&this._private__source.vertLineVisible(),a._internal_horzLine._internal_lineWidth=r.horzLine.width,a._internal_horzLine._internal_lineStyle=r.horzLine.style,a._internal_horzLine._internal_color=r.horzLine.color,a._internal_vertLine._internal_lineWidth=r.vertLine.width,a._internal_vertLine._internal_lineStyle=r.vertLine.style,a._internal_vertLine._internal_color=r.vertLine.color,a._internal_w=e.width(),a._internal_h=e.height(),a._internal_x=this._private__source.appliedX(),a._internal_y=this._private__source.appliedY()},i}();function pr(i,t,e,r,a,_){i.fillRect(t+_,e,r-_*2,_),i.fillRect(t+_,e+a-_,r-_*2,_),i.fillRect(t,e,_,a),i.fillRect(t+r-_,e,_,a)}function z(i,t,e){i.save(),i.scale(t,t),e(),i.restore()}function At(i,t,e,r,a,_){i.save(),i.globalCompositeOperation="copy",i.fillStyle=_,i.fillRect(t,e,r,a),i.restore()}function oi(i,t,e,r,a,_,n){i.save(),i.globalCompositeOperation="copy";var s=i.createLinearGradient(0,0,0,a);s.addColorStop(0,_),s.addColorStop(1,n),i.fillStyle=s,i.fillRect(t,e,r,a),i.restore()}var be=function(){function i(t,e){this.setData(t,e)}return i.prototype.setData=function(t,e){this._private__data=t,this._private__commonData=e},i.prototype.draw=function(t,e,r,a,_,n){if(this._private__data.visible){t.font=e.font;var s=this._private__data.tickVisible||!this._private__data.moveTextToInvisibleTick?e.tickLength:0,o=e.borderSize,l=e.paddingTop,p=e.paddingBottom,v=e.paddingInner,h=e.paddingOuter,c=this._private__data.text,u=Math.ceil(r.measureText(t,c)),f=e.baselineOffset,d=e.fontSize+l+p,m=Math.ceil(d*.5),y=o+u+v+h+s,b=this._private__commonData.coordinate;this._private__commonData.fixedCoordinate&&(b=this._private__commonData.fixedCoordinate),b=Math.round(b);var C=b-m,S=C+d,T=_==="right",k=T?a:0,I=Math.ceil(a*n),F=k,U,Ot;if(t.fillStyle=this._private__commonData.background,t.lineWidth=1,t.lineCap="butt",c){T?(F=k-y,U=k-s,Ot=F+h):(F=k+y,U=k+s,Ot=k+o+s+v);var ve=Math.max(1,Math.floor(n)),he=Math.max(1,Math.floor(o*n)),dt=T?I:0,at=Math.round(C*n),ce=Math.round(F*n),Wt=Math.round(b*n)-Math.floor(n*.5),zt=Wt+ve+(Wt-at),Vi=Math.round(U*n);t.save(),t.beginPath(),t.moveTo(dt,at),t.lineTo(ce,at),t.lineTo(ce,zt),t.lineTo(dt,zt),t.fill(),t.fillStyle=this._private__data.borderColor,t.fillRect(T?I-he:0,at,he,zt-at),this._private__data.tickVisible&&(t.fillStyle=this._private__commonData.color,t.fillRect(dt,Wt,Vi-dt,ve)),t.textAlign="left",t.fillStyle=this._private__commonData.color,z(t,n,function(){t.fillText(c,Ot,S-p-f)}),t.restore()}}},i.prototype.height=function(t,e){return this._private__data.visible?t.fontSize+t.paddingTop+t.paddingBottom:0},i}(),re=function(){function i(t){this._private__commonRendererData={coordinate:0,color:"#FFF",background:"#000"},this._private__axisRendererData={text:"",visible:!1,tickVisible:!0,moveTextToInvisibleTick:!1,borderColor:""},this._private__paneRendererData={text:"",visible:!1,tickVisible:!1,moveTextToInvisibleTick:!0,borderColor:""},this._private__invalidated=!0,this._private__axisRenderer=new(t||be)(this._private__axisRendererData,this._private__commonRendererData),this._private__paneRenderer=new(t||be)(this._private__paneRendererData,this._private__commonRendererData)}return i.prototype.text=function(){return this._private__updateRendererDataIfNeeded(),this._private__axisRendererData.text},i.prototype.coordinate=function(){return this._private__updateRendererDataIfNeeded(),this._private__commonRendererData.coordinate},i.prototype.update=function(){this._private__invalidated=!0},i.prototype.height=function(t,e){return e===void 0&&(e=!1),Math.max(this._private__axisRenderer.height(t,e),this._private__paneRenderer.height(t,e))},i.prototype.getFixedCoordinate=function(){return this._private__commonRendererData.fixedCoordinate||0},i.prototype.setFixedCoordinate=function(t){this._private__commonRendererData.fixedCoordinate=t},i.prototype.isVisible=function(){return this._private__updateRendererDataIfNeeded(),this._private__axisRendererData.visible||this._private__paneRendererData.visible},i.prototype.isAxisLabelVisible=function(){return this._private__updateRendererDataIfNeeded(),this._private__axisRendererData.visible},i.prototype.renderer=function(t){return this._private__updateRendererDataIfNeeded(),this._private__axisRendererData.tickVisible=this._private__axisRendererData.tickVisible&&t.options().drawTicks,this._private__paneRendererData.tickVisible=this._private__paneRendererData.tickVisible&&t.options().drawTicks,this._private__axisRenderer.setData(this._private__axisRendererData,this._private__commonRendererData),this._private__paneRenderer.setData(this._private__paneRendererData,this._private__commonRendererData),this._private__axisRenderer},i.prototype.paneRenderer=function(){return this._private__updateRendererDataIfNeeded(),this._private__axisRenderer.setData(this._private__axisRendererData,this._private__commonRendererData),this._private__paneRenderer.setData(this._private__paneRendererData,this._private__commonRendererData),this._private__paneRenderer},i.prototype._private__updateRendererDataIfNeeded=function(){this._private__invalidated&&(this._private__axisRendererData.tickVisible=!0,this._private__paneRendererData.tickVisible=!1,this._internal__updateRendererData(this._private__axisRendererData,this._private__paneRendererData,this._private__commonRendererData))},i}(),vr=function(i){w(t,i);function t(e,r,a){var _=i.call(this)||this;return _._private__source=e,_._private__priceScale=r,_._private__valueProvider=a,_}return t.prototype._internal__updateRendererData=function(e,r,a){e.visible=!1;var _=this._private__source.options().horzLine;if(_.labelVisible){var n=this._private__priceScale.firstValue();if(!(!this._private__source.visible()||this._private__priceScale.isEmpty()||n===null)){var s=Lt(_.labelBackgroundColor);a.background=s._internal_background,a.color=s._internal_foreground;var o=this._private__valueProvider(this._private__priceScale);a.coordinate=o._internal_coordinate,e.text=this._private__priceScale.formatPrice(o._internal_price,n),e.visible=!0}}},t}(re),hr=/[1-9]/g,cr=function(){function i(){this._private__data=null}return i.prototype.setData=function(t){this._private__data=t},i.prototype.draw=function(t,e,r){var a=this;if(!(this._private__data===null||this._private__data.visible===!1||this._private__data.text.length===0)){t.font=e.font;var _=Math.round(e.widthCache.measureText(t,this._private__data.text,hr));if(!(_<=0)){t.save();var n=e.paddingHorizontal,s=_+2*n,o=s/2,l=this._private__data.width,p=this._private__data.coordinate,v=Math.floor(p-o)+.5;v<0?(p=p+Math.abs(0-v),v=Math.floor(p-o)+.5):v+s>l&&(p=p-Math.abs(l-(v+s)),v=Math.floor(p-o)+.5);var h=v+s,c=0,u=c+e.borderSize+e.paddingTop+e.fontSize+e.paddingBottom;t.fillStyle=this._private__data.background;var f=Math.round(v*r),d=Math.round(c*r),m=Math.round(h*r),y=Math.round(u*r);t.fillRect(f,d,m-f,y-d);var b=Math.round(this._private__data.coordinate*r),C=d,S=Math.round((C+e.borderSize+e.tickLength)*r);t.fillStyle=this._private__data.color;var T=Math.max(1,Math.floor(r)),k=Math.floor(r*.5);t.fillRect(b-k,C,T,S-C);var I=u-e.baselineOffset-e.paddingBottom;t.textAlign="left",t.fillStyle=this._private__data.color,z(t,r,function(){t.fillText(g(a._private__data).text,v+n,I)}),t.restore()}}},i}(),ur=function(){function i(t,e,r){this._private__invalidated=!0,this._private__renderer=new cr,this._private__rendererData={visible:!1,background:"#4c525e",color:"white",text:"",width:0,coordinate:NaN},this._private__crosshair=t,this._private__model=e,this._private__valueProvider=r}return i.prototype._internal_update=function(){this._private__invalidated=!0},i.prototype.renderer=function(){return this._private__invalidated&&(this._private__updateImpl(),this._private__invalidated=!1),this._private__renderer.setData(this._private__rendererData),this._private__renderer},i.prototype._private__updateImpl=function(){var t=this._private__rendererData;t.visible=!1;var e=this._private__crosshair.options().vertLine;if(e.labelVisible){var r=this._private__model.timeScale();if(!r.isEmpty()){var a=r.indexToTime(this._private__crosshair.appliedIndex());t.width=r.width();var _=this._private__valueProvider();if(_._internal_time){t.coordinate=_._internal_coordinate,t.text=r.formatDateTime(g(a)),t.visible=!0;var n=Lt(e.labelBackgroundColor);t.background=n._internal_background,t.color=n._internal_foreground}}}},i}(),ae=function(){function i(){this._priceScale=null,this._private__zorder=0}return i.prototype.zorder=function(){return this._private__zorder},i.prototype.setZorder=function(t){this._private__zorder=t},i.prototype.priceScale=function(){return this._priceScale},i.prototype.setPriceScale=function(t){this._priceScale=t},i.prototype.timeAxisViews=function(){return[]},i.prototype.visible=function(){return!0},i}(),Se;(function(i){i[i.Normal=0]="Normal",i[i.Magnet=1]="Magnet"})(Se||(Se={}));var dr=function(i){w(t,i);function t(e,r){var a=i.call(this)||this;a._private__pane=null,a._private__price=NaN,a._private__index=0,a._private__visible=!0,a._private__priceAxisViews=new Map,a._private__subscribed=!1,a._private__x=NaN,a._private__y=NaN,a._private__originX=NaN,a._private__originY=NaN,a._private__model=e,a._private__options=r,a._private__markersPaneView=new sr(e,a);var _=function(o,l){return function(p){var v=l(),h=o();if(p===g(a._private__pane).defaultPriceScale())return{_internal_price:h,_internal_coordinate:v};var c=g(p.firstValue()),u=p.coordinateToPrice(v,c);return{_internal_price:u,_internal_coordinate:v}}},n=function(o,l){return function(){return{_internal_time:a._private__model.timeScale().indexToTime(o()),_internal_coordinate:l()}}};a._private__currentPosPriceProvider=_(function(){return a._private__price},function(){return a._private__y});var s=n(function(){return a._private__index},function(){return a.appliedX()});return a._private__timeAxisView=new ur(a,e,s),a._private__paneView=new lr(a),a}return t.prototype.options=function(){return this._private__options},t.prototype.saveOriginCoord=function(e,r){this._private__originX=e,this._private__originY=r},t.prototype.clearOriginCoord=function(){this._private__originX=NaN,this._private__originY=NaN},t.prototype.originCoordX=function(){return this._private__originX},t.prototype.originCoordY=function(){return this._private__originY},t.prototype.setPosition=function(e,r,a){this._private__subscribed||(this._private__subscribed=!0),this._private__visible=!0,this._private__tryToUpdateViews(e,r,a)},t.prototype.appliedIndex=function(){return this._private__index},t.prototype.appliedX=function(){return this._private__x},t.prototype.appliedY=function(){return this._private__y},t.prototype.visible=function(){return this._private__visible},t.prototype.clearPosition=function(){this._private__visible=!1,this._private__setIndexToLastSeriesBarIndex(),this._private__price=NaN,this._private__x=NaN,this._private__y=NaN,this._private__pane=null,this.clearOriginCoord()},t.prototype.paneViews=function(e){return this._private__pane!==null?[this._private__paneView,this._private__markersPaneView]:[]},t.prototype.horzLineVisible=function(e){return e===this._private__pane&&this._private__options.horzLine.visible},t.prototype.vertLineVisible=function(){return this._private__options.vertLine.visible},t.prototype.priceAxisViews=function(e,r){(!this._private__visible||this._private__pane!==e)&&this._private__priceAxisViews.clear();var a=[];return this._private__pane===e&&a.push(this._private__createPriceAxisViewOnDemand(this._private__priceAxisViews,r,this._private__currentPosPriceProvider)),a},t.prototype.timeAxisViews=function(){return this._private__visible?[this._private__timeAxisView]:[]},t.prototype.pane=function(){return this._private__pane},t.prototype.updateAllViews=function(){this._private__paneView._internal_update(),this._private__priceAxisViews.forEach(function(e){return e.update()}),this._private__timeAxisView._internal_update(),this._private__markersPaneView.update()},t.prototype._private__priceScaleByPane=function(e){return e&&!e.defaultPriceScale().isEmpty()?e.defaultPriceScale():null},t.prototype._private__tryToUpdateViews=function(e,r,a){this._private__tryToUpdateData(e,r,a)&&this.updateAllViews()},t.prototype._private__tryToUpdateData=function(e,r,a){var _=this._private__x,n=this._private__y,s=this._private__price,o=this._private__index,l=this._private__pane,p=this._private__priceScaleByPane(a);this._private__index=e,this._private__x=isNaN(e)?NaN:this._private__model.timeScale().indexToCoordinate(e),this._private__pane=a;var v=p!==null?p.firstValue():null;return p!==null&&v!==null?(this._private__price=r,this._private__y=p.priceToCoordinate(r,v)):(this._private__price=NaN,this._private__y=NaN),_!==this._private__x||n!==this._private__y||o!==this._private__index||s!==this._private__price||l!==this._private__pane},t.prototype._private__setIndexToLastSeriesBarIndex=function(){var e=this._private__model.serieses().map(function(a){return a.bars().lastIndex()}).filter(ir),r=e.length===0?null:Math.max.apply(Math,e);this._private__index=r!==null?r:NaN},t.prototype._private__createPriceAxisViewOnDemand=function(e,r,a){var _=e.get(r);return _===void 0&&(_=new vr(this,r,a),e.set(r,_)),_},t}(ae);function Vt(i){return i==="left"||i==="right"}function fr(i,t){if(i===void 0)return t;var e=Math.max(i.level,t.level),r=i.autoScale||t.autoScale;return{level:e,autoScale:r}}var A=function(){function i(t){this._private__invalidatedPanes=new Map,this._private__timeScaleInvalidations=[],this._private__globalLevel=t}return i.prototype.invalidatePane=function(t,e){var r=this._private__invalidatedPanes.get(t),a=fr(r,e);this._private__invalidatedPanes.set(t,a)},i.prototype.fullInvalidation=function(){return this._private__globalLevel},i.prototype.invalidateForPane=function(t){var e=this._private__invalidatedPanes.get(t);return e===void 0?{level:this._private__globalLevel}:{level:Math.max(this._private__globalLevel,e.level),autoScale:e.autoScale}},i.prototype.setFitContent=function(){this._private__timeScaleInvalidations=[{type:0}]},i.prototype.applyRange=function(t){this._private__timeScaleInvalidations=[{type:1,value:t}]},i.prototype.resetTimeScale=function(){this._private__timeScaleInvalidations=[{type:4}]},i.prototype.setBarSpacing=function(t){this._private__timeScaleInvalidations.push({type:2,value:t})},i.prototype.setRightOffset=function(t){this._private__timeScaleInvalidations.push({type:3,value:t})},i.prototype.timeScaleInvalidations=function(){return this._private__timeScaleInvalidations},i.prototype.merge=function(t){for(var e=this,r=0,a=t._private__timeScaleInvalidations;r<a.length;r++){var _=a[r];this._private__applyTimeScaleInvalidation(_)}this._private__globalLevel=Math.max(this._private__globalLevel,t._private__globalLevel),t._private__invalidatedPanes.forEach(function(n,s){e.invalidatePane(s,n)})},i.prototype._private__applyTimeScaleInvalidation=function(t){switch(t.type){case 0:this.setFitContent();break;case 1:this.applyRange(t.value);break;case 2:this.setBarSpacing(t.value);break;case 3:this.setRightOffset(t.value);break;case 4:this.resetTimeScale();break}},i}(),we={_internal_decimalSign:".",_internal_decimalSignFractional:"'"};function N(i,t){if(!O(i))return"n/a";if(!pt(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");if(t===0)return i.toString();var e="0000000000000000";return(e+i.toString()).slice(-t)}var Et=function(){function i(t,e){if(e||(e=1),(!O(t)||!pt(t))&&(t=100),t<0)throw new TypeError("invalid base");this._private__priceScale=t,this._private__minMove=e,this._private__calculateDecimal()}return i.prototype.format=function(t){var e=t<0?"−":"";return t=Math.abs(t),e+this._private__formatAsDecimal(t)},i.prototype._private__calculateDecimal=function(){if(this._internal__fractionalLength=0,this._private__priceScale>0&&this._private__minMove>0)for(var t=this._private__priceScale;t>1;)t/=10,this._internal__fractionalLength++},i.prototype._private__formatAsDecimal=function(t){var e=this._private__priceScale/this._private__minMove,r=Math.floor(t),a="",_=this._internal__fractionalLength!==void 0?this._internal__fractionalLength:NaN;if(e>1){var n=+(Math.round(t*e)-r*e).toFixed(this._internal__fractionalLength);n>=e&&(n-=e,r+=1),a=we._internal_decimalSign+N(+n.toFixed(this._internal__fractionalLength)*this._private__minMove,_)}else r=Math.round(r*e)/e,_>0&&(a=we._internal_decimalSign+N(0,_));return r.toFixed(0)+a},i}(),li=function(i){w(t,i);function t(e){return e===void 0&&(e=100),i.call(this,e)||this}return t.prototype.format=function(e){return"".concat(i.prototype.format.call(this,e),"%")},t}(Et),mr=function(){function i(t){this._private__precision=t}return i.prototype.format=function(t){var e="";return t<0&&(e="-",t=-t),t<995?e+this._private__formatNumber(t):t<999995?e+this._private__formatNumber(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this._private__formatNumber(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this._private__formatNumber(t/1e9)+"B")},i.prototype._private__formatNumber=function(t){var e,r=Math.pow(10,this._private__precision);return t=Math.round(t*r)/r,t>=1e-15&&t<1?e=t.toFixed(this._private__precision).replace(/\.?0+$/,""):e=String(t),e.replace(/(\.[1-9]*)0+$/,function(a,_){return _})},i}();function pi(i,t,e,r){if(t.length!==0){var a=t[r.from]._internal_x,_=t[r.from]._internal_y;i.moveTo(a,_);for(var n=r.from+1;n<r.to;++n){var s=t[n];if(e===1){var o=t[n-1]._internal_y,l=s._internal_x;i.lineTo(l,o)}i.lineTo(s._internal_x,s._internal_y)}}}var vi=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._internal__data=null,e}return t.prototype._internal_setData=function(e){this._internal__data=e},t.prototype._internal__drawImpl=function(e){if(!(this._internal__data===null||this._internal__data._internal_items.length===0||this._internal__data._internal_visibleRange===null)){if(e.lineCap="butt",e.lineJoin="round",e.lineWidth=this._internal__data._internal_lineWidth,q(e,this._internal__data._internal_lineStyle),e.lineWidth=1,e.beginPath(),this._internal__data._internal_items.length===1){var r=this._internal__data._internal_items[0],a=this._internal__data._internal_barWidth/2;e.moveTo(r.x-a,this._internal__data._internal_baseLevelCoordinate),e.lineTo(r.x-a,r.y),e.lineTo(r.x+a,r.y),e.lineTo(r.x+a,this._internal__data._internal_baseLevelCoordinate)}else e.moveTo(this._internal__data._internal_items[this._internal__data._internal_visibleRange.from].x,this._internal__data._internal_baseLevelCoordinate),e.lineTo(this._internal__data._internal_items[this._internal__data._internal_visibleRange.from].x,this._internal__data._internal_items[this._internal__data._internal_visibleRange.from].y),pi(e,this._internal__data._internal_items,this._internal__data._internal_lineType,this._internal__data._internal_visibleRange),this._internal__data._internal_visibleRange.to>this._internal__data._internal_visibleRange.from&&(e.lineTo(this._internal__data._internal_items[this._internal__data._internal_visibleRange.to-1].x,this._internal__data._internal_baseLevelCoordinate),e.lineTo(this._internal__data._internal_items[this._internal__data._internal_visibleRange.from].x,this._internal__data._internal_baseLevelCoordinate));e.closePath(),e.fillStyle=this._internal__fillStyle(e),e.fill()}},t}(ht),gr=function(i){w(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype._internal__fillStyle=function(e){var r=this._internal__data,a=e.createLinearGradient(0,0,0,r._internal_bottom);return a.addColorStop(0,r._internal_topColor),a.addColorStop(1,r._internal_bottomColor),a},t}(vi),hi=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._internal__data=null,e}return t.prototype._internal_setData=function(e){this._internal__data=e},t.prototype._internal__drawImpl=function(e){if(!(this._internal__data===null||this._internal__data._internal_items.length===0||this._internal__data._internal_visibleRange===null))if(e.lineCap="butt",e.lineWidth=this._internal__data._internal_lineWidth,q(e,this._internal__data._internal_lineStyle),e.strokeStyle=this._internal__strokeStyle(e),e.lineJoin="round",this._internal__data._internal_items.length===1){e.beginPath();var r=this._internal__data._internal_items[0];e.moveTo(r.x-this._internal__data._internal_barWidth/2,r.y),e.lineTo(r.x+this._internal__data._internal_barWidth/2,r.y),r._internal_color!==void 0&&(e.strokeStyle=r._internal_color),e.stroke()}else this._internal__drawLine(e,this._internal__data)},t.prototype._internal__drawLine=function(e,r){e.beginPath(),pi(e,r._internal_items,r._internal_lineType,r._internal_visibleRange),e.stroke()},t}(ht),ci=function(i){w(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype._internal__drawLine=function(e,r){var a,_,n=r._internal_items,s=r._internal_visibleRange,o=r._internal_lineType,l=r._internal_lineColor;if(!(n.length===0||s===null)){e.beginPath();var p=n[s.from];e.moveTo(p.x,p.y);var v=(a=p._internal_color)!==null&&a!==void 0?a:l;e.strokeStyle=v;for(var h=function(m){e.stroke(),e.beginPath(),e.strokeStyle=m,v=m},c=s.from+1;c<s.to;++c){var u=n[c],f=n[c-1],d=(_=u._internal_color)!==null&&_!==void 0?_:l;o===1&&(e.lineTo(u.x,f.y),d!==v&&(h(d),e.moveTo(u.x,f.y))),e.lineTo(u.x,u.y),o!==1&&d!==v&&(h(d),e.moveTo(u.x,u.y))}e.stroke()}},t.prototype._internal__strokeStyle=function(){return this._internal__data._internal_lineColor},t}(hi);function ct(i,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=i.length);for(var _=a-r;0<_;){var n=_>>1,s=r+n;e(i[s],t)?(r=s+1,_-=n+1):_=n}return r}function ui(i,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=i.length);for(var _=a-r;0<_;){var n=_>>1,s=r+n;e(t,i[s])?_=n:(r=s+1,_-=n+1)}return r}function yr(i,t){return i.time<t}function br(i,t){return i<t.time}function _e(i,t,e){var r=t.left(),a=t.right(),_=ct(i,r,yr),n=ui(i,a,br);if(!e)return{from:_,to:n};var s=_,o=n;return _>0&&_<i.length&&i[_].time>=r&&(s=_-1),n>0&&n<i.length&&i[n-1].time<=a&&(o=n+1),{from:s,to:o}}var ne=function(){function i(t,e,r){this._internal__invalidated=!0,this._internal__dataInvalidated=!0,this._internal__optionsInvalidated=!0,this._internal__items=[],this._internal__itemsVisibleRange=null,this._internal__series=t,this._internal__model=e,this._private__extendedVisibleRange=r}return i.prototype.update=function(t){this._internal__invalidated=!0,t==="data"&&(this._internal__dataInvalidated=!0),t==="options"&&(this._internal__optionsInvalidated=!0)},i.prototype._internal__makeValid=function(){this._internal__dataInvalidated&&(this._internal__fillRawPoints(),this._internal__dataInvalidated=!1),this._internal__invalidated&&(this._internal__updatePoints(),this._internal__invalidated=!1),this._internal__optionsInvalidated&&(this._internal__updateOptions(),this._internal__optionsInvalidated=!1)},i.prototype._internal__clearVisibleRange=function(){this._internal__itemsVisibleRange=null},i.prototype._internal__updatePoints=function(){var t=this._internal__series.priceScale(),e=this._internal__model.timeScale();if(this._internal__clearVisibleRange(),!(e.isEmpty()||t.isEmpty())){var r=e.visibleStrictRange();if(r!==null&&this._internal__series.bars().size()!==0){var a=this._internal__series.firstValue();a!==null&&(this._internal__itemsVisibleRange=_e(this._internal__items,r,this._private__extendedVisibleRange),this._internal__convertToCoordinates(t,e,a.value))}}},i}(),se=function(i){w(t,i);function t(e,r){return i.call(this,e,r,!0)||this}return t.prototype._internal__convertToCoordinates=function(e,r,a){r.indexesToCoordinates(this._internal__items,Tt(this._internal__itemsVisibleRange)),e.pointsArrayToCoordinates(this._internal__items,a,Tt(this._internal__itemsVisibleRange))},t.prototype._internal__createRawItemBase=function(e,r){return{time:e,price:r,x:NaN,y:NaN}},t.prototype._internal__updateOptions=function(){},t.prototype._internal__fillRawPoints=function(){var e=this,r=this._internal__series.barColorer();this._internal__items=this._internal__series.bars().rows().map(function(a){var _=a.value[3];return e._internal__createRawItem(a.index,_,r)})},t}(ne),Sr=function(i){w(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._private__renderer=new xt,a._private__areaRenderer=new gr,a._private__lineRenderer=new ci,a._private__renderer._internal_setRenderers([a._private__areaRenderer,a._private__lineRenderer]),a}return t.prototype.renderer=function(e,r){if(!this._internal__series.visible())return null;var a=this._internal__series.options();return this._internal__makeValid(),this._private__areaRenderer._internal_setData({_internal_lineType:a.lineType,_internal_items:this._internal__items,_internal_lineStyle:a.lineStyle,_internal_lineWidth:a.lineWidth,_internal_topColor:a.topColor,_internal_bottomColor:a.bottomColor,_internal_baseLevelCoordinate:e,_internal_bottom:e,_internal_visibleRange:this._internal__itemsVisibleRange,_internal_barWidth:this._internal__model.timeScale().barSpacing()}),this._private__lineRenderer._internal_setData({_internal_lineType:a.lineType,_internal_items:this._internal__items,_internal_lineColor:a.lineColor,_internal_lineStyle:a.lineStyle,_internal_lineWidth:a.lineWidth,_internal_visibleRange:this._internal__itemsVisibleRange,_internal_barWidth:this._internal__model.timeScale().barSpacing()}),this._private__renderer},t.prototype._internal__createRawItem=function(e,r){return this._internal__createRawItemBase(e,r)},t}(se);function wr(i,t){return Math.floor(i*.3*t)}function Cr(i,t){var e=2.5,r=4,a=3;if(i>=e&&i<=r)return Math.floor(a*t);var _=.2,n=1-_*Math.atan(Math.max(r,i)-r)/(Math.PI*.5),s=Math.floor(i*n*t),o=Math.floor(i*t),l=Math.min(s,o);return Math.max(Math.floor(t),l)}var Pr=function(){function i(){this._private__data=null,this._private__barWidth=0,this._private__barLineWidth=0}return i.prototype._internal_setData=function(t){this._private__data=t},i.prototype.draw=function(t,e,r,a){if(!(this._private__data===null||this._private__data._internal_bars.length===0||this._private__data._internal_visibleRange===null)){if(this._private__barWidth=this._private__calcBarWidth(e),this._private__barWidth>=2){var _=Math.max(1,Math.floor(e));_%2!==this._private__barWidth%2&&this._private__barWidth--}this._private__barLineWidth=this._private__data._internal_thinBars?Math.min(this._private__barWidth,Math.floor(e)):this._private__barWidth;for(var n=null,s=this._private__barLineWidth<=this._private__barWidth&&this._private__data._internal_barSpacing>=Math.floor(1.5*e),o=this._private__data._internal_visibleRange.from;o<this._private__data._internal_visibleRange.to;++o){var l=this._private__data._internal_bars[o];n!==l._internal_color&&(t.fillStyle=l._internal_color,n=l._internal_color);var p=Math.floor(this._private__barLineWidth*.5),v=Math.round(l.x*e),h=v-p,c=this._private__barLineWidth,u=h+c-1,f=Math.min(l.highY,l.lowY),d=Math.max(l.highY,l.lowY),m=Math.round(f*e)-p,y=Math.round(d*e)+p,b=Math.max(y-m,this._private__barLineWidth);t.fillRect(h,m,c,b);var C=Math.ceil(this._private__barWidth*1.5);if(s){if(this._private__data._internal_openVisible){var S=v-C,T=Math.max(m,Math.round(l.openY*e)-p),k=T+c-1;k>m+b-1&&(k=m+b-1,T=k-c+1),t.fillRect(S,T,h-S,k-T+1)}var I=v+C,F=Math.max(m,Math.round(l.closeY*e)-p),U=F+c-1;U>m+b-1&&(U=m+b-1,F=U-c+1),t.fillRect(u+1,F,I-u,U-F+1)}}}},i.prototype._private__calcBarWidth=function(t){var e=Math.floor(t);return Math.max(e,Math.floor(wr(g(this._private__data)._internal_barSpacing,t)))},i}(),di=function(i){w(t,i);function t(e,r){return i.call(this,e,r,!1)||this}return t.prototype._internal__convertToCoordinates=function(e,r,a){r.indexesToCoordinates(this._internal__items,Tt(this._internal__itemsVisibleRange)),e.barPricesToCoordinates(this._internal__items,a,Tt(this._internal__itemsVisibleRange))},t.prototype._internal__createDefaultItem=function(e,r,a){return{time:e,open:r.value[0],high:r.value[1],low:r.value[2],close:r.value[3],x:NaN,openY:NaN,highY:NaN,lowY:NaN,closeY:NaN}},t.prototype._internal__fillRawPoints=function(){var e=this,r=this._internal__series.barColorer();this._internal__items=this._internal__series.bars().rows().map(function(a){return e._internal__createRawItem(a.index,a,r)})},t}(ne),Mr=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._private__renderer=new Pr,e}return t.prototype.renderer=function(e,r){if(!this._internal__series.visible())return null;var a=this._internal__series.options();this._internal__makeValid();var _={_internal_bars:this._internal__items,_internal_barSpacing:this._internal__model.timeScale().barSpacing(),_internal_openVisible:a.openVisible,_internal_thinBars:a.thinBars,_internal_visibleRange:this._internal__itemsVisibleRange};return this._private__renderer._internal_setData(_),this._private__renderer},t.prototype._internal__updateOptions=function(){var e=this;this._internal__items.forEach(function(r){r._internal_color=e._internal__series.barColorer().barStyle(r.time).barColor})},t.prototype._internal__createRawItem=function(e,r,a){return P(P({},this._internal__createDefaultItem(e,r,a)),{_internal_color:a.barStyle(e).barColor})},t}(di);function kt(i,t,e){return Math.min(Math.max(i,t),e)}function Tr(i){if(i<0)return!1;for(var t=i;t>1;t/=10)if(t%10!==0)return!1;return!0}function ft(i,t,e){return t-i<=e}function kr(i,t,e){return Math.abs(i-t)<e}function fi(i){return i<=0?NaN:Math.log(i)/Math.log(10)}function Rr(i){if(i.length<1)throw Error("array is empty");for(var t=i[0],e=1;e<i.length;++e)i[e]<t&&(t=i[e]);return t}function Jt(i){var t=Math.ceil(i);return t%2!==0?t-1:t}function mi(i){var t=Math.ceil(i);return t%2===0?t-1:t}var Dr=function(i){w(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype._internal__fillStyle=function(e){var r=this._internal__data,a=e.createLinearGradient(0,0,0,r._internal_bottom),_=kt(r._internal_baseLevelCoordinate/r._internal_bottom,0,1);return a.addColorStop(0,r._internal_topFillColor1),a.addColorStop(_,r._internal_topFillColor2),a.addColorStop(_,r._internal_bottomFillColor1),a.addColorStop(1,r._internal_bottomFillColor2),a},t}(vi),Lr=function(i){w(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype._internal__strokeStyle=function(e){var r=this._internal__data,a=e.createLinearGradient(0,0,0,r._internal_bottom),_=kt(r._internal_baseLevelCoordinate/r._internal_bottom,0,1);return a.addColorStop(0,r._internal_topColor),a.addColorStop(_,r._internal_topColor),a.addColorStop(_,r._internal_bottomColor),a.addColorStop(1,r._internal_bottomColor),a},t}(hi),xr=function(i){w(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._private__baselineAreaRenderer=new Dr,a._private__baselineLineRenderer=new Lr,a._private__compositeRenderer=new xt,a._private__compositeRenderer._internal_setRenderers([a._private__baselineAreaRenderer,a._private__baselineLineRenderer]),a}return t.prototype.renderer=function(e,r){if(!this._internal__series.visible())return null;var a=this._internal__series.firstValue();if(a===null)return null;var _=this._internal__series.options();this._internal__makeValid();var n=this._internal__series.priceScale().priceToCoordinate(_.baseValue.price,a.value),s=this._internal__model.timeScale().barSpacing();return this._private__baselineAreaRenderer._internal_setData({_internal_items:this._internal__items,_internal_topFillColor1:_.topFillColor1,_internal_topFillColor2:_.topFillColor2,_internal_bottomFillColor1:_.bottomFillColor1,_internal_bottomFillColor2:_.bottomFillColor2,_internal_lineWidth:_.lineWidth,_internal_lineStyle:_.lineStyle,_internal_lineType:0,_internal_baseLevelCoordinate:n,_internal_bottom:e,_internal_visibleRange:this._internal__itemsVisibleRange,_internal_barWidth:s}),this._private__baselineLineRenderer._internal_setData({_internal_items:this._internal__items,_internal_topColor:_.topLineColor,_internal_bottomColor:_.bottomLineColor,_internal_lineWidth:_.lineWidth,_internal_lineStyle:_.lineStyle,_internal_lineType:0,_internal_baseLevelCoordinate:n,_internal_bottom:e,_internal_visibleRange:this._internal__itemsVisibleRange,_internal_barWidth:s}),this._private__compositeRenderer},t.prototype._internal__createRawItem=function(e,r){return this._internal__createRawItemBase(e,r)},t}(se),Ar=function(){function i(){this._private__data=null,this._private__barWidth=0}return i.prototype._internal_setData=function(t){this._private__data=t},i.prototype.draw=function(t,e,r,a){if(!(this._private__data===null||this._private__data._internal_bars.length===0||this._private__data._internal_visibleRange===null)){if(this._private__barWidth=Cr(this._private__data._internal_barSpacing,e),this._private__barWidth>=2){var _=Math.floor(e);_%2!==this._private__barWidth%2&&this._private__barWidth--}var n=this._private__data._internal_bars;this._private__data._internal_wickVisible&&this._private__drawWicks(t,n,this._private__data._internal_visibleRange,e),this._private__data._internal_borderVisible&&this._private__drawBorder(t,n,this._private__data._internal_visibleRange,this._private__data._internal_barSpacing,e);var s=this._private__calculateBorderWidth(e);(!this._private__data._internal_borderVisible||this._private__barWidth>s*2)&&this._private__drawCandles(t,n,this._private__data._internal_visibleRange,e)}},i.prototype._private__drawWicks=function(t,e,r,a){if(this._private__data!==null){var _="",n=Math.min(Math.floor(a),Math.floor(this._private__data._internal_barSpacing*a));n=Math.max(Math.floor(a),Math.min(n,this._private__barWidth));for(var s=Math.floor(n*.5),o=null,l=r.from;l<r.to;l++){var p=e[l];p._internal_wickColor!==_&&(t.fillStyle=p._internal_wickColor,_=p._internal_wickColor);var v=Math.round(Math.min(p.openY,p.closeY)*a),h=Math.round(Math.max(p.openY,p.closeY)*a),c=Math.round(p.highY*a),u=Math.round(p.lowY*a),f=Math.round(a*p.x),d=f-s,m=d+n-1;o!==null&&(d=Math.max(o+1,d),d=Math.min(d,m));var y=m-d+1;t.fillRect(d,c,y,v-c),t.fillRect(d,h+1,y,u-h),o=m}}},i.prototype._private__calculateBorderWidth=function(t){var e=Math.floor(1*t);this._private__barWidth<=2*e&&(e=Math.floor((this._private__barWidth-1)*.5));var r=Math.max(Math.floor(t),e);return this._private__barWidth<=r*2?Math.max(Math.floor(t),Math.floor(1*t)):r},i.prototype._private__drawBorder=function(t,e,r,a,_){if(this._private__data!==null)for(var n="",s=this._private__calculateBorderWidth(_),o=null,l=r.from;l<r.to;l++){var p=e[l];p._internal_borderColor!==n&&(t.fillStyle=p._internal_borderColor,n=p._internal_borderColor);var v=Math.round(p.x*_)-Math.floor(this._private__barWidth*.5),h=v+this._private__barWidth-1,c=Math.round(Math.min(p.openY,p.closeY)*_),u=Math.round(Math.max(p.openY,p.closeY)*_);if(o!==null&&(v=Math.max(o+1,v),v=Math.min(v,h)),this._private__data._internal_barSpacing*_>2*s)pr(t,v,c,h-v+1,u-c+1,s);else{var f=h-v+1;t.fillRect(v,c,f,u-c+1)}o=h}},i.prototype._private__drawCandles=function(t,e,r,a){if(this._private__data!==null)for(var _="",n=this._private__calculateBorderWidth(a),s=r.from;s<r.to;s++){var o=e[s],l=Math.round(Math.min(o.openY,o.closeY)*a),p=Math.round(Math.max(o.openY,o.closeY)*a),v=Math.round(o.x*a)-Math.floor(this._private__barWidth*.5),h=v+this._private__barWidth-1;if(o._internal_color!==_){var c=o._internal_color;t.fillStyle=c,_=c}this._private__data._internal_borderVisible&&(v+=n,l+=n,h-=n,p-=n),!(l>p)&&t.fillRect(v,l,h-v+1,p-l+1)}},i}(),Vr=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._private__renderer=new Ar,e}return t.prototype.renderer=function(e,r){if(!this._internal__series.visible())return null;var a=this._internal__series.options();this._internal__makeValid();var _={_internal_bars:this._internal__items,_internal_barSpacing:this._internal__model.timeScale().barSpacing(),_internal_wickVisible:a.wickVisible,_internal_borderVisible:a.borderVisible,_internal_visibleRange:this._internal__itemsVisibleRange};return this._private__renderer._internal_setData(_),this._private__renderer},t.prototype._internal__updateOptions=function(){var e=this;this._internal__items.forEach(function(r){var a=e._internal__series.barColorer().barStyle(r.time);r._internal_color=a.barColor,r._internal_wickColor=a.barWickColor,r._internal_borderColor=a.barBorderColor})},t.prototype._internal__createRawItem=function(e,r,a){var _=a.barStyle(e);return P(P({},this._internal__createDefaultItem(e,r,a)),{_internal_color:_.barColor,_internal_wickColor:_.barWickColor,_internal_borderColor:_.barBorderColor})},t}(di),Er=1,Ir=4,Br=function(){function i(){this._private__data=null,this._private__precalculatedCache=[]}return i.prototype._internal_setData=function(t){this._private__data=t,this._private__precalculatedCache=[]},i.prototype.draw=function(t,e,r,a){if(!(this._private__data===null||this._private__data._internal_items.length===0||this._private__data._internal_visibleRange===null)){this._private__precalculatedCache.length||this._private__fillPrecalculatedCache(e);for(var _=Math.max(1,Math.floor(e)),n=Math.round(this._private__data._internal_histogramBase*e),s=n-Math.floor(_/2),o=s+_,l=this._private__data._internal_visibleRange.from;l<this._private__data._internal_visibleRange.to;l++){var p=this._private__data._internal_items[l],v=this._private__precalculatedCache[l-this._private__data._internal_visibleRange.from],h=Math.round(p.y*e);t.fillStyle=p._internal_color;var c=void 0,u=void 0;h<=s?(c=h,u=o):(c=s,u=h-Math.floor(_/2)+_),t.fillRect(v._internal_left,c,v._internal_right-v._internal_left+1,u-c)}}},i.prototype._private__fillPrecalculatedCache=function(t){if(this._private__data===null||this._private__data._internal_items.length===0||this._private__data._internal_visibleRange===null){this._private__precalculatedCache=[];return}var e=Math.ceil(this._private__data._internal_barSpacing*t)<=Er?0:Math.max(1,Math.floor(t)),r=Math.round(this._private__data._internal_barSpacing*t)-e;this._private__precalculatedCache=new Array(this._private__data._internal_visibleRange.to-this._private__data._internal_visibleRange.from);for(var a=this._private__data._internal_visibleRange.from;a<this._private__data._internal_visibleRange.to;a++){var _=this._private__data._internal_items[a],n=Math.round(_.x*t),s=void 0,o=void 0;if(r%2){var l=(r-1)/2;s=n-l,o=n+l}else{var l=r/2;s=n-l,o=n+l-1}this._private__precalculatedCache[a-this._private__data._internal_visibleRange.from]={_internal_left:s,_internal_right:o,_internal_roundedCenter:n,_internal_center:_.x*t,_internal_time:_.time}}for(var a=this._private__data._internal_visibleRange.from+1;a<this._private__data._internal_visibleRange.to;a++){var p=this._private__precalculatedCache[a-this._private__data._internal_visibleRange.from],v=this._private__precalculatedCache[a-this._private__data._internal_visibleRange.from-1];p._internal_time===v._internal_time+1&&p._internal_left-v._internal_right!==e+1&&(v._internal_roundedCenter>v._internal_center?v._internal_right=p._internal_left-e-1:p._internal_left=v._internal_right+e+1)}for(var h=Math.ceil(this._private__data._internal_barSpacing*t),a=this._private__data._internal_visibleRange.from;a<this._private__data._internal_visibleRange.to;a++){var p=this._private__precalculatedCache[a-this._private__data._internal_visibleRange.from];p._internal_right<p._internal_left&&(p._internal_right=p._internal_left);var c=p._internal_right-p._internal_left+1;h=Math.min(c,h)}if(e>0&&h<Ir)for(var a=this._private__data._internal_visibleRange.from;a<this._private__data._internal_visibleRange.to;a++){var p=this._private__precalculatedCache[a-this._private__data._internal_visibleRange.from],c=p._internal_right-p._internal_left+1;c>h&&(p._internal_roundedCenter>p._internal_center?p._internal_right-=1:p._internal_left+=1)}},i}();function Ce(i){return{_internal_items:[],_internal_barSpacing:i,_internal_histogramBase:NaN,_internal_visibleRange:null}}function Or(i,t,e){return{time:i,price:t,x:NaN,y:NaN,_internal_color:e}}var Wr=function(i){w(t,i);function t(e,r){var a=i.call(this,e,r,!1)||this;return a._private__compositeRenderer=new xt,a._private__histogramData=Ce(0),a._private__renderer=new Br,a}return t.prototype.renderer=function(e,r){return this._internal__series.visible()?(this._internal__makeValid(),this._private__compositeRenderer):null},t.prototype._internal__fillRawPoints=function(){var e=this._internal__model.timeScale().barSpacing();this._private__histogramData=Ce(e);for(var r=0,a=0,_=this._internal__series.options().color,n=0,s=this._internal__series.bars().rows();n<s.length;n++){var o=s[n],l=o.value[3],p=o.color!==void 0?o.color:_,v=Or(o.index,l,p);r++,r<this._private__histogramData._internal_items.length?this._private__histogramData._internal_items[r]=v:this._private__histogramData._internal_items.push(v),this._internal__items[a++]={time:o.index,x:0}}this._private__renderer._internal_setData(this._private__histogramData),this._private__compositeRenderer._internal_setRenderers([this._private__renderer])},t.prototype._internal__updateOptions=function(){},t.prototype._internal__clearVisibleRange=function(){i.prototype._internal__clearVisibleRange.call(this),this._private__histogramData._internal_visibleRange=null},t.prototype._internal__convertToCoordinates=function(e,r,a){if(this._internal__itemsVisibleRange!==null){var _=r.barSpacing(),n=g(r.visibleStrictRange()),s=e.priceToCoordinate(this._internal__series.options().base,a);r.indexesToCoordinates(this._private__histogramData._internal_items),e.pointsArrayToCoordinates(this._private__histogramData._internal_items,a),this._private__histogramData._internal_histogramBase=s,this._private__histogramData._internal_visibleRange=_e(this._private__histogramData._internal_items,n,!1),this._private__histogramData._internal_barSpacing=_,this._private__renderer._internal_setData(this._private__histogramData)}},t}(ne),zr=function(i){w(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._private__lineRenderer=new ci,a}return t.prototype.renderer=function(e,r){if(!this._internal__series.visible())return null;var a=this._internal__series.options();this._internal__makeValid();var _={_internal_items:this._internal__items,_internal_lineColor:a.color,_internal_lineStyle:a.lineStyle,_internal_lineType:a.lineType,_internal_lineWidth:a.lineWidth,_internal_visibleRange:this._internal__itemsVisibleRange,_internal_barWidth:this._internal__model.timeScale().barSpacing()};return this._private__lineRenderer._internal_setData(_),this._private__lineRenderer},t.prototype._internal__updateOptions=function(){var e=this;this._internal__items.forEach(function(r){r._internal_color=e._internal__series.barColorer().barStyle(r.time).barColor})},t.prototype._internal__createRawItem=function(e,r,a){var _=this._internal__createRawItemBase(e,r);return _._internal_color=a.barStyle(e).barColor,_},t}(se),Fr=/[2-9]/g,rt=function(){function i(t){t===void 0&&(t=50),this._private__cache=new Map,this._private__keysIndex=0,this._private__keys=Array.from(new Array(t))}return i.prototype.reset=function(){this._private__cache.clear(),this._private__keys.fill(void 0)},i.prototype.measureText=function(t,e,r){var a=r||Fr,_=String(e).replace(a,"0"),n=this._private__cache.get(_);if(n===void 0){if(n=t.measureText(_).width,n===0&&e.length!==0)return 0;var s=this._private__keys[this._private__keysIndex];s!==void 0&&this._private__cache.delete(s),this._private__keys[this._private__keysIndex]=_,this._private__keysIndex=(this._private__keysIndex+1)%this._private__keys.length,this._private__cache.set(_,n)}return n},i}(),Nr=function(){function i(t){this._private__priceAxisViewRenderer=null,this._private__rendererOptions=null,this._private__align="right",this._private__width=0,this._private__textWidthCache=t}return i.prototype._internal_setParams=function(t,e,r,a){this._private__priceAxisViewRenderer=t,this._private__rendererOptions=e,this._private__width=r,this._private__align=a},i.prototype.draw=function(t,e){this._private__rendererOptions===null||this._private__priceAxisViewRenderer===null||this._private__priceAxisViewRenderer.draw(t,this._private__rendererOptions,this._private__textWidthCache,this._private__width,this._private__align,e)},i}(),gi=function(){function i(t,e,r){this._private__priceAxisView=t,this._private__textWidthCache=new rt(50),this._private__dataSource=e,this._private__chartModel=r,this._private__fontSize=-1,this._private__renderer=new Nr(this._private__textWidthCache)}return i.prototype.renderer=function(t,e){var r=this._private__chartModel.paneForSource(this._private__dataSource);if(r===null)return null;var a=r.isOverlay(this._private__dataSource)?r.defaultVisiblePriceScale():this._private__dataSource.priceScale();if(a===null)return null;var _=r.priceScalePosition(a);if(_==="overlay")return null;var n=this._private__chartModel.priceAxisRendererOptions();return n.fontSize!==this._private__fontSize&&(this._private__fontSize=n.fontSize,this._private__textWidthCache.reset()),this._private__renderer._internal_setParams(this._private__priceAxisView.paneRenderer(),n,e,_),this._private__renderer},i}(),Hr=function(){function i(){this._private__data=null}return i.prototype._internal_setData=function(t){this._private__data=t},i.prototype.draw=function(t,e,r,a){if(this._private__data!==null&&this._private__data._internal_visible!==!1){var _=Math.round(this._private__data._internal_y*e);if(!(_<0||_>Math.ceil(this._private__data._internal_height*e))){var n=Math.ceil(this._private__data._internal_width*e);t.lineCap="butt",t.strokeStyle=this._private__data._internal_color,t.lineWidth=Math.floor(this._private__data._internal_lineWidth*e),q(t,this._private__data._internal_lineStyle),_i(t,_,0,n)}}},i}(),oe=function(){function i(t){this._internal__lineRendererData={_internal_width:0,_internal_height:0,_internal_y:0,_internal_color:"rgba(0, 0, 0, 0)",_internal_lineWidth:1,_internal_lineStyle:0,_internal_visible:!1},this._internal__lineRenderer=new Hr,this._private__invalidated=!0,this._internal__series=t,this._internal__model=t.model(),this._internal__lineRenderer._internal_setData(this._internal__lineRendererData)}return i.prototype._internal_update=function(){this._private__invalidated=!0},i.prototype.renderer=function(t,e){return this._internal__series.visible()?(this._private__invalidated&&(this._internal__updateImpl(t,e),this._private__invalidated=!1),this._internal__lineRenderer):null},i}(),Ur=function(i){w(t,i);function t(e){return i.call(this,e)||this}return t.prototype._internal__updateImpl=function(e,r){this._internal__lineRendererData._internal_visible=!1;var a=this._internal__series.priceScale(),_=a.mode().mode;if(!(_!==2&&_!==3)){var n=this._internal__series.options();if(!(!n.baseLineVisible||!this._internal__series.visible())){var s=this._internal__series.firstValue();s!==null&&(this._internal__lineRendererData._internal_visible=!0,this._internal__lineRendererData._internal_y=a.priceToCoordinate(s.value,s.value),this._internal__lineRendererData._internal_width=r,this._internal__lineRendererData._internal_height=e,this._internal__lineRendererData._internal_color=n.baseLineColor,this._internal__lineRendererData._internal_lineWidth=n.baseLineWidth,this._internal__lineRendererData._internal_lineStyle=n.baseLineStyle)}}},t}(oe),Yr=function(){function i(){this._private__data=null}return i.prototype._internal_setData=function(t){this._private__data=t},i.prototype._internal_data=function(){return this._private__data},i.prototype.draw=function(t,e,r,a){var _=this._private__data;if(_!==null){t.save();var n=Math.max(1,Math.floor(e)),s=n%2/2,o=Math.round(_._internal_center.x*e)+s,l=_._internal_center.y*e;t.fillStyle=_._internal_seriesLineColor,t.beginPath();var p=Math.max(2,_._internal_seriesLineWidth*1.5)*e;t.arc(o,l,p,0,2*Math.PI,!1),t.fill(),t.fillStyle=_._internal_fillColor,t.beginPath(),t.arc(o,l,_._internal_radius*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=n,t.strokeStyle=_._internal_strokeColor,t.beginPath(),t.arc(o,l,_._internal_radius*e+n/2,0,2*Math.PI,!1),t.stroke(),t.restore()}},i}(),Xr=[{_internal_start:0,_internal_end:.25,_internal_startRadius:4,_internal_endRadius:10,_internal_startFillAlpha:.25,_internal_endFillAlpha:0,_internal_startStrokeAlpha:.4,_internal_endStrokeAlpha:.8},{_internal_start:.25,_internal_end:.25+.275,_internal_startRadius:10,_internal_endRadius:14,_internal_startFillAlpha:0,_internal_endFillAlpha:0,_internal_startStrokeAlpha:.8,_internal_endStrokeAlpha:0},{_internal_start:.25+.275,_internal_end:.25+.275+.475,_internal_startRadius:14,_internal_endRadius:14,_internal_startFillAlpha:0,_internal_endFillAlpha:0,_internal_startStrokeAlpha:0,_internal_endStrokeAlpha:0}];function Pe(i,t,e,r){var a=e+(r-e)*t;return Ji(i,a)}function qr(i,t,e){return t+(e-t)*i}function Me(i,t){for(var e=i%2600/2600,r,a=0,_=Xr;a<_.length;a++){var n=_[a];if(e>=n._internal_start&&e<=n._internal_end){r=n;break}}x(r!==void 0,"Last price animation internal logic error");var s=(e-r._internal_start)/(r._internal_end-r._internal_start);return{_internal_fillColor:Pe(t,s,r._internal_startFillAlpha,r._internal_endFillAlpha),_internal_strokeColor:Pe(t,s,r._internal_startStrokeAlpha,r._internal_endStrokeAlpha),_internal_radius:qr(s,r._internal_startRadius,r._internal_endRadius)}}var Gr=function(){function i(t){this._private__renderer=new Yr,this._private__invalidated=!0,this._private__stageInvalidated=!0,this._private__startTime=performance.now(),this._private__endTime=this._private__startTime-1,this._private__series=t}return i.prototype._internal_onDataCleared=function(){this._private__endTime=this._private__startTime-1,this.update()},i.prototype._internal_onNewRealtimeDataReceived=function(){if(this.update(),this._private__series.options().lastPriceAnimation===2){var t=performance.now(),e=this._private__endTime-t;if(e>0){e<2600/4&&(this._private__endTime+=2600);return}this._private__startTime=t,this._private__endTime=t+2600}},i.prototype.update=function(){this._private__invalidated=!0},i.prototype._internal_invalidateStage=function(){this._private__stageInvalidated=!0},i.prototype._internal_visible=function(){return this._private__series.options().lastPriceAnimation!==0},i.prototype._internal_animationActive=function(){switch(this._private__series.options().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this._private__endTime}},i.prototype.renderer=function(t,e){return this._private__invalidated?(this._private__updateImpl(t,e),this._private__invalidated=!1,this._private__stageInvalidated=!1):this._private__stageInvalidated&&(this._private__updateRendererDataStage(),this._private__stageInvalidated=!1),this._private__renderer},i.prototype._private__updateImpl=function(t,e){this._private__renderer._internal_setData(null);var r=this._private__series.model().timeScale(),a=r.visibleStrictRange(),_=this._private__series.firstValue();if(!(a===null||_===null)){var n=this._private__series.lastValueData(!0);if(!(n.noData||!a.contains(n.index))){var s={x:r.indexToCoordinate(n.index),y:this._private__series.priceScale().priceToCoordinate(n.price,_.value)},o=n.color,l=this._private__series.options().lineWidth,p=Me(this._private__duration(),o);this._private__renderer._internal_setData({_internal_seriesLineColor:o,_internal_seriesLineWidth:l,_internal_fillColor:p._internal_fillColor,_internal_strokeColor:p._internal_strokeColor,_internal_radius:p._internal_radius,_internal_center:s})}}},i.prototype._private__updateRendererDataStage=function(){var t=this._private__renderer._internal_data();if(t!==null){var e=Me(this._private__duration(),t._internal_seriesLineColor);t._internal_fillColor=e._internal_fillColor,t._internal_strokeColor=e._internal_strokeColor,t._internal_radius=e._internal_radius}},i.prototype._private__duration=function(){return this._internal_animationActive()?performance.now()-this._private__startTime:2600-1},i}();function st(i,t){var e=Math.min(Math.max(i,12),30)*t;return mi(e)}function ut(i,t){switch(i){case"arrowDown":case"arrowUp":return st(t,1);case"circle":return st(t,.8);case"square":return st(t,.7)}}function yi(i){return Jt(st(i,1))}function Te(i){return Math.max(st(i,.1),3)}function jr(i,t,e,r){var a=ut("square",r),_=(a-1)/2,n=t-_,s=e-_;i.fillRect(n,s,a,a)}function bi(i,t,e,r,a){var _=ut("square",e),n=(_-1)/2,s=i-n,o=t-n;return r>=s&&r<=s+_&&a>=o&&a<=o+_}function ke(i,t,e,r,a){var _=ut("arrowUp",a),n=(_-1)/2,s=mi(a/2),o=(s-1)/2;t.beginPath(),i?(t.moveTo(e-n,r),t.lineTo(e,r-n),t.lineTo(e+n,r),t.lineTo(e+o,r),t.lineTo(e+o,r+n),t.lineTo(e-o,r+n),t.lineTo(e-o,r)):(t.moveTo(e-n,r),t.lineTo(e,r+n),t.lineTo(e+n,r),t.lineTo(e+o,r),t.lineTo(e+o,r-n),t.lineTo(e-o,r-n),t.lineTo(e-o,r)),t.fill()}function Re(i,t,e,r,a,_){return bi(t,e,r,a,_)}function Kr(i,t,e,r){var a=ut("circle",r),_=(a-1)/2;i.beginPath(),i.arc(t,e,_,0,2*Math.PI,!1),i.fill()}function Zr(i,t,e,r,a){var _=ut("circle",e),n=2+_/2,s=i-r,o=t-a,l=Math.sqrt(s*s+o*o);return l<=n}function $r(i,t,e,r){i.fillText(t,e,r)}function Qr(i,t,e,r,a,_){var n=r/2;return a>=i&&a<=i+e&&_>=t-n&&_<=t+n}var Jr=function(i){w(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._private__data=null,e._private__textWidthCache=new rt,e._private__fontSize=-1,e._private__fontFamily="",e._private__font="",e}return t.prototype._internal_setData=function(e){this._private__data=e},t.prototype._internal_setParams=function(e,r){(this._private__fontSize!==e||this._private__fontFamily!==r)&&(this._private__fontSize=e,this._private__fontFamily=r,this._private__font=G(e,r),this._private__textWidthCache.reset())},t.prototype.hitTest=function(e,r){if(this._private__data===null||this._private__data._internal_visibleRange===null)return null;for(var a=this._private__data._internal_visibleRange.from;a<this._private__data._internal_visibleRange.to;a++){var _=this._private__data._internal_items[a];if(ia(_,e,r))return{hitTestData:_._internal_internalId,externalId:_._internal_externalId}}return null},t.prototype._internal__drawImpl=function(e,r,a){if(!(this._private__data===null||this._private__data._internal_visibleRange===null)){e.textBaseline="middle",e.font=this._private__font;for(var _=this._private__data._internal_visibleRange.from;_<this._private__data._internal_visibleRange.to;_++){var n=this._private__data._internal_items[_];n._internal_text!==void 0&&(n._internal_text._internal_width=this._private__textWidthCache.measureText(e,n._internal_text._internal_content),n._internal_text._internal_height=this._private__fontSize),ta(n,e)}}},t}(ht);function ta(i,t){t.fillStyle=i._internal_color,i._internal_text!==void 0&&$r(t,i._internal_text._internal_content,i.x-i._internal_text._internal_width/2,i._internal_text._internal_y),ea(i,t)}function ea(i,t){if(i._internal_size!==0){switch(i._internal_shape){case"arrowDown":ke(!1,t,i.x,i._internal_y,i._internal_size);return;case"arrowUp":ke(!0,t,i.x,i._internal_y,i._internal_size);return;case"circle":Kr(t,i.x,i._internal_y,i._internal_size);return;case"square":jr(t,i.x,i._internal_y,i._internal_size);return}i._internal_shape}}function ia(i,t,e){return i._internal_text!==void 0&&Qr(i.x,i._internal_text._internal_y,i._internal_text._internal_width,i._internal_text._internal_height,t,e)?!0:ra(i,t,e)}function ra(i,t,e){if(i._internal_size===0)return!1;switch(i._internal_shape){case"arrowDown":return Re(!0,i.x,i._internal_y,i._internal_size,t,e);case"arrowUp":return Re(!1,i.x,i._internal_y,i._internal_size,t,e);case"circle":return Zr(i.x,i._internal_y,i._internal_size,t,e);case"square":return bi(i.x,i._internal_y,i._internal_size,t,e)}}function aa(i,t,e,r,a,_,n,s,o){var l=O(e)?e:e.close,p=O(e)?e:e.high,v=O(e)?e:e.low,h=O(t.size)?Math.max(t.size,0):1,c=yi(s.barSpacing())*h,u=c/2;switch(i._internal_size=c,t.position){case"inBar":{i._internal_y=n.priceToCoordinate(l,o),i._internal_text!==void 0&&(i._internal_text._internal_y=i._internal_y+u+_+a*(.5+.1));return}case"aboveBar":{i._internal_y=n.priceToCoordinate(p,o)-u-r._internal_aboveBar,i._internal_text!==void 0&&(i._internal_text._internal_y=i._internal_y-u-a*(.5+.1),r._internal_aboveBar+=a*(1+2*.1)),r._internal_aboveBar+=c+_;return}case"belowBar":{i._internal_y=n.priceToCoordinate(v,o)+u+r._internal_belowBar,i._internal_text!==void 0&&(i._internal_text._internal_y=i._internal_y+u+_+a*(.5+.1),r._internal_belowBar+=a*(1+2*.1)),r._internal_belowBar+=c+_;return}}t.position}var _a=function(){function i(t,e){this._private__invalidated=!0,this._private__dataInvalidated=!0,this._private__autoScaleMarginsInvalidated=!0,this._private__autoScaleMargins=null,this._private__renderer=new Jr,this._private__series=t,this._private__model=e,this._private__data={_internal_items:[],_internal_visibleRange:null}}return i.prototype.update=function(t){this._private__invalidated=!0,this._private__autoScaleMarginsInvalidated=!0,t==="data"&&(this._private__dataInvalidated=!0)},i.prototype.renderer=function(t,e,r){if(!this._private__series.visible())return null;this._private__invalidated&&this._internal__makeValid();var a=this._private__model.options().layout;return this._private__renderer._internal_setParams(a.fontSize,a.fontFamily),this._private__renderer._internal_setData(this._private__data),this._private__renderer},i.prototype._internal_autoScaleMargins=function(){if(this._private__autoScaleMarginsInvalidated){if(this._private__series.indexedMarkers().length>0){var t=this._private__model.timeScale().barSpacing(),e=Te(t),r=yi(t)*1.5+e*2;this._private__autoScaleMargins={above:r,below:r}}else this._private__autoScaleMargins=null;this._private__autoScaleMarginsInvalidated=!1}return this._private__autoScaleMargins},i.prototype._internal__makeValid=function(){var t=this._private__series.priceScale(),e=this._private__model.timeScale(),r=this._private__series.indexedMarkers();this._private__dataInvalidated&&(this._private__data._internal_items=r.map(function(u){return{time:u.time,x:0,_internal_y:0,_internal_size:0,_internal_shape:u.shape,_internal_color:u.color,_internal_internalId:u.internalId,_internal_externalId:u.id,_internal_text:void 0}}),this._private__dataInvalidated=!1);var a=this._private__model.options().layout;this._private__data._internal_visibleRange=null;var _=e.visibleStrictRange();if(_!==null){var n=this._private__series.firstValue();if(n!==null&&this._private__data._internal_items.length!==0){var s=NaN,o=Te(e.barSpacing()),l={_internal_aboveBar:o,_internal_belowBar:o};this._private__data._internal_visibleRange=_e(this._private__data._internal_items,_,!0);for(var p=this._private__data._internal_visibleRange.from;p<this._private__data._internal_visibleRange.to;p++){var v=r[p];v.time!==s&&(l._internal_aboveBar=o,l._internal_belowBar=o,s=v.time);var h=this._private__data._internal_items[p];h.x=e.indexToCoordinate(v.time),v.text!==void 0&&v.text.length>0&&(h._internal_text={_internal_content:v.text,_internal_y:0,_internal_width:0,_internal_height:0});var c=this._private__series.dataAt(v.time);c!==null&&aa(h,v,c,l,a.fontSize,o,t,e,n.value)}this._private__invalidated=!1}}},i}(),na=function(i){w(t,i);function t(e){return i.call(this,e)||this}return t.prototype._internal__updateImpl=function(e,r){var a=this._internal__lineRendererData;a._internal_visible=!1;var _=this._internal__series.options();if(!(!_.priceLineVisible||!this._internal__series.visible())){var n=this._internal__series.lastValueData(_.priceLineSource===0);n.noData||(a._internal_visible=!0,a._internal_y=n.coordinate,a._internal_color=this._internal__series.priceLineColor(n.color),a._internal_width=r,a._internal_height=e,a._internal_lineWidth=_.priceLineWidth,a._internal_lineStyle=_.priceLineStyle)}},t}(oe),sa=function(i){w(t,i);function t(e){var r=i.call(this)||this;return r._private__source=e,r}return t.prototype._internal__updateRendererData=function(e,r,a){e.visible=!1,r.visible=!1;var _=this._private__source;if(_.visible()){var n=_.options(),s=n.lastValueVisible,o=_.title()!=="",l=n.seriesLastValueMode===0,p=_.lastValueData(!1);if(!p.noData){s&&(e.text=this._internal__axisText(p,s,l),e.visible=e.text.length!==0),(o||l)&&(r.text=this._internal__paneText(p,s,o,l),r.visible=r.text.length>0);var v=_.priceLineColor(p.color),h=Lt(v);a.background=h._internal_background,a.color=h._internal_foreground,a.coordinate=p.coordinate,r.borderColor=_.model().backgroundColorAtYPercentFromTop(p.coordinate/_.priceScale().height()),e.borderColor=v}}},t.prototype._internal__paneText=function(e,r,a,_){var n="",s=this._private__source.title();return a&&s.length!==0&&(n+="".concat(s," ")),r&&_&&(n+=this._private__source.priceScale().isPercentage()?e.formattedPriceAbsolute:e.formattedPricePercentage),n.trim()},t.prototype._internal__axisText=function(e,r,a){return r?a?this._private__source.priceScale().isPercentage()?e.formattedPricePercentage:e.formattedPriceAbsolute:e.text:""},t}(re),H=function(){function i(t,e){this._private__minValue=t,this._private__maxValue=e}return i.prototype.equals=function(t){return t===null?!1:this._private__minValue===t._private__minValue&&this._private__maxValue===t._private__maxValue},i.prototype.clone=function(){return new i(this._private__minValue,this._private__maxValue)},i.prototype.minValue=function(){return this._private__minValue},i.prototype.maxValue=function(){return this._private__maxValue},i.prototype.length=function(){return this._private__maxValue-this._private__minValue},i.prototype.isEmpty=function(){return this._private__maxValue===this._private__minValue||Number.isNaN(this._private__maxValue)||Number.isNaN(this._private__minValue)},i.prototype.merge=function(t){return t===null?this:new i(Math.min(this.minValue(),t.minValue()),Math.max(this.maxValue(),t.maxValue()))},i.prototype.scaleAroundCenter=function(t){if(O(t)){var e=this._private__maxValue-this._private__minValue;if(e!==0){var r=(this._private__maxValue+this._private__minValue)*.5,a=this._private__maxValue-r,_=this._private__minValue-r;a*=t,_*=t,this._private__maxValue=r+a,this._private__minValue=r+_}}},i.prototype.shift=function(t){O(t)&&(this._private__maxValue+=t,this._private__minValue+=t)},i.prototype.toRaw=function(){return{minValue:this._private__minValue,maxValue:this._private__maxValue}},i.fromRaw=function(t){return t===null?null:new i(t.minValue,t.maxValue)},i}(),De=function(){function i(t,e){this._private__priceRange=t,this._private__margins=e||null}return i.prototype.priceRange=function(){return this._private__priceRange},i.prototype.margins=function(){return this._private__margins},i.prototype.toRaw=function(){return this._private__priceRange===null?null:{priceRange:this._private__priceRange.toRaw(),margins:this._private__margins||void 0}},i.fromRaw=function(t){return t===null?null:new i(H.fromRaw(t.priceRange),t.margins)},i}(),oa=function(i){w(t,i);function t(e,r){var a=i.call(this,e)||this;return a._private__priceLine=r,a}return t.prototype._internal__updateImpl=function(e,r){var a=this._internal__lineRendererData;a._internal_visible=!1;var _=this._private__priceLine.options();if(!(!this._internal__series.visible()||!_.lineVisible)){var n=this._private__priceLine.yCoord();n!==null&&(a._internal_visible=!0,a._internal_y=n,a._internal_color=_.color,a._internal_width=r,a._internal_height=e,a._internal_lineWidth=_.lineWidth,a._internal_lineStyle=_.lineStyle)}},t}(oe),la=function(i){w(t,i);function t(e,r){var a=i.call(this)||this;return a._private__series=e,a._private__priceLine=r,a}return t.prototype._internal__updateRendererData=function(e,r,a){e.visible=!1,r.visible=!1;var _=this._private__priceLine.options(),n=_.axisLabelVisible,s=_.title!=="",o=this._private__series;if(!(!n||!o.visible())){var l=this._private__priceLine.yCoord();if(l!==null){s&&(r.text=_.title,r.visible=!0),r.borderColor=o.model().backgroundColorAtYPercentFromTop(l/o.priceScale().height()),e.text=o.priceScale().formatPriceAbsolute(_.price),e.visible=!0;var p=Lt(_.color);a.background=p._internal_background,a.color=p._internal_foreground,a.coordinate=l}}},t}(re),pa=function(){function i(t,e){this._private__series=t,this._private__options=e,this._private__priceLineView=new oa(t,this),this._private__priceAxisView=new la(t,this),this._private__panePriceAxisView=new gi(this._private__priceAxisView,t,t.model())}return i.prototype.applyOptions=function(t){R(this._private__options,t),this.update(),this._private__series.model().lightUpdate()},i.prototype.options=function(){return this._private__options},i.prototype.paneViews=function(){return[this._private__priceLineView,this._private__panePriceAxisView]},i.prototype.priceAxisView=function(){return this._private__priceAxisView},i.prototype.update=function(){this._private__priceLineView._internal_update(),this._private__priceAxisView.update()},i.prototype.yCoord=function(){var t=this._private__series,e=t.priceScale(),r=t.model().timeScale();if(r.isEmpty()||e.isEmpty())return null;var a=t.firstValue();return a===null?null:e.priceToCoordinate(this._private__options.price,a.value)},i}(),va=function(i){w(t,i);function t(e){var r=i.call(this)||this;return r._private__model=e,r}return t.prototype.model=function(){return this._private__model},t}(ae),K={barColor:"",barBorderColor:"",barWickColor:""},ha=function(){function i(t){this._private__series=t}return i.prototype.barStyle=function(t,e){var r=this._private__series.seriesType(),a=this._private__series.options();switch(r){case"Line":return this._private__lineStyle(a,t,e);case"Area":return this._private__areaStyle(a);case"Baseline":return this._private__baselineStyle(a,t,e);case"Bar":return this._private__barStyle(a,t,e);case"Candlestick":return this._private__candleStyle(a,t,e);case"Histogram":return this._private__histogramStyle(a,t,e)}throw new Error("Unknown chart style")},i.prototype._private__barStyle=function(t,e,r){var a=P({},K),_=t.upColor,n=t.downColor,s=_,o=n,l=g(this._private__findBar(e,r)),p=nt(l.value[0])<=nt(l.value[3]);return l.color!==void 0?(a.barColor=l.color,a.barBorderColor=l.color):(a.barColor=p?_:n,a.barBorderColor=p?s:o),a},i.prototype._private__candleStyle=function(t,e,r){var a,_,n,s=P({},K),o=t.upColor,l=t.downColor,p=t.borderUpColor,v=t.borderDownColor,h=t.wickUpColor,c=t.wickDownColor,u=g(this._private__findBar(e,r)),f=nt(u.value[0])<=nt(u.value[3]);return s.barColor=(a=u.color)!==null&&a!==void 0?a:f?o:l,s.barBorderColor=(_=u.borderColor)!==null&&_!==void 0?_:f?p:v,s.barWickColor=(n=u.wickColor)!==null&&n!==void 0?n:f?h:c,s},i.prototype._private__areaStyle=function(t){return P(P({},K),{barColor:t.lineColor})},i.prototype._private__baselineStyle=function(t,e,r){var a=g(this._private__findBar(e,r)),_=a.value[3]>=t.baseValue.price;return P(P({},K),{barColor:_?t.topLineColor:t.bottomLineColor})},i.prototype._private__lineStyle=function(t,e,r){var a,_=g(this._private__findBar(e,r));return P(P({},K),{barColor:(a=_.color)!==null&&a!==void 0?a:t.color})},i.prototype._private__histogramStyle=function(t,e,r){var a=P({},K),_=g(this._private__findBar(e,r));return a.barColor=_.color!==void 0?_.color:t.color,a},i.prototype._private__findBar=function(t,e){return e!==void 0?e.value:this._private__series.bars().valueAt(t)},i}(),Y=30,ca=function(){function i(){this._private__items=[],this._private__minMaxCache=new Map,this._private__rowSearchCache=new Map}return i.prototype.last=function(){return this.size()>0?this._private__items[this._private__items.length-1]:null},i.prototype.firstIndex=function(){return this.size()>0?this._private__indexAt(0):null},i.prototype.lastIndex=function(){return this.size()>0?this._private__indexAt(this._private__items.length-1):null},i.prototype.size=function(){return this._private__items.length},i.prototype.isEmpty=function(){return this.size()===0},i.prototype.contains=function(t){return this._private__search(t,0)!==null},i.prototype.valueAt=function(t){return this.search(t)},i.prototype.search=function(t,e){e===void 0&&(e=0);var r=this._private__search(t,e);return r===null?null:P(P({},this._private__valueAt(r)),{index:this._private__indexAt(r)})},i.prototype.rows=function(){return this._private__items},i.prototype.minMaxOnRangeCached=function(t,e,r){if(this.isEmpty())return null;for(var a=null,_=0,n=r;_<n.length;_++){var s=n[_],o=this._private__minMaxOnRangeCachedImpl(t,e,s);a=mt(a,o)}return a},i.prototype.setData=function(t){this._private__rowSearchCache.clear(),this._private__minMaxCache.clear(),this._private__items=t},i.prototype._private__indexAt=function(t){return this._private__items[t].index},i.prototype._private__valueAt=function(t){return this._private__items[t]},i.prototype._private__search=function(t,e){var r=this._private__bsearch(t);if(r===null&&e!==0)switch(e){case-1:return this._private__searchNearestLeft(t);case 1:return this._private__searchNearestRight(t);default:throw new TypeError("Unknown search mode")}return r},i.prototype._private__searchNearestLeft=function(t){var e=this._private__lowerbound(t);return e>0&&(e=e-1),e!==this._private__items.length&&this._private__indexAt(e)<t?e:null},i.prototype._private__searchNearestRight=function(t){var e=this._private__upperbound(t);return e!==this._private__items.length&&t<this._private__indexAt(e)?e:null},i.prototype._private__bsearch=function(t){var e=this._private__lowerbound(t);return e!==this._private__items.length&&!(t<this._private__items[e].index)?e:null},i.prototype._private__lowerbound=function(t){return ct(this._private__items,t,function(e,r){return e.index<r})},i.prototype._private__upperbound=function(t){return ui(this._private__items,t,function(e,r){return r.index>e})},i.prototype._private__plotMinMax=function(t,e,r){for(var a=null,_=t;_<e;_++){var n=this._private__items[_].value,s=n[r];Number.isNaN(s)||(a===null?a={min:s,max:s}:(s<a.min&&(a.min=s),s>a.max&&(a.max=s)))}return a},i.prototype._private__minMaxOnRangeCachedImpl=function(t,e,r){if(this.isEmpty())return null;var a=null,_=g(this.firstIndex()),n=g(this.lastIndex()),s=Math.max(t,_),o=Math.min(e,n),l=Math.ceil(s/Y)*Y,p=Math.max(l,Math.floor(o/Y)*Y);{var v=this._private__lowerbound(s),h=this._private__upperbound(Math.min(o,l,e)),c=this._private__plotMinMax(v,h,r);a=mt(a,c)}var u=this._private__minMaxCache.get(r);u===void 0&&(u=new Map,this._private__minMaxCache.set(r,u));for(var f=Math.max(l+1,s);f<p;f+=Y){var d=Math.floor(f/Y),m=u.get(d);if(m===void 0){var y=this._private__lowerbound(d*Y),b=this._private__upperbound((d+1)*Y-1);m=this._private__plotMinMax(y,b,r),u.set(d,m)}a=mt(a,m)}{var v=this._private__lowerbound(p),h=this._private__upperbound(o),c=this._private__plotMinMax(v,h,r);a=mt(a,c)}return a},i}();function mt(i,t){if(i===null)return t;if(t===null)return i;var e=Math.min(i.min,t.min),r=Math.max(i.max,t.max);return{min:e,max:r}}function ua(){return new ca}var It=function(i){w(t,i);function t(e,r,a){var _=i.call(this,e)||this;_._private__data=ua(),_._private__priceLineView=new na(_),_._private__customPriceLines=[],_._private__baseHorizontalLineView=new Ur(_),_._private__lastPriceAnimationPaneView=null,_._private__barColorerCache=null,_._private__markers=[],_._private__indexedMarkers=[],_._private__animationTimeoutId=null,_._private__options=r,_._private__seriesType=a;var n=new sa(_);return _._private__priceAxisViews=[n],_._private__panePriceAxisView=new gi(n,_,e),(a==="Area"||a==="Line"||a==="Baseline")&&(_._private__lastPriceAnimationPaneView=new Gr(_)),_._private__recreateFormatter(),_._private__recreatePaneViews(),_}return t.prototype.destroy=function(){this._private__animationTimeoutId!==null&&clearTimeout(this._private__animationTimeoutId)},t.prototype.priceLineColor=function(e){return this._private__options.priceLineColor||e},t.prototype.lastValueData=function(e){var r={noData:!0},a=this.priceScale();if(this.model().timeScale().isEmpty()||a.isEmpty()||this._private__data.isEmpty())return r;var _=this.model().timeScale().visibleStrictRange(),n=this.firstValue();if(_===null||n===null)return r;var s,o;if(e){var l=this._private__data.last();if(l===null)return r;s=l,o=l.index}else{var p=this._private__data.search(_.right(),-1);if(p===null||(s=this._private__data.valueAt(p.index),s===null))return r;o=p.index}var v=s.value[3],h=this.barColorer(),c=h.barStyle(o,{value:s}),u=a.priceToCoordinate(v,n.value);return{noData:!1,price:v,text:a.formatPrice(v,n.value),formattedPriceAbsolute:a.formatPriceAbsolute(v),formattedPricePercentage:a.formatPricePercentage(v,n.value),color:c.barColor,coordinate:u,index:o}},t.prototype.barColorer=function(){return this._private__barColorerCache!==null?this._private__barColorerCache:(this._private__barColorerCache=new ha(this),this._private__barColorerCache)},t.prototype.options=function(){return this._private__options},t.prototype.applyOptions=function(e){var r=e.priceScaleId;r!==void 0&&r!==this._private__options.priceScaleId&&this.model().moveSeriesToScale(this,r),R(this._private__options,e),this._priceScale!==null&&e.scaleMargins!==void 0&&this._priceScale.applyOptions({scaleMargins:e.scaleMargins}),e.priceFormat!==void 0&&(this._private__recreateFormatter(),this.model().fullUpdate()),this.model().updateSource(this),this.model().updateCrosshair(),this._private__paneView.update("options")},t.prototype.setData=function(e,r){this._private__data.setData(e),this._private__recalculateMarkers(),this._private__paneView.update("data"),this._private__markersPaneView.update("data"),this._private__lastPriceAnimationPaneView!==null&&(r&&r.lastBarUpdatedOrNewBarsAddedToTheRight?this._private__lastPriceAnimationPaneView._internal_onNewRealtimeDataReceived():e.length===0&&this._private__lastPriceAnimationPaneView._internal_onDataCleared());var a=this.model().paneForSource(this);this.model().recalculatePane(a),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},t.prototype.setMarkers=function(e){this._private__markers=e.map(function(a){return P({},a)}),this._private__recalculateMarkers();var r=this.model().paneForSource(this);this._private__markersPaneView.update("data"),this.model().recalculatePane(r),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},t.prototype.indexedMarkers=function(){return this._private__indexedMarkers},t.prototype.createPriceLine=function(e){var r=new pa(this,e);return this._private__customPriceLines.push(r),this.model().updateSource(this),r},t.prototype.removePriceLine=function(e){var r=this._private__customPriceLines.indexOf(e);r!==-1&&this._private__customPriceLines.splice(r,1),this.model().updateSource(this)},t.prototype.customPriceLines=function(){return this._private__customPriceLines},t.prototype.seriesType=function(){return this._private__seriesType},t.prototype.firstValue=function(){var e=this.firstBar();return e===null?null:{value:e.value[3],timePoint:e.time}},t.prototype.firstBar=function(){var e=this.model().timeScale().visibleStrictRange();if(e===null)return null;var r=e.left();return this._private__data.search(r,1)},t.prototype.bars=function(){return this._private__data},t.prototype.dataAt=function(e){var r=this._private__data.valueAt(e);return r===null?null:this._private__seriesType==="Bar"||this._private__seriesType==="Candlestick"?{open:r.value[0],high:r.value[1],low:r.value[2],close:r.value[3]}:r.value[3]},t.prototype.topPaneViews=function(e){var r=this,a=this._private__lastPriceAnimationPaneView;return a===null||!a._internal_visible()?[]:(this._private__animationTimeoutId===null&&a._internal_animationActive()&&(this._private__animationTimeoutId=setTimeout(function(){r._private__animationTimeoutId=null,r.model().cursorUpdate()},0)),a._internal_invalidateStage(),[a])},t.prototype.paneViews=function(){var e=[];this._private__isOverlay()||e.push(this._private__baseHorizontalLineView);for(var r=0,a=this._private__customPriceLines;r<a.length;r++){var _=a[r];e.push.apply(e,_.paneViews())}return e.push(this._private__paneView,this._private__priceLineView,this._private__panePriceAxisView,this._private__markersPaneView),e},t.prototype.priceAxisViews=function(e,r){if(r!==this._priceScale&&!this._private__isOverlay())return[];for(var a=si([],this._private__priceAxisViews,!0),_=0,n=this._private__customPriceLines;_<n.length;_++){var s=n[_];a.push(s.priceAxisView())}return a},t.prototype.autoscaleInfo=function(e,r){var a=this;if(this._private__options.autoscaleInfoProvider!==void 0){var _=this._private__options.autoscaleInfoProvider(function(){var n=a._private__autoscaleInfoImpl(e,r);return n===null?null:n.toRaw()});return De.fromRaw(_)}return this._private__autoscaleInfoImpl(e,r)},t.prototype.minMove=function(){return this._private__options.priceFormat.minMove},t.prototype.formatter=function(){return this._private__formatter},t.prototype.updateAllViews=function(){var e;this._private__paneView.update(),this._private__markersPaneView.update();for(var r=0,a=this._private__priceAxisViews;r<a.length;r++){var _=a[r];_.update()}for(var n=0,s=this._private__customPriceLines;n<s.length;n++){var o=s[n];o.update()}this._private__priceLineView._internal_update(),this._private__baseHorizontalLineView._internal_update(),(e=this._private__lastPriceAnimationPaneView)===null||e===void 0||e.update()},t.prototype.priceScale=function(){return g(i.prototype.priceScale.call(this))},t.prototype.markerDataAtIndex=function(e){var r=(this._private__seriesType==="Line"||this._private__seriesType==="Area"||this._private__seriesType==="Baseline")&&this._private__options.crosshairMarkerVisible;if(!r)return null;var a=this._private__data.valueAt(e);if(a===null)return null;var _=a.value[3],n=this._private__markerRadius(),s=this._private__markerBorderColor(),o=this._private__markerBackgroundColor(e);return{price:_,radius:n,borderColor:s,backgroundColor:o}},t.prototype.title=function(){return this._private__options.title},t.prototype.visible=function(){return this._private__options.visible},t.prototype._private__isOverlay=function(){var e=this.priceScale();return!Vt(e.id())},t.prototype._private__autoscaleInfoImpl=function(e,r){if(!pt(e)||!pt(r)||this._private__data.isEmpty())return null;var a=this._private__seriesType==="Line"||this._private__seriesType==="Area"||this._private__seriesType==="Baseline"||this._private__seriesType==="Histogram"?[3]:[2,1],_=this._private__data.minMaxOnRangeCached(e,r,a),n=_!==null?new H(_.min,_.max):null;if(this.seriesType()==="Histogram"){var s=this._private__options.base,o=new H(s,s);n=n!==null?n.merge(o):o}return new De(n,this._private__markersPaneView._internal_autoScaleMargins())},t.prototype._private__markerRadius=function(){switch(this._private__seriesType){case"Line":case"Area":case"Baseline":return this._private__options.crosshairMarkerRadius}return 0},t.prototype._private__markerBorderColor=function(){switch(this._private__seriesType){case"Line":case"Area":case"Baseline":{var e=this._private__options.crosshairMarkerBorderColor;if(e.length!==0)return e}}return null},t.prototype._private__markerBackgroundColor=function(e){switch(this._private__seriesType){case"Line":case"Area":case"Baseline":{var r=this._private__options.crosshairMarkerBackgroundColor;if(r.length!==0)return r}}return this.barColorer().barStyle(e).barColor},t.prototype._private__recreateFormatter=function(){switch(this._private__options.priceFormat.type){case"custom":{this._private__formatter={format:this._private__options.priceFormat.formatter};break}case"volume":{this._private__formatter=new mr(this._private__options.priceFormat.precision);break}case"percent":{this._private__formatter=new li(this._private__options.priceFormat.precision);break}default:{var e=Math.pow(10,this._private__options.priceFormat.precision);this._private__formatter=new Et(e,this._private__options.priceFormat.minMove*e)}}this._priceScale!==null&&this._priceScale.updateFormatter()},t.prototype._private__recalculateMarkers=function(){var e=this,r=this.model().timeScale();if(r.isEmpty()||this._private__data.size()===0){this._private__indexedMarkers=[];return}var a=g(this._private__data.firstIndex());this._private__indexedMarkers=this._private__markers.map(function(_,n){var s=g(r.timeToIndex(_.time,!0)),o=s<a?1:-1,l=g(e._private__data.search(s,o)).index;return{time:l,position:_.position,shape:_.shape,color:_.color,id:_.id,internalId:n,text:_.text,size:_.size}})},t.prototype._private__recreatePaneViews=function(){switch(this._private__markersPaneView=new _a(this,this.model()),this._private__seriesType){case"Bar":{this._private__paneView=new Mr(this,this.model());break}case"Candlestick":{this._private__paneView=new Vr(this,this.model());break}case"Line":{this._private__paneView=new zr(this,this.model());break}case"Area":{this._private__paneView=new Sr(this,this.model());break}case"Baseline":{this._private__paneView=new xr(this,this.model());break}case"Histogram":{this._private__paneView=new Wr(this,this.model());break}default:throw Error("Unknown chart style assigned: "+this._private__seriesType)}},t}(va),da=function(){function i(t){this._private__options=t}return i.prototype._internal_align=function(t,e,r){var a=t;if(this._private__options.mode===0)return a;var _=r.defaultPriceScale(),n=_.firstValue();if(n===null)return a;var s=_.priceToCoordinate(t,n),o=r.dataSources().filter(function(v){return v instanceof It}),l=o.reduce(function(v,h){if(r.isOverlay(h)||!h.visible())return v;var c=h.priceScale(),u=h.bars();if(c.isEmpty()||!u.contains(e))return v;var f=u.valueAt(e);if(f===null)return v;var d=nt(h.firstValue());return v.concat([c.priceToCoordinate(f.value[3],d.value)])},[]);if(l.length===0)return a;l.sort(function(v,h){return Math.abs(v-s)-Math.abs(h-s)});var p=l[0];return a=_.coordinateToPrice(p,n),a},i}(),fa=function(){function i(){this._private__data=null}return i.prototype._internal_setData=function(t){this._private__data=t},i.prototype.draw=function(t,e,r,a){var _=this;if(this._private__data!==null){var n=Math.max(1,Math.floor(e));t.lineWidth=n;var s=Math.ceil(this._private__data._internal_h*e),o=Math.ceil(this._private__data._internal_w*e);Gi(t,function(){var l=g(_._private__data);if(l._internal_vertLinesVisible){t.strokeStyle=l._internal_vertLinesColor,q(t,l._internal_vertLineStyle),t.beginPath();for(var p=0,v=l._internal_timeMarks;p<v.length;p++){var h=v[p],c=Math.round(h._internal_coord*e);t.moveTo(c,-n),t.lineTo(c,s+n)}t.stroke()}if(l._internal_horzLinesVisible){t.strokeStyle=l._internal_horzLinesColor,q(t,l._internal_horzLineStyle),t.beginPath();for(var u=0,f=l._internal_priceMarks;u<f.length;u++){var d=f[u],m=Math.round(d.coord*e);t.moveTo(-n,m),t.lineTo(o+n,m)}t.stroke()}})}},i}(),ma=function(){function i(t){this._private__renderer=new fa,this._private__invalidated=!0,this._private__pane=t}return i.prototype.update=function(){this._private__invalidated=!0},i.prototype.renderer=function(t,e){if(this._private__invalidated){var r=this._private__pane.model().options().grid,a={_internal_h:t,_internal_w:e,_internal_horzLinesVisible:r.horzLines.visible,_internal_vertLinesVisible:r.vertLines.visible,_internal_horzLinesColor:r.horzLines.color,_internal_vertLinesColor:r.vertLines.color,_internal_horzLineStyle:r.horzLines.style,_internal_vertLineStyle:r.vertLines.style,_internal_priceMarks:this._private__pane.defaultPriceScale().marks(),_internal_timeMarks:this._private__pane.model().timeScale().marks()||[]};this._private__renderer._internal_setData(a),this._private__invalidated=!1}return this._private__renderer},i}(),ga=function(){function i(t){this._private__paneView=new ma(t)}return i.prototype.paneView=function(){return this._private__paneView},i}(),Nt={_internal_logicalOffset:4,_internal_coordOffset:1e-4};function ya(i,t){return t<0&&(i=-i),i/100*t+t}function et(i,t){var e=100*(i-t)/t;return t<0?-e:e}function ba(i,t){var e=et(i.minValue(),t),r=et(i.maxValue(),t);return new H(e,r)}function Sa(i,t){return i-=100,t<0&&(i=-i),i/100*t+t}function ot(i,t){var e=100*(i-t)/t+100;return t<0?-e:e}function wa(i,t){var e=ot(i.minValue(),t),r=ot(i.maxValue(),t);return new H(e,r)}function Rt(i,t){var e=Math.abs(i);if(e<1e-15)return 0;var r=fi(e+t._internal_coordOffset)+t._internal_logicalOffset;return i<0?-r:r}function vt(i,t){var e=Math.abs(i);if(e<1e-15)return 0;var r=Math.pow(10,e-t._internal_logicalOffset)-t._internal_coordOffset;return i<0?-r:r}function _t(i,t){if(i===null)return null;var e=Rt(i.minValue(),t),r=Rt(i.maxValue(),t);return new H(e,r)}function Ca(i,t){if(i===null)return!1;var e=vt(i.minValue(),t),r=vt(i.maxValue(),t);return isFinite(e)&&isFinite(r)}function gt(i,t){if(i===null)return null;var e=vt(i.minValue(),t),r=vt(i.maxValue(),t);return new H(e,r)}function Ht(i){if(i===null)return Nt;var t=Math.abs(i.maxValue()-i.minValue());if(t>=1||t<1e-15)return Nt;var e=Math.ceil(Math.abs(Math.log10(t))),r=Nt._internal_logicalOffset+e,a=1/Math.pow(10,r);return{_internal_logicalOffset:r,_internal_coordOffset:a}}function Pa(i,t){return i._internal_logicalOffset===t._internal_logicalOffset&&i._internal_coordOffset===t._internal_coordOffset}var Ut=function(){function i(t,e){if(this._private__base=t,this._private__integralDividers=e,Tr(this._private__base))this._private__fractionalDividers=[2,2.5,2];else{this._private__fractionalDividers=[];for(var r=this._private__base;r!==1;){if(r%2===0)this._private__fractionalDividers.push(2),r/=2;else if(r%5===0)this._private__fractionalDividers.push(2,2.5),r/=5;else throw new Error("unexpected base");if(this._private__fractionalDividers.length>100)throw new Error("something wrong with base")}}}return i.prototype._internal_tickSpan=function(t,e,r){for(var a=this._private__base===0?0:1/this._private__base,_=Math.pow(10,Math.max(0,Math.ceil(fi(t-e)))),n=0,s=this._private__integralDividers[0];;){var o=ft(_,a,1e-14)&&_>a+1e-14,l=ft(_,r*s,1e-14),p=ft(_,1,1e-14),v=o&&l&&p;if(!v)break;_/=s,s=this._private__integralDividers[++n%this._private__integralDividers.length]}if(_<=a+1e-14&&(_=a),_=Math.max(1,_),this._private__fractionalDividers.length>0&&kr(_,1,1e-14))for(n=0,s=this._private__fractionalDividers[0];ft(_,r*s,1e-14)&&_>a+1e-14;)_/=s,s=this._private__fractionalDividers[++n%this._private__fractionalDividers.length];return _},i}(),Ma=2.5,Le=function(){function i(t,e,r,a){this._private__marks=[],this._private__priceScale=t,this._private__base=e,this._private__coordinateToLogicalFunc=r,this._private__logicalToCoordinateFunc=a}return i.prototype._internal_tickSpan=function(t,e){if(t<e)throw new Error("high < low");var r=this._private__priceScale.height(),a=this._private__tickMarkHeight(),_=(t-e)*a/r,n=new Ut(this._private__base,[2,2.5,2]),s=new Ut(this._private__base,[2,2,2.5]),o=new Ut(this._private__base,[2.5,2,2]),l=[];return l.push(n._internal_tickSpan(t,e,_),s._internal_tickSpan(t,e,_),o._internal_tickSpan(t,e,_)),Rr(l)},i.prototype._internal_rebuildTickMarks=function(){var t=this._private__priceScale,e=t.firstValue();if(e===null){this._private__marks=[];return}var r=t.height(),a=this._private__coordinateToLogicalFunc(r-1,e),_=this._private__coordinateToLogicalFunc(0,e),n=this._private__priceScale.options().entireTextOnly?this._private__fontHeight()/2:0,s=n,o=r-1-n,l=Math.max(a,_),p=Math.min(a,_);if(l===p){this._private__marks=[];return}var v=this._internal_tickSpan(l,p),h=l%v;h+=h<0?v:0;for(var c=l>=p?1:-1,u=null,f=0,d=l-h;d>p;d-=v){var m=this._private__logicalToCoordinateFunc(d,e,!0);u!==null&&Math.abs(m-u)<this._private__tickMarkHeight()||m<s||m>o||(f<this._private__marks.length?(this._private__marks[f].coord=m,this._private__marks[f].label=t.formatLogical(d)):this._private__marks.push({coord:m,label:t.formatLogical(d)}),f++,u=m,t.isLog()&&(v=this._internal_tickSpan(d*c,p)))}this._private__marks.length=f},i.prototype._internal_marks=function(){return this._private__marks},i.prototype._private__fontHeight=function(){return this._private__priceScale.fontSize()},i.prototype._private__tickMarkHeight=function(){return Math.ceil(this._private__fontHeight()*Ma)},i}();function Si(i){return i.slice().sort(function(t,e){return g(t.zorder())-g(e.zorder())})}var xe;(function(i){i[i.Normal=0]="Normal",i[i.Logarithmic=1]="Logarithmic",i[i.Percentage=2]="Percentage",i[i.IndexedTo100=3]="IndexedTo100"})(xe||(xe={}));var Ae=new li,Ve=new Et(100,1),Ta=function(){function i(t,e,r,a){this._private__height=0,this._private__internalHeightCache=null,this._private__priceRange=null,this._private__priceRangeSnapshot=null,this._private__invalidatedForRange={_internal_isValid:!1,_internal_visibleBars:null},this._private__marginAbove=0,this._private__marginBelow=0,this._private__onMarksChanged=new M,this._private__modeChanged=new M,this._private__dataSources=[],this._private__cachedOrderedSources=null,this._private__marksCache=null,this._private__scaleStartPoint=null,this._private__scrollStartPoint=null,this._private__formatter=Ve,this._private__logFormula=Ht(null),this._private__id=t,this._private__options=e,this._private__layoutOptions=r,this._private__localizationOptions=a,this._private__markBuilder=new Le(this,100,this._private__coordinateToLogical.bind(this),this._private__logicalToCoordinate.bind(this))}return i.prototype.id=function(){return this._private__id},i.prototype.options=function(){return this._private__options},i.prototype.applyOptions=function(t){if(R(this._private__options,t),this.updateFormatter(),t.mode!==void 0&&this.setMode({mode:t.mode}),t.scaleMargins!==void 0){var e=E(t.scaleMargins.top),r=E(t.scaleMargins.bottom);if(e<0||e>1)throw new Error("Invalid top margin - expect value between 0 and 1, given=".concat(e));if(r<0||r>1||e+r>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(r));if(e+r>1)throw new Error("Invalid margins - sum of margins must be less than 1, given=".concat(e+r));this._private__invalidateInternalHeightCache(),this._private__marksCache=null}},i.prototype.isAutoScale=function(){return this._private__options.autoScale},i.prototype.isLog=function(){return this._private__options.mode===1},i.prototype.isPercentage=function(){return this._private__options.mode===2},i.prototype.isIndexedTo100=function(){return this._private__options.mode===3},i.prototype.mode=function(){return{autoScale:this._private__options.autoScale,isInverted:this._private__options.invertScale,mode:this._private__options.mode}},i.prototype.setMode=function(t){var e=this.mode(),r=null;t.autoScale!==void 0&&(this._private__options.autoScale=t.autoScale),t.mode!==void 0&&(this._private__options.mode=t.mode,(t.mode===2||t.mode===3)&&(this._private__options.autoScale=!0),this._private__invalidatedForRange._internal_isValid=!1),e.mode===1&&t.mode!==e.mode&&(Ca(this._private__priceRange,this._private__logFormula)?(r=gt(this._private__priceRange,this._private__logFormula),r!==null&&this.setPriceRange(r)):this._private__options.autoScale=!0),t.mode===1&&t.mode!==e.mode&&(r=_t(this._private__priceRange,this._private__logFormula),r!==null&&this.setPriceRange(r));var a=e.mode!==this._private__options.mode;a&&(e.mode===2||this.isPercentage())&&this.updateFormatter(),a&&(e.mode===3||this.isIndexedTo100())&&this.updateFormatter(),t.isInverted!==void 0&&e.isInverted!==t.isInverted&&(this._private__options.invertScale=t.isInverted,this._private__onIsInvertedChanged()),this._private__modeChanged._internal_fire(e,this.mode())},i.prototype.modeChanged=function(){return this._private__modeChanged},i.prototype.fontSize=function(){return this._private__layoutOptions.fontSize},i.prototype.height=function(){return this._private__height},i.prototype.setHeight=function(t){this._private__height!==t&&(this._private__height=t,this._private__invalidateInternalHeightCache(),this._private__marksCache=null)},i.prototype.internalHeight=function(){if(this._private__internalHeightCache)return this._private__internalHeightCache;var t=this.height()-this._private__topMarginPx()-this._private__bottomMarginPx();return this._private__internalHeightCache=t,t},i.prototype.priceRange=function(){return this._private__makeSureItIsValid(),this._private__priceRange},i.prototype.setPriceRange=function(t,e){var r=this._private__priceRange;!e&&!(r===null&&t!==null)&&(r===null||r.equals(t))||(this._private__marksCache=null,this._private__priceRange=t)},i.prototype.isEmpty=function(){return this._private__makeSureItIsValid(),this._private__height===0||!this._private__priceRange||this._private__priceRange.isEmpty()},i.prototype.invertedCoordinate=function(t){return this.isInverted()?t:this.height()-1-t},i.prototype.priceToCoordinate=function(t,e){return this.isPercentage()?t=et(t,e):this.isIndexedTo100()&&(t=ot(t,e)),this._private__logicalToCoordinate(t,e)},i.prototype.pointsArrayToCoordinates=function(t,e,r){this._private__makeSureItIsValid();for(var a=this._private__bottomMarginPx(),_=g(this.priceRange()),n=_.minValue(),s=_.maxValue(),o=this.internalHeight()-1,l=this.isInverted(),p=o/(s-n),v=r===void 0?0:r.from,h=r===void 0?t.length:r.to,c=this._private__getCoordinateTransformer(),u=v;u<h;u++){var f=t[u],d=f.price;if(!isNaN(d)){var m=d;c!==null&&(m=c(f.price,e));var y=a+p*(m-n),b=l?y:this._private__height-1-y;f.y=b}}},i.prototype.barPricesToCoordinates=function(t,e,r){this._private__makeSureItIsValid();for(var a=this._private__bottomMarginPx(),_=g(this.priceRange()),n=_.minValue(),s=_.maxValue(),o=this.internalHeight()-1,l=this.isInverted(),p=o/(s-n),v=r===void 0?0:r.from,h=r===void 0?t.length:r.to,c=this._private__getCoordinateTransformer(),u=v;u<h;u++){var f=t[u],d=f.open,m=f.high,y=f.low,b=f.close;c!==null&&(d=c(f.open,e),m=c(f.high,e),y=c(f.low,e),b=c(f.close,e));var C=a+p*(d-n),S=l?C:this._private__height-1-C;f.openY=S,C=a+p*(m-n),S=l?C:this._private__height-1-C,f.highY=S,C=a+p*(y-n),S=l?C:this._private__height-1-C,f.lowY=S,C=a+p*(b-n),S=l?C:this._private__height-1-C,f.closeY=S}},i.prototype.coordinateToPrice=function(t,e){var r=this._private__coordinateToLogical(t,e);return this.logicalToPrice(r,e)},i.prototype.logicalToPrice=function(t,e){var r=t;return this.isPercentage()?r=ya(r,e):this.isIndexedTo100()&&(r=Sa(r,e)),r},i.prototype.dataSources=function(){return this._private__dataSources},i.prototype.orderedSources=function(){if(this._private__cachedOrderedSources)return this._private__cachedOrderedSources;for(var t=[],e=0;e<this._private__dataSources.length;e++){var r=this._private__dataSources[e];r.zorder()===null&&r.setZorder(e+1),t.push(r)}return t=Si(t),this._private__cachedOrderedSources=t,this._private__cachedOrderedSources},i.prototype.addDataSource=function(t){this._private__dataSources.indexOf(t)===-1&&(this._private__dataSources.push(t),this.updateFormatter(),this.invalidateSourcesCache())},i.prototype.removeDataSource=function(t){var e=this._private__dataSources.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this._private__dataSources.splice(e,1),this._private__dataSources.length===0&&(this.setMode({autoScale:!0}),this.setPriceRange(null)),this.updateFormatter(),this.invalidateSourcesCache()},i.prototype.firstValue=function(){for(var t=null,e=0,r=this._private__dataSources;e<r.length;e++){var a=r[e],_=a.firstValue();_!==null&&(t===null||_.timePoint<t.timePoint)&&(t=_)}return t===null?null:t.value},i.prototype.isInverted=function(){return this._private__options.invertScale},i.prototype.marks=function(){var t=this.firstValue()===null;if(this._private__marksCache!==null&&(t||this._private__marksCache._internal_firstValueIsNull===t))return this._private__marksCache._internal_marks;this._private__markBuilder._internal_rebuildTickMarks();var e=this._private__markBuilder._internal_marks();return this._private__marksCache={_internal_marks:e,_internal_firstValueIsNull:t},this._private__onMarksChanged._internal_fire(),e},i.prototype.onMarksChanged=function(){return this._private__onMarksChanged},i.prototype.startScale=function(t){this.isPercentage()||this.isIndexedTo100()||this._private__scaleStartPoint!==null||this._private__priceRangeSnapshot!==null||this.isEmpty()||(this._private__scaleStartPoint=this._private__height-t,this._private__priceRangeSnapshot=g(this.priceRange()).clone())},i.prototype.scaleTo=function(t){if(!(this.isPercentage()||this.isIndexedTo100())&&this._private__scaleStartPoint!==null){this.setMode({autoScale:!1}),t=this._private__height-t,t<0&&(t=0);var e=(this._private__scaleStartPoint+(this._private__height-1)*.2)/(t+(this._private__height-1)*.2),r=g(this._private__priceRangeSnapshot).clone();e=Math.max(e,.1),r.scaleAroundCenter(e),this.setPriceRange(r)}},i.prototype.endScale=function(){this.isPercentage()||this.isIndexedTo100()||(this._private__scaleStartPoint=null,this._private__priceRangeSnapshot=null)},i.prototype.startScroll=function(t){this.isAutoScale()||this._private__scrollStartPoint!==null||this._private__priceRangeSnapshot!==null||this.isEmpty()||(this._private__scrollStartPoint=t,this._private__priceRangeSnapshot=g(this.priceRange()).clone())},i.prototype.scrollTo=function(t){if(!this.isAutoScale()&&this._private__scrollStartPoint!==null){var e=g(this.priceRange()).length()/(this.internalHeight()-1),r=t-this._private__scrollStartPoint;this.isInverted()&&(r*=-1);var a=r*e,_=g(this._private__priceRangeSnapshot).clone();_.shift(a),this.setPriceRange(_,!0),this._private__marksCache=null}},i.prototype.endScroll=function(){this.isAutoScale()||this._private__scrollStartPoint!==null&&(this._private__scrollStartPoint=null,this._private__priceRangeSnapshot=null)},i.prototype.formatter=function(){return this._private__formatter||this.updateFormatter(),this._private__formatter},i.prototype.formatPrice=function(t,e){switch(this._private__options.mode){case 2:return this.formatter().format(et(t,e));case 3:return this.formatter().format(ot(t,e));default:return this._private__formatPrice(t)}},i.prototype.formatLogical=function(t){switch(this._private__options.mode){case 2:case 3:return this.formatter().format(t);default:return this._private__formatPrice(t)}},i.prototype.formatPriceAbsolute=function(t){return this._private__formatPrice(t,g(this._private__formatterSource()).formatter())},i.prototype.formatPricePercentage=function(t,e){return t=et(t,e),Ae.format(t)},i.prototype.sourcesForAutoScale=function(){return this._private__dataSources},i.prototype.recalculatePriceRange=function(t){this._private__invalidatedForRange={_internal_visibleBars:t,_internal_isValid:!1}},i.prototype.updateAllViews=function(){this._private__dataSources.forEach(function(t){return t.updateAllViews()})},i.prototype.updateFormatter=function(){this._private__marksCache=null;var t=this._private__formatterSource(),e=100;t!==null&&(e=Math.round(1/t.minMove())),this._private__formatter=Ve,this.isPercentage()?(this._private__formatter=Ae,e=100):this.isIndexedTo100()?(this._private__formatter=new Et(100,1),e=100):t!==null&&(this._private__formatter=t.formatter()),this._private__markBuilder=new Le(this,e,this._private__coordinateToLogical.bind(this),this._private__logicalToCoordinate.bind(this)),this._private__markBuilder._internal_rebuildTickMarks()},i.prototype.invalidateSourcesCache=function(){this._private__cachedOrderedSources=null},i.prototype._private__formatterSource=function(){return this._private__dataSources[0]||null},i.prototype._private__topMarginPx=function(){return this.isInverted()?this._private__options.scaleMargins.bottom*this.height()+this._private__marginBelow:this._private__options.scaleMargins.top*this.height()+this._private__marginAbove},i.prototype._private__bottomMarginPx=function(){return this.isInverted()?this._private__options.scaleMargins.top*this.height()+this._private__marginAbove:this._private__options.scaleMargins.bottom*this.height()+this._private__marginBelow},i.prototype._private__makeSureItIsValid=function(){this._private__invalidatedForRange._internal_isValid||(this._private__invalidatedForRange._internal_isValid=!0,this._private__recalculatePriceRangeImpl())},i.prototype._private__invalidateInternalHeightCache=function(){this._private__internalHeightCache=null},i.prototype._private__logicalToCoordinate=function(t,e){if(this._private__makeSureItIsValid(),this.isEmpty())return 0;t=this.isLog()&&t?Rt(t,this._private__logFormula):t;var r=g(this.priceRange()),a=this._private__bottomMarginPx()+(this.internalHeight()-1)*(t-r.minValue())/r.length(),_=this.invertedCoordinate(a);return _},i.prototype._private__coordinateToLogical=function(t,e){if(this._private__makeSureItIsValid(),this.isEmpty())return 0;var r=this.invertedCoordinate(t),a=g(this.priceRange()),_=a.minValue()+a.length()*((r-this._private__bottomMarginPx())/(this.internalHeight()-1));return this.isLog()?vt(_,this._private__logFormula):_},i.prototype._private__onIsInvertedChanged=function(){this._private__marksCache=null,this._private__markBuilder._internal_rebuildTickMarks()},i.prototype._private__recalculatePriceRangeImpl=function(){var t=this._private__invalidatedForRange._internal_visibleBars;if(t!==null){for(var e=null,r=this.sourcesForAutoScale(),a=0,_=0,n=0,s=r;n<s.length;n++){var o=s[n];if(o.visible()){var l=o.firstValue();if(l!==null){var p=o.autoscaleInfo(t.left(),t.right()),v=p&&p.priceRange();if(v!==null){switch(this._private__options.mode){case 1:v=_t(v,this._private__logFormula);break;case 2:v=ba(v,l.value);break;case 3:v=wa(v,l.value);break}if(e===null?e=v:e=e.merge(g(v)),p!==null){var h=p.margins();h!==null&&(a=Math.max(a,h.above),_=Math.max(a,h.below))}}}}}if((a!==this._private__marginAbove||_!==this._private__marginBelow)&&(this._private__marginAbove=a,this._private__marginBelow=_,this._private__marksCache=null,this._private__invalidateInternalHeightCache()),e!==null){if(e.minValue()===e.maxValue()){var c=this._private__formatterSource(),u=c===null||this.isPercentage()||this.isIndexedTo100()?1:c.minMove(),f=5*u;this.isLog()&&(e=gt(e,this._private__logFormula)),e=new H(e.minValue()-f,e.maxValue()+f),this.isLog()&&(e=_t(e,this._private__logFormula))}if(this.isLog()){var d=gt(e,this._private__logFormula),m=Ht(d);if(!Pa(m,this._private__logFormula)){var y=this._private__priceRangeSnapshot!==null?gt(this._private__priceRangeSnapshot,this._private__logFormula):null;this._private__logFormula=m,e=_t(d,m),y!==null&&(this._private__priceRangeSnapshot=_t(y,m))}}this.setPriceRange(e)}else this._private__priceRange===null&&(this.setPriceRange(new H(-.5,.5)),this._private__logFormula=Ht(null));this._private__invalidatedForRange._internal_isValid=!0}},i.prototype._private__getCoordinateTransformer=function(){var t=this;return this.isPercentage()?et:this.isIndexedTo100()?ot:this.isLog()?function(e){return Rt(e,t._private__logFormula)}:null},i.prototype._private__formatPrice=function(t,e){return this._private__localizationOptions.priceFormatter===void 0?(e===void 0&&(e=this.formatter()),e.format(t)):this._private__localizationOptions.priceFormatter(t)},i}(),wi=1e3,ka=function(){function i(t,e){this._private__dataSources=[],this._private__overlaySourcesByScaleId=new Map,this._private__height=0,this._private__width=0,this._private__stretchFactor=wi,this._private__cachedOrderedSources=null,this._private__destroyed=new M,this._private__timeScale=t,this._private__model=e,this._private__grid=new ga(this);var r=e.options();this._private__leftPriceScale=this._private__createPriceScale("left",r.leftPriceScale),this._private__rightPriceScale=this._private__createPriceScale("right",r.rightPriceScale),this._private__leftPriceScale.modeChanged().subscribe(this._private__onPriceScaleModeChanged.bind(this,this._private__leftPriceScale),this),this._private__rightPriceScale.modeChanged().subscribe(this._private__onPriceScaleModeChanged.bind(this,this._private__leftPriceScale),this),this.applyScaleOptions(r)}return i.prototype.applyScaleOptions=function(t){if(t.leftPriceScale&&this._private__leftPriceScale.applyOptions(t.leftPriceScale),t.rightPriceScale&&this._private__rightPriceScale.applyOptions(t.rightPriceScale),t.localization&&(this._private__leftPriceScale.updateFormatter(),this._private__rightPriceScale.updateFormatter()),t.overlayPriceScales)for(var e=Array.from(this._private__overlaySourcesByScaleId.values()),r=0,a=e;r<a.length;r++){var _=a[r],n=g(_[0].priceScale());n.applyOptions(t.overlayPriceScales),t.localization&&n.updateFormatter()}},i.prototype.priceScaleById=function(t){switch(t){case"left":return this._private__leftPriceScale;case"right":return this._private__rightPriceScale}return this._private__overlaySourcesByScaleId.has(t)?E(this._private__overlaySourcesByScaleId.get(t))[0].priceScale():null},i.prototype.destroy=function(){this.model().priceScalesOptionsChanged().unsubscribeAll(this),this._private__leftPriceScale.modeChanged().unsubscribeAll(this),this._private__rightPriceScale.modeChanged().unsubscribeAll(this),this._private__dataSources.forEach(function(t){t.destroy&&t.destroy()}),this._private__destroyed._internal_fire()},i.prototype.stretchFactor=function(){return this._private__stretchFactor},i.prototype.setStretchFactor=function(t){this._private__stretchFactor=t},i.prototype.model=function(){return this._private__model},i.prototype.width=function(){return this._private__width},i.prototype.height=function(){return this._private__height},i.prototype.setWidth=function(t){this._private__width=t,this.updateAllSources()},i.prototype.setHeight=function(t){var e=this;this._private__height=t,this._private__leftPriceScale.setHeight(t),this._private__rightPriceScale.setHeight(t),this._private__dataSources.forEach(function(r){if(e.isOverlay(r)){var a=r.priceScale();a!==null&&a.setHeight(t)}}),this.updateAllSources()},i.prototype.dataSources=function(){return this._private__dataSources},i.prototype.isOverlay=function(t){var e=t.priceScale();return e===null?!0:this._private__leftPriceScale!==e&&this._private__rightPriceScale!==e},i.prototype.addDataSource=function(t,e,r){var a=r!==void 0?r:this._private__getZOrderMinMax()._internal_maxZOrder+1;this._private__insertDataSource(t,e,a)},i.prototype.removeDataSource=function(t){var e=this._private__dataSources.indexOf(t);x(e!==-1,"removeDataSource: invalid data source"),this._private__dataSources.splice(e,1);var r=g(t.priceScale()).id();if(this._private__overlaySourcesByScaleId.has(r)){var a=E(this._private__overlaySourcesByScaleId.get(r)),_=a.indexOf(t);_!==-1&&(a.splice(_,1),a.length===0&&this._private__overlaySourcesByScaleId.delete(r))}var n=t.priceScale();n&&n.dataSources().indexOf(t)>=0&&n.removeDataSource(t),n!==null&&(n.invalidateSourcesCache(),this.recalculatePriceScale(n)),this._private__cachedOrderedSources=null},i.prototype.priceScalePosition=function(t){return t===this._private__leftPriceScale?"left":t===this._private__rightPriceScale?"right":"overlay"},i.prototype.leftPriceScale=function(){return this._private__leftPriceScale},i.prototype.rightPriceScale=function(){return this._private__rightPriceScale},i.prototype.startScalePrice=function(t,e){t.startScale(e)},i.prototype.scalePriceTo=function(t,e){t.scaleTo(e),this.updateAllSources()},i.prototype.endScalePrice=function(t){t.endScale()},i.prototype.startScrollPrice=function(t,e){t.startScroll(e)},i.prototype.scrollPriceTo=function(t,e){t.scrollTo(e),this.updateAllSources()},i.prototype.endScrollPrice=function(t){t.endScroll()},i.prototype.updateAllSources=function(){this._private__dataSources.forEach(function(t){t.updateAllViews()})},i.prototype.defaultPriceScale=function(){var t=null;return this._private__model.options().rightPriceScale.visible&&this._private__rightPriceScale.dataSources().length!==0?t=this._private__rightPriceScale:this._private__model.options().leftPriceScale.visible&&this._private__leftPriceScale.dataSources().length!==0?t=this._private__leftPriceScale:this._private__dataSources.length!==0&&(t=this._private__dataSources[0].priceScale()),t===null&&(t=this._private__rightPriceScale),t},i.prototype.defaultVisiblePriceScale=function(){var t=null;return this._private__model.options().rightPriceScale.visible?t=this._private__rightPriceScale:this._private__model.options().leftPriceScale.visible&&(t=this._private__leftPriceScale),t},i.prototype.recalculatePriceScale=function(t){t===null||!t.isAutoScale()||this._private__recalculatePriceScaleImpl(t)},i.prototype.resetPriceScale=function(t){var e=this._private__timeScale.visibleStrictRange();t.setMode({autoScale:!0}),e!==null&&t.recalculatePriceRange(e),this.updateAllSources()},i.prototype.momentaryAutoScale=function(){this._private__recalculatePriceScaleImpl(this._private__leftPriceScale),this._private__recalculatePriceScaleImpl(this._private__rightPriceScale)},i.prototype.recalculate=function(){var t=this;this.recalculatePriceScale(this._private__leftPriceScale),this.recalculatePriceScale(this._private__rightPriceScale),this._private__dataSources.forEach(function(e){t.isOverlay(e)&&t.recalculatePriceScale(e.priceScale())}),this.updateAllSources(),this._private__model.lightUpdate()},i.prototype.orderedSources=function(){return this._private__cachedOrderedSources===null&&(this._private__cachedOrderedSources=Si(this._private__dataSources)),this._private__cachedOrderedSources},i.prototype.onDestroyed=function(){return this._private__destroyed},i.prototype.grid=function(){return this._private__grid},i.prototype._private__recalculatePriceScaleImpl=function(t){var e=t.sourcesForAutoScale();if(e&&e.length>0&&!this._private__timeScale.isEmpty()){var r=this._private__timeScale.visibleStrictRange();r!==null&&t.recalculatePriceRange(r)}t.updateAllViews()},i.prototype._private__getZOrderMinMax=function(){var t=this.orderedSources();if(t.length===0)return{_internal_minZOrder:0,_internal_maxZOrder:0};for(var e=0,r=0,a=0;a<t.length;a++){var _=t[a],n=_.zorder();n!==null&&(n<e&&(e=n),n>r&&(r=n))}return{_internal_minZOrder:e,_internal_maxZOrder:r}},i.prototype._private__insertDataSource=function(t,e,r){var a=this.priceScaleById(e);if(a===null&&(a=this._private__createPriceScale(e,this._private__model.options().overlayPriceScales)),this._private__dataSources.push(t),!Vt(e)){var _=this._private__overlaySourcesByScaleId.get(e)||[];_.push(t),this._private__overlaySourcesByScaleId.set(e,_)}a.addDataSource(t),t.setPriceScale(a),t.setZorder(r),this.recalculatePriceScale(a),this._private__cachedOrderedSources=null},i.prototype._private__onPriceScaleModeChanged=function(t,e,r){e.mode!==r.mode&&this._private__recalculatePriceScaleImpl(t)},i.prototype._private__createPriceScale=function(t,e){var r=P({visible:!0,autoScale:!0},L(e)),a=new Ta(t,r,this._private__model.options().layout,this._private__model.options().localization);return a.setHeight(this.height()),a},i}(),Ra=function(i){return i.getUTCMonth()+1},Da=function(i){return i.getUTCDate()},Ci=function(i){return i.getUTCFullYear()},La=function(i){return N(Da(i),2)},xa=function(i,t){return new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(t,{month:"long"})},Aa=function(i,t){return new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(t,{month:"short"})},Va=function(i){return N(Ra(i),2)},Ea=function(i){return N(Ci(i)%100,2)},Ia=function(i){return N(Ci(i),4)};function Ba(i,t,e){return t.replace(/yyyy/g,Ia(i)).replace(/yy/g,Ea(i)).replace(/MMMM/g,xa(i,e)).replace(/MMM/g,Aa(i,e)).replace(/MM/g,Va(i)).replace(/dd/g,La(i))}var Pi=function(){function i(t,e){t===void 0&&(t="yyyy-MM-dd"),e===void 0&&(e="default"),this._private__dateFormat=t,this._private__locale=e}return i.prototype._internal_format=function(t){return Ba(t,this._private__dateFormat,this._private__locale)},i}(),Oa=function(){function i(t){this._private__formatStr=t||"%h:%m:%s"}return i.prototype._internal_format=function(t){return this._private__formatStr.replace("%h",N(t.getUTCHours(),2)).replace("%m",N(t.getUTCMinutes(),2)).replace("%s",N(t.getUTCSeconds(),2))},i}(),Wa={_internal_dateFormat:"yyyy-MM-dd",_internal_timeFormat:"%h:%m:%s",_internal_dateTimeSeparator:" ",_internal_locale:"default"},za=function(){function i(t){t===void 0&&(t={});var e=P(P({},Wa),t);this._private__dateFormatter=new Pi(e._internal_dateFormat,e._internal_locale),this._private__timeFormatter=new Oa(e._internal_timeFormat),this._private__separator=e._internal_dateTimeSeparator}return i.prototype._internal_format=function(t){return"".concat(this._private__dateFormatter._internal_format(t)).concat(this._private__separator).concat(this._private__timeFormatter._internal_format(t))},i}();function Fa(i,t,e){var r={};switch(t){case 0:r.year="numeric";break;case 1:r.month="short";break;case 2:r.day="numeric";break;case 3:r.hour12=!1,r.hour="2-digit",r.minute="2-digit";break;case 4:r.hour12=!1,r.hour="2-digit",r.minute="2-digit",r.second="2-digit";break}var a=i.businessDay===void 0?new Date(i.timestamp*1e3):new Date(Date.UTC(i.businessDay.year,i.businessDay.month-1,i.businessDay.day)),_=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds());return _.toLocaleString(e,r)}var Na=function(){function i(t,e){e===void 0&&(e=50),this._private__actualSize=0,this._private__usageTick=1,this._private__oldestTick=1,this._private__cache=new Map,this._private__tick2Labels=new Map,this._private__format=t,this._private__maxSize=e}return i.prototype._internal_format=function(t){var e=t.businessDay===void 0?new Date(t.timestamp*1e3).getTime():new Date(Date.UTC(t.businessDay.year,t.businessDay.month-1,t.businessDay.day)).getTime(),r=this._private__cache.get(e);if(r!==void 0)return r._internal_string;if(this._private__actualSize===this._private__maxSize){var a=this._private__tick2Labels.get(this._private__oldestTick);this._private__tick2Labels.delete(this._private__oldestTick),this._private__cache.delete(E(a)),this._private__oldestTick++,this._private__actualSize--}var _=this._private__format(t);return this._private__cache.set(e,{_internal_string:_,_internal_tick:this._private__usageTick}),this._private__tick2Labels.set(this._private__usageTick,e),this._private__actualSize++,this._private__usageTick++,_},i}(),lt=function(){function i(t,e){x(t<=e,"right should be >= left"),this._private__left=t,this._private__right=e}return i.prototype.left=function(){return this._private__left},i.prototype.right=function(){return this._private__right},i.prototype.count=function(){return this._private__right-this._private__left+1},i.prototype.contains=function(t){return this._private__left<=t&&t<=this._private__right},i.prototype.equals=function(t){return this._private__left===t.left()&&this._private__right===t.right()},i}();function Ee(i,t){return i===null||t===null?i===t:i.equals(t)}var Ha=function(){function i(){this._private__marksByWeight=new Map,this._private__cache=null}return i.prototype._internal_setTimeScalePoints=function(t,e){this._private__removeMarksSinceIndex(e),this._private__cache=null;for(var r=e;r<t.length;++r){var a=t[r],_=this._private__marksByWeight.get(a.timeWeight);_===void 0&&(_=[],this._private__marksByWeight.set(a.timeWeight,_)),_.push({_internal_index:r,_internal_time:a.time,_internal_weight:a.timeWeight})}},i.prototype._internal_build=function(t,e){var r=Math.ceil(e/t);return(this._private__cache===null||this._private__cache._internal_maxIndexesPerMark!==r)&&(this._private__cache={_internal_marks:this._private__buildMarksImpl(r),_internal_maxIndexesPerMark:r}),this._private__cache._internal_marks},i.prototype._private__removeMarksSinceIndex=function(t){if(t===0){this._private__marksByWeight.clear();return}var e=[];this._private__marksByWeight.forEach(function(n,s){t<=n[0]._internal_index?e.push(s):n.splice(ct(n,t,function(o){return o._internal_index<t}),1/0)});for(var r=0,a=e;r<a.length;r++){var _=a[r];this._private__marksByWeight.delete(_)}},i.prototype._private__buildMarksImpl=function(t){for(var e=[],r=0,a=Array.from(this._private__marksByWeight.keys()).sort(function(y,b){return b-y});r<a.length;r++){var _=a[r];if(this._private__marksByWeight.get(_)){var n=e;e=[];for(var s=n.length,o=0,l=E(this._private__marksByWeight.get(_)),p=l.length,v=1/0,h=-1/0,c=0;c<p;c++){for(var u=l[c],f=u._internal_index;o<s;){var d=n[o],m=d._internal_index;if(m<f)o++,e.push(d),h=m,v=1/0;else{v=m;break}}v-f>=t&&f-h>=t&&(e.push(u),h=f)}for(;o<s;o++)e.push(n[o])}}return e},i}(),Pt=function(){function i(t){this._private__logicalRange=t}return i.prototype._internal_strictRange=function(){return this._private__logicalRange===null?null:new lt(Math.floor(this._private__logicalRange.left()),Math.ceil(this._private__logicalRange.right()))},i.prototype._internal_logicalRange=function(){return this._private__logicalRange},i._internal_invalid=function(){return new i(null)},i}(),Ie;(function(i){i[i.Year=0]="Year",i[i.Month=1]="Month",i[i.DayOfMonth=2]="DayOfMonth",i[i.Time=3]="Time",i[i.TimeWithSeconds=4]="TimeWithSeconds"})(Ie||(Ie={}));var Ua=function(){function i(t,e,r){this._private__width=0,this._private__baseIndexOrNull=null,this._private__points=[],this._private__scrollStartPoint=null,this._private__scaleStartPoint=null,this._private__tickMarks=new Ha,this._private__formattedByWeight=new Map,this._private__visibleRange=Pt._internal_invalid(),this._private__visibleRangeInvalidated=!0,this._private__visibleBarsChanged=new M,this._private__logicalRangeChanged=new M,this._private__optionsApplied=new M,this._private__commonTransitionStartState=null,this._private__timeMarksCache=null,this._private__labels=[],this._private__options=e,this._private__localizationOptions=r,this._private__rightOffset=e.rightOffset,this._private__barSpacing=e.barSpacing,this._private__model=t,this._private__updateDateTimeFormatter()}return i.prototype.options=function(){return this._private__options},i.prototype.applyLocalizationOptions=function(t){R(this._private__localizationOptions,t),this._private__invalidateTickMarks(),this._private__updateDateTimeFormatter()},i.prototype.applyOptions=function(t,e){var r;R(this._private__options,t),this._private__options.fixLeftEdge&&this._private__doFixLeftEdge(),this._private__options.fixRightEdge&&this._private__doFixRightEdge(),t.barSpacing!==void 0&&this._private__model.setBarSpacing(t.barSpacing),t.rightOffset!==void 0&&this._private__model.setRightOffset(t.rightOffset),t.minBarSpacing!==void 0&&this._private__model.setBarSpacing((r=t.barSpacing)!==null&&r!==void 0?r:this._private__barSpacing),this._private__invalidateTickMarks(),this._private__updateDateTimeFormatter(),this._private__optionsApplied._internal_fire()},i.prototype.indexToTime=function(t){var e;return((e=this._private__points[t])===null||e===void 0?void 0:e.time)||null},i.prototype.timeToIndex=function(t,e){if(this._private__points.length<1)return null;if(t.timestamp>this._private__points[this._private__points.length-1].time.timestamp)return e?this._private__points.length-1:null;var r=ct(this._private__points,t.timestamp,function(a,_){return a.time.timestamp<_});return t.timestamp<this._private__points[r].time.timestamp?e?r:null:r},i.prototype.isEmpty=function(){return this._private__width===0||this._private__points.length===0||this._private__baseIndexOrNull===null},i.prototype.visibleStrictRange=function(){return this._private__updateVisibleRange(),this._private__visibleRange._internal_strictRange()},i.prototype.visibleLogicalRange=function(){return this._private__updateVisibleRange(),this._private__visibleRange._internal_logicalRange()},i.prototype.visibleTimeRange=function(){var t=this.visibleStrictRange();if(t===null)return null;var e={from:t.left(),to:t.right()};return this.timeRangeForLogicalRange(e)},i.prototype.timeRangeForLogicalRange=function(t){var e=Math.round(t.from),r=Math.round(t.to),a=g(this._private__firstIndex()),_=g(this._private__lastIndex());return{from:g(this.indexToTime(Math.max(a,e))),to:g(this.indexToTime(Math.min(_,r)))}},i.prototype.logicalRangeForTimeRange=function(t){return{from:g(this.timeToIndex(t.from,!0)),to:g(this.timeToIndex(t.to,!0))}},i.prototype.width=function(){return this._private__width},i.prototype.setWidth=function(t){if(!(!isFinite(t)||t<=0)&&this._private__width!==t){if(this._private__options.lockVisibleTimeRangeOnResize&&this._private__width){var e=this._private__barSpacing*t/this._private__width;this._private__barSpacing=e}if(this._private__options.fixLeftEdge){var r=this.visibleStrictRange();if(r!==null){var a=r.left();if(a<=0){var _=this._private__width-t;this._private__rightOffset-=Math.round(_/this._private__barSpacing)+1}}}this._private__width=t,this._private__visibleRangeInvalidated=!0,this._private__correctBarSpacing(),this._private__correctOffset()}},i.prototype.indexToCoordinate=function(t){if(this.isEmpty()||!pt(t))return 0;var e=this.baseIndex(),r=e+this._private__rightOffset-t,a=this._private__width-(r+.5)*this._private__barSpacing-1;return a},i.prototype.indexesToCoordinates=function(t,e){for(var r=this.baseIndex(),a=e===void 0?0:e.from,_=e===void 0?t.length:e.to,n=a;n<_;n++){var s=t[n].time,o=r+this._private__rightOffset-s,l=this._private__width-(o+.5)*this._private__barSpacing-1;t[n].x=l}},i.prototype.coordinateToIndex=function(t){return Math.ceil(this._private__coordinateToFloatIndex(t))},i.prototype.setRightOffset=function(t){this._private__visibleRangeInvalidated=!0,this._private__rightOffset=t,this._private__correctOffset(),this._private__model.recalculateAllPanes(),this._private__model.lightUpdate()},i.prototype.barSpacing=function(){return this._private__barSpacing},i.prototype.setBarSpacing=function(t){this._private__setBarSpacing(t),this._private__correctOffset(),this._private__model.recalculateAllPanes(),this._private__model.lightUpdate()},i.prototype.rightOffset=function(){return this._private__rightOffset},i.prototype.marks=function(){if(this.isEmpty())return null;if(this._private__timeMarksCache!==null)return this._private__timeMarksCache;for(var t=this._private__barSpacing,e=this._private__model.options().layout.fontSize,r=(e+4)*5,a=Math.round(r/t),_=g(this.visibleStrictRange()),n=Math.max(_.left(),_.left()-a),s=Math.max(_.right(),_.right()-a),o=this._private__tickMarks._internal_build(t,r),l=this._private__firstIndex()+a,p=this._private__lastIndex()-a,v=this._private__isAllScalingAndScrollingDisabled(),h=this._private__options.fixLeftEdge||v,c=this._private__options.fixRightEdge||v,u=0,f=0,d=o;f<d.length;f++){var m=d[f];if(n<=m._internal_index&&m._internal_index<=s){var y=void 0;u<this._private__labels.length?(y=this._private__labels[u],y.coord=this.indexToCoordinate(m._internal_index),y.label=this._private__formatLabel(m._internal_time,m._internal_weight),y.weight=m._internal_weight):(y={needAlignCoordinate:!1,coord:this.indexToCoordinate(m._internal_index),label:this._private__formatLabel(m._internal_time,m._internal_weight),weight:m._internal_weight},this._private__labels.push(y)),this._private__barSpacing>r/2&&!v?y.needAlignCoordinate=!1:y.needAlignCoordinate=h&&m._internal_index<=l||c&&m._internal_index>=p,u++}}return this._private__labels.length=u,this._private__timeMarksCache=this._private__labels,this._private__labels},i.prototype.restoreDefault=function(){this._private__visibleRangeInvalidated=!0,this.setBarSpacing(this._private__options.barSpacing),this.setRightOffset(this._private__options.rightOffset)},i.prototype.setBaseIndex=function(t){this._private__visibleRangeInvalidated=!0,this._private__baseIndexOrNull=t,this._private__correctOffset(),this._private__doFixLeftEdge()},i.prototype.zoom=function(t,e){var r=this._private__coordinateToFloatIndex(t),a=this.barSpacing(),_=a+e*(a/10);this.setBarSpacing(_),this._private__options.rightBarStaysOnScroll||this.setRightOffset(this.rightOffset()+(r-this._private__coordinateToFloatIndex(t)))},i.prototype.startScale=function(t){this._private__scrollStartPoint&&this.endScroll(),!(this._private__scaleStartPoint!==null||this._private__commonTransitionStartState!==null)&&(this.isEmpty()||(this._private__scaleStartPoint=t,this._private__saveCommonTransitionsStartState()))},i.prototype.scaleTo=function(t){if(this._private__commonTransitionStartState!==null){var e=kt(this._private__width-t,0,this._private__width),r=kt(this._private__width-g(this._private__scaleStartPoint),0,this._private__width);e===0||r===0||this.setBarSpacing(this._private__commonTransitionStartState._internal_barSpacing*e/r)}},i.prototype.endScale=function(){this._private__scaleStartPoint!==null&&(this._private__scaleStartPoint=null,this._private__clearCommonTransitionsStartState())},i.prototype.startScroll=function(t){this._private__scrollStartPoint!==null||this._private__commonTransitionStartState!==null||this.isEmpty()||(this._private__scrollStartPoint=t,this._private__saveCommonTransitionsStartState())},i.prototype.scrollTo=function(t){if(this._private__scrollStartPoint!==null){var e=(this._private__scrollStartPoint-t)/this.barSpacing();this._private__rightOffset=g(this._private__commonTransitionStartState)._internal_rightOffset+e,this._private__visibleRangeInvalidated=!0,this._private__correctOffset()}},i.prototype.endScroll=function(){this._private__scrollStartPoint!==null&&(this._private__scrollStartPoint=null,this._private__clearCommonTransitionsStartState())},i.prototype.scrollToRealTime=function(){this.scrollToOffsetAnimated(this._private__options.rightOffset)},i.prototype.scrollToOffsetAnimated=function(t,e){var r=this;if(e===void 0&&(e=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var a=this._private__rightOffset,_=performance.now(),n=function(){var s=(performance.now()-_)/e,o=s>=1,l=o?t:a+(t-a)*s;r.setRightOffset(l),o||setTimeout(n,20)};n()},i.prototype.update=function(t,e){this._private__visibleRangeInvalidated=!0,this._private__points=t,this._private__tickMarks._internal_setTimeScalePoints(t,e),this._private__correctOffset()},i.prototype.visibleBarsChanged=function(){return this._private__visibleBarsChanged},i.prototype.logicalRangeChanged=function(){return this._private__logicalRangeChanged},i.prototype.optionsApplied=function(){return this._private__optionsApplied},i.prototype.baseIndex=function(){return this._private__baseIndexOrNull||0},i.prototype.setVisibleRange=function(t){var e=t.count();this._private__setBarSpacing(this._private__width/e),this._private__rightOffset=t.right()-this.baseIndex(),this._private__correctOffset(),this._private__visibleRangeInvalidated=!0,this._private__model.recalculateAllPanes(),this._private__model.lightUpdate()},i.prototype.fitContent=function(){var t=this._private__firstIndex(),e=this._private__lastIndex();t===null||e===null||this.setVisibleRange(new lt(t,e+this._private__options.rightOffset))},i.prototype.setLogicalRange=function(t){var e=new lt(t.from,t.to);this.setVisibleRange(e)},i.prototype.formatDateTime=function(t){return this._private__localizationOptions.timeFormatter!==void 0?this._private__localizationOptions.timeFormatter(t.businessDay||t.timestamp):this._private__dateTimeFormatter._internal_format(new Date(t.timestamp*1e3))},i.prototype._private__isAllScalingAndScrollingDisabled=function(){var t=this._private__model.options(),e=t.handleScroll,r=t.handleScale;return!e.horzTouchDrag&&!e.mouseWheel&&!e.pressedMouseMove&&!e.vertTouchDrag&&!r.axisDoubleClickReset&&!r.axisPressedMouseMove.time&&!r.mouseWheel&&!r.pinch},i.prototype._private__firstIndex=function(){return this._private__points.length===0?null:0},i.prototype._private__lastIndex=function(){return this._private__points.length===0?null:this._private__points.length-1},i.prototype._private__rightOffsetForCoordinate=function(t){return(this._private__width-1-t)/this._private__barSpacing},i.prototype._private__coordinateToFloatIndex=function(t){var e=this._private__rightOffsetForCoordinate(t),r=this.baseIndex(),a=r+this._private__rightOffset-e;return Math.round(a*1e6)/1e6},i.prototype._private__setBarSpacing=function(t){var e=this._private__barSpacing;this._private__barSpacing=t,this._private__correctBarSpacing(),e!==this._private__barSpacing&&(this._private__visibleRangeInvalidated=!0,this._private__resetTimeMarksCache())},i.prototype._private__updateVisibleRange=function(){if(this._private__visibleRangeInvalidated){if(this._private__visibleRangeInvalidated=!1,this.isEmpty()){this._private__setVisibleRange(Pt._internal_invalid());return}var t=this.baseIndex(),e=this._private__width/this._private__barSpacing,r=this._private__rightOffset+t,a=r-e+1,_=new lt(a,r);this._private__setVisibleRange(new Pt(_))}},i.prototype._private__correctBarSpacing=function(){var t=this._private__minBarSpacing();if(this._private__barSpacing<t&&(this._private__barSpacing=t,this._private__visibleRangeInvalidated=!0),this._private__width!==0){var e=this._private__width*.5;this._private__barSpacing>e&&(this._private__barSpacing=e,this._private__visibleRangeInvalidated=!0)}},i.prototype._private__minBarSpacing=function(){return this._private__options.fixLeftEdge&&this._private__options.fixRightEdge&&this._private__points.length!==0?this._private__width/this._private__points.length:this._private__options.minBarSpacing},i.prototype._private__correctOffset=function(){var t=this._private__maxRightOffset();this._private__rightOffset>t&&(this._private__rightOffset=t,this._private__visibleRangeInvalidated=!0);var e=this._private__minRightOffset();e!==null&&this._private__rightOffset<e&&(this._private__rightOffset=e,this._private__visibleRangeInvalidated=!0)},i.prototype._private__minRightOffset=function(){var t=this._private__firstIndex(),e=this._private__baseIndexOrNull;if(t===null||e===null)return null;var r=this._private__options.fixLeftEdge?this._private__width/this._private__barSpacing:Math.min(2,this._private__points.length);return t-e-1+r},i.prototype._private__maxRightOffset=function(){return this._private__options.fixRightEdge?0:this._private__width/this._private__barSpacing-Math.min(2,this._private__points.length)},i.prototype._private__saveCommonTransitionsStartState=function(){this._private__commonTransitionStartState={_internal_barSpacing:this.barSpacing(),_internal_rightOffset:this.rightOffset()}},i.prototype._private__clearCommonTransitionsStartState=function(){this._private__commonTransitionStartState=null},i.prototype._private__formatLabel=function(t,e){var r=this,a=this._private__formattedByWeight.get(e);return a===void 0&&(a=new Na(function(_){return r._private__formatLabelImpl(_,e)}),this._private__formattedByWeight.set(e,a)),a._internal_format(t)},i.prototype._private__formatLabelImpl=function(t,e){var r,a=Ya(e,this._private__options.timeVisible,this._private__options.secondsVisible);return this._private__options.tickMarkFormatter!==void 0?this._private__options.tickMarkFormatter((r=t.businessDay)!==null&&r!==void 0?r:t.timestamp,a,this._private__localizationOptions.locale):Fa(t,a,this._private__localizationOptions.locale)},i.prototype._private__setVisibleRange=function(t){var e=this._private__visibleRange;this._private__visibleRange=t,Ee(e._internal_strictRange(),this._private__visibleRange._internal_strictRange())||this._private__visibleBarsChanged._internal_fire(),Ee(e._internal_logicalRange(),this._private__visibleRange._internal_logicalRange())||this._private__logicalRangeChanged._internal_fire(),this._private__resetTimeMarksCache()},i.prototype._private__resetTimeMarksCache=function(){this._private__timeMarksCache=null},i.prototype._private__invalidateTickMarks=function(){this._private__resetTimeMarksCache(),this._private__formattedByWeight.clear()},i.prototype._private__updateDateTimeFormatter=function(){var t=this._private__localizationOptions.dateFormat;this._private__options.timeVisible?this._private__dateTimeFormatter=new za({_internal_dateFormat:t,_internal_timeFormat:this._private__options.secondsVisible?"%h:%m:%s":"%h:%m",_internal_dateTimeSeparator:"   ",_internal_locale:this._private__localizationOptions.locale}):this._private__dateTimeFormatter=new Pi(t,this._private__localizationOptions.locale)},i.prototype._private__doFixLeftEdge=function(){if(this._private__options.fixLeftEdge){var t=this._private__firstIndex();if(t!==null){var e=this.visibleStrictRange();if(e!==null){var r=e.left()-t;if(r<0){var a=this._private__rightOffset-r-1;this.setRightOffset(a)}this._private__correctBarSpacing()}}}},i.prototype._private__doFixRightEdge=function(){this._private__correctOffset(),this._private__correctBarSpacing()},i}();function Ya(i,t,e){switch(i){case 0:case 10:return t?e?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return t?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}var Xa=function(i){w(t,i);function t(e){var r=i.call(this)||this;return r._private__metricsCache=new Map,r._private__data=e,r}return t.prototype._internal__drawImpl=function(e){},t.prototype._internal__drawBackgroundImpl=function(e){if(this._private__data._internal_visible){e.save();for(var r=0,a=0,_=this._private__data._internal_lines;a<_.length;a++){var n=_[a];if(n._internal_text.length!==0){e.font=n._internal_font;var s=this._private__metrics(e,n._internal_text);s>this._private__data._internal_width?n._internal_zoom=this._private__data._internal_width/s:n._internal_zoom=1,r+=n._internal_lineHeight*n._internal_zoom}}var o=0;switch(this._private__data._internal_vertAlign){case"top":o=0;break;case"center":o=Math.max((this._private__data._internal_height-r)/2,0);break;case"bottom":o=Math.max(this._private__data._internal_height-r,0);break}e.fillStyle=this._private__data._internal_color;for(var l=0,p=this._private__data._internal_lines;l<p.length;l++){var n=p[l];e.save();var v=0;switch(this._private__data._internal_horzAlign){case"left":e.textAlign="left",v=n._internal_lineHeight/2;break;case"center":e.textAlign="center",v=this._private__data._internal_width/2;break;case"right":e.textAlign="right",v=this._private__data._internal_width-1-n._internal_lineHeight/2;break}e.translate(v,o),e.textBaseline="top",e.font=n._internal_font,e.scale(n._internal_zoom,n._internal_zoom),e.fillText(n._internal_text,0,n._internal_vertOffset),e.restore(),o+=n._internal_lineHeight*n._internal_zoom}e.restore()}},t.prototype._private__metrics=function(e,r){var a=this._private__fontCache(e.font),_=a.get(r);return _===void 0&&(_=e.measureText(r).width,a.set(r,_)),_},t.prototype._private__fontCache=function(e){var r=this._private__metricsCache.get(e);return r===void 0&&(r=new Map,this._private__metricsCache.set(e,r)),r},t}(ht),qa=function(){function i(t){this._private__invalidated=!0,this._private__rendererData={_internal_visible:!1,_internal_color:"",_internal_height:0,_internal_width:0,_internal_lines:[],_internal_vertAlign:"center",_internal_horzAlign:"center"},this._private__renderer=new Xa(this._private__rendererData),this._private__source=t}return i.prototype.update=function(){this._private__invalidated=!0},i.prototype.renderer=function(t,e){return this._private__invalidated&&(this._private__updateImpl(t,e),this._private__invalidated=!1),this._private__renderer},i.prototype._private__updateImpl=function(t,e){var r=this._private__source.options(),a=this._private__rendererData;a._internal_visible=r.visible,a._internal_visible&&(a._internal_color=r.color,a._internal_width=e,a._internal_height=t,a._internal_horzAlign=r.horzAlign,a._internal_vertAlign=r.vertAlign,a._internal_lines=[{_internal_text:r.text,_internal_font:G(r.fontSize,r.fontFamily,r.fontStyle),_internal_lineHeight:r.fontSize*1.2,_internal_vertOffset:0,_internal_zoom:0}])},i}(),Ga=function(i){w(t,i);function t(e,r){var a=i.call(this)||this;return a._private__options=r,a._private__paneView=new qa(a),a}return t.prototype.priceAxisViews=function(){return[]},t.prototype.paneViews=function(){return[this._private__paneView]},t.prototype.options=function(){return this._private__options},t.prototype.updateAllViews=function(){this._private__paneView.update()},t}(ae),Be;(function(i){i[i.OnTouchEnd=0]="OnTouchEnd",i[i.OnNextTap=1]="OnNextTap"})(Be||(Be={}));var ja=function(){function i(t,e){this._private__panes=[],this._private__serieses=[],this._private__width=0,this._private__initialTimeScrollPos=null,this._private__hoveredSource=null,this._private__priceScalesOptionsChanged=new M,this._private__crosshairMoved=new M,this._private__customPriceLineDragged=new M,this._private__gradientColorsCache=null,this._private__invalidateHandler=t,this._private__options=e,this._private__rendererOptionsProvider=new rr(this),this._private__timeScale=new Ua(this,e.timeScale,this._private__options.localization),this._private__crosshair=new dr(this,e.crosshair),this._private__magnet=new da(e.crosshair),this._private__watermark=new Ga(this,e.watermark),this.createPane(),this._private__panes[0].setStretchFactor(wi*2),this._private__backgroundTopColor=this._private__getBackgroundColor(0),this._private__backgroundBottomColor=this._private__getBackgroundColor(1)}return i.prototype.fullUpdate=function(){this._private__invalidate(new A(3))},i.prototype.lightUpdate=function(){this._private__invalidate(new A(2))},i.prototype.cursorUpdate=function(){this._private__invalidate(new A(1))},i.prototype.updateSource=function(t){var e=this._private__invalidationMaskForSource(t);this._private__invalidate(e)},i.prototype.hoveredSource=function(){return this._private__hoveredSource},i.prototype.setHoveredSource=function(t){var e=this._private__hoveredSource;this._private__hoveredSource=t,e!==null&&this.updateSource(e.source),t!==null&&this.updateSource(t.source)},i.prototype.options=function(){return this._private__options},i.prototype.applyOptions=function(t){R(this._private__options,t),this._private__panes.forEach(function(e){return e.applyScaleOptions(t)}),t.timeScale!==void 0&&this._private__timeScale.applyOptions(t.timeScale),t.localization!==void 0&&this._private__timeScale.applyLocalizationOptions(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this._private__priceScalesOptionsChanged._internal_fire(),this._private__backgroundTopColor=this._private__getBackgroundColor(0),this._private__backgroundBottomColor=this._private__getBackgroundColor(1),this.fullUpdate()},i.prototype.applyPriceScaleOptions=function(t,e){if(t==="left"){this.applyOptions({leftPriceScale:e});return}else if(t==="right"){this.applyOptions({rightPriceScale:e});return}var r=this.findPriceScale(t);if(r===null)throw new Error("Trying to apply price scale options with incorrect ID: ".concat(t));r.priceScale.applyOptions(e),this._private__priceScalesOptionsChanged._internal_fire()},i.prototype.findPriceScale=function(t){for(var e=0,r=this._private__panes;e<r.length;e++){var a=r[e],_=a.priceScaleById(t);if(_!==null)return{pane:a,priceScale:_}}return null},i.prototype.timeScale=function(){return this._private__timeScale},i.prototype.panes=function(){return this._private__panes},i.prototype.watermarkSource=function(){return this._private__watermark},i.prototype.crosshairSource=function(){return this._private__crosshair},i.prototype.crosshairMoved=function(){return this._private__crosshairMoved},i.prototype.customPriceLineDragged=function(){return this._private__customPriceLineDragged},i.prototype.setPaneHeight=function(t,e){t.setHeight(e),this.recalculateAllPanes()},i.prototype.setWidth=function(t){this._private__width=t,this._private__timeScale.setWidth(this._private__width),this._private__panes.forEach(function(e){return e.setWidth(t)}),this.recalculateAllPanes()},i.prototype.createPane=function(t){var e=new ka(this._private__timeScale,this);t!==void 0?this._private__panes.splice(t,0,e):this._private__panes.push(e);var r=t===void 0?this._private__panes.length-1:t,a=new A(3);return a.invalidatePane(r,{level:0,autoScale:!0}),this._private__invalidate(a),e},i.prototype.startScalePrice=function(t,e,r){t.startScalePrice(e,r)},i.prototype.scalePriceTo=function(t,e,r){t.scalePriceTo(e,r),this.updateCrosshair(),this._private__invalidate(this._private__paneInvalidationMask(t,2))},i.prototype.endScalePrice=function(t,e){t.endScalePrice(e),this._private__invalidate(this._private__paneInvalidationMask(t,2))},i.prototype.startScrollPrice=function(t,e,r){e.isAutoScale()||t.startScrollPrice(e,r)},i.prototype.scrollPriceTo=function(t,e,r){e.isAutoScale()||(t.scrollPriceTo(e,r),this.updateCrosshair(),this._private__invalidate(this._private__paneInvalidationMask(t,2)))},i.prototype.endScrollPrice=function(t,e){e.isAutoScale()||(t.endScrollPrice(e),this._private__invalidate(this._private__paneInvalidationMask(t,2)))},i.prototype.resetPriceScale=function(t,e){t.resetPriceScale(e),this._private__invalidate(this._private__paneInvalidationMask(t,2))},i.prototype.startScaleTime=function(t){this._private__timeScale.startScale(t)},i.prototype.zoomTime=function(t,e){var r=this.timeScale();if(!(r.isEmpty()||e===0)){var a=r.width();t=Math.max(1,Math.min(t,a)),r.zoom(t,e),this.recalculateAllPanes()}},i.prototype.scrollChart=function(t){this.startScrollTime(0),this.scrollTimeTo(t),this.endScrollTime()},i.prototype.scaleTimeTo=function(t){this._private__timeScale.scaleTo(t),this.recalculateAllPanes()},i.prototype.endScaleTime=function(){this._private__timeScale.endScale(),this.lightUpdate()},i.prototype.startScrollTime=function(t){this._private__initialTimeScrollPos=t,this._private__timeScale.startScroll(t)},i.prototype.scrollTimeTo=function(t){var e=!1;return this._private__initialTimeScrollPos!==null&&Math.abs(t-this._private__initialTimeScrollPos)>20&&(this._private__initialTimeScrollPos=null,e=!0),this._private__timeScale.scrollTo(t),this.recalculateAllPanes(),e},i.prototype.endScrollTime=function(){this._private__timeScale.endScroll(),this.lightUpdate(),this._private__initialTimeScrollPos=null},i.prototype.serieses=function(){return this._private__serieses},i.prototype.setAndSaveCurrentPosition=function(t,e,r){this._private__crosshair.saveOriginCoord(t,e);var a=NaN,_=this._private__timeScale.coordinateToIndex(t),n=this._private__timeScale.visibleStrictRange();n!==null&&(_=Math.min(Math.max(n.left(),_),n.right()));var s=r.defaultPriceScale(),o=s.firstValue();o!==null&&(a=s.coordinateToPrice(e,o)),a=this._private__magnet._internal_align(a,_,r),this._private__crosshair.setPosition(_,a,r),this.cursorUpdate(),this._private__crosshairMoved._internal_fire(this._private__crosshair.appliedIndex(),{x:t,y:e})},i.prototype.clearCurrentPosition=function(){var t=this.crosshairSource();t.clearPosition(),this.cursorUpdate(),this._private__crosshairMoved._internal_fire(null,null)},i.prototype.updateCrosshair=function(){var t=this._private__crosshair.pane();if(t!==null){var e=this._private__crosshair.originCoordX(),r=this._private__crosshair.originCoordY();this.setAndSaveCurrentPosition(e,r,t)}this._private__crosshair.updateAllViews()},i.prototype.updateTimeScale=function(t,e,r){var a=this._private__timeScale.indexToTime(0);e!==void 0&&r!==void 0&&this._private__timeScale.update(e,r);var _=this._private__timeScale.indexToTime(0),n=this._private__timeScale.baseIndex(),s=this._private__timeScale.visibleStrictRange();if(s!==null&&a!==null&&_!==null){var o=s.contains(n),l=a.timestamp>_.timestamp,p=t!==null&&t>n,v=p&&!l,h=o&&this._private__timeScale.options().shiftVisibleRangeOnNewBar;if(v&&!h){var c=t-n;this._private__timeScale.setRightOffset(this._private__timeScale.rightOffset()-c)}}this._private__timeScale.setBaseIndex(t)},i.prototype.recalculatePane=function(t){t!==null&&t.recalculate()},i.prototype.paneForSource=function(t){var e=this._private__panes.find(function(r){return r.orderedSources().includes(t)});return e===void 0?null:e},i.prototype.recalculateAllPanes=function(){this._private__watermark.updateAllViews(),this._private__panes.forEach(function(t){return t.recalculate()}),this.updateCrosshair()},i.prototype.fireCustomPriceLineDragged=function(t,e){this._private__customPriceLineDragged._internal_fire(t,e)},i.prototype.destroy=function(){this._private__panes.forEach(function(t){return t.destroy()}),this._private__panes.length=0,this._private__options.localization.priceFormatter=void 0,this._private__options.localization.timeFormatter=void 0},i.prototype.rendererOptionsProvider=function(){return this._private__rendererOptionsProvider},i.prototype.priceAxisRendererOptions=function(){return this._private__rendererOptionsProvider.options()},i.prototype.priceScalesOptionsChanged=function(){return this._private__priceScalesOptionsChanged},i.prototype.createSeries=function(t,e){var r=this._private__panes[0],a=this._private__createSeries(e,t,r);return this._private__serieses.push(a),this._private__serieses.length===1?this.fullUpdate():this.lightUpdate(),a},i.prototype.removeSeries=function(t){var e=this.paneForSource(t),r=this._private__serieses.indexOf(t);x(r!==-1,"Series not found"),this._private__serieses.splice(r,1),g(e).removeDataSource(t),t.destroy&&t.destroy()},i.prototype.moveSeriesToScale=function(t,e){var r=g(this.paneForSource(t));r.removeDataSource(t);var a=this.findPriceScale(e);if(a===null){var _=t.zorder();r.addDataSource(t,e,_)}else{var _=a.pane===r?t.zorder():void 0;a.pane.addDataSource(t,e,_)}},i.prototype.fitContent=function(){var t=new A(2);t.setFitContent(),this._private__invalidate(t)},i.prototype.setTargetLogicalRange=function(t){var e=new A(2);e.applyRange(t),this._private__invalidate(e)},i.prototype.resetTimeScale=function(){var t=new A(2);t.resetTimeScale(),this._private__invalidate(t)},i.prototype.setBarSpacing=function(t){var e=new A(2);e.setBarSpacing(t),this._private__invalidate(e)},i.prototype.setRightOffset=function(t){var e=new A(2);e.setRightOffset(t),this._private__invalidate(e)},i.prototype.defaultVisiblePriceScaleId=function(){return this._private__options.rightPriceScale.visible?"right":"left"},i.prototype.backgroundBottomColor=function(){return this._private__backgroundBottomColor},i.prototype.backgroundTopColor=function(){return this._private__backgroundTopColor},i.prototype.backgroundColorAtYPercentFromTop=function(t){var e=this._private__backgroundBottomColor,r=this._private__backgroundTopColor;if(e===r)return e;if(t=Math.max(0,Math.min(100,Math.round(t*100))),this._private__gradientColorsCache===null||this._private__gradientColorsCache._internal_topColor!==r||this._private__gradientColorsCache._internal_bottomColor!==e)this._private__gradientColorsCache={_internal_topColor:r,_internal_bottomColor:e,_internal_colors:new Map};else{var a=this._private__gradientColorsCache._internal_colors.get(t);if(a!==void 0)return a}var _=tr(r,e,t/100);return this._private__gradientColorsCache._internal_colors.set(t,_),_},i.prototype._private__paneInvalidationMask=function(t,e){var r=new A(e);if(t!==null){var a=this._private__panes.indexOf(t);r.invalidatePane(a,{level:e})}return r},i.prototype._private__invalidationMaskForSource=function(t,e){return e===void 0&&(e=2),this._private__paneInvalidationMask(this.paneForSource(t),e)},i.prototype._private__invalidate=function(t){this._private__invalidateHandler&&this._private__invalidateHandler(t),this._private__panes.forEach(function(e){return e.grid().paneView().update()})},i.prototype._private__createSeries=function(t,e,r){var a=new It(this,t,e),_=t.priceScaleId!==void 0?t.priceScaleId:this.defaultVisiblePriceScaleId();return r.addDataSource(a,_),Vt(_)||a.applyOptions(t),a},i.prototype._private__getBackgroundColor=function(t){var e=this._private__options.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color},i}();function Mi(i){i.borderColor!==void 0&&(i.borderUpColor=i.borderColor,i.borderDownColor=i.borderColor),i.wickColor!==void 0&&(i.wickUpColor=i.wickColor,i.wickDownColor=i.wickColor)}var Oe;(function(i){i[i.Disabled=0]="Disabled",i[i.Continuous=1]="Continuous",i[i.OnDataUpdate=2]="OnDataUpdate"})(Oe||(Oe={}));function Ka(i){if(i>=1)return 0;for(var t=0;t<8;t++){var e=Math.round(i),r=Math.abs(e-i);if(r<1e-8)return t;i=i*10}return t}var We;(function(i){i[i.LastBar=0]="LastBar",i[i.LastVisible=1]="LastVisible"})(We||(We={}));var ze;(function(i){i.Solid="solid",i.VerticalGradient="gradient"})(ze||(ze={}));function le(i){return!O(i)&&!ee(i)}function Ti(i){return O(i)}function Za(i){return i.open===void 0&&i.value===void 0}function ki(i){return i.open!==void 0||i.value!==void 0}var D=function(){function i(t,e){this._internal_w=t,this._internal_h=e}return i.prototype._internal_equals=function(t){return this._internal_w===t._internal_w&&this._internal_h===t._internal_h},i}();function Dt(i){return i.ownerDocument&&i.ownerDocument.defaultView&&i.ownerDocument.defaultView.devicePixelRatio||1}function W(i){var t=g(i.getContext("2d"));return t.setTransform(1,0,0,1,0,0),t}function Ri(i,t){var e=i.createElement("canvas"),r=Dt(e);return e.style.width="".concat(t._internal_w,"px"),e.style.height="".concat(t._internal_h,"px"),e.width=t._internal_w*r,e.height=t._internal_h*r,e}function j(i,t){var e=g(i.ownerDocument),r=e.createElement("canvas");i.appendChild(r);var a=Yi(r,{allowDownsampling:!1});return a.resizeCanvas({width:t._internal_w,height:t._internal_h}),a}function Yt(i,t){return i._internal_position-t._internal_position}function Xt(i,t,e){var r=(i._internal_position-t._internal_position)/(i._internal_time-t._internal_time);return Math.sign(r)*Math.min(Math.abs(r),e)}function $a(i,t){var e=Math.log(t);return Math.log(1*e/-i)/e}var Qa=function(){function i(t,e,r,a){this._private__position1=null,this._private__position2=null,this._private__position3=null,this._private__position4=null,this._private__animationStartPosition=null,this._private__durationMsecs=0,this._private__speedPxPerMsec=0,this._private__terminated=!1,this._private__minSpeed=t,this._private__maxSpeed=e,this._private__dumpingCoeff=r,this._private__minMove=a}return i.prototype._internal_addPosition=function(t,e){if(this._private__position1!==null){if(this._private__position1._internal_time===e){this._private__position1._internal_position=t;return}if(Math.abs(this._private__position1._internal_position-t)<this._private__minMove)return}this._private__position4=this._private__position3,this._private__position3=this._private__position2,this._private__position2=this._private__position1,this._private__position1={_internal_time:e,_internal_position:t}},i.prototype._internal_start=function(t,e){if(!(this._private__position1===null||this._private__position2===null)&&!(e-this._private__position1._internal_time>50)){var r=0,a=Xt(this._private__position1,this._private__position2,this._private__maxSpeed),_=Yt(this._private__position1,this._private__position2),n=[a],s=[_];if(r+=_,this._private__position3!==null){var o=Xt(this._private__position2,this._private__position3,this._private__maxSpeed);if(Math.sign(o)===Math.sign(a)){var l=Yt(this._private__position2,this._private__position3);if(n.push(o),s.push(l),r+=l,this._private__position4!==null){var p=Xt(this._private__position3,this._private__position4,this._private__maxSpeed);if(Math.sign(p)===Math.sign(a)){var v=Yt(this._private__position3,this._private__position4);n.push(p),s.push(v),r+=v}}}}for(var h=0,c=0;c<n.length;++c)h+=s[c]/r*n[c];Math.abs(h)<this._private__minSpeed||(this._private__animationStartPosition={_internal_position:t,_internal_time:e},this._private__speedPxPerMsec=h,this._private__durationMsecs=$a(Math.abs(h),this._private__dumpingCoeff))}},i.prototype._internal_getPosition=function(t){var e=g(this._private__animationStartPosition),r=t-e._internal_time;return e._internal_position+this._private__speedPxPerMsec*(Math.pow(this._private__dumpingCoeff,r)-1)/Math.log(this._private__dumpingCoeff)},i.prototype._internal_finished=function(t){return this._private__animationStartPosition===null||this._private__progressDuration(t)===this._private__durationMsecs},i.prototype._internal_terminated=function(){return this._private__terminated},i.prototype._internal_terminate=function(){this._private__terminated=!0},i.prototype._private__progressDuration=function(t){var e=g(this._private__animationStartPosition),r=t-e._internal_time;return Math.min(r,this._private__durationMsecs)},i}(),Bt=typeof window<"u";function Fe(){return Bt?window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1:!1}function qt(){return Bt?/iPhone|iPad|iPod/.test(window.navigator.platform):!1}function Ja(){return Bt?window.chrome!==void 0:!1}function t_(i){Ja()&&i.addEventListener("mousedown",function(t){if(t.button===1)return t.preventDefault(),!1})}var pe=function(){function i(t,e,r){var a=this;this._private__clickCount=0,this._private__clickTimeoutId=null,this._private__clickPosition={_internal_x:Number.NEGATIVE_INFINITY,_internal_y:Number.POSITIVE_INFINITY},this._private__tapCount=0,this._private__tapTimeoutId=null,this._private__tapPosition={_internal_x:Number.NEGATIVE_INFINITY,_internal_y:Number.POSITIVE_INFINITY},this._private__longTapTimeoutId=null,this._private__longTapActive=!1,this._private__mouseMoveStartPosition=null,this._private__touchMoveStartPosition=null,this._private__touchMoveExceededManhattanDistance=!1,this._private__cancelClick=!1,this._private__cancelTap=!1,this._private__unsubscribeOutsideMouseEvents=null,this._private__unsubscribeOutsideTouchEvents=null,this._private__unsubscribeMobileSafariEvents=null,this._private__unsubscribeMousemove=null,this._private__unsubscribeRootMouseEvents=null,this._private__unsubscribeRootTouchEvents=null,this._private__startPinchMiddlePoint=null,this._private__startPinchDistance=0,this._private__pinchPrevented=!1,this._private__preventTouchDragProcess=!1,this._private__mousePressed=!1,this._private__lastTouchEventTimeStamp=0,this._private__activeTouchId=null,this._private__acceptMouseLeave=!qt(),this._private__onFirefoxOutsideMouseUp=function(_){a._private__mouseUpHandler(_)},this._private__onMobileSafariDoubleClick=function(_){if(a._private__firesTouchEvents(_)){var n=a._private__makeCompatEvent(_);if(++a._private__tapCount,a._private__tapTimeoutId&&a._private__tapCount>1){var s=a._private__touchMouseMoveWithDownInfo(B(_),a._private__tapPosition)._internal_manhattanDistance;s<30&&!a._private__cancelTap&&a._private__processTouchEvent(n,a._private__handler._internal_doubleTapEvent),a._private__resetTapTimeout()}}else{var n=a._private__makeCompatEvent(_);if(++a._private__clickCount,a._private__clickTimeoutId&&a._private__clickCount>1){var s=a._private__touchMouseMoveWithDownInfo(B(_),a._private__clickPosition)._internal_manhattanDistance;s<5&&!a._private__cancelClick&&a._private__processMouseEvent(n,a._private__handler._internal_mouseDoubleClickEvent),a._private__resetClickTimeout()}}},this._private__target=t,this._private__handler=e,this._private__options=r,this._private__init()}return i.prototype.destroy=function(){this._private__unsubscribeOutsideMouseEvents!==null&&(this._private__unsubscribeOutsideMouseEvents(),this._private__unsubscribeOutsideMouseEvents=null),this._private__unsubscribeOutsideTouchEvents!==null&&(this._private__unsubscribeOutsideTouchEvents(),this._private__unsubscribeOutsideTouchEvents=null),this._private__unsubscribeMousemove!==null&&(this._private__unsubscribeMousemove(),this._private__unsubscribeMousemove=null),this._private__unsubscribeRootMouseEvents!==null&&(this._private__unsubscribeRootMouseEvents(),this._private__unsubscribeRootMouseEvents=null),this._private__unsubscribeRootTouchEvents!==null&&(this._private__unsubscribeRootTouchEvents(),this._private__unsubscribeRootTouchEvents=null),this._private__unsubscribeMobileSafariEvents!==null&&(this._private__unsubscribeMobileSafariEvents(),this._private__unsubscribeMobileSafariEvents=null),this._private__clearLongTapTimeout(),this._private__resetClickTimeout()},i.prototype._private__mouseEnterHandler=function(t){var e=this;this._private__unsubscribeMousemove&&this._private__unsubscribeMousemove();var r=this._private__mouseMoveHandler.bind(this);if(this._private__unsubscribeMousemove=function(){e._private__target.removeEventListener("mousemove",r)},this._private__target.addEventListener("mousemove",r),!this._private__firesTouchEvents(t)){var a=this._private__makeCompatEvent(t);this._private__processMouseEvent(a,this._private__handler._internal_mouseEnterEvent),this._private__acceptMouseLeave=!0}},i.prototype._private__resetClickTimeout=function(){this._private__clickTimeoutId!==null&&clearTimeout(this._private__clickTimeoutId),this._private__clickCount=0,this._private__clickTimeoutId=null,this._private__clickPosition={_internal_x:Number.NEGATIVE_INFINITY,_internal_y:Number.POSITIVE_INFINITY}},i.prototype._private__resetTapTimeout=function(){this._private__tapTimeoutId!==null&&clearTimeout(this._private__tapTimeoutId),this._private__tapCount=0,this._private__tapTimeoutId=null,this._private__tapPosition={_internal_x:Number.NEGATIVE_INFINITY,_internal_y:Number.POSITIVE_INFINITY}},i.prototype._private__mouseMoveHandler=function(t){if(!(this._private__mousePressed||this._private__touchMoveStartPosition!==null)&&!this._private__firesTouchEvents(t)){var e=this._private__makeCompatEvent(t);this._private__processMouseEvent(e,this._private__handler._internal_mouseMoveEvent),this._private__acceptMouseLeave=!0}},i.prototype._private__touchMoveHandler=function(t){var e=Gt(t.changedTouches,g(this._private__activeTouchId));if(e!==null&&(this._private__lastTouchEventTimeStamp=yt(t),this._private__startPinchMiddlePoint===null&&!this._private__preventTouchDragProcess)){this._private__pinchPrevented=!0;var r=this._private__touchMouseMoveWithDownInfo(B(e),g(this._private__touchMoveStartPosition)),a=r._internal_xOffset,_=r._internal_yOffset,n=r._internal_manhattanDistance;if(!(!this._private__touchMoveExceededManhattanDistance&&n<5)){if(!this._private__touchMoveExceededManhattanDistance){var s=a*.5,o=_>=s&&!this._private__options._internal_treatVertTouchDragAsPageScroll(),l=s>_&&!this._private__options._internal_treatHorzTouchDragAsPageScroll();!o&&!l&&(this._private__preventTouchDragProcess=!0),this._private__touchMoveExceededManhattanDistance=!0,this._private__cancelTap=!0,this._private__clearLongTapTimeout(),this._private__resetTapTimeout()}if(!this._private__preventTouchDragProcess){var p=this._private__makeCompatEvent(t,e);this._private__processTouchEvent(p,this._private__handler._internal_touchMoveEvent),Z(t)}}}},i.prototype._private__mouseMoveWithDownHandler=function(t){if(t.button===0){var e=this._private__touchMouseMoveWithDownInfo(B(t),g(this._private__mouseMoveStartPosition)),r=e._internal_manhattanDistance;if(r>=5&&(this._private__cancelClick=!0,this._private__resetClickTimeout()),this._private__cancelClick){var a=this._private__makeCompatEvent(t);this._private__processMouseEvent(a,this._private__handler._internal_pressedMouseMoveEvent)}}},i.prototype._private__touchMouseMoveWithDownInfo=function(t,e){var r=Math.abs(e._internal_x-t._internal_x),a=Math.abs(e._internal_y-t._internal_y),_=r+a;return{_internal_xOffset:r,_internal_yOffset:a,_internal_manhattanDistance:_}},i.prototype._private__touchEndHandler=function(t){var e=Gt(t.changedTouches,g(this._private__activeTouchId));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._private__activeTouchId=null,this._private__lastTouchEventTimeStamp=yt(t),this._private__clearLongTapTimeout(),this._private__touchMoveStartPosition=null,this._private__unsubscribeRootTouchEvents&&(this._private__unsubscribeRootTouchEvents(),this._private__unsubscribeRootTouchEvents=null);var r=this._private__makeCompatEvent(t,e);if(this._private__processTouchEvent(r,this._private__handler._internal_touchEndEvent),++this._private__tapCount,this._private__tapTimeoutId&&this._private__tapCount>1){var a=this._private__touchMouseMoveWithDownInfo(B(e),this._private__tapPosition)._internal_manhattanDistance;a<30&&!this._private__cancelTap&&this._private__processTouchEvent(r,this._private__handler._internal_doubleTapEvent),this._private__resetTapTimeout()}else this._private__cancelTap||(this._private__processTouchEvent(r,this._private__handler._internal_tapEvent),this._private__handler._internal_tapEvent&&Z(t));this._private__tapCount===0&&Z(t),t.touches.length===0&&this._private__longTapActive&&(this._private__longTapActive=!1,Z(t))}},i.prototype._private__mouseUpHandler=function(t){if(t.button===0){var e=this._private__makeCompatEvent(t);if(this._private__mouseMoveStartPosition=null,this._private__mousePressed=!1,this._private__unsubscribeRootMouseEvents&&(this._private__unsubscribeRootMouseEvents(),this._private__unsubscribeRootMouseEvents=null),Fe()){var r=this._private__target.ownerDocument.documentElement;r.removeEventListener("mouseleave",this._private__onFirefoxOutsideMouseUp)}if(!this._private__firesTouchEvents(t))if(this._private__processMouseEvent(e,this._private__handler._internal_mouseUpEvent),++this._private__clickCount,this._private__clickTimeoutId&&this._private__clickCount>1){var a=this._private__touchMouseMoveWithDownInfo(B(t),this._private__clickPosition)._internal_manhattanDistance;a<5&&!this._private__cancelClick&&this._private__processMouseEvent(e,this._private__handler._internal_mouseDoubleClickEvent),this._private__resetClickTimeout()}else this._private__cancelClick||this._private__processMouseEvent(e,this._private__handler._internal_mouseClickEvent)}},i.prototype._private__clearLongTapTimeout=function(){this._private__longTapTimeoutId!==null&&(clearTimeout(this._private__longTapTimeoutId),this._private__longTapTimeoutId=null)},i.prototype._private__touchStartHandler=function(t){if(this._private__activeTouchId===null){var e=t.changedTouches[0];this._private__activeTouchId=e.identifier,this._private__lastTouchEventTimeStamp=yt(t);var r=this._private__target.ownerDocument.documentElement;this._private__cancelTap=!1,this._private__touchMoveExceededManhattanDistance=!1,this._private__preventTouchDragProcess=!1,this._private__touchMoveStartPosition=B(e),this._private__unsubscribeRootTouchEvents&&(this._private__unsubscribeRootTouchEvents(),this._private__unsubscribeRootTouchEvents=null);{var a=this._private__touchMoveHandler.bind(this),_=this._private__touchEndHandler.bind(this);this._private__unsubscribeRootTouchEvents=function(){r.removeEventListener("touchmove",a),r.removeEventListener("touchend",_)},r.addEventListener("touchmove",a,{passive:!1}),r.addEventListener("touchend",_,{passive:!1}),this._private__clearLongTapTimeout(),this._private__longTapTimeoutId=setTimeout(this._private__longTapHandler.bind(this,t),240)}var n=this._private__makeCompatEvent(t,e);this._private__processTouchEvent(n,this._private__handler._internal_touchStartEvent),this._private__tapTimeoutId||(this._private__tapCount=0,this._private__tapTimeoutId=setTimeout(this._private__resetTapTimeout.bind(this),500),this._private__tapPosition=B(e))}},i.prototype._private__mouseDownHandler=function(t){if(t.button===0){var e=this._private__target.ownerDocument.documentElement;Fe()&&e.addEventListener("mouseleave",this._private__onFirefoxOutsideMouseUp),this._private__cancelClick=!1,this._private__mouseMoveStartPosition=B(t),this._private__unsubscribeRootMouseEvents&&(this._private__unsubscribeRootMouseEvents(),this._private__unsubscribeRootMouseEvents=null);{var r=this._private__mouseMoveWithDownHandler.bind(this),a=this._private__mouseUpHandler.bind(this);this._private__unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",r),e.removeEventListener("mouseup",a)},e.addEventListener("mousemove",r),e.addEventListener("mouseup",a)}if(this._private__mousePressed=!0,!this._private__firesTouchEvents(t)){var _=this._private__makeCompatEvent(t);this._private__processMouseEvent(_,this._private__handler._internal_mouseDownEvent),this._private__clickTimeoutId||(this._private__clickCount=0,this._private__clickTimeoutId=setTimeout(this._private__resetClickTimeout.bind(this),500),this._private__clickPosition=B(t))}}},i.prototype._private__init=function(){var t=this;this._private__target.addEventListener("mouseenter",this._private__mouseEnterHandler.bind(this)),this._private__target.addEventListener("touchcancel",this._private__clearLongTapTimeout.bind(this));{var e=this._private__target.ownerDocument,r=function(a){t._private__handler._internal_mouseDownOutsideEvent&&(a.target&&t._private__target.contains(a.target)||t._private__handler._internal_mouseDownOutsideEvent())};this._private__unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",r)},this._private__unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",r)},e.addEventListener("mousedown",r),e.addEventListener("touchstart",r,{passive:!0})}qt()&&(this._private__unsubscribeMobileSafariEvents=function(){t._private__target.removeEventListener("dblclick",t._private__onMobileSafariDoubleClick)},this._private__target.addEventListener("dblclick",this._private__onMobileSafariDoubleClick)),this._private__target.addEventListener("mouseleave",this._private__mouseLeaveHandler.bind(this)),this._private__target.addEventListener("touchstart",this._private__touchStartHandler.bind(this),{passive:!0}),t_(this._private__target),this._private__target.addEventListener("mousedown",this._private__mouseDownHandler.bind(this)),this._private__initPinch(),this._private__target.addEventListener("touchmove",function(){},{passive:!1})},i.prototype._private__initPinch=function(){var t=this;this._private__handler._internal_pinchStartEvent===void 0&&this._private__handler._internal_pinchEvent===void 0&&this._private__handler._internal_pinchEndEvent===void 0||(this._private__target.addEventListener("touchstart",function(e){return t._private__checkPinchState(e.touches)},{passive:!0}),this._private__target.addEventListener("touchmove",function(e){if(!(e.touches.length!==2||t._private__startPinchMiddlePoint===null)&&t._private__handler._internal_pinchEvent!==void 0){var r=Ne(e.touches[0],e.touches[1]),a=r/t._private__startPinchDistance;t._private__handler._internal_pinchEvent(t._private__startPinchMiddlePoint,a),Z(e)}},{passive:!1}),this._private__target.addEventListener("touchend",function(e){t._private__checkPinchState(e.touches)}))},i.prototype._private__checkPinchState=function(t){t.length===1&&(this._private__pinchPrevented=!1),t.length!==2||this._private__pinchPrevented||this._private__longTapActive?this._private__stopPinch():this._private__startPinch(t)},i.prototype._private__startPinch=function(t){var e=e_(this._private__target);this._private__startPinchMiddlePoint={_internal_x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,_internal_y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._private__startPinchDistance=Ne(t[0],t[1]),this._private__handler._internal_pinchStartEvent!==void 0&&this._private__handler._internal_pinchStartEvent(),this._private__clearLongTapTimeout()},i.prototype._private__stopPinch=function(){this._private__startPinchMiddlePoint!==null&&(this._private__startPinchMiddlePoint=null,this._private__handler._internal_pinchEndEvent!==void 0&&this._private__handler._internal_pinchEndEvent())},i.prototype._private__mouseLeaveHandler=function(t){if(this._private__unsubscribeMousemove&&this._private__unsubscribeMousemove(),!this._private__firesTouchEvents(t)&&this._private__acceptMouseLeave){var e=this._private__makeCompatEvent(t);this._private__processMouseEvent(e,this._private__handler._internal_mouseLeaveEvent),this._private__acceptMouseLeave=!qt()}},i.prototype._private__longTapHandler=function(t){var e=Gt(t.touches,g(this._private__activeTouchId));if(e!==null){var r=this._private__makeCompatEvent(t,e);this._private__processTouchEvent(r,this._private__handler._internal_longTapEvent),this._private__cancelTap=!0,this._private__longTapActive=!0}},i.prototype._private__firesTouchEvents=function(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:yt(t)<this._private__lastTouchEventTimeStamp+500},i.prototype._private__processTouchEvent=function(t,e){e&&e.call(this._private__handler,t)},i.prototype._private__processMouseEvent=function(t,e){e&&e.call(this._private__handler,t)},i.prototype._private__makeCompatEvent=function(t,e){var r=e||t,a=this._private__target.getBoundingClientRect()||{left:0,top:0};return{_internal_clientX:r.clientX,_internal_clientY:r.clientY,_internal_pageX:r.pageX,_internal_pageY:r.pageY,_internal_screenX:r.screenX,_internal_screenY:r.screenY,_internal_localX:r.clientX-a.left,_internal_localY:r.clientY-a.top,_internal_ctrlKey:t.ctrlKey,_internal_altKey:t.altKey,_internal_shiftKey:t.shiftKey,_internal_metaKey:t.metaKey,_internal_isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",_internal_srcType:t.type,_internal_target:r.target,_internal_view:t.view,_internal_preventDefault:function(){t.type!=="touchstart"&&Z(t)}}},i}();function e_(i){return i.getBoundingClientRect()||{left:0,top:0}}function Ne(i,t){var e=i.clientX-t.clientX,r=i.clientY-t.clientY;return Math.sqrt(e*e+r*r)}function Z(i){i.cancelable&&i.preventDefault()}function B(i){return{_internal_x:i.pageX,_internal_y:i.pageY}}function yt(i){return i.timeStamp||performance.now()}function Gt(i,t){for(var e=0;e<i.length;++e)if(i[e].identifier===t)return i[e];return null}var He=200,Ue=function(){function i(t,e,r,a){this._private__textWidthCache=new rt(He),this._private__fontSize=0,this._private__color="",this._private__font="",this._private__keys=[],this._private__hash=new Map,this._private__fontSize=t,this._private__color=e,this._private__font=G(t,r,a)}return i.prototype.destroy=function(){this._private__textWidthCache.reset(),this._private__keys=[],this._private__hash.clear()},i.prototype._internal_paintTo=function(t,e,r,a,_){var n=this._private__getLabelImage(t,e);if(_!=="left"){var s=Dt(t.canvas);r-=Math.floor(n._internal_textWidth*s)}a-=Math.floor(n._internal_height/2),t.drawImage(n._internal_canvas,r,a,n._internal_width,n._internal_height)},i.prototype._private__getLabelImage=function(t,e){var r=this,a;if(this._private__hash.has(e))a=E(this._private__hash.get(e));else{if(this._private__keys.length>=He){var _=E(this._private__keys.shift());this._private__hash.delete(_)}var n=Dt(t.canvas),s=Math.ceil(this._private__fontSize/4.5),o=Math.round(this._private__fontSize/10),l=Math.ceil(this._private__textWidthCache.measureText(t,e)),p=Jt(Math.round(l+s*2)),v=Jt(this._private__fontSize+s*2),h=Ri(document,new D(p,v));a={_internal_text:e,_internal_textWidth:Math.round(Math.max(1,l)),_internal_width:Math.ceil(p*n),_internal_height:Math.ceil(v*n),_internal_canvas:h},l!==0&&(this._private__keys.push(a._internal_text),this._private__hash.set(a._internal_text,a)),t=W(a._internal_canvas),z(t,n,function(){t.font=r._private__font,t.fillStyle=r._private__color,t.fillText(e,0,v-s-o)})}return a},i}(),Ye=function(){function i(t,e,r,a){var _=this;this._private__priceScale=null,this._private__size=null,this._private__mousedown=!1,this._private__mouseDraggingCustomPriceLine=null,this._private__mouseDragFromPriceString="",this._private__widthCache=new rt(50),this._private__tickMarksCache=new Ue(11,"#000"),this._private__color=null,this._private__font=null,this._private__prevOptimalWidth=0,this._private__isSettingSize=!1,this._private__canvasConfiguredHandler=function(){_._private__recreateTickMarksCache(_._private__rendererOptionsProvider.options()),_._private__isSettingSize||_._private__pane._internal_chart()._internal_model().lightUpdate()},this._private__topCanvasConfiguredHandler=function(){_._private__isSettingSize||_._private__pane._internal_chart()._internal_model().lightUpdate()},this._private__pane=t,this._private__options=e,this._private__rendererOptionsProvider=r,this._private__isLeft=a==="left",this._private__cell=document.createElement("div"),this._private__cell.style.height="100%",this._private__cell.style.overflow="hidden",this._private__cell.style.width="25px",this._private__cell.style.left="0",this._private__cell.style.position="relative",this._private__canvasBinding=j(this._private__cell,new D(16,16)),this._private__canvasBinding.subscribeCanvasConfigured(this._private__canvasConfiguredHandler);var n=this._private__canvasBinding.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this._private__topCanvasBinding=j(this._private__cell,new D(16,16)),this._private__topCanvasBinding.subscribeCanvasConfigured(this._private__topCanvasConfiguredHandler);var s=this._private__topCanvasBinding.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0";var o={_internal_mouseMoveEvent:this._private__mouseMoveEvent.bind(this),_internal_mouseDownEvent:this._private__mouseDownEvent.bind(this),_internal_touchStartEvent:this._private__mouseDownEvent.bind(this),_internal_pressedMouseMoveEvent:this._private__pressedMouseMoveEvent.bind(this),_internal_touchMoveEvent:this._private__pressedMouseMoveEvent.bind(this),_internal_mouseDownOutsideEvent:this._private__mouseDownOutsideEvent.bind(this),_internal_mouseUpEvent:this._private__mouseUpEvent.bind(this),_internal_touchEndEvent:this._private__mouseUpEvent.bind(this),_internal_mouseDoubleClickEvent:this._private__mouseDoubleClickEvent.bind(this),_internal_doubleTapEvent:this._private__mouseDoubleClickEvent.bind(this),_internal_mouseEnterEvent:this._private__mouseEnterEvent.bind(this),_internal_mouseLeaveEvent:this._private__mouseLeaveEvent.bind(this)};this._private__mouseEventHandler=new pe(this._private__topCanvasBinding.canvas,o,{_internal_treatVertTouchDragAsPageScroll:function(){return!1},_internal_treatHorzTouchDragAsPageScroll:function(){return!0}})}return i.prototype.destroy=function(){this._private__mouseEventHandler.destroy(),this._private__topCanvasBinding.unsubscribeCanvasConfigured(this._private__topCanvasConfiguredHandler),this._private__topCanvasBinding.destroy(),this._private__canvasBinding.unsubscribeCanvasConfigured(this._private__canvasConfiguredHandler),this._private__canvasBinding.destroy(),this._private__priceScale!==null&&this._private__priceScale.onMarksChanged().unsubscribeAll(this),this._private__priceScale=null,this._private__tickMarksCache.destroy()},i.prototype._internal_getElement=function(){return this._private__cell},i.prototype._internal_lineColor=function(){return g(this._private__priceScale).options().borderColor},i.prototype._internal_textColor=function(){return this._private__options.textColor},i.prototype._internal_fontSize=function(){return this._private__options.fontSize},i.prototype._internal_baseFont=function(){return G(this._internal_fontSize(),this._private__options.fontFamily)},i.prototype._internal_rendererOptions=function(){var t=this._private__rendererOptionsProvider.options(),e=this._private__color!==t.color,r=this._private__font!==t.font;return(e||r)&&(this._private__recreateTickMarksCache(t),this._private__color=t.color),r&&(this._private__widthCache.reset(),this._private__font=t.font),t},i.prototype._internal_optimalWidth=function(){if(this._private__priceScale===null)return 0;var t=0,e=this._internal_rendererOptions(),r=W(this._private__canvasBinding.canvas),a=this._private__priceScale.marks();r.font=this._internal_baseFont(),a.length>0&&(t=Math.max(this._private__widthCache.measureText(r,a[0].label),this._private__widthCache.measureText(r,a[a.length-1].label)));for(var _=this._private__backLabels(),n=_.length;n--;){var s=this._private__widthCache.measureText(r,_[n].text());s>t&&(t=s)}var o=this._private__priceScale.firstValue();if(o!==null&&this._private__size!==null){var l=this._private__priceScale.coordinateToPrice(1,o),p=this._private__priceScale.coordinateToPrice(this._private__size._internal_h-2,o);t=Math.max(t,this._private__widthCache.measureText(r,this._private__priceScale.formatPrice(Math.floor(Math.min(l,p))+.11111111111111,o)),this._private__widthCache.measureText(r,this._private__priceScale.formatPrice(Math.ceil(Math.max(l,p))-.11111111111111,o)))}var v=t||34,h=Math.ceil(e.borderSize+e.tickLength+e.paddingInner+e.paddingOuter+v);return h+=h%2,h},i.prototype._internal_setSize=function(t){if(t._internal_w<0||t._internal_h<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));(this._private__size===null||!this._private__size._internal_equals(t))&&(this._private__size=t,this._private__isSettingSize=!0,this._private__canvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__topCanvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__isSettingSize=!1,this._private__cell.style.width=t._internal_w+"px",this._private__cell.style.height=t._internal_h+"px",this._private__cell.style.minWidth=t._internal_w+"px")},i.prototype._internal_getWidth=function(){return g(this._private__size)._internal_w},i.prototype._internal_setPriceScale=function(t){this._private__priceScale!==t&&(this._private__priceScale!==null&&this._private__priceScale.onMarksChanged().unsubscribeAll(this),this._private__priceScale=t,t.onMarksChanged().subscribe(this._private__onMarksChanged.bind(this),this))},i.prototype._internal_priceScale=function(){return this._private__priceScale},i.prototype._internal_reset=function(){var t=this._private__pane._internal_state(),e=this._private__pane._internal_chart()._internal_model();e.resetPriceScale(t,g(this._internal_priceScale()))},i.prototype._internal_paint=function(t){if(this._private__size!==null){if(t!==1){var e=W(this._private__canvasBinding.canvas);this._private__alignLabels(),this._private__drawBackground(e,this._private__canvasBinding.pixelRatio),this._private__drawBorder(e,this._private__canvasBinding.pixelRatio),this._private__drawTickMarks(e,this._private__canvasBinding.pixelRatio),this._private__drawBackLabels(e,this._private__canvasBinding.pixelRatio)}var r=W(this._private__topCanvasBinding.canvas),a=this._private__size._internal_w,_=this._private__size._internal_h;z(r,this._private__topCanvasBinding.pixelRatio,function(){r.clearRect(0,0,a,_)}),this._private__drawCrosshairLabel(r,this._private__topCanvasBinding.pixelRatio)}},i.prototype._internal_getImage=function(){return this._private__canvasBinding.canvas},i.prototype._internal_update=function(){var t;(t=this._private__priceScale)===null||t===void 0||t.marks()},i.prototype._private__getDraggableCustomPriceLines=function(){for(var t=[],e=0,r=this._private__pane._internal_state().orderedSources();e<r.length;e++){var a=r[e];a instanceof It&&t.push.apply(t,a.customPriceLines().filter(function(_){return _.options().draggable&&_.priceAxisView().isAxisLabelVisible()}))}return t},i.prototype._private__mouseHoveredCustomPriceLine=function(t){for(var e=this._internal_rendererOptions(),r=0,a=this._private__getDraggableCustomPriceLines();r<a.length;r++){var _=a[r],n=_.priceAxisView(),s=n.height(e,!1),o=n.getFixedCoordinate();if(o-s/2<=t&&t<=o+s/2)return _}return null},i.prototype._private__mouseMoveEvent=function(t){this._private__mouseHoveredCustomPriceLine(t._internal_localY)!==null?this._private__setCursor(2):this._private__setCursor(1)},i.prototype._private__mouseDownEvent=function(t){if(!(this._private__priceScale===null||this._private__priceScale.isEmpty())){this._private__mousedown=!0;var e=this._private__mouseHoveredCustomPriceLine(t._internal_localY);if(e){this._private__mouseDraggingCustomPriceLine=e;var r=e.options().price,a=g(this._private__priceScale.firstValue());this._private__mouseDragFromPriceString=this._private__priceScale.formatPrice(r,a),this._private__setCursor(3);return}if(this._private__pane._internal_chart()._internal_options().handleScale.axisPressedMouseMove.price){var _=this._private__pane._internal_chart()._internal_model(),n=this._private__pane._internal_state();_.startScalePrice(n,this._private__priceScale,t._internal_localY)}}},i.prototype._private__pressedMouseMoveEvent=function(t){if(this._private__priceScale!==null){var e=this._private__priceScale;if(this._private__mouseDraggingCustomPriceLine){var r=g(e.firstValue()),a=e.coordinateToPrice(t._internal_localY,r);this._private__mouseDraggingCustomPriceLine.applyOptions({price:a});return}if(this._private__pane._internal_chart()._internal_options().handleScale.axisPressedMouseMove.price){var _=this._private__pane._internal_chart()._internal_model(),n=this._private__pane._internal_state();_.scalePriceTo(n,e,t._internal_localY)}}},i.prototype._private__mouseDownOutsideEvent=function(){if(this._private__priceScale!==null&&this._private__mousedown){if(this._private__mousedown=!1,this._private__mouseDraggingCustomPriceLine=null,this._private__mouseDragFromPriceString="",!this._private__pane._internal_chart()._internal_options().handleScale.axisPressedMouseMove.price)return;var t=this._private__pane._internal_chart()._internal_model(),e=this._private__pane._internal_state(),r=this._private__priceScale;t.endScalePrice(e,r)}},i.prototype._private__mouseUpEvent=function(t){if(this._private__priceScale!==null){var e=this._private__pane._internal_chart()._internal_model();if(this._private__mousedown=!1,this._private__mouseDraggingCustomPriceLine){e.fireCustomPriceLineDragged(this._private__mouseDraggingCustomPriceLine,this._private__mouseDragFromPriceString),this._private__mouseDraggingCustomPriceLine=null,this._private__mouseDragFromPriceString="",this._private__setCursor(2);return}if(this._private__pane._internal_chart()._internal_options().handleScale.axisPressedMouseMove.price){var r=this._private__pane._internal_state();e.endScalePrice(r,this._private__priceScale)}}},i.prototype._private__mouseDoubleClickEvent=function(t){this._private__mouseHoveredCustomPriceLine(t._internal_localY)===null&&this._private__pane._internal_chart()._internal_options().handleScale.axisDoubleClickReset&&this._internal_reset()},i.prototype._private__mouseEnterEvent=function(t){if(this._private__priceScale!==null){if(this._private__mouseDraggingCustomPriceLine!==null){this._private__setCursor(3);return}if(this._private__mouseHoveredCustomPriceLine(t._internal_localY)!==null){this._private__setCursor(2);return}var e=this._private__pane._internal_chart()._internal_model();e.options().handleScale.axisPressedMouseMove.price&&!this._private__priceScale.isPercentage()&&!this._private__priceScale.isIndexedTo100()&&this._private__setCursor(1)}},i.prototype._private__mouseLeaveEvent=function(t){this._private__setCursor(0)},i.prototype._private__backLabels=function(){var t=this,e=[],r=this._private__priceScale===null?void 0:this._private__priceScale,a=function(_){for(var n=0;n<_.length;++n)for(var s=_[n],o=s.priceAxisViews(t._private__pane._internal_state(),r),l=0;l<o.length;l++)e.push(o[l])};return a(this._private__pane._internal_state().orderedSources()),e},i.prototype._private__drawBackground=function(t,e){var r=this;if(this._private__size!==null){var a=this._private__size._internal_w,_=this._private__size._internal_h;z(t,e,function(){var n=r._private__pane._internal_state().model(),s=n.backgroundTopColor(),o=n.backgroundBottomColor();s===o?At(t,0,0,a,_,s):oi(t,0,0,a,_,s,o)})}},i.prototype._private__drawBorder=function(t,e){if(!(this._private__size===null||this._private__priceScale===null||!this._private__priceScale.options().borderVisible)){t.save(),t.fillStyle=this._internal_lineColor();var r=Math.max(1,Math.floor(this._internal_rendererOptions().borderSize*e)),a;this._private__isLeft?a=Math.floor(this._private__size._internal_w*e)-r:a=0,t.fillRect(a,0,r,Math.ceil(this._private__size._internal_h*e)),t.restore()}},i.prototype._private__drawTickMarks=function(t,e){if(!(this._private__size===null||this._private__priceScale===null)){var r=this._private__priceScale.marks();t.save(),t.strokeStyle=this._internal_lineColor(),t.font=this._internal_baseFont(),t.fillStyle=this._internal_lineColor();var a=this._internal_rendererOptions(),_=this._private__priceScale.options().borderVisible&&this._private__priceScale.options().drawTicks,n=this._private__isLeft?Math.floor((this._private__size._internal_w-a.tickLength)*e-a.borderSize*e):Math.floor(a.borderSize*e),s=this._private__isLeft?Math.round(n-a.paddingInner*e):Math.round(n+a.tickLength*e+a.paddingInner*e),o=this._private__isLeft?"right":"left",l=Math.max(1,Math.floor(e)),p=Math.floor(e*.5);if(_){var v=Math.round(a.tickLength*e);t.beginPath();for(var h=0,c=r;h<c.length;h++){var u=c[h];t.rect(n,Math.round(u.coord*e)-p,v,l)}t.fill()}t.fillStyle=this._internal_textColor();for(var f=0,d=r;f<d.length;f++){var u=d[f];this._private__tickMarksCache._internal_paintTo(t,u.label,s,Math.round(u.coord*e),o)}t.restore()}},i.prototype._private__alignLabels=function(){if(!(this._private__size===null||this._private__priceScale===null)){var t=this._private__size._internal_h/2,e=[],r=this._private__priceScale.orderedSources().slice(),a=this._private__pane,_=a._internal_state(),n=this._internal_rendererOptions(),s=this._private__priceScale===_.defaultVisiblePriceScale();s&&this._private__pane._internal_state().orderedSources().forEach(function(S){_.isOverlay(S)&&r.push(S)});var o=this._private__priceScale.dataSources()[0],l=this._private__priceScale,p=function(S){S.forEach(function(T){var k=T.priceAxisViews(_,l);k.forEach(function(I){I.setFixedCoordinate(null),I.isVisible()&&e.push(I)}),o===T&&k.length>0&&(t=k[0].coordinate())})};p(r);var v=e.filter(function(S){return S.coordinate()<=t}),h=e.filter(function(S){return S.coordinate()>t});v.sort(function(S,T){return T.coordinate()-S.coordinate()}),v.length&&h.length&&h.push(v[0]),h.sort(function(S,T){return S.coordinate()-T.coordinate()}),e.forEach(function(S){return S.setFixedCoordinate(S.coordinate())});var c=this._private__priceScale.options();if(c.alignLabels){for(var u=1;u<v.length;u++){var f=v[u],d=v[u-1],m=d.height(n,!1),y=f.coordinate(),b=d.getFixedCoordinate();y>b-m&&f.setFixedCoordinate(b-m)}for(var C=1;C<h.length;C++){var f=h[C],d=h[C-1],m=d.height(n,!0),y=f.coordinate(),b=d.getFixedCoordinate();y<b+m&&f.setFixedCoordinate(b+m)}}}},i.prototype._private__drawBackLabels=function(t,e){var r=this;if(this._private__size!==null){t.save();var a=this._private__size,_=this._private__backLabels(),n=this._internal_rendererOptions(),s=this._private__isLeft?"right":"left";_.forEach(function(o){if(o.isAxisLabelVisible()){var l=o.renderer(g(r._private__priceScale));t.save(),l.draw(t,n,r._private__widthCache,a._internal_w,s,e),t.restore()}}),t.restore()}},i.prototype._private__drawCrosshairLabel=function(t,e){var r=this;if(!(this._private__size===null||this._private__priceScale===null)){t.save();var a=this._private__size,_=this._private__pane._internal_chart()._internal_model(),n=[],s=this._private__pane._internal_state(),o=_.crosshairSource().priceAxisViews(s,this._private__priceScale);o.length&&n.push(o);var l=this._internal_rendererOptions(),p=this._private__isLeft?"right":"left";n.forEach(function(v){v.forEach(function(h){t.save(),h.renderer(g(r._private__priceScale)).draw(t,l,r._private__widthCache,a._internal_w,p,e),t.restore()})}),t.restore()}},i.prototype._private__setCursor=function(t){var e="default";t===1?e="ns-resize":t===2?e="grab":t===3&&(e="grabbing"),this._private__cell.style.cursor=e},i.prototype._private__onMarksChanged=function(){var t=this._internal_optimalWidth();this._private__prevOptimalWidth<t&&this._private__pane._internal_chart()._internal_model().fullUpdate(),this._private__prevOptimalWidth=t},i.prototype._private__recreateTickMarksCache=function(t){this._private__tickMarksCache.destroy(),this._private__tickMarksCache=new Ue(t.fontSize,t.color,t.fontFamily)},i}();function Xe(i,t,e,r,a){i.drawBackground&&i.drawBackground(t,e,r,a)}function jt(i,t,e,r,a){i.draw(t,e,r,a)}function bt(i,t){return i.paneViews(t)}function i_(i,t){return i.topPaneViews!==void 0?i.topPaneViews(t):[]}var r_=function(){function i(t,e){var r=this;this._private__size=new D(0,0),this._private__leftPriceAxisWidget=null,this._private__rightPriceAxisWidget=null,this._private__startScrollingPos=null,this._private__isScrolling=!1,this._private__clicked=new M,this._private__prevPinchScale=0,this._private__longTap=!1,this._private__startTrackPoint=null,this._private__exitTrackingModeOnNextTry=!1,this._private__initCrosshairPosition=null,this._private__scrollXAnimation=null,this._private__isSettingSize=!1,this._private__canvasConfiguredHandler=function(){r._private__isSettingSize||r._private__state===null||r._private__model().lightUpdate()},this._private__topCanvasConfiguredHandler=function(){r._private__isSettingSize||r._private__state===null||r._private__model().lightUpdate()},this._private__chart=t,this._private__state=e,this._private__state.onDestroyed().subscribe(this._private__onStateDestroyed.bind(this),this,!0),this._private__paneCell=document.createElement("td"),this._private__paneCell.style.padding="0",this._private__paneCell.style.position="relative";var a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.position="relative",a.style.overflow="hidden",this._private__leftAxisCell=document.createElement("td"),this._private__leftAxisCell.style.padding="0",this._private__rightAxisCell=document.createElement("td"),this._private__rightAxisCell.style.padding="0",this._private__paneCell.appendChild(a),this._private__canvasBinding=j(a,new D(16,16)),this._private__canvasBinding.subscribeCanvasConfigured(this._private__canvasConfiguredHandler);var _=this._private__canvasBinding.canvas;_.style.position="absolute",_.style.zIndex="1",_.style.left="0",_.style.top="0",this._private__topCanvasBinding=j(a,new D(16,16)),this._private__topCanvasBinding.subscribeCanvasConfigured(this._private__topCanvasConfiguredHandler);var n=this._private__topCanvasBinding.canvas;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this._private__rowElement=document.createElement("tr"),this._private__rowElement.appendChild(this._private__leftAxisCell),this._private__rowElement.appendChild(this._private__paneCell),this._private__rowElement.appendChild(this._private__rightAxisCell),this._internal_updatePriceAxisWidgetsStates(),this._private__mouseEventHandler=new pe(this._private__topCanvasBinding.canvas,this,{_internal_treatVertTouchDragAsPageScroll:function(){return r._private__startTrackPoint===null&&!r._private__chart._internal_options().handleScroll.vertTouchDrag},_internal_treatHorzTouchDragAsPageScroll:function(){return r._private__startTrackPoint===null&&!r._private__chart._internal_options().handleScroll.horzTouchDrag}})}return i.prototype.destroy=function(){this._private__leftPriceAxisWidget!==null&&this._private__leftPriceAxisWidget.destroy(),this._private__rightPriceAxisWidget!==null&&this._private__rightPriceAxisWidget.destroy(),this._private__topCanvasBinding.unsubscribeCanvasConfigured(this._private__topCanvasConfiguredHandler),this._private__topCanvasBinding.destroy(),this._private__canvasBinding.unsubscribeCanvasConfigured(this._private__canvasConfiguredHandler),this._private__canvasBinding.destroy(),this._private__state!==null&&this._private__state.onDestroyed().unsubscribeAll(this),this._private__mouseEventHandler.destroy()},i.prototype._internal_state=function(){return g(this._private__state)},i.prototype._internal_setState=function(t){this._private__state!==null&&this._private__state.onDestroyed().unsubscribeAll(this),this._private__state=t,this._private__state!==null&&this._private__state.onDestroyed().subscribe(i.prototype._private__onStateDestroyed.bind(this),this,!0),this._internal_updatePriceAxisWidgetsStates()},i.prototype._internal_chart=function(){return this._private__chart},i.prototype._internal_getElement=function(){return this._private__rowElement},i.prototype._internal_updatePriceAxisWidgetsStates=function(){if(this._private__state!==null&&(this._private__recreatePriceAxisWidgets(),this._private__model().serieses().length!==0)){if(this._private__leftPriceAxisWidget!==null){var t=this._private__state.leftPriceScale();this._private__leftPriceAxisWidget._internal_setPriceScale(g(t))}if(this._private__rightPriceAxisWidget!==null){var e=this._private__state.rightPriceScale();this._private__rightPriceAxisWidget._internal_setPriceScale(g(e))}}},i.prototype._internal_updatePriceAxisWidgets=function(){this._private__leftPriceAxisWidget!==null&&this._private__leftPriceAxisWidget._internal_update(),this._private__rightPriceAxisWidget!==null&&this._private__rightPriceAxisWidget._internal_update()},i.prototype._internal_stretchFactor=function(){return this._private__state!==null?this._private__state.stretchFactor():0},i.prototype._internal_setStretchFactor=function(t){this._private__state&&this._private__state.setStretchFactor(t)},i.prototype._internal_mouseEnterEvent=function(t){if(this._private__state){this._private__onMouseEvent();var e=t._internal_localX,r=t._internal_localY;this._private__setCrosshairPosition(e,r)}},i.prototype._internal_mouseDownEvent=function(t){this._private__onMouseEvent(),this._private__mouseTouchDownEvent(),this._private__setCrosshairPosition(t._internal_localX,t._internal_localY)},i.prototype._internal_mouseMoveEvent=function(t){if(this._private__state){this._private__onMouseEvent();var e=t._internal_localX,r=t._internal_localY;this._private__setCrosshairPosition(e,r);var a=this._internal_hitTest(e,r);this._private__model().setHoveredSource(a&&{source:a._internal_source,object:a._internal_object})}},i.prototype._internal_mouseClickEvent=function(t){if(this._private__state!==null){this._private__onMouseEvent();var e=t._internal_localX,r=t._internal_localY;if(this._private__clicked._internal_hasListeners()){var a=this._private__model().crosshairSource().appliedIndex();this._private__clicked._internal_fire(a,{x:e,y:r})}}},i.prototype._internal_pressedMouseMoveEvent=function(t){this._private__onMouseEvent(),this._private__pressedMouseTouchMoveEvent(t),this._private__setCrosshairPosition(t._internal_localX,t._internal_localY)},i.prototype._internal_mouseUpEvent=function(t){this._private__state!==null&&(this._private__onMouseEvent(),this._private__longTap=!1,this._private__endScroll(t))},i.prototype._internal_longTapEvent=function(t){if(this._private__longTap=!0,this._private__startTrackPoint===null){var e={x:t._internal_localX,y:t._internal_localY};this._private__startTrackingMode(e,e)}},i.prototype._internal_mouseLeaveEvent=function(t){this._private__state!==null&&(this._private__onMouseEvent(),this._private__state.model().setHoveredSource(null),this._private__clearCrosshairPosition())},i.prototype._internal_clicked=function(){return this._private__clicked},i.prototype._internal_pinchStartEvent=function(){this._private__prevPinchScale=1,this._private__terminateKineticAnimation()},i.prototype._internal_pinchEvent=function(t,e){if(this._private__chart._internal_options().handleScale.pinch){var r=(e-this._private__prevPinchScale)*5;this._private__prevPinchScale=e,this._private__model().zoomTime(t._internal_x,r)}},i.prototype._internal_touchStartEvent=function(t){if(this._private__longTap=!1,this._private__exitTrackingModeOnNextTry=this._private__startTrackPoint!==null,this._private__mouseTouchDownEvent(),this._private__startTrackPoint!==null){var e=this._private__model().crosshairSource();this._private__initCrosshairPosition={x:e.appliedX(),y:e.appliedY()},this._private__startTrackPoint={x:t._internal_localX,y:t._internal_localY}}},i.prototype._internal_touchMoveEvent=function(t){if(this._private__state!==null){var e=t._internal_localX,r=t._internal_localY;if(this._private__startTrackPoint!==null){this._private__exitTrackingModeOnNextTry=!1;var a=g(this._private__initCrosshairPosition),_=a.x+(e-this._private__startTrackPoint.x),n=a.y+(r-this._private__startTrackPoint.y);this._private__setCrosshairPosition(_,n);return}this._private__pressedMouseTouchMoveEvent(t)}},i.prototype._internal_touchEndEvent=function(t){this._internal_chart()._internal_options().trackingMode.exitMode===0&&(this._private__exitTrackingModeOnNextTry=!0),this._private__tryExitTrackingMode(),this._private__endScroll(t)},i.prototype._internal_hitTest=function(t,e){var r=this._private__state;if(r===null)return null;for(var a=r.orderedSources(),_=0,n=a;_<n.length;_++){var s=n[_],o=this._private__hitTestPaneView(s.paneViews(r),t,e);if(o!==null)return{_internal_source:s,_internal_view:o._internal_view,_internal_object:o._internal_object}}return null},i.prototype._internal_setPriceAxisSize=function(t,e){var r=e==="left"?this._private__leftPriceAxisWidget:this._private__rightPriceAxisWidget;g(r)._internal_setSize(new D(t,this._private__size._internal_h))},i.prototype._internal_getSize=function(){return this._private__size},i.prototype._internal_setSize=function(t){if(t._internal_w<0||t._internal_h<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this._private__size._internal_equals(t)||(this._private__size=t,this._private__isSettingSize=!0,this._private__canvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__topCanvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__isSettingSize=!1,this._private__paneCell.style.width=t._internal_w+"px",this._private__paneCell.style.height=t._internal_h+"px")},i.prototype._internal_recalculatePriceScales=function(){var t=g(this._private__state);t.recalculatePriceScale(t.leftPriceScale()),t.recalculatePriceScale(t.rightPriceScale());for(var e=0,r=t.dataSources();e<r.length;e++){var a=r[e];if(t.isOverlay(a)){var _=a.priceScale();_!==null&&t.recalculatePriceScale(_),a.updateAllViews()}}},i.prototype._internal_getImage=function(){return this._private__canvasBinding.canvas},i.prototype._internal_paint=function(t){if(t!==0&&this._private__state!==null){if(t>1&&this._internal_recalculatePriceScales(),this._private__leftPriceAxisWidget!==null&&this._private__leftPriceAxisWidget._internal_paint(t),this._private__rightPriceAxisWidget!==null&&this._private__rightPriceAxisWidget._internal_paint(t),t!==1){var e=W(this._private__canvasBinding.canvas);e.save(),this._private__drawBackground(e,this._private__canvasBinding.pixelRatio),this._private__state&&(this._private__drawGrid(e,this._private__canvasBinding.pixelRatio),this._private__drawWatermark(e,this._private__canvasBinding.pixelRatio),this._private__drawSources(e,this._private__canvasBinding.pixelRatio,bt)),e.restore()}var r=W(this._private__topCanvasBinding.canvas);r.clearRect(0,0,Math.ceil(this._private__size._internal_w*this._private__topCanvasBinding.pixelRatio),Math.ceil(this._private__size._internal_h*this._private__topCanvasBinding.pixelRatio)),this._private__drawSources(r,this._private__canvasBinding.pixelRatio,i_),this._private__drawCrosshair(r,this._private__topCanvasBinding.pixelRatio)}},i.prototype._internal_leftPriceAxisWidget=function(){return this._private__leftPriceAxisWidget},i.prototype._internal_rightPriceAxisWidget=function(){return this._private__rightPriceAxisWidget},i.prototype._private__onStateDestroyed=function(){this._private__state!==null&&this._private__state.onDestroyed().unsubscribeAll(this),this._private__state=null},i.prototype._private__drawBackground=function(t,e){var r=this;z(t,e,function(){var a=r._private__model(),_=a.backgroundTopColor(),n=a.backgroundBottomColor();_===n?At(t,0,0,r._private__size._internal_w,r._private__size._internal_h,n):oi(t,0,0,r._private__size._internal_w,r._private__size._internal_h,_,n)})},i.prototype._private__drawGrid=function(t,e){var r=g(this._private__state),a=r.grid().paneView(),_=a.renderer(r.height(),r.width());_!==null&&(t.save(),_.draw(t,e,!1),t.restore())},i.prototype._private__drawWatermark=function(t,e){var r=this._private__model().watermarkSource();this._private__drawSourceImpl(t,e,bt,Xe,r),this._private__drawSourceImpl(t,e,bt,jt,r)},i.prototype._private__drawCrosshair=function(t,e){this._private__drawSourceImpl(t,e,bt,jt,this._private__model().crosshairSource())},i.prototype._private__drawSources=function(t,e,r){for(var a=g(this._private__state),_=a.orderedSources(),n=0,s=_;n<s.length;n++){var o=s[n];this._private__drawSourceImpl(t,e,r,Xe,o)}for(var l=0,p=_;l<p.length;l++){var o=p[l];this._private__drawSourceImpl(t,e,r,jt,o)}},i.prototype._private__drawSourceImpl=function(t,e,r,a,_){for(var n=g(this._private__state),s=r(_,n),o=n.height(),l=n.width(),p=n.model().hoveredSource(),v=p!==null&&p.source===_,h=p!==null&&v&&p.object!==void 0?p.object.hitTestData:void 0,c=0,u=s;c<u.length;c++){var f=u[c],d=f.renderer(o,l);d!==null&&(t.save(),a(d,t,e,v,h),t.restore())}},i.prototype._private__hitTestPaneView=function(t,e,r){for(var a=0,_=t;a<_.length;a++){var n=_[a],s=n.renderer(this._private__size._internal_h,this._private__size._internal_w);if(s!==null&&s.hitTest){var o=s.hitTest(e,r);if(o!==null)return{_internal_view:n,_internal_object:o}}}return null},i.prototype._private__recreatePriceAxisWidgets=function(){if(this._private__state!==null){var t=this._private__chart,e=this._private__state.leftPriceScale().options().visible,r=this._private__state.rightPriceScale().options().visible;!e&&this._private__leftPriceAxisWidget!==null&&(this._private__leftAxisCell.removeChild(this._private__leftPriceAxisWidget._internal_getElement()),this._private__leftPriceAxisWidget.destroy(),this._private__leftPriceAxisWidget=null),!r&&this._private__rightPriceAxisWidget!==null&&(this._private__rightAxisCell.removeChild(this._private__rightPriceAxisWidget._internal_getElement()),this._private__rightPriceAxisWidget.destroy(),this._private__rightPriceAxisWidget=null);var a=t._internal_model().rendererOptionsProvider();e&&this._private__leftPriceAxisWidget===null&&(this._private__leftPriceAxisWidget=new Ye(this,t._internal_options().layout,a,"left"),this._private__leftAxisCell.appendChild(this._private__leftPriceAxisWidget._internal_getElement())),r&&this._private__rightPriceAxisWidget===null&&(this._private__rightPriceAxisWidget=new Ye(this,t._internal_options().layout,a,"right"),this._private__rightAxisCell.appendChild(this._private__rightPriceAxisWidget._internal_getElement()))}},i.prototype._private__preventScroll=function(t){return t._internal_isTouch&&this._private__longTap||this._private__startTrackPoint!==null},i.prototype._private__correctXCoord=function(t){return Math.max(0,Math.min(t,this._private__size._internal_w-1))},i.prototype._private__correctYCoord=function(t){return Math.max(0,Math.min(t,this._private__size._internal_h-1))},i.prototype._private__setCrosshairPosition=function(t,e){this._private__model().setAndSaveCurrentPosition(this._private__correctXCoord(t),this._private__correctYCoord(e),g(this._private__state))},i.prototype._private__clearCrosshairPosition=function(){this._private__model().clearCurrentPosition()},i.prototype._private__tryExitTrackingMode=function(){this._private__exitTrackingModeOnNextTry&&(this._private__startTrackPoint=null,this._private__clearCrosshairPosition())},i.prototype._private__startTrackingMode=function(t,e){this._private__startTrackPoint=t,this._private__exitTrackingModeOnNextTry=!1,this._private__setCrosshairPosition(e.x,e.y);var r=this._private__model().crosshairSource();this._private__initCrosshairPosition={x:r.appliedX(),y:r.appliedY()}},i.prototype._private__model=function(){return this._private__chart._internal_model()},i.prototype._private__finishScroll=function(){var t=this._private__model(),e=this._internal_state(),r=e.defaultPriceScale();t.endScrollPrice(e,r),t.endScrollTime(),this._private__startScrollingPos=null,this._private__isScrolling=!1},i.prototype._private__endScroll=function(t){var e=this;if(this._private__isScrolling){var r=performance.now();if(this._private__scrollXAnimation!==null&&this._private__scrollXAnimation._internal_start(t._internal_localX,r),this._private__scrollXAnimation===null||this._private__scrollXAnimation._internal_finished(r)){this._private__finishScroll();return}var a=this._private__model(),_=a.timeScale(),n=this._private__scrollXAnimation,s=function(){if(!n._internal_terminated()){var o=performance.now(),l=n._internal_finished(o);if(!n._internal_terminated()){var p=_.rightOffset();a.scrollTimeTo(n._internal_getPosition(o)),p===_.rightOffset()&&(l=!0,e._private__scrollXAnimation=null)}if(l){e._private__finishScroll();return}requestAnimationFrame(s)}};requestAnimationFrame(s)}},i.prototype._private__onMouseEvent=function(){this._private__startTrackPoint=null},i.prototype._private__mouseTouchDownEvent=function(){if(this._private__state){if(this._private__terminateKineticAnimation(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)g(document.activeElement).blur();else{var t=document.getSelection();t!==null&&t.removeAllRanges()}var e=this._private__state.defaultPriceScale();e.isEmpty()||this._private__model().timeScale().isEmpty()}},i.prototype._private__pressedMouseTouchMoveEvent=function(t){if(this._private__state!==null){var e=this._private__model();if(!e.timeScale().isEmpty()){var r=this._private__chart._internal_options(),a=r.handleScroll,_=r.kineticScroll;if(!((!a.pressedMouseMove||t._internal_isTouch)&&(!a.horzTouchDrag&&!a.vertTouchDrag||!t._internal_isTouch))){var n=this._private__state.defaultPriceScale(),s=performance.now();this._private__startScrollingPos===null&&!this._private__preventScroll(t)&&(this._private__startScrollingPos={x:t._internal_clientX,y:t._internal_clientY,_internal_timestamp:s,_internal_localX:t._internal_localX,_internal_localY:t._internal_localY}),this._private__scrollXAnimation!==null&&this._private__scrollXAnimation._internal_addPosition(t._internal_localX,s),this._private__startScrollingPos!==null&&!this._private__isScrolling&&(this._private__startScrollingPos.x!==t._internal_clientX||this._private__startScrollingPos.y!==t._internal_clientY)&&(this._private__scrollXAnimation===null&&(t._internal_isTouch&&_.touch||!t._internal_isTouch&&_.mouse)&&(this._private__scrollXAnimation=new Qa(.2,7,.997,15),this._private__scrollXAnimation._internal_addPosition(this._private__startScrollingPos._internal_localX,this._private__startScrollingPos._internal_timestamp),this._private__scrollXAnimation._internal_addPosition(t._internal_localX,s)),n.isEmpty()||e.startScrollPrice(this._private__state,n,t._internal_localY),e.startScrollTime(t._internal_localX),this._private__isScrolling=!0),this._private__isScrolling&&(n.isEmpty()||e.scrollPriceTo(this._private__state,n,t._internal_localY),e.scrollTimeTo(t._internal_localX))}}}},i.prototype._private__terminateKineticAnimation=function(){var t=performance.now(),e=this._private__scrollXAnimation===null||this._private__scrollXAnimation._internal_finished(t);this._private__scrollXAnimation!==null&&(e||this._private__finishScroll()),this._private__scrollXAnimation!==null&&(this._private__scrollXAnimation._internal_terminate(),this._private__scrollXAnimation=null)},i}(),qe=function(){function i(t,e,r,a,_){var n=this;this._private__invalidated=!0,this._private__size=new D(0,0),this._private__canvasConfiguredHandler=function(){return n._internal_paint(3)},this._private__isLeft=t==="left",this._private__rendererOptionsProvider=r._internal_rendererOptionsProvider,this._private__options=e,this._private__borderVisible=a,this._private__bottomColor=_,this._private__cell=document.createElement("div"),this._private__cell.style.width="25px",this._private__cell.style.height="100%",this._private__cell.style.overflow="hidden",this._private__canvasBinding=j(this._private__cell,new D(16,16)),this._private__canvasBinding.subscribeCanvasConfigured(this._private__canvasConfiguredHandler)}return i.prototype.destroy=function(){this._private__canvasBinding.unsubscribeCanvasConfigured(this._private__canvasConfiguredHandler),this._private__canvasBinding.destroy()},i.prototype._internal_getElement=function(){return this._private__cell},i.prototype._internal_getSize=function(){return this._private__size},i.prototype._internal_setSize=function(t){if(t._internal_w<0||t._internal_h<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this._private__size._internal_equals(t)||(this._private__size=t,this._private__canvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__cell.style.width="".concat(t._internal_w,"px"),this._private__cell.style.minWidth="".concat(t._internal_w,"px"),this._private__cell.style.height="".concat(t._internal_h,"px"),this._private__invalidated=!0)},i.prototype._internal_paint=function(t){if(!(t<3&&!this._private__invalidated)&&!(this._private__size._internal_w===0||this._private__size._internal_h===0)){this._private__invalidated=!1;var e=W(this._private__canvasBinding.canvas);this._private__drawBackground(e,this._private__canvasBinding.pixelRatio),this._private__drawBorder(e,this._private__canvasBinding.pixelRatio)}},i.prototype._internal_getImage=function(){return this._private__canvasBinding.canvas},i.prototype._private__drawBorder=function(t,e){if(this._private__borderVisible()){var r=this._private__size._internal_w;t.save(),t.fillStyle=this._private__options.timeScale.borderColor;var a=Math.floor(this._private__rendererOptionsProvider.options().borderSize*e),_=this._private__isLeft?Math.round(r*e)-a:0;t.fillRect(_,0,a,a),t.restore()}},i.prototype._private__drawBackground=function(t,e){var r=this;z(t,e,function(){At(t,0,0,r._private__size._internal_w,r._private__size._internal_h,r._private__bottomColor())})},i}();function a_(i,t){return i.weight>t.weight?i:t}var __=function(){function i(t){var e=this;this._private__leftStub=null,this._private__rightStub=null,this._private__rendererOptions=null,this._private__mouseDown=!1,this._private__size=new D(0,0),this._private__sizeChanged=new M,this._private__widthCache=new rt(5),this._private__isSettingSize=!1,this._private__canvasConfiguredHandler=function(){e._private__isSettingSize||e._private__chart._internal_model().lightUpdate()},this._private__topCanvasConfiguredHandler=function(){e._private__isSettingSize||e._private__chart._internal_model().lightUpdate()},this._private__chart=t,this._private__options=t._internal_options().layout,this._private__element=document.createElement("tr"),this._private__leftStubCell=document.createElement("td"),this._private__leftStubCell.style.padding="0",this._private__rightStubCell=document.createElement("td"),this._private__rightStubCell.style.padding="0",this._private__cell=document.createElement("td"),this._private__cell.style.height="25px",this._private__cell.style.padding="0",this._private__dv=document.createElement("div"),this._private__dv.style.width="100%",this._private__dv.style.height="100%",this._private__dv.style.position="relative",this._private__dv.style.overflow="hidden",this._private__cell.appendChild(this._private__dv),this._private__canvasBinding=j(this._private__dv,new D(16,16)),this._private__canvasBinding.subscribeCanvasConfigured(this._private__canvasConfiguredHandler);var r=this._private__canvasBinding.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this._private__topCanvasBinding=j(this._private__dv,new D(16,16)),this._private__topCanvasBinding.subscribeCanvasConfigured(this._private__topCanvasConfiguredHandler);var a=this._private__topCanvasBinding.canvas;a.style.position="absolute",a.style.zIndex="2",a.style.left="0",a.style.top="0",this._private__element.appendChild(this._private__leftStubCell),this._private__element.appendChild(this._private__cell),this._private__element.appendChild(this._private__rightStubCell),this._private__recreateStubs(),this._private__chart._internal_model().priceScalesOptionsChanged().subscribe(this._private__recreateStubs.bind(this),this),this._private__mouseEventHandler=new pe(this._private__topCanvasBinding.canvas,this,{_internal_treatVertTouchDragAsPageScroll:function(){return!0},_internal_treatHorzTouchDragAsPageScroll:function(){return!1}})}return i.prototype.destroy=function(){this._private__mouseEventHandler.destroy(),this._private__leftStub!==null&&this._private__leftStub.destroy(),this._private__rightStub!==null&&this._private__rightStub.destroy(),this._private__topCanvasBinding.unsubscribeCanvasConfigured(this._private__topCanvasConfiguredHandler),this._private__topCanvasBinding.destroy(),this._private__canvasBinding.unsubscribeCanvasConfigured(this._private__canvasConfiguredHandler),this._private__canvasBinding.destroy()},i.prototype._internal_getElement=function(){return this._private__element},i.prototype._internal_leftStub=function(){return this._private__leftStub},i.prototype._internal_rightStub=function(){return this._private__rightStub},i.prototype._internal_mouseDownEvent=function(t){if(!this._private__mouseDown){this._private__mouseDown=!0;var e=this._private__chart._internal_model();e.timeScale().isEmpty()||!this._private__chart._internal_options().handleScale.axisPressedMouseMove.time||e.startScaleTime(t._internal_localX)}},i.prototype._internal_touchStartEvent=function(t){this._internal_mouseDownEvent(t)},i.prototype._internal_mouseDownOutsideEvent=function(){var t=this._private__chart._internal_model();!t.timeScale().isEmpty()&&this._private__mouseDown&&(this._private__mouseDown=!1,this._private__chart._internal_options().handleScale.axisPressedMouseMove.time&&t.endScaleTime())},i.prototype._internal_pressedMouseMoveEvent=function(t){var e=this._private__chart._internal_model();e.timeScale().isEmpty()||!this._private__chart._internal_options().handleScale.axisPressedMouseMove.time||e.scaleTimeTo(t._internal_localX)},i.prototype._internal_touchMoveEvent=function(t){this._internal_pressedMouseMoveEvent(t)},i.prototype._internal_mouseUpEvent=function(){this._private__mouseDown=!1;var t=this._private__chart._internal_model();t.timeScale().isEmpty()&&!this._private__chart._internal_options().handleScale.axisPressedMouseMove.time||t.endScaleTime()},i.prototype._internal_touchEndEvent=function(){this._internal_mouseUpEvent()},i.prototype._internal_mouseDoubleClickEvent=function(){this._private__chart._internal_options().handleScale.axisDoubleClickReset&&this._private__chart._internal_model().resetTimeScale()},i.prototype._internal_doubleTapEvent=function(){this._internal_mouseDoubleClickEvent()},i.prototype._internal_mouseEnterEvent=function(){this._private__chart._internal_model().options().handleScale.axisPressedMouseMove.time&&this._private__setCursor(1)},i.prototype._internal_mouseLeaveEvent=function(){this._private__setCursor(0)},i.prototype._internal_getSize=function(){return this._private__size},i.prototype._internal_sizeChanged=function(){return this._private__sizeChanged},i.prototype._internal_setSizes=function(t,e,r){(!this._private__size||!this._private__size._internal_equals(t))&&(this._private__size=t,this._private__isSettingSize=!0,this._private__canvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__topCanvasBinding.resizeCanvas({width:t._internal_w,height:t._internal_h}),this._private__isSettingSize=!1,this._private__cell.style.width=t._internal_w+"px",this._private__cell.style.height=t._internal_h+"px",this._private__sizeChanged._internal_fire(t)),this._private__leftStub!==null&&this._private__leftStub._internal_setSize(new D(e,t._internal_h)),this._private__rightStub!==null&&this._private__rightStub._internal_setSize(new D(r,t._internal_h))},i.prototype._internal_optimalHeight=function(){var t=this._private__getRendererOptions();return Math.ceil(t.borderSize+t.tickLength+t.fontSize+t.paddingTop+t.paddingBottom)},i.prototype._internal_update=function(){this._private__chart._internal_model().timeScale().marks()},i.prototype._internal_getImage=function(){return this._private__canvasBinding.canvas},i.prototype._internal_paint=function(t){if(t!==0){if(t!==1){var e=W(this._private__canvasBinding.canvas);this._private__drawBackground(e,this._private__canvasBinding.pixelRatio),this._private__drawBorder(e,this._private__canvasBinding.pixelRatio),this._private__drawTickMarks(e,this._private__canvasBinding.pixelRatio),this._private__leftStub!==null&&this._private__leftStub._internal_paint(t),this._private__rightStub!==null&&this._private__rightStub._internal_paint(t)}var r=W(this._private__topCanvasBinding.canvas),a=this._private__topCanvasBinding.pixelRatio;r.clearRect(0,0,Math.ceil(this._private__size._internal_w*a),Math.ceil(this._private__size._internal_h*a)),this._private__drawLabels([this._private__chart._internal_model().crosshairSource()],r,a)}},i.prototype._private__drawBackground=function(t,e){var r=this;z(t,e,function(){At(t,0,0,r._private__size._internal_w,r._private__size._internal_h,r._private__chart._internal_model().backgroundBottomColor())})},i.prototype._private__drawBorder=function(t,e){if(this._private__chart._internal_options().timeScale.borderVisible){t.save(),t.fillStyle=this._private__lineColor();var r=Math.max(1,Math.floor(this._private__getRendererOptions().borderSize*e));t.fillRect(0,0,Math.ceil(this._private__size._internal_w*e),r),t.restore()}},i.prototype._private__drawTickMarks=function(t,e){var r=this,a=this._private__chart._internal_model().timeScale().marks();if(!(!a||a.length===0)){var _=a.reduce(a_,a[0]).weight;_>30&&_<50&&(_=30),t.save(),t.strokeStyle=this._private__lineColor();var n=this._private__getRendererOptions(),s=n.borderSize+n.tickLength+n.paddingTop+n.fontSize-n.baselineOffset;t.textAlign="center",t.fillStyle=this._private__lineColor();var o=Math.floor(this._private__getRendererOptions().borderSize*e),l=Math.max(1,Math.floor(e)),p=Math.floor(e*.5);if(this._private__chart._internal_model().timeScale().options().borderVisible){t.beginPath();for(var v=Math.round(n.tickLength*e),h=a.length;h--;){var c=Math.round(a[h].coord*e);t.rect(c-p,o,l,v)}t.fill()}t.fillStyle=this._private__textColor(),z(t,e,function(){t.font=r._private__baseFont();for(var u=0,f=a;u<f.length;u++){var d=f[u];if(d.weight<_){var m=d.needAlignCoordinate?r._private__alignTickMarkLabelCoordinate(t,d.coord,d.label):d.coord;t.fillText(d.label,m,s)}}t.font=r._private__baseBoldFont();for(var y=0,b=a;y<b.length;y++){var d=b[y];if(d.weight>=_){var m=d.needAlignCoordinate?r._private__alignTickMarkLabelCoordinate(t,d.coord,d.label):d.coord;t.fillText(d.label,m,s)}}}),t.restore()}},i.prototype._private__alignTickMarkLabelCoordinate=function(t,e,r){var a=this._private__widthCache.measureText(t,r),_=a/2,n=Math.floor(e-_)+.5;return n<0?e=e+Math.abs(0-n):n+a>this._private__size._internal_w&&(e=e-Math.abs(this._private__size._internal_w-(n+a))),e},i.prototype._private__drawLabels=function(t,e,r){for(var a=this._private__getRendererOptions(),_=0,n=t;_<n.length;_++)for(var s=n[_],o=0,l=s.timeAxisViews();o<l.length;o++){var p=l[o];e.save(),p.renderer().draw(e,a,r),e.restore()}},i.prototype._private__lineColor=function(){return this._private__chart._internal_options().timeScale.borderColor},i.prototype._private__textColor=function(){return this._private__options.textColor},i.prototype._private__fontSize=function(){return this._private__options.fontSize},i.prototype._private__baseFont=function(){return G(this._private__fontSize(),this._private__options.fontFamily)},i.prototype._private__baseBoldFont=function(){return G(this._private__fontSize(),this._private__options.fontFamily,"bold")},i.prototype._private__getRendererOptions=function(){this._private__rendererOptions===null&&(this._private__rendererOptions={borderSize:1,baselineOffset:NaN,paddingTop:NaN,paddingBottom:NaN,paddingHorizontal:NaN,tickLength:3,fontSize:NaN,font:"",widthCache:new rt});var t=this._private__rendererOptions,e=this._private__baseFont();if(t.font!==e){var r=this._private__fontSize();t.fontSize=r,t.font=e,t.paddingTop=Math.ceil(r/2.5),t.paddingBottom=t.paddingTop,t.paddingHorizontal=Math.ceil(r/2),t.baselineOffset=Math.round(this._private__fontSize()/5),t.widthCache.reset()}return this._private__rendererOptions},i.prototype._private__setCursor=function(t){this._private__cell.style.cursor=t===1?"ew-resize":"default"},i.prototype._private__recreateStubs=function(){var t=this._private__chart._internal_model(),e=t.options();!e.leftPriceScale.visible&&this._private__leftStub!==null&&(this._private__leftStubCell.removeChild(this._private__leftStub._internal_getElement()),this._private__leftStub.destroy(),this._private__leftStub=null),!e.rightPriceScale.visible&&this._private__rightStub!==null&&(this._private__rightStubCell.removeChild(this._private__rightStub._internal_getElement()),this._private__rightStub.destroy(),this._private__rightStub=null);var r=this._private__chart._internal_model().rendererOptionsProvider(),a={_internal_rendererOptionsProvider:r},_=function(){return e.leftPriceScale.borderVisible&&t.timeScale().options().borderVisible},n=function(){return t.backgroundBottomColor()};e.leftPriceScale.visible&&this._private__leftStub===null&&(this._private__leftStub=new qe("left",e,a,_,n),this._private__leftStubCell.appendChild(this._private__leftStub._internal_getElement())),e.rightPriceScale.visible&&this._private__rightStub===null&&(this._private__rightStub=new qe("right",e,a,_,n),this._private__rightStubCell.appendChild(this._private__rightStub._internal_getElement()))},i}(),n_=function(){function i(t,e){this._private__paneWidgets=[],this._private__drawRafId=0,this._private__height=0,this._private__width=0,this._private__leftPriceAxisWidth=0,this._private__rightPriceAxisWidth=0,this._private__invalidateMask=null,this._private__drawPlanned=!1,this._private__clicked=new M,this._private__crosshairMoved=new M,this._private__customPriceLineDragged=new M,this._private__options=e,this._private__element=document.createElement("div"),this._private__element.classList.add("tv-lightweight-charts"),this._private__element.style.overflow="hidden",this._private__element.style.width="100%",this._private__element.style.height="100%",s_(this._private__element),this._private__tableElement=document.createElement("table"),this._private__tableElement.setAttribute("cellspacing","0"),this._private__element.appendChild(this._private__tableElement),this._private__onWheelBound=this._private__onMousewheel.bind(this),this._private__element.addEventListener("wheel",this._private__onWheelBound,{passive:!1}),this._private__model=new ja(this._private__invalidateHandler.bind(this),this._private__options),this._internal_model().crosshairMoved().subscribe(this._private__onPaneWidgetCrosshairMoved.bind(this),this),this._internal_model().customPriceLineDragged().subscribe(this._private__onCustomPriceLineDragged.bind(this),this),this._private__timeAxisWidget=new __(this),this._private__tableElement.appendChild(this._private__timeAxisWidget._internal_getElement());var r=this._private__options.width,a=this._private__options.height;if(r===0||a===0){var _=t.getBoundingClientRect();r===0&&(r=Math.floor(_.width),r-=r%2),a===0&&(a=Math.floor(_.height),a-=a%2)}this._internal_resize(r,a),this._private__syncGuiWithModel(),t.appendChild(this._private__element),this._private__updateTimeAxisVisibility(),this._private__model.timeScale().optionsApplied().subscribe(this._private__model.fullUpdate.bind(this._private__model),this),this._private__model.priceScalesOptionsChanged().subscribe(this._private__model.fullUpdate.bind(this._private__model),this)}return i.prototype._internal_model=function(){return this._private__model},i.prototype._internal_options=function(){return this._private__options},i.prototype._internal_paneWidgets=function(){return this._private__paneWidgets},i.prototype._internal_timeAxisWidget=function(){return this._private__timeAxisWidget},i.prototype.destroy=function(){this._private__element.removeEventListener("wheel",this._private__onWheelBound),this._private__drawRafId!==0&&window.cancelAnimationFrame(this._private__drawRafId),this._private__model.crosshairMoved().unsubscribeAll(this),this._private__model.customPriceLineDragged().unsubscribeAll(this),this._private__model.timeScale().optionsApplied().unsubscribeAll(this),this._private__model.priceScalesOptionsChanged().unsubscribeAll(this),this._private__model.destroy();for(var t=0,e=this._private__paneWidgets;t<e.length;t++){var r=e[t];this._private__tableElement.removeChild(r._internal_getElement()),r._internal_clicked().unsubscribeAll(this),r.destroy()}this._private__paneWidgets=[],g(this._private__timeAxisWidget).destroy(),this._private__element.parentElement!==null&&this._private__element.parentElement.removeChild(this._private__element),this._private__crosshairMoved._internal_destroy(),this._private__clicked._internal_destroy()},i.prototype._internal_resize=function(t,e,r){if(r===void 0&&(r=!1),!(this._private__height===e&&this._private__width===t)){this._private__height=e,this._private__width=t;var a=e+"px",_=t+"px";g(this._private__element).style.height=a,g(this._private__element).style.width=_,this._private__tableElement.style.height=a,this._private__tableElement.style.width=_,r?this._private__drawImpl(new A(3)):this._private__model.fullUpdate()}},i.prototype._internal_paint=function(t){t===void 0&&(t=new A(3));for(var e=0;e<this._private__paneWidgets.length;e++)this._private__paneWidgets[e]._internal_paint(t.invalidateForPane(e).level);this._private__options.timeScale.visible&&this._private__timeAxisWidget._internal_paint(t.fullInvalidation())},i.prototype._internal_applyOptions=function(t){this._private__model.applyOptions(t),this._private__updateTimeAxisVisibility();var e=t.width||this._private__width,r=t.height||this._private__height;this._internal_resize(e,r)},i.prototype._internal_clicked=function(){return this._private__clicked},i.prototype._internal_crosshairMoved=function(){return this._private__crosshairMoved},i.prototype._internal_customPriceLineDragged=function(){return this._private__customPriceLineDragged},i.prototype._internal_takeScreenshot=function(){var t=this;this._private__invalidateMask!==null&&(this._private__drawImpl(this._private__invalidateMask),this._private__invalidateMask=null);var e=this._private__paneWidgets[0],r=Ri(document,new D(this._private__width,this._private__height)),a=W(r),_=Dt(r);return z(a,_,function(){var n=0,s=0,o=function(f){for(var d=0;d<t._private__paneWidgets.length;d++){var m=t._private__paneWidgets[d],y=m._internal_getSize()._internal_h,b=g(f==="left"?m._internal_leftPriceAxisWidget():m._internal_rightPriceAxisWidget()),C=b._internal_getImage();a.drawImage(C,n,s,b._internal_getWidth(),y),s+=y}};t._private__isLeftAxisVisible()&&(o("left"),n=g(e._internal_leftPriceAxisWidget())._internal_getWidth()),s=0;for(var l=0;l<t._private__paneWidgets.length;l++){var p=t._private__paneWidgets[l],v=p._internal_getSize(),h=p._internal_getImage();a.drawImage(h,n,s,v._internal_w,v._internal_h),s+=v._internal_h}n+=e._internal_getSize()._internal_w,t._private__isRightAxisVisible()&&(s=0,o("right"));var c=function(f){var d=g(f==="left"?t._private__timeAxisWidget._internal_leftStub():t._private__timeAxisWidget._internal_rightStub()),m=d._internal_getSize(),y=d._internal_getImage();a.drawImage(y,n,s,m._internal_w,m._internal_h)};if(t._private__options.timeScale.visible){n=0,t._private__isLeftAxisVisible()&&(c("left"),n=g(e._internal_leftPriceAxisWidget())._internal_getWidth());var u=t._private__timeAxisWidget._internal_getSize(),h=t._private__timeAxisWidget._internal_getImage();a.drawImage(h,n,s,u._internal_w,u._internal_h),t._private__isRightAxisVisible()&&(n+=e._internal_getSize()._internal_w,c("right"),a.restore())}}),r},i.prototype._internal_getPriceAxisWidth=function(t){if(t==="none"||t==="left"&&!this._private__isLeftAxisVisible()||t==="right"&&!this._private__isRightAxisVisible()||this._private__paneWidgets.length===0)return 0;var e=t==="left"?this._private__paneWidgets[0]._internal_leftPriceAxisWidget():this._private__paneWidgets[0]._internal_rightPriceAxisWidget();return g(e)._internal_getWidth()},i.prototype._private__adjustSizeImpl=function(){for(var t=0,e=0,r=0,a=0,_=this._private__paneWidgets;a<_.length;a++){var n=_[a];this._private__isLeftAxisVisible()&&(e=Math.max(e,g(n._internal_leftPriceAxisWidget())._internal_optimalWidth())),this._private__isRightAxisVisible()&&(r=Math.max(r,g(n._internal_rightPriceAxisWidget())._internal_optimalWidth())),t+=n._internal_stretchFactor()}var s=this._private__width,o=this._private__height,l=Math.max(s-e-r,0),p=0,v=this._private__options.timeScale.visible,h=v?this._private__timeAxisWidget._internal_optimalHeight():0;h%2&&(h+=1);for(var c=p+h,u=o<c?0:o-c,f=u/t,d=0,m=0;m<this._private__paneWidgets.length;++m){var n=this._private__paneWidgets[m];n._internal_setState(this._private__model.panes()[m]);var y=0,b=0;m===this._private__paneWidgets.length-1?b=u-d:b=Math.round(n._internal_stretchFactor()*f),y=Math.max(b,2),d+=y,n._internal_setSize(new D(l,y)),this._private__isLeftAxisVisible()&&n._internal_setPriceAxisSize(e,"left"),this._private__isRightAxisVisible()&&n._internal_setPriceAxisSize(r,"right"),n._internal_state()&&this._private__model.setPaneHeight(n._internal_state(),y)}this._private__timeAxisWidget._internal_setSizes(new D(v?l:0,h),v?e:0,v?r:0),this._private__model.setWidth(l),this._private__leftPriceAxisWidth!==e&&(this._private__leftPriceAxisWidth=e),this._private__rightPriceAxisWidth!==r&&(this._private__rightPriceAxisWidth=r)},i.prototype._private__onMousewheel=function(t){var e=t.deltaX/100,r=-(t.deltaY/100);if(!((e===0||!this._private__options.handleScroll.mouseWheel)&&(r===0||!this._private__options.handleScale.mouseWheel))){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120,r*=120;break;case t.DOM_DELTA_LINE:e*=32,r*=32;break}if(r!==0&&this._private__options.handleScale.mouseWheel){var a=Math.sign(r)*Math.min(1,Math.abs(r)),_=t.clientX-this._private__element.getBoundingClientRect().left;this._internal_model().zoomTime(_,a)}e!==0&&this._private__options.handleScroll.mouseWheel&&this._internal_model().scrollChart(e*-80)}},i.prototype._private__drawImpl=function(t){var e,r=t.fullInvalidation();r===3&&this._private__updateGui(),(r===3||r===2)&&(this._private__applyMomentaryAutoScale(t),this._private__applyTimeScaleInvalidations(t),this._private__timeAxisWidget._internal_update(),this._private__paneWidgets.forEach(function(a){a._internal_updatePriceAxisWidgets()}),((e=this._private__invalidateMask)===null||e===void 0?void 0:e.fullInvalidation())===3&&(this._private__invalidateMask.merge(t),this._private__updateGui(),this._private__applyMomentaryAutoScale(this._private__invalidateMask),this._private__applyTimeScaleInvalidations(this._private__invalidateMask),t=this._private__invalidateMask,this._private__invalidateMask=null)),this._internal_paint(t)},i.prototype._private__applyTimeScaleInvalidations=function(t){for(var e=t.timeScaleInvalidations(),r=0,a=e;r<a.length;r++){var _=a[r];this._private__applyTimeScaleInvalidation(_)}},i.prototype._private__applyMomentaryAutoScale=function(t){for(var e=this._private__model.panes(),r=0;r<e.length;r++)t.invalidateForPane(r).autoScale&&e[r].momentaryAutoScale()},i.prototype._private__applyTimeScaleInvalidation=function(t){var e=this._private__model.timeScale();switch(t.type){case 0:e.fitContent();break;case 1:e.setLogicalRange(t.value);break;case 2:e.setBarSpacing(t.value);break;case 3:e.setRightOffset(t.value);break;case 4:e.restoreDefault();break}},i.prototype._private__invalidateHandler=function(t){var e=this;this._private__invalidateMask!==null?this._private__invalidateMask.merge(t):this._private__invalidateMask=t,this._private__drawPlanned||(this._private__drawPlanned=!0,this._private__drawRafId=window.requestAnimationFrame(function(){if(e._private__drawPlanned=!1,e._private__drawRafId=0,e._private__invalidateMask!==null){var r=e._private__invalidateMask;e._private__invalidateMask=null,e._private__drawImpl(r)}}))},i.prototype._private__updateGui=function(){this._private__syncGuiWithModel()},i.prototype._private__syncGuiWithModel=function(){for(var t=this._private__model.panes(),e=t.length,r=this._private__paneWidgets.length,a=e;a<r;a++){var _=E(this._private__paneWidgets.pop());this._private__tableElement.removeChild(_._internal_getElement()),_._internal_clicked().unsubscribeAll(this),_.destroy()}for(var a=r;a<e;a++){var _=new r_(this,t[a]);_._internal_clicked().subscribe(this._private__onPaneWidgetClicked.bind(this),this),this._private__paneWidgets.push(_),this._private__tableElement.insertBefore(_._internal_getElement(),this._private__timeAxisWidget._internal_getElement())}for(var a=0;a<e;a++){var n=t[a],_=this._private__paneWidgets[a];_._internal_state()!==n?_._internal_setState(n):_._internal_updatePriceAxisWidgetsStates()}this._private__updateTimeAxisVisibility(),this._private__adjustSizeImpl()},i.prototype._private__getMouseEventParamsImpl=function(t,e){var r=new Map;if(t!==null){var a=this._private__model.serieses();a.forEach(function(p){var v=p.dataAt(t);v!==null&&r.set(p,v)})}var _;if(t!==null){var n=this._private__model.timeScale().indexToTime(t);n!==null&&(_=n)}var s=this._internal_model().hoveredSource(),o=s!==null&&s.source instanceof It?s.source:void 0,l=s!==null&&s.object!==void 0?s.object.externalId:void 0;return{_internal_time:_,_internal_point:e||void 0,_internal_hoveredSeries:o,_internal_seriesPrices:r,_internal_hoveredObject:l}},i.prototype._private__getCustomPriceLineDraggedEventParamsImpl=function(t,e){return{_internal_customPriceLine:t,_internal_fromPriceString:e}},i.prototype._private__onPaneWidgetClicked=function(t,e){var r=this;this._private__clicked._internal_fire(function(){return r._private__getMouseEventParamsImpl(t,e)})},i.prototype._private__onPaneWidgetCrosshairMoved=function(t,e){var r=this;this._private__crosshairMoved._internal_fire(function(){return r._private__getMouseEventParamsImpl(t,e)})},i.prototype._private__onCustomPriceLineDragged=function(t,e){var r=this;this._private__customPriceLineDragged._internal_fire(function(){return r._private__getCustomPriceLineDraggedEventParamsImpl(t,e)})},i.prototype._private__updateTimeAxisVisibility=function(){var t=this._private__options.timeScale.visible?"":"none";this._private__timeAxisWidget._internal_getElement().style.display=t},i.prototype._private__isLeftAxisVisible=function(){return this._private__paneWidgets[0]._internal_state().leftPriceScale().options().visible},i.prototype._private__isRightAxisVisible=function(){return this._private__paneWidgets[0]._internal_state().rightPriceScale().options().visible},i}();function s_(i){i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.msUserSelect="none",i.style.MozUserSelect="none",i.style.webkitTapHighlightColor="transparent"}function Di(i){console.warn(i)}function Ge(i,t,e){var r=e.value;return{index:t,time:i,value:[r,r,r,r]}}function je(i,t,e){var r=e.value,a={index:t,time:i,value:[r,r,r,r]};return"color"in e&&e.color!==void 0&&(a.color=e.color),a}function o_(i,t,e){var r={index:t,time:i,value:[e.open,e.high,e.low,e.close]};return"color"in e&&e.color!==void 0&&(r.color=e.color),r}function l_(i,t,e){var r={index:t,time:i,value:[e.open,e.high,e.low,e.close]};return"color"in e&&e.color!==void 0&&(r.color=e.color),"borderColor"in e&&e.borderColor!==void 0&&(r.borderColor=e.borderColor),"wickColor"in e&&e.wickColor!==void 0&&(r.wickColor=e.wickColor),r}function St(i){return i.value!==void 0}function $(i){return function(t,e,r){return Za(r)?{time:t,index:e}:i(t,e,r)}}var p_={Candlestick:$(l_),Bar:$(o_),Area:$(Ge),Baseline:$(Ge),Histogram:$(je),Line:$(je)};function Ke(i){return p_[i]}function wt(i){return i*60*60*1e3}function Kt(i){return i*60*1e3}function v_(i){return i*1e3}var Ct=[{_internal_divisor:v_(1),_internal_weight:10},{_internal_divisor:Kt(1),_internal_weight:20},{_internal_divisor:Kt(5),_internal_weight:21},{_internal_divisor:Kt(30),_internal_weight:22},{_internal_divisor:wt(1),_internal_weight:30},{_internal_divisor:wt(3),_internal_weight:31},{_internal_divisor:wt(6),_internal_weight:32},{_internal_divisor:wt(12),_internal_weight:33}];function Ze(i,t){if(i.getUTCFullYear()!==t.getUTCFullYear())return 70;if(i.getUTCMonth()!==t.getUTCMonth())return 60;if(i.getUTCDate()!==t.getUTCDate())return 50;for(var e=Ct.length-1;e>=0;--e)if(Math.floor(t.getTime()/Ct[e]._internal_divisor)!==Math.floor(i.getTime()/Ct[e]._internal_divisor))return Ct[e]._internal_weight;return 0}function $e(i,t){if(t===void 0&&(t=0),i.length!==0){for(var e=t===0?null:i[t-1].time.timestamp,r=e!==null?new Date(e*1e3):null,a=0,_=t;_<i.length;++_){var n=i[_],s=new Date(n.time.timestamp*1e3);r!==null&&(n.timeWeight=Ze(s,r)),a+=n.time.timestamp-(e||n.time.timestamp),e=n.time.timestamp,r=s}if(t===0&&i.length>1){var o=Math.ceil(a/(i.length-1)),l=new Date((i[0].time.timestamp-o)*1e3);i[0].timeWeight=Ze(new Date(i[0].time.timestamp*1e3),l)}}}function te(i){if(!le(i))throw new Error("time must be of type BusinessDay");var t=new Date(Date.UTC(i.year,i.month-1,i.day,0,0,0,0));return{timestamp:Math.round(t.getTime()/1e3),businessDay:i}}function Li(i){if(!Ti(i))throw new Error("time must be of type isUTCTimestamp");return{timestamp:i}}function Qe(i){return i.length===0?null:le(i[0].time)?te:Li}function it(i){return Ti(i)?Li(i):le(i)?te(i):te(xi(i))}var h_=/^\d\d\d\d-\d\d-\d\d$/;function xi(i){if(!h_.test(i))throw new Error("Invalid date string=".concat(i,", expected format=yyyy-mm-dd"));var t=new Date(i);if(isNaN(t.getTime()))throw new Error("Invalid date string=".concat(i,", expected format=yyyy-mm-dd"));return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function Ai(i){ee(i.time)&&(i.time=xi(i.time))}function c_(i){return i.forEach(Ai)}function Je(i){return{_internal_index:0,_internal_mapping:new Map,_internal_timePoint:i}}function ti(i){if(!(i===void 0||i.length===0))return{_internal_firstTime:i[0].time.timestamp,_internal_lastTime:i[i.length-1].time.timestamp}}function u_(i,t){var e=ti(i),r=ti(t);if(e!==void 0&&r!==void 0)return{lastBarUpdatedOrNewBarsAddedToTheRight:e._internal_lastTime>=r._internal_lastTime&&e._internal_firstTime>=r._internal_firstTime}}var d_=function(){function i(){this._private__pointDataByTimePoint=new Map,this._private__seriesRowsBySeries=new Map,this._private__seriesLastTimePoint=new Map,this._private__sortedTimePoints=[]}return i.prototype._internal_destroy=function(){this._private__pointDataByTimePoint.clear(),this._private__seriesRowsBySeries.clear(),this._private__seriesLastTimePoint.clear(),this._private__sortedTimePoints=[]},i.prototype._internal_setSeriesData=function(t,e){var r=this,a=this._private__pointDataByTimePoint.size!==0,_=!1,n=this._private__seriesRowsBySeries.get(t);if(n!==void 0)if(this._private__seriesRowsBySeries.size===1)a=!1,_=!0,this._private__pointDataByTimePoint.clear();else for(var s=0,o=this._private__sortedTimePoints;s<o.length;s++){var l=o[s];l.pointData._internal_mapping.delete(t)&&(_=!0)}var p=[];if(e.length!==0){c_(e);var v=g(Qe(e)),h=Ke(t.seriesType());p=e.map(function(f){var d=v(f.time),m=r._private__pointDataByTimePoint.get(d.timestamp);m===void 0&&(m=Je(d),r._private__pointDataByTimePoint.set(d.timestamp,m),_=!0);var y=h(d,m._internal_index,f);return m._internal_mapping.set(t,y),y})}a&&this._private__cleanupPointsData(),this._private__setRowsToSeries(t,p);var c=-1;if(_){var u=[];this._private__pointDataByTimePoint.forEach(function(f){u.push({timeWeight:0,time:f._internal_timePoint,pointData:f})}),u.sort(function(f,d){return f.time.timestamp-d.time.timestamp}),c=this._private__replaceTimeScalePoints(u)}return this._private__getUpdateResponse(t,c,u_(this._private__seriesRowsBySeries.get(t),n))},i.prototype._internal_removeSeries=function(t){return this._internal_setSeriesData(t,[])},i.prototype._internal_updateSeriesData=function(t,e){Ai(e);var r=g(Qe([e]))(e.time),a=this._private__seriesLastTimePoint.get(t);if(a!==void 0&&r.timestamp<a.timestamp)throw new Error("Cannot update oldest data, last time=".concat(a.timestamp,", new time=").concat(r.timestamp));var _=this._private__pointDataByTimePoint.get(r.timestamp),n=_===void 0;_===void 0&&(_=Je(r),this._private__pointDataByTimePoint.set(r.timestamp,_));var s=Ke(t.seriesType()),o=s(r,_._internal_index,e);_._internal_mapping.set(t,o),this._private__updateLastSeriesRow(t,o);var l={lastBarUpdatedOrNewBarsAddedToTheRight:St(o)};if(!n)return this._private__getUpdateResponse(t,-1,l);var p={timeWeight:0,time:_._internal_timePoint,pointData:_},v=ct(this._private__sortedTimePoints,p.time.timestamp,function(c,u){return c.time.timestamp<u});this._private__sortedTimePoints.splice(v,0,p);for(var h=v;h<this._private__sortedTimePoints.length;++h)Zt(this._private__sortedTimePoints[h].pointData,h);return $e(this._private__sortedTimePoints,v),this._private__getUpdateResponse(t,v,l)},i.prototype._private__updateLastSeriesRow=function(t,e){var r=this._private__seriesRowsBySeries.get(t);r===void 0&&(r=[],this._private__seriesRowsBySeries.set(t,r));var a=r.length!==0?r[r.length-1]:null;a===null||e.time.timestamp>a.time.timestamp?St(e)&&r.push(e):St(e)?r[r.length-1]=e:r.splice(-1,1),this._private__seriesLastTimePoint.set(t,e.time)},i.prototype._private__setRowsToSeries=function(t,e){e.length!==0?(this._private__seriesRowsBySeries.set(t,e.filter(St)),this._private__seriesLastTimePoint.set(t,e[e.length-1].time)):(this._private__seriesRowsBySeries.delete(t),this._private__seriesLastTimePoint.delete(t))},i.prototype._private__cleanupPointsData=function(){for(var t=0,e=this._private__sortedTimePoints;t<e.length;t++){var r=e[t];r.pointData._internal_mapping.size===0&&this._private__pointDataByTimePoint.delete(r.time.timestamp)}},i.prototype._private__replaceTimeScalePoints=function(t){for(var e=-1,r=0;r<this._private__sortedTimePoints.length&&r<t.length;++r){var a=this._private__sortedTimePoints[r],_=t[r];if(a.time.timestamp!==_.time.timestamp){e=r;break}_.timeWeight=a.timeWeight,Zt(_.pointData,r)}if(e===-1&&this._private__sortedTimePoints.length!==t.length&&(e=Math.min(this._private__sortedTimePoints.length,t.length)),e===-1)return-1;for(var r=e;r<t.length;++r)Zt(t[r].pointData,r);return $e(t,e),this._private__sortedTimePoints=t,e},i.prototype._private__getBaseIndex=function(){if(this._private__seriesRowsBySeries.size===0)return null;var t=0;return this._private__seriesRowsBySeries.forEach(function(e){e.length!==0&&(t=Math.max(t,e[e.length-1].index))}),t},i.prototype._private__getUpdateResponse=function(t,e,r){var a={_internal_series:new Map,_internal_timeScale:{_internal_baseIndex:this._private__getBaseIndex()}};if(e!==-1)this._private__seriesRowsBySeries.forEach(function(n,s){a._internal_series.set(s,{_internal_data:n,_internal_info:s===t?r:void 0})}),this._private__seriesRowsBySeries.has(t)||a._internal_series.set(t,{_internal_data:[],_internal_info:r}),a._internal_timeScale._internal_points=this._private__sortedTimePoints,a._internal_timeScale._internal_firstChangedPointIndex=e;else{var _=this._private__seriesRowsBySeries.get(t);a._internal_series.set(t,{_internal_data:_||[],_internal_info:r})}return a},i}();function Zt(i,t){i._internal_index=t,i._internal_mapping.forEach(function(e){e.index=t})}function f_(i){x(typeof i.price=="number","the type of 'price' price line's property must be a number, got '".concat(typeof i.price,"'"))}function ei(i,t){if(t===void 0&&(t=!1),i.length!==0)for(var e=it(i[0].time).timestamp,r=1;r<i.length;++r){var a=it(i[r].time).timestamp,_=t?e<=a:e<a;x(_,"data must be asc ordered by time, index=".concat(r,", time=").concat(a,", prev time=").concat(e)),e=a}}function ii(i,t){t.forEach(m_(i))}function m_(i){switch(i){case"Bar":case"Candlestick":return g_.bind(null,i);case"Area":case"Baseline":case"Line":case"Histogram":return y_.bind(null,i)}}function g_(i,t){ki(t)&&(x(typeof t.open=="number","".concat(i," series item data value of open must be a number, got=").concat(typeof t.open,", value=").concat(t.open)),x(typeof t.high=="number","".concat(i," series item data value of high must be a number, got=").concat(typeof t.high,", value=").concat(t.high)),x(typeof t.low=="number","".concat(i," series item data value of low must be a number, got=").concat(typeof t.low,", value=").concat(t.low)),x(typeof t.close=="number","".concat(i," series item data value of close must be a number, got=").concat(typeof t.close,", value=").concat(t.close)))}function y_(i,t){ki(t)&&x(typeof t.value=="number","".concat(i," series item data value must be a number, got=").concat(typeof t.value,", value=").concat(t.value))}var b_={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",draggable:!1},S_=function(){function i(t){this._private__priceLine=t}return i.prototype.applyOptions=function(t){this._private__priceLine.applyOptions(t)},i.prototype.options=function(){return this._private__priceLine.options()},i.prototype._internal_priceLine=function(){return this._private__priceLine},i}();function X(i){var t=i.overlay,e=er(i,["overlay"]);return t&&(e.priceScaleId=""),e}var tt=function(){function i(t,e,r){this._internal__series=t,this._internal__dataUpdatesConsumer=e,this._private__priceScaleApiProvider=r}return i.prototype.priceFormatter=function(){return this._internal__series.formatter()},i.prototype.priceToCoordinate=function(t){var e=this._internal__series.firstValue();return e===null?null:this._internal__series.priceScale().priceToCoordinate(t,e.value)},i.prototype.coordinateToPrice=function(t){var e=this._internal__series.firstValue();return e===null?null:this._internal__series.priceScale().coordinateToPrice(t,e.value)},i.prototype.barsInLogicalRange=function(t){if(t===null)return null;var e=new Pt(new lt(t.from,t.to))._internal_strictRange(),r=this._internal__series.bars();if(r.isEmpty())return null;var a=r.search(e.left(),1),_=r.search(e.right(),-1),n=g(r.firstIndex()),s=g(r.lastIndex());if(a!==null&&_!==null&&a.index>_.index)return{barsBefore:t.from-n,barsAfter:s-t.to};var o=a===null||a.index===n?t.from-n:a.index-n,l=_===null||_.index===s?s-t.to:s-_.index,p={barsBefore:o,barsAfter:l};return a!==null&&_!==null&&(p.from=a.time.businessDay||a.time.timestamp,p.to=_.time.businessDay||_.time.timestamp),p},i.prototype.setData=function(t){ei(t),ii(this._internal__series.seriesType(),t),this._internal__dataUpdatesConsumer._internal_applyNewData(this._internal__series,t)},i.prototype.update=function(t){ii(this._internal__series.seriesType(),[t]),this._internal__dataUpdatesConsumer._internal_updateData(this._internal__series,t)},i.prototype.setMarkers=function(t){ei(t,!0);var e=t.map(function(r){return P(P({},r),{time:it(r.time)})});this._internal__series.setMarkers(e)},i.prototype.applyOptions=function(t){var e=X(t);this._internal__series.applyOptions(e)},i.prototype.options=function(){return L(this._internal__series.options())},i.prototype.priceScale=function(){return this._private__priceScaleApiProvider.priceScale(this._internal__series.priceScale().id())},i.prototype.createPriceLine=function(t){f_(t);var e=R(L(b_),t),r=this._internal__series.createPriceLine(e);return new S_(r)},i.prototype.removePriceLine=function(t){this._internal__series.removePriceLine(t._internal_priceLine())},i.prototype.seriesType=function(){return this._internal__series.seriesType()},i}(),w_=function(i){w(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.applyOptions=function(e){Mi(e),i.prototype.applyOptions.call(this,e)},t}(tt),C_={vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},P_={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},M_={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:ie},$t={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},T_={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},k_={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:ie,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},ri={width:0,height:0,layout:M_,crosshair:C_,grid:P_,overlayPriceScales:P({},$t),leftPriceScale:P(P({},$t),{visible:!1}),rightPriceScale:P(P({},$t),{visible:!0}),timeScale:T_,watermark:k_,localization:{locale:Bt?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},R_={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},D_={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},L_={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},x_={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},A_={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},V_={color:"#26a69a",base:0},Q={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},E_=function(){function i(t,e){this._private__chartWidget=t,this._private__priceScaleId=e}return i.prototype.applyOptions=function(t){this._private__chartWidget._internal_model().applyPriceScaleOptions(this._private__priceScaleId,t)},i.prototype.options=function(){return this._private__priceScale().options()},i.prototype.width=function(){return Vt(this._private__priceScaleId)?this._private__chartWidget._internal_getPriceAxisWidth(this._private__priceScaleId==="left"?"left":"right"):0},i.prototype.formatPrice=function(t,e){return e===void 0&&(e=0),this._private__priceScale().formatPrice(t,e)},i.prototype._private__priceScale=function(){return g(this._private__chartWidget._internal_model().findPriceScale(this._private__priceScaleId)).priceScale},i}(),I_=function(){function i(t,e){this._private__timeRangeChanged=new M,this._private__logicalRangeChanged=new M,this._private__sizeChanged=new M,this._private__model=t,this._private__timeScale=t.timeScale(),this._private__timeAxisWidget=e,this._private__timeScale.visibleBarsChanged().subscribe(this._private__onVisibleBarsChanged.bind(this)),this._private__timeScale.logicalRangeChanged().subscribe(this._private__onVisibleLogicalRangeChanged.bind(this)),this._private__timeAxisWidget._internal_sizeChanged().subscribe(this._private__onSizeChanged.bind(this))}return i.prototype.destroy=function(){this._private__timeScale.visibleBarsChanged().unsubscribeAll(this),this._private__timeScale.logicalRangeChanged().unsubscribeAll(this),this._private__timeAxisWidget._internal_sizeChanged().unsubscribeAll(this),this._private__timeRangeChanged._internal_destroy(),this._private__logicalRangeChanged._internal_destroy(),this._private__sizeChanged._internal_destroy()},i.prototype.scrollPosition=function(){return this._private__timeScale.rightOffset()},i.prototype.scrollToPosition=function(t,e){if(!e){this._private__model.setRightOffset(t);return}this._private__timeScale.scrollToOffsetAnimated(t,1e3)},i.prototype.scrollToRealTime=function(){this._private__timeScale.scrollToRealTime()},i.prototype.getVisibleRange=function(){var t,e,r=this._private__timeScale.visibleTimeRange();return r===null?null:{from:(t=r.from.businessDay)!==null&&t!==void 0?t:r.from.timestamp,to:(e=r.to.businessDay)!==null&&e!==void 0?e:r.to.timestamp}},i.prototype.setVisibleRange=function(t){var e={from:it(t.from),to:it(t.to)},r=this._private__timeScale.logicalRangeForTimeRange(e);this._private__model.setTargetLogicalRange(r)},i.prototype.getVisibleLogicalRange=function(){var t=this._private__timeScale.visibleLogicalRange();return t===null?null:{from:t.left(),to:t.right()}},i.prototype.setVisibleLogicalRange=function(t){x(t.from<=t.to,"The from index cannot be after the to index."),this._private__model.setTargetLogicalRange(t)},i.prototype.resetTimeScale=function(){this._private__model.resetTimeScale()},i.prototype.fitContent=function(){this._private__model.fitContent()},i.prototype.logicalToCoordinate=function(t){var e=this._private__model.timeScale();return e.isEmpty()?null:e.indexToCoordinate(t)},i.prototype.coordinateToLogical=function(t){return this._private__timeScale.isEmpty()?null:this._private__timeScale.coordinateToIndex(t)},i.prototype.timeToCoordinate=function(t){var e=it(t),r=this._private__timeScale.timeToIndex(e,!1);return r===null?null:this._private__timeScale.indexToCoordinate(r)},i.prototype.coordinateToTime=function(t){var e,r=this._private__model.timeScale(),a=r.coordinateToIndex(t),_=r.indexToTime(a);return _===null?null:(e=_.businessDay)!==null&&e!==void 0?e:_.timestamp},i.prototype.width=function(){return this._private__timeAxisWidget._internal_getSize()._internal_w},i.prototype.height=function(){return this._private__timeAxisWidget._internal_getSize()._internal_h},i.prototype.subscribeVisibleTimeRangeChange=function(t){this._private__timeRangeChanged.subscribe(t)},i.prototype.unsubscribeVisibleTimeRangeChange=function(t){this._private__timeRangeChanged.unsubscribe(t)},i.prototype.subscribeVisibleLogicalRangeChange=function(t){this._private__logicalRangeChanged.subscribe(t)},i.prototype.unsubscribeVisibleLogicalRangeChange=function(t){this._private__logicalRangeChanged.unsubscribe(t)},i.prototype.subscribeSizeChange=function(t){this._private__sizeChanged.subscribe(t)},i.prototype.unsubscribeSizeChange=function(t){this._private__sizeChanged.unsubscribe(t)},i.prototype.applyOptions=function(t){this._private__timeScale.applyOptions(t)},i.prototype.options=function(){return L(this._private__timeScale.options())},i.prototype._private__onVisibleBarsChanged=function(){this._private__timeRangeChanged._internal_hasListeners()&&this._private__timeRangeChanged._internal_fire(this.getVisibleRange())},i.prototype._private__onVisibleLogicalRangeChanged=function(){this._private__logicalRangeChanged._internal_hasListeners()&&this._private__logicalRangeChanged._internal_fire(this.getVisibleLogicalRange())},i.prototype._private__onSizeChanged=function(t){this._private__sizeChanged._internal_fire(t._internal_w,t._internal_h)},i}();function J(i){if(!(i===void 0||i.type==="custom")){var t=i;t.minMove!==void 0&&t.precision===void 0&&(t.precision=Ka(t.minMove))}}function B_(i){if(Ft(i.handleScale)){var t=i.handleScale;i.handleScale={axisDoubleClickReset:t,axisPressedMouseMove:{time:t,price:t},mouseWheel:t,pinch:t}}else if(i.handleScale!==void 0&&Ft(i.handleScale.axisPressedMouseMove)){var e=i.handleScale.axisPressedMouseMove;i.handleScale.axisPressedMouseMove={time:e,price:e}}var r=i.handleScroll;Ft(r)&&(i.handleScroll={horzTouchDrag:r,vertTouchDrag:r,mouseWheel:r,pressedMouseMove:r})}function O_(i){if(i.priceScale){Di('"priceScale" option has been deprecated, use "leftPriceScale", "rightPriceScale" and "overlayPriceScales" instead'),i.leftPriceScale=i.leftPriceScale||{},i.rightPriceScale=i.rightPriceScale||{};var t=i.priceScale.position;delete i.priceScale.position,i.leftPriceScale=R(i.leftPriceScale,i.priceScale),i.rightPriceScale=R(i.rightPriceScale,i.priceScale),t==="left"&&(i.leftPriceScale.visible=!0,i.rightPriceScale.visible=!1),t==="right"&&(i.leftPriceScale.visible=!1,i.rightPriceScale.visible=!0),t==="none"&&(i.leftPriceScale.visible=!1,i.rightPriceScale.visible=!1),i.overlayPriceScales=i.overlayPriceScales||{},i.priceScale.invertScale!==void 0&&(i.overlayPriceScales.invertScale=i.priceScale.invertScale),i.priceScale.scaleMargins!==void 0&&(i.overlayPriceScales.scaleMargins=i.priceScale.scaleMargins)}}function W_(i){i.layout&&i.layout.backgroundColor&&!i.layout.background&&(i.layout.background={type:"solid",color:i.layout.backgroundColor})}function ai(i){return B_(i),O_(i),W_(i),i}var z_=function(){function i(t,e){var r=this;this._private__dataLayer=new d_,this._private__seriesMap=new Map,this._private__seriesMapReversed=new Map,this._private__clickedDelegate=new M,this._private__crosshairMovedDelegate=new M,this._private__customPriceLineDraggedDelegate=new M;var a=e===void 0?L(ri):R(L(ri),ai(e));this._private__chartWidget=new n_(t,a),this._private__chartWidget._internal_clicked().subscribe(function(n){r._private__clickedDelegate._internal_hasListeners()&&r._private__clickedDelegate._internal_fire(r._private__convertMouseParams(n()))},this),this._private__chartWidget._internal_crosshairMoved().subscribe(function(n){r._private__crosshairMovedDelegate._internal_hasListeners()&&r._private__crosshairMovedDelegate._internal_fire(r._private__convertMouseParams(n()))},this),this._private__chartWidget._internal_customPriceLineDragged().subscribe(function(n){r._private__customPriceLineDraggedDelegate._internal_hasListeners()&&r._private__customPriceLineDraggedDelegate._internal_fire(r._private__convertCustomPriceLineDraggedParams(n()))},this);var _=this._private__chartWidget._internal_model();this._private__timeScaleApi=new I_(_,this._private__chartWidget._internal_timeAxisWidget())}return i.prototype.remove=function(){this._private__chartWidget._internal_clicked().unsubscribeAll(this),this._private__chartWidget._internal_crosshairMoved().unsubscribeAll(this),this._private__chartWidget._internal_customPriceLineDragged().unsubscribeAll(this),this._private__timeScaleApi.destroy(),this._private__chartWidget.destroy(),this._private__seriesMap.clear(),this._private__seriesMapReversed.clear(),this._private__clickedDelegate._internal_destroy(),this._private__crosshairMovedDelegate._internal_destroy(),this._private__customPriceLineDraggedDelegate._internal_destroy(),this._private__dataLayer._internal_destroy()},i.prototype.resize=function(t,e,r){this._private__chartWidget._internal_resize(t,e,r)},i.prototype.addAreaSeries=function(t){t===void 0&&(t={}),t=X(t),J(t.priceFormat);var e=R(L(Q),x_,t),r=this._private__chartWidget._internal_model().createSeries("Area",e),a=new tt(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.addBaselineSeries=function(t){t===void 0&&(t={}),t=X(t),J(t.priceFormat);var e=R(L(Q),L(A_),t),r=this._private__chartWidget._internal_model().createSeries("Baseline",e),a=new tt(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.addBarSeries=function(t){t===void 0&&(t={}),t=X(t),J(t.priceFormat);var e=R(L(Q),D_,t),r=this._private__chartWidget._internal_model().createSeries("Bar",e),a=new tt(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.addCandlestickSeries=function(t){t===void 0&&(t={}),t=X(t),Mi(t),J(t.priceFormat);var e=R(L(Q),R_,t),r=this._private__chartWidget._internal_model().createSeries("Candlestick",e),a=new w_(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.addHistogramSeries=function(t){t===void 0&&(t={}),t=X(t),J(t.priceFormat);var e=R(L(Q),V_,t),r=this._private__chartWidget._internal_model().createSeries("Histogram",e),a=new tt(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.addLineSeries=function(t){t===void 0&&(t={}),t=X(t),J(t.priceFormat);var e=R(L(Q),L_,t),r=this._private__chartWidget._internal_model().createSeries("Line",e),a=new tt(r,this,this);return this._private__seriesMap.set(a,r),this._private__seriesMapReversed.set(r,a),a},i.prototype.removeSeries=function(t){var e=E(this._private__seriesMap.get(t)),r=this._private__dataLayer._internal_removeSeries(e),a=this._private__chartWidget._internal_model();a.removeSeries(e),this._private__sendUpdateToChart(r),this._private__seriesMap.delete(t),this._private__seriesMapReversed.delete(e)},i.prototype._internal_applyNewData=function(t,e){this._private__sendUpdateToChart(this._private__dataLayer._internal_setSeriesData(t,e))},i.prototype._internal_updateData=function(t,e){this._private__sendUpdateToChart(this._private__dataLayer._internal_updateSeriesData(t,e))},i.prototype.subscribeClick=function(t){this._private__clickedDelegate.subscribe(t)},i.prototype.unsubscribeClick=function(t){this._private__clickedDelegate.unsubscribe(t)},i.prototype.subscribeCrosshairMove=function(t){this._private__crosshairMovedDelegate.subscribe(t)},i.prototype.unsubscribeCrosshairMove=function(t){this._private__crosshairMovedDelegate.unsubscribe(t)},i.prototype.subscribeCustomPriceLineDragged=function(t){this._private__customPriceLineDraggedDelegate.subscribe(t)},i.prototype.unsubscribeCustomPriceLineDragged=function(t){this._private__customPriceLineDraggedDelegate.unsubscribe(t)},i.prototype.priceScale=function(t){return t===void 0&&(Di("Using ChartApi.priceScale() method without arguments has been deprecated, pass valid price scale id instead"),t=this._private__chartWidget._internal_model().defaultVisiblePriceScaleId()),new E_(this._private__chartWidget,t)},i.prototype.timeScale=function(){return this._private__timeScaleApi},i.prototype.applyOptions=function(t){this._private__chartWidget._internal_applyOptions(ai(t))},i.prototype.options=function(){return this._private__chartWidget._internal_options()},i.prototype.takeScreenshot=function(){return this._private__chartWidget._internal_takeScreenshot()},i.prototype._private__sendUpdateToChart=function(t){var e=this._private__chartWidget._internal_model();e.updateTimeScale(t._internal_timeScale._internal_baseIndex,t._internal_timeScale._internal_points,t._internal_timeScale._internal_firstChangedPointIndex),t._internal_series.forEach(function(r,a){return a.setData(r._internal_data,r._internal_info)}),e.recalculateAllPanes()},i.prototype._private__mapSeriesToApi=function(t){return E(this._private__seriesMapReversed.get(t))},i.prototype._private__convertMouseParams=function(t){var e=this,r=new Map;t._internal_seriesPrices.forEach(function(_,n){r.set(e._private__mapSeriesToApi(n),_)});var a=t._internal_hoveredSeries===void 0?void 0:this._private__mapSeriesToApi(t._internal_hoveredSeries);return{time:t._internal_time&&(t._internal_time.businessDay||t._internal_time.timestamp),point:t._internal_point,hoveredSeries:a,hoveredMarkerId:t._internal_hoveredObject,seriesPrices:r}},i.prototype._private__convertCustomPriceLineDraggedParams=function(t){return{customPriceLine:t._internal_customPriceLine,fromPriceString:t._internal_fromPriceString}},i}();function F_(i,t){var e;if(ee(i)){var r=document.getElementById(i);x(r!==null,"Cannot find element in DOM with id=".concat(i)),e=r}else e=i;return new z_(e,t)}const N_=["title"],H_={__name:"DailyCashFlowPopup",setup(i,{expose:t}){const e={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.05,bottom:.4}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!1,rightOffset:20,minBarSpacing:.01},watermark:{visible:!0,fontSize:50,horzAlign:"center",vertAlign:"center",color:"rgba(171, 71, 188, 0.2)"}},r=Ei(),a=ue(null),_=ue(null),n=Ii({symbol:"VN30F1M"});let s={chart:{},series:{price:{},avg:{},cash:{}}};function o(){a.value.show()}function l(c){if(n.symbol=="")return!1;n.symbol=n.symbol.toUpperCase(),r.dispatch("tradingOrder/cashflow",n.symbol).then(u=>{s.series.price.setData(u.price),s.series.avg.setData(u.avg),s.series.cash.setData(u.cash),s.chart.applyOptions({watermark:{text:n.symbol}}),c.target.blur()})}function p(c){c.target.select()}function v(){s.chart=F_(_.value,e),r.dispatch("tradingOrder/cashflow",n.symbol).then(c=>{s.series.price=s.chart.addCandlestickSeries({upColor:"#26a69a",downColor:"#ef5350",borderVisible:!1,wickUpColor:"#26a69a",wickDownColor:"#ef5350",priceFormat:{minMove:.1}}),s.series.price.setData(c.price),s.series.avg=s.chart.addLineSeries({color:"#CCCCCC",priceFormat:{minMove:.1},lastValueVisible:!1,priceLineVisible:!1}),s.series.avg.setData(c.avg),s.series.cash=s.chart.addLineSeries({color:"#2962FF",priceScaleId:"cash",scaleMargins:{top:.61,bottom:.01},lastValueVisible:!1}),s.series.cash.setData(c.cash),s.chart.timeScale().fitContent(),s.chart.applyOptions({watermark:{text:n.symbol}})})}function h(){_.value.removeChild(_.value.lastChild)}return t({show:o}),(c,u)=>{const f=Bi("DxScrollView");return zi(),Oi(Wi,{ref_key:"popupRef",ref:a,class:"cashflow-popup",title:c.$t("trading.orderChart.DailyCashFlowPopup.title"),fullScreen:!0,onShown:v,onHidden:h},{default:de(()=>[Fi(f,null,{default:de(()=>[fe("div",{class:"cashflow-chart",style:{height:"calc(100vh - 64px)"},ref_key:"orderChartRef",ref:_},[Ni(fe("input",{type:"text",class:"symbol-input",title:c.$t("trading.orderChart.DailyCashFlowPopup.symbol"),"onUpdate:modelValue":u[0]||(u[0]=d=>n.symbol=d),onChange:l,onFocus:p},null,40,N_),[[Hi,n.symbol]])],512)]),_:1})]),_:1},8,["title"])}}},Y_=Object.freeze(Object.defineProperty({__proto__:null,default:H_},Symbol.toStringTag,{value:"Module"}));export{Y_ as D,H_ as _,F_ as c};
