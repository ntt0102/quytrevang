import{y as v,E as C,z as R,c as r,d as t,t as i,J as $,M as S,B as u,e as _,w as m,C as T,D as F,o,v as N}from"./app-8ef0f3dc.js";import{a as b,D as A}from"./data-grid-cb67b115.js";/* empty css                                                            */import"./row_dragging-9fbcd02a.js";import"./dialog-21a07523.js";import"./exporter-4f1d342d.js";const E={class:"overview-contracts"},z={class:"sum dx-card responsive-paddings content-block"},P={class:"title"},V={key:0,class:"currency"},B={key:1},G={class:"title"},L={key:0,class:"currency"},U={key:1},O={class:"title"},j={key:0,class:"currency interest"},J={key:1},M={class:"list content-block"},q=["onClick"],H={class:"responsive-paddings",style:{position:"relative"}},I={class:"info"},K={class:"interest-rate"},Q={class:"date"},W={class:"currency"},X={class:"principal"},Y={class:"interest"},oe={__name:"Contracts",setup(Z){const d=T(),h=F("mf"),p=v(null),f=v(null),g=C(()=>d.state.auth.user.level),a=R({gridData:null,asset:null,principal:null,interest:null});let s={sum:{},interval:{},change:{},doneFlag:!1};d.dispatch("userContract/getContracts",!1).then(()=>{a.gridData=h.cloneDeep(d.state.userContract.contracts),w()});function y(e){e.rowType=="header"&&(e.rowElement.style.display="none")}function D(e){return`status-${e}`}function w(){s.sum=a.gridData.reduce((e,l)=>([2,3].includes(l.status)&&(e.principal+=l.principal,e.interest+=l.interest,e.asset+=l.total),e),{principal:0,interest:0,asset:0}),k(),s.interval=setInterval(()=>{c("principal"),c("interest"),c("asset"),s.doneFlag&&clearInterval(s.interval)},4)}function k(){let e=25;s.change={principal:s.sum.principal/e,interest:s.sum.interest/e,asset:s.sum.asset/e}}function c(e){a[e]<s.sum[e]-s.change[e]?(a[e]+=s.change[e],s.doneFlag=!1):(a[e]=s.sum[e],s.doneFlag=!0)}return(e,l)=>(o(),r("div",E,[t("div",z,[t("div",null,[t("div",P,i(e.$t("user.overview.assetSum")),1),a.asset!=null?(o(),r("div",V,i(e.$filters.currency(a.asset.toFixed(0))),1)):(o(),r("div",B,"-"))]),t("div",null,[t("div",G,i(e.$t("user.overview.principalSum")),1),a.principal!=null?(o(),r("div",L,i(e.$filters.currency(a.principal.toFixed(0))),1)):(o(),r("div",U,"-"))]),t("div",null,[t("div",O,i(e.$t("user.overview.interestSum")),1),a.interest!=null?(o(),r("div",j,i(e.$filters.currency(a.interest.toFixed(0),"+ ")),1)):(o(),r("div",J,"-"))])]),$(t("div",M,[_(u(A),{ref_key:"dataGridRef",ref:p,"data-source":a.gridData,"key-expr":"id","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate",onContentReady:l[0]||(l[0]=()=>e.$mf.dataGridPreload(a.gridData,p.value.instance)),onRowPrepared:y},{dataRowTemplate:m(({data:n})=>[t("tr",{role:"cell",class:"item",onClick:te=>f.value.show(n.data)},[t("td",null,[t("div",H,[t("div",{class:N(["status",D(n.data.status)])},null,2),t("div",I,[t("div",null,[t("span",null,"#"+i(n.data.code),1),t("span",K,i(e.$filters.percentInterestRate(n.data.interest_rate)),1)]),t("div",Q,[t("div",null,i(e.$filters.formatDate(n.data.paid_at))+" ~ "+i(e.$filters.formatDate(n.data.withdrawn_at))+" Â  ",1),t("div",null,"("+i(n.data.duration)+")",1)])]),t("div",W,[t("div",X,i(e.$filters.currency(n.data.principal)),1),t("div",Y,i(e.$filters.currency(n.data.interest,"+ ")),1)])])])],8,q)]),default:m(()=>[_(u(b))]),_:1},8,["data-source"])],512),[[S,u(g)>=6]])]))}};export{oe as default};
