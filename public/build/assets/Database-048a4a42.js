import{_ as m,Q as f,R as _,b as h,c as D,d as t,t as d,e as o,w as r,r as c,o as g,i as u,h as F,dP as k,dQ as E}from"./app-28056b86.js";import{D as S}from"./accordion-ebf480f1.js";import{a as x}from"./index-fb36e198.js";const v={components:{DxAccordion:S,DxForm:f,DxItem:_},data(){return{backupData:{sendMail:!0,download:!0},RESTORE_FILE_EXTENSION:"sql",restoreFileName:null}},beforeCreate(){this.$store.registerModule("Settings",x)},destroyed(){this.$store.unregisterModule("Settings")},methods:{...h("Settings",["backupDatabase","restoreDatabase"]),onBackupForm(){this.$bus.emit("checkPin",()=>this.backupDatabase(this.backupData))},onRestoreForm(){this.$bus.emit("checkPin",()=>{let e=new FormData;e.append("file",this.$refs.file.files[0]),this.restoreDatabase(e)})},onFileChange(e){var a=e.target.files[0].name;a.split(".").pop()===this.RESTORE_FILE_EXTENSION?this.restoreFileName=a:this.$toasted.show(this.$t("settings.database.notMatchExtension").replace("{extension}",this.RESTORE_FILE_EXTENSION))}}},I=e=>(k("data-v-4c2b6e5a"),e=e(),E(),e),N={class:"settings-page"},w={class:"content-block"},T={class:"content-block dx-card responsive-paddings"},y={class:"settings-database-tab"},R={class:"upload-browser"},B=["accept"],C={for:"restoreFile"},$=I(()=>t("i",{class:"far fa-file-upload"},null,-1));function M(e,a,O,A,s,n){const i=c("DxItem"),p=c("DxForm"),b=c("DxAccordion");return g(),D("div",N,[t("h2",w,d(e.$t("settings.database.title")),1),t("div",T,[t("div",y,[o(b,{collapsible:!0,items:[{title:e.$t("settings.database.backup"),template:"backupTemplate"},{title:e.$t("settings.database.restore"),template:"restoreTemplate"}]},{backupTemplate:r(()=>[t("form",{onSubmit:a[0]||(a[0]=u((...l)=>n.onBackupForm&&n.onBackupForm(...l),["prevent"]))},[o(p,{ref:"form","form-data":s.backupData,"label-location":e.$devices.phone?"top":"left","scrolling-enabled":!0},{default:r(()=>[o(i,{"data-field":"sendMail","editor-type":"dxCheckBox",label:{location:"left",text:e.$t("settings.database.sendMail")}},null,8,["label"]),o(i,{"data-field":"download","editor-type":"dxCheckBox",label:{location:"left",text:e.$t("settings.database.download")}},null,8,["label"]),o(i,{"item-type":"button","button-options":{disabled:!s.backupData.sendMail&&!s.backupData.download,width:150,left:0,type:"default",icon:"far fa-copy",text:e.$t("buttons.backup"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],32)]),restoreTemplate:r(()=>[t("form",{onSubmit:a[2]||(a[2]=u((...l)=>n.onRestoreForm&&n.onRestoreForm(...l),["prevent"]))},[o(p,{ref:"form","form-data":s.backupData,"label-location":e.$devices.phone?"top":"left","scrolling-enabled":!0},{default:r(()=>[o(i,null,{default:r(()=>[t("div",R,[t("input",{type:"file",id:"restoreFile",ref:"file",accept:`.${s.RESTORE_FILE_EXTENSION}`,onChange:a[1]||(a[1]=(...l)=>n.onFileChange&&n.onFileChange(...l))},null,40,B),t("label",C,[$,F(" "+d(e.$t("buttons.chooseFile")),1)]),t("span",null,d(s.restoreFileName),1)])]),_:1}),o(i,{"item-type":"button","button-options":{disabled:!s.restoreFileName,width:150,left:0,type:"default",icon:"far fa-undo",text:e.$t("buttons.restore"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],32)]),_:1},8,["items"])])])])}const V=m(v,[["render",M],["__scopeId","data-v-4c2b6e5a"]]);export{V as default};
