import{r as _,c as R,a as S,b as r,d as t,t as s,I as b,J as F,e as u,f as h,g as m,h as T,k as P,o,E,n as f}from"./app-ld7jX9pZ.js";import{_ as G}from"./ContractDetailPopup-sSQfj5Gu.js";/* empty css            */const N={class:"overview-contracts"},z={class:"sum dx-card responsive-paddings content-block"},A={class:"header"},B={class:"body"},V={class:"title"},U={key:0,class:"currency"},j={key:1},J={class:"title"},L={key:0,class:"currency"},O={key:1},q={class:"title"},H={key:0,class:"currency interest"},K={key:1},M={class:"list dx-card responsive-paddings content-block"},Q={class:"header"},W=["onClick"],X={class:"responsive-paddings",style:{position:"relative"}},Y={class:"info"},Z={class:"interest-rate"},x={class:"date"},I={class:"currency"},ee={class:"principal"},te={class:"interest"},se=100,g=4,oe={__name:"Contracts",setup(ae){const d=T(),y=P("mf"),v=_(null),p=_(null),w=R(()=>d.state.auth.user.level),i=S({gridData:null,asset:null,principal:null,interest:null});let a={sum:{},interval:{},change:{},doneFlag:!1};d.dispatch("userContract/getContracts",!1).then(()=>{i.gridData=y.cloneDeep(d.state.userContract.contracts),k()});function D(e){e.rowType=="header"&&(e.rowElement.style.display="none")}function $(e){return`status-${e}`}function k(){a.sum=i.gridData.reduce((e,l)=>([2,3].includes(l.status)&&(e.principal+=l.principal,e.interest+=l.interest,e.asset+=l.total),e),{principal:0,interest:0,asset:0}),C(),a.interval=setInterval(()=>{c("principal"),c("interest"),c("asset"),a.doneFlag&&clearInterval(a.interval)},g)}function C(){let e=se/g;a.change={principal:a.sum.principal/e,interest:a.sum.interest/e,asset:a.sum.asset/e}}function c(e){i[e]<a.sum[e]-a.change[e]?(i[e]+=a.change[e],a.doneFlag=!1):(i[e]=a.sum[e],a.doneFlag=!0)}return(e,l)=>(o(),r("div",N,[t("div",z,[t("div",A,s(e.$t("user.overview.contract.sumTitle")),1),t("div",B,[t("div",null,[t("div",V,s(e.$t("user.overview.contract.assetSum")),1),i.asset!=null?(o(),r("div",U,s(e.$filters.currency(i.asset.toFixed(0))),1)):(o(),r("div",j,"-"))]),t("div",null,[t("div",J,s(e.$t("user.overview.contract.principalSum")),1),i.principal!=null?(o(),r("div",L,s(e.$filters.currency(i.principal.toFixed(0))),1)):(o(),r("div",O,"-"))]),t("div",null,[t("div",q,s(e.$t("user.overview.contract.interestSum")),1),i.interest!=null?(o(),r("div",H,s(e.$filters.currency(i.interest.toFixed(0),"+ ")),1)):(o(),r("div",K,"-"))])])]),b(t("div",M,[t("div",Q,s(e.$t("user.overview.contract.listTitle")),1),u(m(f.DxDataGrid),{ref_key:"dataGridRef",ref:v,"data-source":i.gridData,"key-expr":"code","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate",onContentReady:l[0]||(l[0]=()=>e.$mf.dataGridPreload(i.gridData,v.value.instance)),onRowPrepared:D},{dataRowTemplate:h(({data:n})=>[t("tr",{role:"cell",class:"item",onClick:ie=>p.value.show(n.data)},[t("td",null,[t("div",X,[t("div",{class:E(["status",$(n.data.status)])},null,2),t("div",Y,[t("div",null,[t("span",null,"#"+s(n.data.code),1),t("span",Z,s(e.$filters.percentInterestRate(n.data.interest_rate)),1)]),t("div",x,[t("div",null,s(e.$filters.formatDate(n.data.paid_at))+" ~ "+s(e.$filters.formatDate(n.data.withdrawn_at))+" Â  ",1),t("div",null,"("+s(n.data.duration)+")",1)])]),t("div",I,[t("div",ee,s(e.$filters.currency(n.data.principal)),1),t("div",te,s(e.$filters.currency(n.data.interest,"+ ")),1)])])])],8,W)]),default:h(()=>[u(m(f.DxColumn))]),_:1},8,["data-source"])],512),[[F,w.value>=6]]),u(G,{ref_key:"contractDetailPopupRef",ref:p},null,512)]))}};export{oe as default};
