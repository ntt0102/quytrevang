import{u as x,c as I,i as $,r as i,d as z,f as V,n as u,k as p,_ as D,o as f,j as E,h as m,l as L,bD as O,p as P,v as d}from"./app-a730bc20.js";const j={__name:"ChangeAvatarPopup",setup(F,{expose:h}){const c=x(),{t:s}=I(),b=$("bus"),a=i(null),o=i(null),l=i(null),e=z({isEnabled:!1,imgSrc:null});function g(){a.value.setOption("toolbarItems[0].options.disabled",!1),a.value.show()}function v(){b.emit("checkPin",()=>{let t=o.value.getCroppedCanvas().toDataURL();c.dispatch("userProfile/changeAvatar",t).then(n=>{n&&a.value.hide()})})}function _(){o.value.zoom(.2)}function w(){o.value.zoom(-.2)}function C(){o.value.rotate(-90)}function k(){o.value.rotate(90)}function A(t){const n=t.target.files[0];if(n.type.indexOf("image/")===-1){d.error(s("components.changeAvatar.error.imageType"));return}if(typeof FileReader=="function"){const r=new FileReader;r.onload=B=>{e.imgSrc=B.target.result},r.readAsDataURL(n)}else d.error(s("components.changeAvatar.error.fileReaderSupport"))}function R(){l.value.click()}function y(){e.isEnabled=!0,e.imgSrc=c.state.auth.user.avatar}function S(){e.isEnabled=!1}return h({show:g}),(t,n)=>{const r=V("DxScrollView");return f(),u(D,{ref_key:"popupRef",ref:a,class:"change-avatar-popup",title:t.$t("components.changeAvatar.title"),toolbarItems:[{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-folder-upload",hint:t.$t("components.changeAvatar.buttons.choose"),onClick:R}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-search-minus",hint:t.$t("components.changeAvatar.buttons.zoomOut"),onClick:w}},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-search-plus",hint:t.$t("components.changeAvatar.buttons.zoomIn"),onClick:_}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-undo",hint:t.$t("components.changeAvatar.buttons.rotateLeft"),onClick:C}},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-redo",hint:t.$t("components.changeAvatar.buttons.rotateRight"),onClick:k}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-crop-alt",hint:t.$t("components.changeAvatar.buttons.crop"),onClick:v}}],onShown:y,onHidden:S},{default:p(()=>[E(r,null,{default:p(()=>[m("div",null,[e.isEnabled?(f(),u(L(O),{key:0,ref_key:"cropperRef",ref:o,style:{width:"100%",height:"400px"},src:e.imgSrc,initialAspectRatio:1/1},null,8,["src"])):P("",!0),m("input",{ref_key:"inputRef",ref:l,type:"file",accept:"images/*",onChange:A},null,544)])]),_:1})]),_:1},8,["title","toolbarItems"])}}};export{j as default};
