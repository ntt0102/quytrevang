import{u as w,c as C,i as u,r as b,d as D,e as S,w as k,f as x,g as T,j as n,k as p,l,o as $,D as r,m as I}from"./app-0b38dc40.js";const R={class:"copyists-page content-block dx-card responsive-paddings"},B={__name:"Index",setup(q){const a=w(),{t}=C(),o=u("mt"),m=u("mf"),s=b(null),i=D({gridData:null,validationRules:{user:[{type:"required",message:t("admin.copyists.user")+o.validations.required},{type:"async",validationCallback:e=>a.dispatch("adminCopyist/validateDuplicateUser",e),message:t("admin.copyists.user")+o.validations.duplicate}],vpsCode:[{type:"required",message:t("admin.copyists.vpsCode")+o.validations.required}],lastTransaction:[{type:"deviceLimit",message:t("admin.copyists.deviceLimit")+o.validations.required}],startedAt:[{type:"required",message:t("admin.copyists.startedAt")+o.validations.required}]}}),g=S(()=>a.state.adminCopyist.users);a.dispatch("adminCopyist/getCopyists"),k(()=>a.state.adminCopyist.copyists,e=>{console.log("value",e),i.gridData=m.cloneDeep(e)});function v(e){bus.emit("checkPin",()=>a.dispatch("adminCopyist/save",{changes:e.changes}))}function y(e){e.data.last_transaction=t("admin.copyists.openNewBook")}function f(e){e.toolbarOptions.items.unshift({location:"before",widget:"dxButton",options:{icon:"far fa-tags small",hint:t("admin.copyists.pricePlans"),onClick:()=>{}}})}return(e,c)=>{const h=x("DxToolbar");return $(),T("div",R,[n(l(I),{ref_key:"dataGridRef",ref:s,"data-source":i.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-chooser":{enabled:!0,mode:"select",allowSearch:!0},"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:c[0]||(c[0]=d=>e.$mf.dataGridPreload(i.gridData,s.value.instance)),onInitNewRow:y,onToolbarPreparing:f,onSaved:v},{commandCellTemplate:p(({data:d})=>[n(h,{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"far fa-empty-set small",hint:e.$t("admin.copyists.clearDevices"),text:e.$t("admin.copyists.clearDevices"),onClick:()=>s.value.instance.cellValue(d.rowIndex,"devices",[])}},{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:e.$t("buttons.delete"),text:e.$t("buttons.delete"),onClick:()=>s.value.instance.deleteRow(d.rowIndex)}}]},null,8,["items"])]),default:p(()=>[n(l(r),{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:125,alignment:"center",type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),n(l(r),{"data-field":"user_code",dataType:"number",name:"userCode","header-filter":{allowSearch:!0},caption:e.$t("admin.copyists.user"),"validation-rules":i.validationRules.user,lookup:{dataSource:g.value,displayExpr:"name",valueExpr:"code",searchEnabled:!0,searchExpr:["code","name"]}},null,8,["caption","validation-rules","lookup"]),n(l(r),{"data-field":"vps_code",dataType:"string","header-filter":{allowSearch:!0},caption:e.$t("admin.copyists.vpsCode"),"validation-rules":i.validationRules.vpsCode},null,8,["caption","validation-rules"])]),_:1},8,["data-source"])])}}};export{B as default};
