import F from"./Chart-DE9CpYWd.js";import{h as x,u as C,k as I,r as e,c as E,a as q,w as A,o as g,p as b,f as _,d as R,v as G,e as u,g as h,D as L,z as B,_ as P,n as y,b as S,F as $,A as V,B as j,q as z,m as K}from"./app-DVdcQ1mA.js";import"./lightweight-charts.esm.development-Cejv-WOl.js";const U={ref:"submitRef",class:"display-none"},J={__name:"SettingPopup",setup(k,{expose:s}){const f=x(),{t}=C(),o=I("mt"),n=e(null),d=e(null),p=E(()=>f.state.tradingDerivative.config),a=q({formData:{},validationRules:{tpDefault:[{type:"required",message:t("trading.derivative.settingPopup.tpDefault")+o.validations.required}],slDefault:[{type:"required",message:t("trading.derivative.settingPopup.slDefault")+o.validations.required}]}});A(p,l);function i(){n.value.show()}function w(){f.dispatch("tradingDerivative/setting",a.formData).then(c=>{c?n.value.hide():(l(p.value),r())})}function l(c){a.formData={tpDefault:c.tpDefault,slDefault:c.slDefault}}function r(){setTimeout(()=>{d.value.instance.getEditor("tpDefault").focus()},0)}function v(){l(p.value),r()}function D(){}return s({show:i}),(c,O)=>(g(),b(P,{ref_key:"popupRef",ref:n,width:300,height:260,class:"der-setting-popup",title:c.$t("trading.derivative.buttons.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:c.$t("buttons.save"),onClick:()=>c.$refs.submitRef.click()}}],onShown:v,onHidden:D},{default:_(()=>[R("form",{onSubmit:G(w,["prevent"])},[R("button",U,null,512),u(h(L),{ref_key:"formRef",ref:d,labelLocation:"left","form-data":a.formData},{default:_(()=>[u(h(B.DxItem),{name:"tpDefault","data-field":"tpDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.tpDefault,label:{text:c.$t("trading.derivative.settingPopup.tpDefault")}},null,8,["validation-rules","label"]),u(h(B.DxItem),{name:"slDefault","data-field":"slDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.slDefault,label:{text:c.$t("trading.derivative.settingPopup.slDefault")}},null,8,["validation-rules","label"])]),_:1},8,["form-data"])],32)]),_:1},8,["title","toolbarItems"]))}},Q={__name:"PendingOrdersPopup",setup(k,{expose:s}){const f=x(),t=e(null),o=e([]),n=["orderTime","side","volume","matchVolume","showPrice","avgPrice"];function d(){t.value.show()}function p(){o.value=f.state.tradingDerivative.status.pendingOrders}function a(){}return s({show:d}),(i,w)=>(g(),b(P,{ref_key:"popupRef",ref:t,class:"der-matched-orders-popup",title:i.$t("trading.derivative.pendingOrders"),onShown:p,onHidden:a},{default:_(()=>[u(h(y.DxDataGrid),{"data-source":o.value,"key-expr":"orderNo","show-borders":!0},{default:_(()=>[(g(),S($,null,V(n,l=>u(h(y.DxColumn),{"data-field":l,caption:i.$t(`trading.derivative.pendingOrdersPopup.${l}`)},null,8,["data-field","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},W={__name:"MatchedOrdersPopup",setup(k,{expose:s}){const f=x(),t=e(null),o=e([]),n=["orderTime","side","volume","matchVolume","showPrice","avgPrice"];function d(){t.value.show()}function p(){f.dispatch("tradingDerivative/getMatchedOrders").then(i=>{o.value=i})}function a(){}return s({show:d}),(i,w)=>(g(),b(P,{ref_key:"popupRef",ref:t,class:"der-matched-orders-popup",title:i.$t("trading.derivative.matchedOrders"),onShown:p,onHidden:a},{default:_(()=>[u(h(y.DxDataGrid),{"data-source":o.value,"key-expr":"orderNo","show-borders":!0},{default:_(()=>[(g(),S($,null,V(n,l=>u(h(y.DxColumn),{"data-field":l,caption:i.$t(`trading.derivative.matchedOrdersPopup.${l}`)},null,8,["data-field","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},X={__name:"VpsOtpPopup",setup(k,{expose:s}){const f=x(),t=e(null),o=e(null),n=e(!1),d=e("");function p(){t.value.show(),setTimeout(a,500)}function a(){navigator.clipboard&&navigator.clipboard.readText().then(r=>{r=r.replace(/\s+/g,""),/^\d{6}$/.test(r)&&o.value.fillInput(r)})}function i(r){f.dispatch("tradingDerivative/loginVps",r).then(v=>{v&&t.value.hide(),o.value.clearInput()})}function w(){n.value=!0}function l(){n.value=!1}return s({show:p}),(r,v)=>(g(),b(P,{ref_key:"popupRef",ref:t,width:400,height:190,class:"vps-otp-popup",title:r.$t("trading.derivative.buttons.loginVps"),onShown:w,onHidden:l},{default:_(()=>[n.value?(g(),b(h(j),{key:0,ref_key:"otpInputRef",ref:o,value:d.value,"onUpdate:value":v[0]||(v[0]=D=>d.value=D),"input-classes":"otp-input",separator:"-","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",onOnComplete:i},null,8,["value"])):z("",!0)]),_:1},8,["title"]))}},Y={class:"derivative-page content-block dx-card responsive-paddings"},ne={__name:"Index",setup(k){const s=x(),{t:f}=C(),t=I("bus"),o=E(()=>s.state.tradingDerivative.config.source),n=e(null),d=e(null),p=e(null),a=e(null),i=e(null),w=e([{text:f("trading.derivative.buttons.downloadExport"),value:"download",icon:"far fa-cloud-arrow-down"},{text:f("trading.derivative.buttons.cloneExport"),value:"clone",icon:"far fa-file-export"}]),l=e([{name:"FIREANT",icon:"far fa-database small"},{name:"DNSE",icon:"far fa-database small"},{name:"VPS",icon:"far fa-database small"}]);function r(){d.value.show()}function v(){p.value.show()}function D(){a.value.show()}function c(){t.emit("checkPin",()=>s.dispatch("tradingDerivative/report"))}function O(){i.value.show()}function M(){t.emit("checkPin",()=>s.dispatch("tradingDerivative/export","download"))}function N({itemData:m}){t.emit("checkPin",()=>s.dispatch("tradingDerivative/export",m.value))}function T({item:{name:m}}){n.value.connectSocket(),s.dispatch("tradingDerivative/setSource",m)}return(m,Z)=>{const H=K("DxToolbar");return g(),S($,null,[R("div",Y,[u(H,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-gear small",hint:m.$t("trading.derivative.buttons.setting"),onClick:r}},{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:m.$t("trading.derivative.buttons.report"),onClick:c}},{location:"before",widget:"dxButton",options:{icon:"far fa-arrow-right-to-arc small",hint:m.$t("trading.derivative.buttons.loginVps"),onClick:O}},{location:"before",widget:"dxDropDownButton",options:{splitButton:!0,items:w.value,displayExpr:"text",keyExpr:"value",icon:"far fa-cloud-arrow-down small",hint:m.$t("trading.derivative.buttons.downloadExport"),width:"60",dropDownOptions:{width:"160"},elementAttr:{class:"export"},onButtonClick:M,onItemClick:N}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:l.value,displayExpr:"name",keyExpr:"name",selectedItemKey:o.value,stylingMode:"text",useSelectMode:!0,width:"130",elementAttr:{class:"source"},onSelectionChanged:T}}]},null,8,["items"]),u(F,{ref_key:"chartRef",ref:n,onShowSetting:r,onShowPendingOrders:v,onShowMatchedOrders:D},null,512)]),u(J,{ref_key:"settingPopupRef",ref:d},null,512),u(Q,{ref_key:"pendingOrdersPopupRef",ref:p},null,512),u(W,{ref_key:"matchedOrdersPopupRef",ref:a},null,512),u(X,{ref_key:"vpsOtpPopupRef",ref:i},null,512)],64)}}};export{ne as default};
