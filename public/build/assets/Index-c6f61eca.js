import{_ as v,bl as $,T as _,n as r,f as n,g as p,h as o,t,j as s,q as C,o as d}from"./app-bf6ad851.js";import{U as k}from"./UserDetailPopup-73b3d0f8.js";import b from"./EditProfilePopup-c4415883.js";import D from"./ChangeAvatarPopup-72645b08.js";import w from"./ChangePinPopup-98d5a23e.js";import y from"./ChangePasswordPopup-a60f910d.js";const B={components:{SendCommentPopup:$,UserDetailPopup:k,EditProfilePopup:b,ChangeAvatarPopup:D,ChangePinPopup:w,ChangePasswordPopup:y},data(){return{isLoading:!0,formData:{}}},mounted(){this.$route.hash==="#detail"&&this.detailInfoClick()},computed:{..._("Auth",["name","code","phone","email","avatar","level"]),popup(){return this.$refs.popup.instance}},methods:{...r("Auth",["clearData"]),...r("User.profile",["fetch","save","delete"]),onSubmit(){this.$refs.editProfileForm.$refs.form.instance.validate().isValid&&(this.popup.option("toolbarItems[0].options.disabled",!0),this.save(this.formData).then(()=>{this.popup.hide(),this.$toasted.success(this.$mt.messages.success.saved)}))},cloneDeepData(){this.formData=this.$mf.cloneDeep(this.profile),this.isLoading=!1},validateBirthday(e){return moment(e.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn(e){return moment(e.value).isBefore(moment().subtract(1,"day"))},detailInfoClick(){this.$refs.userDetailPopup.show({getUser:()=>this.fetch()})},onDeleteClick(){this.$bus.emit("checkPin",()=>{this.delete().then(e=>{e&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),this.clearData(),this.$router.push({name:"login"}))})})}}},A={class:"profile-page"},I={class:"content-block"},q={class:"content-block dx-card responsive-paddings"},U={class:"info"},S=o("div",{class:"avatar"},null,-1),E={class:"personal"},T={class:"name"},V={key:0},L={class:"content-block dx-card responsive-paddings change"},N={class:"title"},O={class:"content"},R={class:"content-block dx-card responsive-paddings delete"},G={class:"title"},W={class:"content"};function j(e,a,F,M,z,l){const u=n("DxToolbar"),i=n("DxButton"),c=n("SendCommentPopup"),m=n("UserDetailPopup"),f=n("EditProfilePopup"),h=n("ChangeAvatarPopup"),P=n("ChangePinPopup"),g=n("ChangePasswordPopup");return d(),p("div",A,[o("h2",I,t(e.$t("user.profile.title")),1),o("div",q,[s(u,{items:[{visible:!!e.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>{e.$router.push({name:e.$route.query.redirect})}}},{visible:e.level<5,location:"before",widget:"dxButton",cssClass:"guiding-step-2b",options:{icon:"far fa-user-edit small",hint:e.$t("components.editProfile.title"),onClick:()=>e.$refs.editProfilePopup.show()}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:e.$t("components.changeAvatar.title"),onClick:()=>e.$refs.changeAvatarPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:e.$t("components.changePin.title"),onClick:()=>e.$refs.changePinPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:e.$t("components.changePassword.title"),onClick:()=>e.$refs.changePasswordPopup.show()}}]},null,8,["items"]),o("div",U,[S,o("div",E,[o("div",null,[o("span",null,t(e.$t("models.user.name"))+":",1),o("span",T,t(e.name),1)]),o("div",null,[o("span",null,t(e.$t("models.user.code"))+":",1),o("span",null,t(e.code),1)]),e.phone?(d(),p("div",V,[o("span",null,t(e.$t("models.user.phone"))+":",1),o("span",null,t(e.phone|e.phone),1)])):C("",!0),o("div",null,[o("span",null,t(e.$t("models.user.email"))+":",1),o("span",null,t(e.email),1)]),s(i,{width:"170",class:"detail",type:"default","styling-mode":"outlined",text:e.$t("user.profile.detailInfo"),onClick:l.detailInfoClick},null,8,["text","onClick"])])])]),o("div",L,[o("div",N,t(e.$t("user.profile.changeRequest.title")),1),o("div",O,[o("div",null,t(e.$t("user.profile.changeRequest.desctiption")),1),s(i,{text:e.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained",onClick:a[0]||(a[0]=H=>e.$refs.sendCommentPopup.show())},null,8,["text"])])]),o("div",R,[o("div",G,t(e.$t("user.profile.delete.title")),1),o("div",W,[o("div",null,t(e.$t("user.profile.delete.desctiption")),1),s(i,{text:e.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained",onClick:l.onDeleteClick},null,8,["text","onClick"])])]),s(c,{ref:"sendCommentPopup"},null,512),s(m,{ref:"userDetailPopup"},null,512),s(f,{ref:"editProfilePopup"},null,512),s(h,{ref:"changeAvatarPopup"},null,512),s(P,{ref:"changePinPopup"},null,512),s(g,{ref:"changePasswordPopup"},null,512)])}const x=v(B,[["render",j]]);export{x as default};
