import{u as v,c as w,i as b,r as c,d as y,n as x,k as m,_ as k,o as R,h as S,j as i,l as o,S as s,T as B,s as D}from"./app-065df7cd.js";const T=["onSubmit"],C={__name:"ChangePinPopup",setup(q,{expose:f}){const l=v(),{t}=w(),a=b("mt"),r=c(null),d=c(null),e=y({title:null,hasPin:!1,formData:{},validationRules:{oldPin:[{type:"required",message:t("components.changePin.oldPin")+a.validations.required}],newPin:[{type:"required",message:t("components.changePin.newPin")+a.validations.required}],confirmPin:[{type:"required",message:t("components.changePin.confirmPin")+a.validations.required},{type:"compare",comparisonTarget:()=>e.formData.new_pin,message:t("components.changePin.confirmPin")+a.validations.match}]}});e.hasPin=l.state.auth.user.level>=3,e.title=t("components.changePin."+(e.hasPin?"title":"setTitle"));function h(){r.value.show()}function P(){l.dispatch("userProfile/changePin",e.formData).then(n=>{n?(l.dispatch("auth/check",!0),r.value.hide()):(u(),p())})}function u(){e.formData={pin:"",new_pin:"",pin_confirmation:""}}function p(){setTimeout(()=>{d.value.instance.getEditor(e.hasPin?"pin":"new_pin").focus()},0)}function _(){u(),p()}function g(){}return f({show:h}),(n,M)=>(R(),x(k,{ref_key:"popupRef",ref:r,width:250,height:e.hasPin?355:285,class:"change-pin-popup",title:e.title,onShown:_,onHidden:g},{default:m(()=>[S("form",{onSubmit:D(P,["prevent"])},[i(o(B),{ref_key:"formRef",ref:d,"form-data":e.formData,labelMode:"static"},{default:m(()=>[i(o(s),{visible:e.hasPin,name:"pin","data-field":"pin","editor-type":"dxTextBox","editor-options":{stylingMode:"outlined",mode:"password",mask:"0000"},"validation-rules":e.validationRules.oldPin,label:{text:n.$t("components.changePin.oldPin")}},null,8,["visible","validation-rules","label"]),i(o(s),{name:"new_pin","data-field":"new_pin","editor-type":"dxTextBox","editor-options":{stylingMode:"outlined",mode:"password",mask:"0000"},"validation-rules":e.validationRules.newPin,label:{text:n.$t("components.changePin.newPin")}},null,8,["validation-rules","label"]),i(o(s),{name:"pin_confirmation","data-field":"pin_confirmation","editor-type":"dxTextBox","editor-options":{stylingMode:"outlined",mode:"password",mask:"0000"},"validation-rules":e.validationRules.confirmPin,label:{text:n.$t("components.changePin.confirmPin")}},null,8,["validation-rules","label"]),i(o(s),{"item-type":"button","button-options":{width:"100%",type:"default",text:n.$t("components.changePin.submit"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data"])],40,T)]),_:1},8,["height","title"]))}};export{C as default};
