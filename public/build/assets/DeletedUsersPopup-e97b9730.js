import{_ as c,m as h,b as f,r,f as g,w as d,o as w,e as a}from"./app-6ea57162.js";import{D,a as S}from"./data-grid-b95a844e.js";import"./row_dragging-498caf99.js";import"./dialog-ac020704.js";import"./exporter-e3a8336b.js";const y={components:{DxDataGrid:D,DxColumn:S},data(){return{gridData:null}},computed:{...h("Admin.users",["deletedUsers"]),dataGrid:function(){return this.$refs.dataGrid.instance},popup(){return this.$refs.popup.instance}},watch:{deletedUsers(){this.cloneDeepData()}},methods:{...f("Admin.users",["save"]),show(){this.popup.show(),this.cloneDeepData(),this.$mf.pushPopupToHistoryState(()=>this.popup.hide())},onSavedDeletedUser(e){this.$bus.emit("checkPin",()=>{e.isDeleted=!0,this.save(e)})},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.deletedUsers)},isRowRestored(e){const n=this.dataGrid.option("editing.changes").find(i=>i.type=="update"&&i.key==e);return this.$mf.isSet(n)},unrestore(e){let n=this.dataGrid.option("editing.changes");n=n.filter(i=>!(i.type=="update"&&i.key==e)),this.dataGrid.option("editing.changes",n)},isRowDeleted(e){const n=this.dataGrid.option("editing.changes").find(i=>i.type=="remove"&&i.key==e);return this.$mf.isSet(n)}}};function G(e,n,i,b,l,t){const s=r("DxColumn"),u=r("DxToolbar"),p=r("DxDataGrid"),m=r("DxPopup");return w(),g(m,{ref:"popup",showCloseButton:!0,fullScreen:!!e.$screen.getScreenSizeInfo.isXSmall,"show-title":!0,title:e.$t("admin.users.deletedUsers"),onHiding:e.$mf.popRouteHistoryState},{content:d(()=>[a(p,{ref:"dataGrid","data-source":l.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:n[0]||(n[0]=o=>e.$mf.dataGridPreload(l.gridData,t.dataGrid)),onSaved:t.onSavedDeletedUser},{commandCellTemplate:d(({data:o})=>[a(u,{items:[{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{disabled:t.isRowDeleted(o.key),type:"default",icon:t.isRowRestored(o.key)?"undo":"repeat",hint:e.$t("admin.users.buttons.revert"),text:e.$t("admin.users.buttons.revert"),onClick:()=>{t.isRowRestored(o.key)?t.unrestore(o.key):t.dataGrid.cellValue(o.rowIndex,"deleted_at",null),t.dataGrid.repaintRows(o.rowIndex)}}},{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{type:"default",icon:t.isRowDeleted(o.key)?"undo":"clearsquare",hint:e.$t("admin.users.buttons.remove"),text:e.$t("admin.users.buttons.remove"),onClick:()=>{t.isRowDeleted(o.key)?t.dataGrid.undeleteRow(o.rowIndex):t.dataGrid.deleteRow(o.rowIndex)}}}]},null,8,["items"])]),default:d(()=>[a(s,{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:75,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),a(s,{"allow-editing":!1,"data-field":"code","data-type":"string",caption:e.$t("models.user.codeShort")},null,8,["caption"]),a(s,{"allow-editing":!1,"data-field":"name",caption:e.$t("models.user.name")},null,8,["caption"]),a(s,{"allow-editing":!1,"data-field":"phone",caption:e.$t("models.user.phone")},null,8,["caption"]),a(s,{"allow-editing":!1,visible:!1,"data-field":"deleted_at"})]),_:1},8,["data-source","onSaved"])]),_:1},8,["fullScreen","title","onHiding"])}const $=c(y,[["render",G]]);export{$ as default};
