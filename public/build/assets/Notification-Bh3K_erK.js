import{u as x,r as k,a as I,y as $,b as m,d as O,e as i,f as l,g as o,v as R,h as q,j as B,k as g,o as f,z as a,F as S,A as _,p as A,D as w}from"./app-CJoyMNnX.js";import{_ as C}from"./PickImagePopup-CJPPu5LU.js";import"./FileManager-CYTicSJN.js";const N={class:"content-block dx-card responsive-paddings"},F={__name:"Notification",setup(P){const b=q(),v=B(),{t:s}=x(),y=g("bus"),r=g("mt"),p=k(null),t=I({formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:s("settings.notification.receiver")+r.validations.required}],title:[{type:"required",message:s("settings.notification.notificationTitle")+r.validations.required}],body:[{type:"required",message:s("settings.notification.body")+r.validations.required}]}});t.actionOptions=c(t.formData.actions),t.addActionOptions={icon:"add",text:s("buttons.add"),onClick:()=>{t.formData.actions.push(""),t.actionOptions=c(t.formData.actions)}},$(()=>{t.formData.receiver=v.query.codes||null,setTimeout(()=>{p.value.instance.getEditor("receiver").focus()},500)});function D(){y.emit("checkPin",()=>{b.dispatch("setting/sendNotification",t.formData)})}function c(e){let u=[];for(let n=0;n<e.length;n++)u.push(h(n));return u}function h(e){return{placeholder:s("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{t.formData.actions.splice(e,1),t.actionOptions=c(t.formData.actions)}}}]}}return(e,u)=>(f(),m("div",N,[O("form",{class:"setting-notification-page",onSubmit:R(D,["prevent"])},[i(o(w),{ref_key:"formRef",ref:p,"form-data":t.formData,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:l(()=>[i(o(a.DxItem),{"item-type":"group"},{default:l(()=>[i(o(a.DxItem),{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:e.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>e.$router.push({name:"admin-user",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:e.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),i(o(a.DxItem),{"data-field":"title","validation-rules":t.validationRules.title,label:{text:e.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),i(o(a.DxItem),{"data-field":"body","validation-rules":t.validationRules.body,label:{text:e.$t("settings.notification.body")}},null,8,["validation-rules","label"]),i(o(a.DxItem),{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>e.$refs.pickImagePopupRef.show({clientPath:"notifications",callback:n=>t.formData.image=n})},name:"pickImage",location:"after"}]},label:{text:e.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),i(o(a.DxItem),{"item-type":"group",caption:e.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[i(o(a.DxItem),{"item-type":"group",name:"actions"},{default:l(()=>[(f(!0),m(S,null,_(t.actionOptions,(n,d)=>(f(),A(o(a.DxItem),{key:"action"+(d+1),"data-field":"actions["+d+"]","editor-options":n,label:{text:e.$t("settings.notification.action.title")+" "+(d+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),i(o(a.DxItem),{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),i(o(a.DxItem),{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:e.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],32),i(C,{ref:"pickImagePopupRef"},null,512)]))}};export{F as default};
