import{u as C,p as R,q as p,v as S,s as F,d as r,e as t,t as i,O as b,S as T,f as v,w as _,y as m,o,M as N,a as P,D as z}from"./app-9b98c2f0.js";/* empty css                                                            */const G={class:"overview-contracts"},A={class:"sum dx-card responsive-paddings content-block"},B={class:"title"},E={key:0,class:"currency"},V={key:1},O={class:"title"},U={key:0,class:"currency"},j={key:1},q={class:"title"},L={key:0,class:"currency interest"},M={key:1},H={class:"list content-block"},J=["onClick"],K={class:"responsive-paddings",style:{position:"relative"}},Q={class:"info"},W={class:"interest-rate"},X={class:"date"},Y={class:"currency"},Z={class:"principal"},x={class:"interest"},I=100,h=4,ie={__name:"Contracts",setup(ee){const d=C(),f=R("mf"),u=p(null),g=p(null),y=S(()=>d.state.auth.user.level),a=F({gridData:null,asset:null,principal:null,interest:null});let s={sum:{},interval:{},change:{},doneFlag:!1};d.dispatch("userContract/getContracts",!1).then(()=>{a.gridData=f.cloneDeep(d.state.userContract.contracts),k()});function w(e){e.rowType=="header"&&(e.rowElement.style.display="none")}function D(e){return`status-${e}`}function k(){s.sum=a.gridData.reduce((e,l)=>([2,3].includes(l.status)&&(e.principal+=l.principal,e.interest+=l.interest,e.asset+=l.total),e),{principal:0,interest:0,asset:0}),$(),s.interval=setInterval(()=>{c("principal"),c("interest"),c("asset"),s.doneFlag&&clearInterval(s.interval)},h)}function $(){let e=I/h;s.change={principal:s.sum.principal/e,interest:s.sum.interest/e,asset:s.sum.asset/e}}function c(e){a[e]<s.sum[e]-s.change[e]?(a[e]+=s.change[e],s.doneFlag=!1):(a[e]=s.sum[e],s.doneFlag=!0)}return(e,l)=>(o(),r("div",G,[t("div",A,[t("div",null,[t("div",B,i(e.$t("user.overview.assetSum")),1),a.asset!=null?(o(),r("div",E,i(e.$filters.currency(a.asset.toFixed(0))),1)):(o(),r("div",V,"-"))]),t("div",null,[t("div",O,i(e.$t("user.overview.principalSum")),1),a.principal!=null?(o(),r("div",U,i(e.$filters.currency(a.principal.toFixed(0))),1)):(o(),r("div",j,"-"))]),t("div",null,[t("div",q,i(e.$t("user.overview.interestSum")),1),a.interest!=null?(o(),r("div",L,i(e.$filters.currency(a.interest.toFixed(0),"+ ")),1)):(o(),r("div",M,"-"))])]),b(t("div",H,[v(m(z),{ref_key:"dataGridRef",ref:u,"data-source":a.gridData,"key-expr":"id","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate",onContentReady:l[0]||(l[0]=()=>e.$mf.dataGridPreload(a.gridData,u.value.instance)),onRowPrepared:w},{dataRowTemplate:_(({data:n})=>[t("tr",{role:"cell",class:"item",onClick:te=>g.value.show(n.data)},[t("td",null,[t("div",K,[t("div",{class:N(["status",D(n.data.status)])},null,2),t("div",Q,[t("div",null,[t("span",null,"#"+i(n.data.code),1),t("span",W,i(e.$filters.percentInterestRate(n.data.interest_rate)),1)]),t("div",X,[t("div",null,i(e.$filters.formatDate(n.data.paid_at))+" ~ "+i(e.$filters.formatDate(n.data.withdrawn_at))+" Â  ",1),t("div",null,"("+i(n.data.duration)+")",1)])]),t("div",Y,[t("div",Z,i(e.$filters.currency(n.data.principal)),1),t("div",x,i(e.$filters.currency(n.data.interest,"+ ")),1)])])])],8,J)]),default:_(()=>[v(m(P))]),_:1},8,["data-source"])],512),[[T,y.value>=6]])]))}};export{ie as default};
