import{A as Jt,B as Ht,C as jt,l as ae,u as qt,r as C,a as Qt,c as Y,y as Ut,E as Gt,w as Be,x as w,b as Kt,d as m,e as le,G as E,t as Me,H as q,I as ei,J as ce,K as ti,F as ii,h as ri,j as oi,k as de,z as We,L as si,m as ni,o as ai}from"./app-3c5509ee.js";import li from"./LineContext-c5d80556.js";import ci from"./ScanContext-1a2773fd.js";import di from"./VpsOtpPopup-81e7c16b.js";import{c as pi}from"./lightweight-charts.esm.development-03366bac.js";import{g as T}from"./getUnixTime-fd3c1729.js";import"./text-box-eae59650.js";function ui(N,X,k){return Jt((k==null?void 0:k.in)||N,+Ht(N)+X)}function Se(N,X,k){return ui(N,X*jt,k)}const fi={class:"content-block dx-card responsive-paddings"},vi=["title"],mi=["title"],gi=["title"],hi=["title"],yi=["title"],xi=["title"],Si=["title"],Ci=["title"],wi=["title"],Ti=m("i",{class:"far fa-heart-rate"},null,-1),ki=[Ti],bi=["title"],Di=m("i",{class:"far fa-horizontal-rule"},null,-1),Fi=["title"],Oi=m("i",{class:"far fa-grip-lines-vertical"},null,-1),Li=[Oi],Ri=["title"],Ai=m("i",{class:"far fa-line-height"},null,-1),Pi=[Ai],Ei=["title"],_i=["src"],Ze=3,Ve=2,Ii="wss://tradestation.fireant.vn/quote?access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSIsImtpZCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSJ9.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4iLCJhdWQiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4vcmVzb3VyY2VzIiwiZXhwIjoxODg5NjIyNTMwLCJuYmYiOjE1ODk2MjI1MzAsImNsaWVudF9pZCI6ImZpcmVhbnQudHJhZGVzdGF0aW9uIiwic2NvcGUiOlsiYWNhZGVteS1yZWFkIiwiYWNhZGVteS13cml0ZSIsImFjY291bnRzLXJlYWQiLCJhY2NvdW50cy13cml0ZSIsImJsb2ctcmVhZCIsImNvbXBhbmllcy1yZWFkIiwiZmluYW5jZS1yZWFkIiwiaW5kaXZpZHVhbHMtcmVhZCIsImludmVzdG9wZWRpYS1yZWFkIiwib3JkZXJzLXJlYWQiLCJvcmRlcnMtd3JpdGUiLCJwb3N0cy1yZWFkIiwicG9zdHMtd3JpdGUiLCJzZWFyY2giLCJzeW1ib2xzLXJlYWQiLCJ1c2VyLWRhdGEtcmVhZCIsInVzZXItZGF0YS13cml0ZSIsInVzZXJzLXJlYWQiXSwianRpIjoiMjYxYTZhYWQ2MTQ5Njk1ZmJiYzcwODM5MjM0Njc1NWQifQ.dA5-HVzWv-BRfEiAd24uNBiBxASO-PAyWeWESovZm_hj4aXMAZA1-bWNZeXt88dqogo18AwpDQ-h6gefLPdZSFrG5umC1dVWaeYvUnGm62g4XS29fj6p01dhKNNqrsu5KrhnhdnKYVv9VdmbmqDfWR8wDgglk5cJFqalzq6dJWJInFQEPmUs9BW_Zs8tQDn-i5r4tYq2U8vCdqptXoM7YgPllXaPVDeccC9QNu2Xlp9WUvoROzoQXg25lFub1IYkTrM66gJ6t9fJRZToewCt495WNEOQFa_rwLCZ1QwzvL0iYkONHS_jZ0BOhBCdW9dWSawD6iF1SIQaFROvMDH1rg",Ni={__name:"Index",setup(N){const X={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.25,bottom:.25}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!0,rightOffset:1e3,minBarSpacing:.01,barSpacing:.05}},k=ae(new Date,"yyyy-MM-dd"),b={START:T(new Date(`${k}T08:45:00Z`)),ATO:T(new Date(`${k}T09:00:00Z`)),ATC:T(new Date(`${k}T14:30:00Z`)),END:T(new Date(`${k}T14:45:00Z`))},p=ri(),Ce=oi(),{t:y}=qt(),$e=de("devices"),v=de("mf"),pe=de("bus"),Q=de("filters"),O=C(null),we=C(null),Ye=C(null),Ne=C(null),Xe=C(null),ze=C(null),Je=C(null),U=C(null),ue=C(null),fe=C(null),G=C(null),ve=C(null),He=C(null),B=C(null),z=C(null),Te=C(null);let e={chart:{},series:{},data:{whitespace:[],price:[]},tools:{},crosshair:{},interval:null,interval60:null,websocket:null,isAutoOrdering:!1,socketStop:!1,socketSendData:null,currentSeconds:T(Se(new Date,7))};j();const c=Qt({chartDate:Ce.query.date??k,clock:ae(new Date,"HH:mm:ss"),isFullscreen:!1,isSocketWarning:!1,isOrderWarning:!1,isAutoScan:!1,lineColor:"#F44336",lineTitle:"",pattern:0,scanSide:"left",showScanContext:!1,showLineContext:!1,showTradingView:!1,tradingViewStyle:{left:"32px"}}),D=Y(()=>p.state.tradingDerivative.status),L=Y(()=>p.state.tradingDerivative.config),ke=Y(()=>p.state.tradingDerivative.tools),je=Y(()=>p.state.tradingDerivative.isChartLoading),qe=Y(()=>D.value.position!=0||!!D.value.pending||!!ke.value.order),Qe=Y(()=>`https://chart.vps.com.vn/tv/?u=${L.value.vpsUser}&s=${L.value.vpsSession}&symbol=VN30F1M&resolution=1&lang=vi`);p.dispatch("tradingDerivative/initChart").then(()=>{_()&&me(),!Ce.query.date&&L.value.lastOpeningDate&&(c.chartDate=L.value.lastOpeningDate),p.dispatch("tradingDerivative/getChartData",c.chartDate).then(i=>{i&&H()})}),e.interval=setInterval(nt,1e3),e.interval60=setInterval(()=>{_()?(Ie(),L.value.autoScan&&H()):clearInterval(e.interval60)},6e4),Ut(()=>{e.chart=pi(we.value,X),e.chart.subscribeCrosshairMove(Ke),e.chart.subscribeCustomPriceLineDragged(et),e.series.whitespace=e.chart.addHistogramSeries({priceScaleId:"whitespace",scaleMargins:{top:0,bottom:0},color:"#808080",lastValueVisible:!1,priceLineVisible:!1}),e.series.timeRange=e.chart.addHistogramSeries({priceScaleId:"timeRange",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1}),e.series.timeMark=e.chart.addHistogramSeries({priceScaleId:"timeMark",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1}),e.series.price=e.chart.addLineSeries({color:"#F5F5F5",priceFormat:{minMove:.1}}),new ResizeObserver(tt).observe(O.value),document.addEventListener("keydown",Fe),document.addEventListener("fullscreenchange",Oe)}),Gt(()=>{document.removeEventListener("keydown",Fe),document.removeEventListener("fullscreenchange",Oe),clearInterval(e.interval),clearInterval(e.interval60),e.websocket&&(e.websocket.close(),e.websocket=null),e.socketStop=!0}),Be(()=>p.state.tradingDerivative.chartData,ot),Be(()=>ke.value,rt);function Ue(i){c.showPatternContext=!1,c.showScanContext=!1,c.showLineContext=!1,ie(!1),U.value.classList.contains("selected")?Dt():fe.value.classList.contains("selected")?Rt():G.value.classList.contains("selected")?wt():ve.value.classList.contains("selected")?ut():ue.value.classList.contains("selected")&&yt()}function Ge(i){ie(!0),i.preventDefault()}function be(i){i.stopPropagation()}function De(i){i.preventDefault(),i.stopPropagation()}function Ke(i){if(i.time){let r=i.seriesPrices.get(e.series.price);e.crosshair.time=i.time,e.crosshair.price=r}else $e.phone||(e.crosshair.time=null,e.crosshair.price=null);i.point!=null&&(e.crosshair.x=i.point.x,e.crosshair.y=i.point.y)}function et(i){let r=i.customPriceLine,t=r.options();t.price=parseFloat(t.price.toFixed(1));const o=+i.fromPriceString,n=t.price;switch(t.lineType){case"order":if(n!=o){let a=!1;t.kind=="entry"?D.value.position||(a=!0,e.tools.order[t.kind].price=n,p.dispatch("tradingDerivative/executeOrder",{action:"entry",etData:{cmd:"change",price:e.tools.order.entry.price}}).then(l=>{l.isOk?(V([t.kind]),w.success(y("trading.derivative.changeEntrySuccess"))):(r.applyOptions({price:o}),F(l.message))})):(a=!0,e.tools.order[t.kind].price=n,t.kind=="tp"?p.dispatch("tradingDerivative/executeOrder",{action:"tp",tpData:{cmd:"change",price:e.tools.order.tp.price}}).then(l=>{l.isOk?(V([t.kind]),w.success(y("trading.derivative.changeTpSuccess"))):(r.applyOptions({price:o}),F(l.message))}):p.dispatch("tradingDerivative/executeOrder",{action:"sl",slData:{cmd:"change",price:e.tools.order.sl.price}}).then(l=>{l.isOk?(V([t.kind]),w.success(y("trading.derivative.changeSlSuccess"))):(r.applyOptions({price:o}),F(l.message))})),a||(r.applyOptions({price:o}),w.show(y("trading.derivative.noChangeOrderLine")))}break;case"line":p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:"line",point:o});const s=t.color,u=t.title;p.dispatch("tradingDerivative/drawTools",{isRemove:!1,name:"line",points:[n],data:[{color:s,title:u}]}),U.value.classList.remove("selected");break;case"target":if(v.isSet(e.tools.target.B)){let a={isRemove:!1,name:"target",points:[],data:[]},l,d,f=+e.tools.target.A.options().price,h=+e.tools.target.B.options().price,g=h-f;if(l="A",t.point=="A")g=+e.tools.target.B.options().title,h=f+g;else if(t.point!="B"){let x=0;switch(t.point){case"X":x=1.5;break;case"Y":x=2;break;case"Z":x=3;break;case"W":x=5;break}g=parseFloat(((h-n)/x).toFixed(1)),f=h-g,d={price:f},e.tools.target[l].applyOptions(d)}a.points.push(l),a.data.push(f),l="B",d={price:h,title:g.toFixed(1)},t.point==l&&delete d.price,e.tools.target[l].applyOptions(d),a.points.push(l),a.data.push(h),l="X",d={price:parseFloat((f-.5*g).toFixed(1)),title:(-.5*g).toFixed(1)},t.point==l&&delete d.price,e.tools.target[l].applyOptions(d),l="Y",d={price:parseFloat((f-g).toFixed(1)),title:(-g).toFixed(1)},t.point==l&&delete d.price,e.tools.target[l].applyOptions(d),l="Z",d={price:parseFloat((f-2*g).toFixed(1)),title:(-2*g).toFixed(1)},t.point==l&&delete d.price,e.tools.target[l].applyOptions(d),l="W",d={price:parseFloat((f-4*g).toFixed(1)),title:(-4*g).toFixed(1)},t.point==l&&delete d.price,e.tools.target[l].applyOptions(d),p.dispatch("tradingDerivative/drawTools",a)}break;case"pattern":if(v.isSet(e.tools.pattern.B)){let a,l;const d=e.tools.pattern.A.options(),f=e.tools.pattern.B.options(),h=e.tools.pattern.C.options(),g={A:{time:+d.time,price:+d.price},B:{price:+f.price},C:{price:+h.price}},{pattern:x,timeMark:M,info:{el1:A,el2:W,el3:Z,entry:I,x:P,X:se,y:ne,Y:zt}}=ee(g);ge(x),ye(M),J(g),a="A",l={title:`A ${A}`},e.tools.pattern[a].applyOptions(l),a="B",l={title:`B ${W}`},e.tools.pattern[a].applyOptions(l),a="C",l={title:`C ${Z}`},e.tools.pattern[a].applyOptions(l),a="D",l={price:I,title:"Entry"},t.point==a&&delete l.price,e.tools.pattern[a].applyOptions(l),a="X",l={price:parseFloat(P.toFixed(1)),title:"X "+parseFloat(se.toFixed(1))},e.tools.pattern[a].applyOptions(l),a="Y",l={price:parseFloat(ne.toFixed(1)),title:"Y "+parseFloat(zt.toFixed(1))},e.tools.pattern[a].applyOptions(l)}break}}function tt(){O.value&&(e.chart.resize(O.value.offsetWidth,O.value.offsetHeight),O.value.classList.contains("fullscreen")&&(document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"))}function Fe(i){if(i.ctrlKey)switch(i.keyCode){case 219:e.chart.timeScale().applyOptions({barSpacing:e.chart.options().timeScale.barSpacing-.01});break;case 221:e.chart.timeScale().applyOptions({barSpacing:e.chart.options().timeScale.barSpacing+.01});break}if(i.altKey)switch(i.keyCode){case 219:e.chart.timeScale().scrollToPosition(e.chart.timeScale().scrollPosition()-50);break;case 221:e.chart.timeScale().scrollToPosition(e.chart.timeScale().scrollPosition()+50);break}}function Oe(){O.value&&(document.fullscreenElement?(c.isFullscreen=!0,O.value.classList.add("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"):(c.isFullscreen=!1,O.value.classList.remove("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="unset",document.querySelector(".header-component").style.visibility="unset",document.querySelector(".sc-launcher").style.visibility="unset",document.querySelector(".dx-drawer-content").style.transform="translate(0px, 0px)"))}function it(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function rt(i){Pt(),Object.entries(i).forEach(([r,t])=>{switch(r){case"order":at(t);break;case"pattern":Ae(i.pattern);break;case"tr":Tt(Object.values(t));break;case"line":Ft(t);break;case"target":At(t);break}})}function ot(i){c.chartDate==k&&_()||(i.price.length>0&&(e.data.whitespace=K(e.data.whitespace,Re(c.chartDate))),e.series.whitespace.setData(e.data.whitespace),e.data.price=K(e.data.price,i.price),e.series.price.setData(e.data.price))}function Le(i){let r=[];i.forEach(t=>{const o=T(Se(new Date(t.date),7));r.push({time:o,value:t.price})}),r.length>1?(e.data.price=K(e.data.price,r),e.series.price.setData(e.data.price)):(e.data.price.push(r[0]),e.series.price.update(r[0]))}function Re(i){const r=T(new Date(`${i}T09:00:00Z`)),t=T(new Date(`${i}T11:30:00Z`)),o=T(new Date(`${i}T13:00:00Z`)),n=T(new Date(`${i}T14:30:00Z`)),s=T(new Date(`${i}T14:00:00Z`));let u=[];for(let a=r;a<=n;a++){if(a>t&&a<o)continue;let l={time:a};(a==s||a==n)&&(l.value=1),u.push(l)}return u}function K(i,r){return Array.from(new Map([...i,...r].sort((t,o)=>t.time-o.time).map(t=>[t.time,t])).values())}function me(){p.dispatch("tradingDerivative/setChartLoading",!0),e.websocket=new WebSocket(Ii),e.websocket.onopen=i=>{let r='{"protocol":"json","version":1}';e.websocket.send(r),r='{"arguments":["VN30F1M"],"invocationId":"0","target":"SubscribeTrades","type":1}',e.websocket.send(r),e.socketSendData=r},e.websocket.onclose=i=>{!e.socketStop&&_()&&(c.isSocketWarning=!0,me())},e.websocket.onmessage=i=>{c.isSocketWarning=!1,st(i.data).forEach(t=>{if(!t)return!1;t.type==3?(H(),e.data.whitespace=K(e.data.whitespace,Re(k)),e.series.whitespace.setData(e.data.whitespace),Le(t.result),p.dispatch("tradingDerivative/setChartLoading",!1)):t.type==1&&t.target=="UpdateTrades"&&t.arguments[0]=="VN30F1M"&&(Bt(t.arguments[1].at(-1).price),Le(t.arguments[1]))})}}function st(i){let r=[];return i.split("").forEach(t=>{const o=t.indexOf("{"),n=t.lastIndexOf("}");let s=null;if(o!==-1&&n!==-1&&n>o){const u=t.substring(o,n+1);u!="{}"&&(s=JSON.parse(u))}r.push(s)}),r}function nt(){e.currentSeconds=T(Se(new Date,7)),_()&&(D.value.position&&e.currentSeconds>b.ATC-5*60&&(c.isOrderWarning=!0,e.currentSeconds>b.ATC-15&&v.isSet(e.tools.order.tp.line)&&p.dispatch("tradingDerivative/executeOrder",{action:"cancel",tpData:{cmd:"cancel"},slData:{cmd:"delete"}}).then(i=>{i.isOk?($(["entry","tp","sl"]),w.success(y("trading.derivative.autoCancelTpSlSuccess"))):F(i.message)})),L.value.openingMarket&&e.currentSeconds==b.START&&me()),c.clock=ae(new Date,"HH:mm:ss")}function V(i){const r="order";let t={isRemove:!1,name:r,points:[],data:[]},o,n;i.forEach(s=>{switch(s){case"entry":o="yellow",n=e.tools.order.side>0?"LONG":"SHORT";break;case"tp":o="lime",n=parseFloat(Math.abs(e.tools.order.tp.price-e.tools.order.entry.price).toFixed(1));break;case"sl":o="red",n=parseFloat(Math.abs(e.tools.order.sl.price-e.tools.order.entry.price).toFixed(1));break}if(t.points.push(s),v.isSet(e.tools.order[s].line))e.tools.order[s].line.applyOptions({price:e.tools.order[s].price,title:n}),t.data.push(e.tools.order[s].line.options());else{const u={lineType:r,kind:s,side:e.tools.order.side,price:e.tools.order[s].price,color:o,lineWidth:1,lineStyle:0,title:n,draggable:!0};e.tools.order[s].line=e.series.price.createPriceLine(u),t.data.push(u)}}),p.dispatch("tradingDerivative/drawTools",t)}function at(i){Object.entries(i).forEach(([r,t])=>{e.tools.order.side=t.side,e.tools.order[r].price=t.price,e.tools.order[r].line=e.series.price.createPriceLine(t)})}function $(i,r=!0){r&&p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:"order"}),i.forEach(t=>{v.isSet(e.tools.order[t].line)&&(e.series.price.removePriceLine(e.tools.order[t].line),delete e.tools.order[t].line)})}function lt(i){c.showTradingView=!c.showTradingView,i.stopPropagation()}function ct(){p.dispatch("tradingDerivative/setAutoScan",!L.value.autoScan)}function ge(i){c.pattern=i}function dt(i){c.showScanContext=!1,c.showLineContext=!1;const r=i.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(t=>t.classList.remove("selected")),r||(te(),J(),i.target.classList.add("selected"))}function pt(){c.showScanContext=!c.showScanContext,c.showLineContext=!1}function ut(){const i=c.scanSide=="left",r=e.crosshair.time?e.data.price.filter(o=>!S(o.time,i,e.crosshair.time)):e.data.price;let t=i?ft(r):vt(r);t=mt(t),v.isSet(t)&&(te(),Ae(t),J(t)),ve.value.classList.remove("selected")}function ft(i){let r,[t,o,n,s]=Array(4).fill({});for(let u=i.length-1;u>=0;u--){const a=i[u].value,l=i[u].time,d=R(l);if(d==-1)break;if(u==i.length-1&&(n={index:d,time:l,price:a},[o,t,s]=Array(3).fill(null).map(()=>v.cloneDeep(n))),r==null){if(a==n.price)continue;r=a>n.price}if(S(a,r,o.price)&&(S(t.price,!r,n.price)?([n,o]=[o,t].map(f=>v.cloneDeep(f)),t={index:d,time:l,price:a},s=v.cloneDeep(t),r=!r):o={index:d,time:l,price:a}),S(a,!r,t.price)?(t={index:d,time:l,price:a},s=v.cloneDeep(t)):s.index=d,S(a,r,s.price)&&(s={index:d,time:l,price:a}),n.index>t.index){const f=Math.abs(o.price-n.price);if(f>=1.5&&(t.index-s.index>n.index-o.index||Math.abs(t.price-s.price)>f))break}}return{A:t,B:o,C:n}}function vt(i){let r,[t,o,n]=Array(3).fill({});for(let s=0;s<i.length;s++){const u=i[s].value,a=i[s].time,l=R(a);if(l==-1)break;if(s==0&&(t={index:l,time:a,price:u},o=v.cloneDeep(t),n=v.cloneDeep(t)),r==null){if(u==t.price)continue;r=u>t.price}S(u,r,o.price)&&(o={index:l,time:a,price:u},n=v.cloneDeep(o)),S(o.price,r,t.price)&&S(u,!r,n.price)&&(S(u,r,t.price)?n={index:l,time:a,price:u}:(t=v.cloneDeep(o),o={index:l,time:a,price:u},n=v.cloneDeep(o),r=!r))}return{A:t,B:o,C:n}}function mt(i){const r={};return Object.entries(i).forEach(([t,o])=>{const{index:n,...s}=o;r[t]=s}),r}function gt(i){c.showScanContext=!1,c.showLineContext=!1;const r=i.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(t=>t.classList.remove("selected")),r||i.target.classList.add("selected")}function ht(i){i.target.classList.remove("selected"),te(),J()}function yt(){const i="pattern",r=re(e.crosshair.y),t=e.crosshair.time;let o={lineType:i,price:r,lineWidth:1,lineStyle:0,draggable:!0};if(v.isSet(e.tools.pattern.A)){const n=e.tools.pattern.A.options();if(v.isSet(e.tools.pattern.B)){const s=e.tools.pattern.B.options();let u,a,l;if(v.isSet(e.tools.pattern.C)){let d,f;const h=e.tools.pattern.C.options();u={A:{time:t,price:r},B:{price:+s.price},C:{price:+h.price}};const{pattern:g,timeMark:x,info:{el1:M,el2:A,el3:W,entry:Z,x:I,X:P,y:se,Y:ne}}=ee(u);l=g,a=x,d="A",f={price:r,time:t,title:`A ${M}`},e.tools.pattern[d].applyOptions(f),d="B",f={title:`B ${A}`},e.tools.pattern[d].applyOptions(f),d="C",f={title:`C ${W}`},e.tools.pattern[d].applyOptions(f),d="D",f={price:Z,title:"Entry"},e.tools.pattern[d].applyOptions(f),d="X",f={price:parseFloat(I.toFixed(1)),title:"X "+parseFloat(P.toFixed(1))},e.tools.pattern[d].applyOptions(f),d="Y",f={price:parseFloat(se.toFixed(1)),title:"Y "+parseFloat(ne.toFixed(1))},e.tools.pattern[d].applyOptions(f)}else{u={A:{time:+n.time,price:+n.price},B:{price:+s.price},C:{price:r}};const{pattern:d,timeMark:f,info:{el1:h,el2:g,el3:x,entry:M,x:A,X:W,y:Z,Y:I}}=ee(u);l=d,a=f;let P="A";e.tools.pattern[P].applyOptions({title:`A ${h}`}),P="B",e.tools.pattern[P].applyOptions({title:`B ${g}`}),o.point="C",o.title=`C ${x}`,o.color="#FF9800",e.tools.pattern[o.point]=e.series.price.createPriceLine(o),o.point="D",o.price=M,o.title="Entry",o.color="#9C27B0",o.draggable=!1,e.tools.pattern[o.point]=e.series.price.createPriceLine(o),o.point="Y",o.price=parseFloat(Z.toFixed(1)),o.title="Y "+parseFloat(I.toFixed(1)),o.color="#E91E63",o.draggable=!1,e.tools.pattern[o.point]=e.series.price.createPriceLine(o),o.point="X",o.price=parseFloat(A.toFixed(1)),o.title="X "+parseFloat(W.toFixed(1)),o.color="#2196F3",o.draggable=!1,e.tools.pattern[o.point]=e.series.price.createPriceLine(o)}ge(l),ye(a),J(u),ue.value.classList.remove("selected")}else o.point="B",o.title="B 0",o.color="#4CAF50",e.tools.pattern[o.point]=e.series.price.createPriceLine(o)}else o.point="A",o.title="A 0",o.color="#F44336",o.time=t,e.tools.pattern[o.point]=e.series.price.createPriceLine(o)}function Ae(i){let t={lineType:"pattern",lineWidth:1,lineStyle:0,draggable:!0};const{pattern:o,timeMark:n,info:{el1:s,el2:u,el3:a,entry:l,x:d,X:f,y:h,Y:g}}=ee(i);ge(o),ye(n),t.point="A",t.title=`A ${s}`,t.color="#F44336",t.price=i.A.price,t.time=i.A.time,e.tools.pattern[t.point]=e.series.price.createPriceLine(t),t.point="B",t.title=`B ${u}`,t.color="#4CAF50",t.price=i.B.price,e.tools.pattern[t.point]=e.series.price.createPriceLine(t),t.point="C",t.price=i.C.price,t.title=`C ${a}`,t.color="#FF9800",e.tools.pattern[t.point]=e.series.price.createPriceLine(t),t.point="D",t.price=l,t.title="Entry",t.color="#9C27B0",t.draggable=!1,e.tools.pattern[t.point]=e.series.price.createPriceLine(t),t.point="Y",t.price=parseFloat(h.toFixed(1)),t.title="Y "+parseFloat(g.toFixed(1)),t.color="#E91E63",t.draggable=!1,e.tools.pattern[t.point]=e.series.price.createPriceLine(t),t.point="X",t.price=parseFloat(d.toFixed(1)),t.title="X "+parseFloat(f.toFixed(1)),t.color="#2196F3",t.draggable=!1,e.tools.pattern[t.point]=e.series.price.createPriceLine(t)}function ee(i){const r=he(i.A,i.B),t=he(r.R,i.C),o=he(t.R,i.B),n=parseFloat(r.el.toFixed(1)),s=parseFloat(t.el.toFixed(1)),u=parseFloat(o.el.toFixed(1)),a=i.B.price-i.C.price,l=a>0,d=Math.abs(a),f=[r.R.index+r.tr,t.R.index+t.tr,o.R2.index+o.tr];let h=r.R1.price,g=0;d>r.pr&&o.R.index-r.R.index>r.tr&&S(i.C.price,l,r.S1.price)&&(h=t.S1.price,g=1,Math.abs(i.C.price-o.R.price)>t.pr&&o.R.index-t.R.index>t.tr&&S(o.R.price,!l,t.S1.price)&&Math.abs(o.R.price-o.S1.price)>o.pr&&o.R.index-o.R2.index>o.tr&&S(o.S2.price,l,o.S1.price)&&(h=o.R2.price,g=2));const x=i.B.price,M=r.R1.price,A=x-M,W=x+A,Z=parseInt((o.R.index-r.R.index)/r.tr),I=A*Z,P=x+I;return{pattern:g,timeMark:f,info:{el1:n,el2:s,el3:u,entry:h,x:W,X:A,y:P,Y:I}}}function he(i,r){let t=v.cloneDeep(i),o=v.cloneDeep(r);const n=o.price>t.price;let s={},u={},a={};e.data.price.filter(d=>d.time>=t.time).every((d,f)=>{const h=d.value,g=d.time,x=R(g);return x==-1?!1:((f==0||h==t.price)&&(s={R:{index:x,time:g,price:h},S:{index:x,time:g,price:h},pr:0,tr:0},u=s,a=s),S(h,n,s.R.price)?(Math.abs(s.R.price-u.R.price),s.tr>=a.tr&&s.pr>=a.pr&&(a=s),s={R:{index:x,time:g,price:h},S:{index:x,time:g,price:h},pr:0,tr:0}):(s.S.index=x,s.tr=s.S.index-s.R.index,S(h,!n,s.S.price)&&(s.S.time=g,s.S.price=h,s.pr=Math.abs(s.S.price-s.R.price))),S(h,!n,t.price)?(s.S.price=t.price,!1):!!S(h,!n,o.price))}),o.index=s.S.index,o.time=oe(s.S.index);const l=Math.abs(o.price-a.R.price);return{tr:a.tr,pr:a.pr,exr:l,el:a.pr!=0?l/a.pr:0,S1:a.S,R1:a.R,S2:s.S,R2:s.R,S:t,R:o}}function J(i={}){let r=!v.isSet(i),t={isRemove:r,name:"pattern",points:[],data:[]};r||Object.entries(i).forEach(([o,n])=>{t.points.push(o),t.data.push(n)}),p.dispatch("tradingDerivative/drawTools",t)}function te(){v.isSet(e.tools.pattern.A)&&(e.series.price.removePriceLine(e.tools.pattern.A),v.isSet(e.tools.pattern.B)&&(e.series.price.removePriceLine(e.tools.pattern.B),v.isSet(e.tools.pattern.C)&&(e.series.price.removePriceLine(e.tools.pattern.C),e.series.price.removePriceLine(e.tools.pattern.D),e.series.price.removePriceLine(e.tools.pattern.X),e.series.price.removePriceLine(e.tools.pattern.Y)))),j(["pattern"]),xt()}function ye(i){const r=["#F44336","#4CAF50","#FF9800"];let t=[];for(let o=0;o<i.length;o++)t.push({time:oe(i[o]),value:1,color:r[o]});t.sort((o,n)=>o.time-n.time),e.series.timeMark.setData(t)}function xt(){e.series.timeMark.setData([])}function St(i){c.showScanContext=!1,c.showLineContext=!1;const r=i.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(t=>t.classList.remove("selected")),r||i.target.classList.add("selected")}function Ct(i){Pe(),i.target.classList.remove("selected")}function wt(){let i={isRemove:!1,name:"tr",points:[],data:[]};const r=e.crosshair.time;let t={time:r,value:1};switch(e.tools.timeRange.length){case 0:t.color="OrangeRed",e.tools.timeRange[0]=t,i.points.push(0),i.data.push(r);break;case 1:t.color="lime",e.tools.timeRange[1]=t,i.points.push(1),i.data.push(r),G.value.classList.remove("selected");break;default:const o=R(e.tools.timeRange[0].time),n=R(e.tools.timeRange[1].time),u=R(r)+(n-o),a=oe(u);t.color="OrangeRed",e.tools.timeRange[0]=v.cloneDeep(t),i.points.push(0),i.data.push(r),t.time=a,t.color="lime",e.tools.timeRange[1]=t,i.points.push(1),i.data.push(a),G.value.classList.remove("selected");break}e.series.timeRange.setData(e.tools.timeRange),p.dispatch("tradingDerivative/drawTools",i)}function Tt(i){let r,t;if(i.length==2)r=i[0],t=i[1];else if(i.length==3){const n=R(i[0]),s=R(i[1]),a=R(i[2])+(s-n);r=i[2],t=oe(a)}else return!1;let o=[{time:r,value:1,color:"OrangeRed"},{time:t,value:1,color:"lime"}];e.tools.timeRange=o,e.series.timeRange.setData(o)}function Pe(i=!0,r=!1){i&&p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:"tr"}),r||(e.series.timeRange.setData([]),j(["tr"]))}function kt(i){c.showScanContext=!1,c.showLineContext=!1;const r=i.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(t=>t.classList.remove("selected")),r||i.target.classList.add("selected")}function bt(i){c.showLineContext=!c.showLineContext,c.showScanContext=!1}function Dt(){const i="line",r=re(e.crosshair.y),t=e.tools.lines.length;if(e.tools.lines=e.tools.lines.filter(o=>{const n=o.options(),s=n.type=r==+n.price;return s&&(e.series.price.removePriceLine(o),p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:i,point:r})),!s}),e.tools.lines.length==t){const o=c.lineColor,n=c.lineTitle,s={lineType:i,price:r,color:o,title:n,lineWidth:1,lineStyle:1,draggable:!0};e.tools.lines.push(e.series.price.createPriceLine(s)),p.dispatch("tradingDerivative/drawTools",{isRemove:!1,name:i,points:[r],data:[{color:o,title:n}]})}U.value.classList.remove("selected")}function Ft(i){const t={lineType:"line",lineWidth:1,lineStyle:1,draggable:!0};Object.entries(i).forEach(([o,{color:n,title:s}])=>{t.price=+o,t.color=n,t.title=s,e.tools.lines.push(e.series.price.createPriceLine(t))})}function Ee(i=!0){e.tools.lines.length>0&&(i&&p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:"line"}),e.tools.lines.forEach(r=>e.series.price.removePriceLine(r)),j(["lines"]))}function Ot(i){c.showScanContext=!1,c.showLineContext=!1;const r=i.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(t=>t.classList.remove("selected")),r||(i.target.classList.add("selected"),xe())}function Lt(i){xe(),i.target.classList.remove("selected")}function Rt(){const i="target",r=re(e.crosshair.y);let t={lineType:i,price:r,lineWidth:1,lineStyle:1,draggable:!0},o={isRemove:!1,name:i,points:[],data:[r]};if(v.isSet(e.tools.target.A)){const n=+e.tools.target.A.options().price,s=r-n;t.point="B",t.title=parseFloat(s.toFixed(1)),t.color="#F44336",e.tools.target[t.point]=e.series.price.createPriceLine(t),o.points.push(t.point),t.point="X",t.price=parseFloat((n-.5*s).toFixed(1)),t.title=parseFloat((-.5*s).toFixed(1)),t.color="#2196F3",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="Y",t.price=parseFloat((n-s).toFixed(1)),t.title=parseFloat(-s.toFixed(1)),t.color="#673AB7",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="Z",t.price=parseFloat((n-2*s).toFixed(1)),t.title=parseFloat((-2*s).toFixed(1)),t.color="#9C27B0",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="W",t.price=parseFloat((n-4*s).toFixed(1)),t.title=parseFloat((-4*s).toFixed(1)),t.color="#E91E63",e.tools.target[t.point]=e.series.price.createPriceLine(t),fe.value.classList.remove("selected")}else t.point="A",t.title="0",t.color="#FF9800",e.tools.target[t.point]=e.series.price.createPriceLine(t),o.points.push(t.point);p.dispatch("tradingDerivative/drawTools",o)}function At(i){let t={lineType:"target",lineWidth:1,lineStyle:1,draggable:!0};const o=i.A,n=i.B,s=n-o;t.point="A",t.price=o,t.title="0",t.color="#FF9800",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="B",t.price=n,t.title=parseFloat(s.toFixed(1)),t.color="#F44336",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="X",t.price=parseFloat((o-.5*s).toFixed(1)),t.title=parseFloat((-.5*s).toFixed(1)),t.color="#2196F3",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="Y",t.price=parseFloat((o-s).toFixed(1)),t.title=parseFloat(-s.toFixed(1)),t.color="#673AB7",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="Z",t.price=parseFloat((o-2*s).toFixed(1)),t.title=parseFloat((-2*s).toFixed(1)),t.color="#9C27B0",e.tools.target[t.point]=e.series.price.createPriceLine(t),t.point="W",t.price=parseFloat((o-4*s).toFixed(1)),t.title=parseFloat((-4*s).toFixed(1)),t.color="#E91E63",e.tools.target[t.point]=e.series.price.createPriceLine(t)}function xe(i=!0){i&&p.dispatch("tradingDerivative/drawTools",{isRemove:!0,name:"target"}),v.isSet(e.tools.target.A)&&(e.series.price.removePriceLine(e.tools.target.A),v.isSet(e.tools.target.B)&&(e.series.price.removePriceLine(e.tools.target.B),e.series.price.removePriceLine(e.tools.target.X),e.series.price.removePriceLine(e.tools.target.Y),e.series.price.removePriceLine(e.tools.target.Z),e.series.price.removePriceLine(e.tools.target.W))),j(["target"])}function Pt(){$(["entry","tp","sl"],!1),Ee(!1),xe(!1),Pe(!1),te()}function ie(i){if(i){if(_()&&(v.isSet(e.tools.order.tp.line)||D.value.position&&e.currentSeconds>b.ATO&&e.currentSeconds<b.ATC&&(z.value.style.left=+(e.crosshair.x+(e.crosshair.x>innerWidth-61?-61:1))+"px",z.value.style.top=+(e.crosshair.y+(e.crosshair.y>innerHeight-51?-51:1))+"px",z.value.style.display="block"),!v.isSet(e.tools.order.entry.line))){let r=null,t=0;D.value.position?(e.currentSeconds<b.ATO?r="ATO":e.currentSeconds>b.ATC&&(r="ATC"),r&&(e.tools.order.entry.price=r,t=-D.value.position)):e.currentSeconds>b.ATO&&e.currentSeconds<b.ATC&&(r=re(e.crosshair.y),t=r>=e.data.price.at(-1).value?1:-1,e.tools.order.side=t,e.tools.order.entry.price=r),t&&(B.value.style.left=+(e.crosshair.x+(e.crosshair.x>innerWidth-71?-71:1))+"px",B.value.style.top=+(e.crosshair.y+(e.crosshair.y>innerHeight-61?-61:1))+"px",B.value.style.background=t>0?"green":"red",B.value.innerText=`${t>0?"LONG":"SHORT"} ${r}`,B.value.style.display="block")}}else B.value.style.display="none",z.value.style.display="none"}function Et(){_()&&(e.currentSeconds<b.ATO?We(y("trading.derivative.atoOrder"),y("titles.confirm")).then(r=>{r&&p.dispatch("tradingDerivative/executeOrder",{action:"exit",exitData:{cmd:"new",price:"ATO"}}).then(t=>{t.isOk?w.success(y("trading.derivative.atoOrderSuccess")):F(t.message)})}):e.currentSeconds<b.ATC?p.dispatch("tradingDerivative/executeOrder",{action:"entry",etData:{cmd:"new",side:e.tools.order.side,price:e.tools.order.entry.price}}).then(i=>{i.isOk?(V(["entry"]),w.success(y("trading.derivative.newEntrySuccess"))):F(i.message)}):We(y("trading.derivative.atcOrder"),y("titles.confirm")).then(r=>{r&&p.dispatch("tradingDerivative/executeOrder",{action:"exit",exitData:{cmd:"new",price:"ATC"}}).then(t=>{t.isOk?w.success(y("trading.derivative.atcOrderSuccess")):F(t.message)})}))}function _t(){e.tools.order.tp.price=e.tools.order.entry.price+e.tools.order.side*Ze,e.tools.order.sl.price=e.tools.order.entry.price-e.tools.order.side*Ve,p.dispatch("tradingDerivative/executeOrder",{action:"tpsl",tpData:{cmd:"new",price:e.tools.order.tp.price},slData:{cmd:"new",price:e.tools.order.sl.price}}).then(i=>{i.isOk?(e.tools.order.entry.line.applyOptions({draggable:!1}),V(["entry","tp","sl"]),w.success(y("trading.derivative.newTpSlSuccess"))):F(i.message)})}function It(){v.isSet(e.tools.order.entry.line)?v.isSet(e.tools.order.tp.line)?p.dispatch("tradingDerivative/executeOrder",{action:"exit",tpData:{cmd:"cancel"},slData:{cmd:"delete"},exitData:{cmd:"new",price:"MTL"}}).then(i=>{i.isOk?($(["entry","tp","sl"]),w.success(y("trading.derivative.exitSuccess"))):F(i.message)}):p.dispatch("tradingDerivative/executeOrder",{action:"entry",etData:{cmd:"delete"}}).then(i=>{i.isOk?($(["entry"]),w.success(y("trading.derivative.deleteEntrySuccess"))):F(i.message)}):H()}function Bt(i){v.isSet(e.tools.order.entry.line)&&(v.isSet(e.tools.order.tp.line)?((e.tools.order.side>0&&i>=e.tools.order.tp.price||e.tools.order.side<0&&i<=e.tools.order.tp.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,p.dispatch("tradingDerivative/executeOrder",{action:"sl",slData:{cmd:"delete"}}).then(r=>{r.isOk?($(["entry","tp","sl"]),w.success(y("trading.derivative.deleteTpSuccess")),ie(!1)):F(r.message),e.isAutoOrdering=!1}))),(e.tools.order.side>0&&i<=e.tools.order.sl.price||e.tools.order.side<0&&i>=e.tools.order.sl.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,p.dispatch("tradingDerivative/executeOrder",{action:"tp",tpData:{cmd:"cancel"}}).then(r=>{r.isOk?($(["entry","tp","sl"]),w.success(y("trading.derivative.deleteSlSuccess")),ie(!1)):F(r.message),e.isAutoOrdering=!1})))):(e.tools.order.side>0&&i>=e.tools.order.entry.price||e.tools.order.side<0&&i<=e.tools.order.entry.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,setTimeout(()=>{e.tools.order.tp.price=e.tools.order.entry.price+e.tools.order.side*Ze,e.tools.order.sl.price=e.tools.order.entry.price-e.tools.order.side*Ve,p.dispatch("tradingDerivative/executeOrder",{action:"tpsl",tpData:{cmd:"new",price:e.tools.order.tp.price},slData:{cmd:"new",price:e.tools.order.sl.price}}).then(r=>{r.isOk?(e.tools.order.entry.line.applyOptions({draggable:!1}),V(["entry","tp","sl"]),w.success(y("trading.derivative.autoNewTpSlSuccess"))):F(r.message),e.isAutoOrdering=!1})},1e3))))}function Mt(){e.chart.timeScale().scrollToRealTime()}function _(){return L.value.openingMarket&&e.currentSeconds>=b.START&&e.currentSeconds<=b.END}function re(i){return parseFloat(e.series.price.coordinateToPrice(i).toFixed(1))}function F(i){i||(i="unknown"),w.error(y(`trading.derivative.${i}`))}function Wt(){if(!c.chartDate)return!1;p.dispatch("tradingDerivative/getChartData",c.chartDate)}function _e(){_()&&e.websocket.send(e.socketSendData)}function Zt(){e.data.whitespace=[],e.data.price=[],_e(),p.dispatch("tradingDerivative/getChartData",c.chartDate)}function Ie(){p.dispatch("tradingDerivative/getStatus")}function H(){p.dispatch("tradingDerivative/getTools")}function j(i){i==null&&(i=["order","lines","tr","pattern","target"]),i.includes("order")&&(e.tools.order={side:0,entry:{},tp:{},sl:{}}),i.includes("lines")&&(e.tools.lines=[]),i.includes("target")&&(e.tools.target={}),i.includes("tr")&&(e.tools.timeRange=[]),i.includes("pattern")&&(e.tools.pattern={})}function Vt(){p.dispatch("tradingDerivative/getAccountInfo").then(i=>{let r="";r+='<div style="width: 200px;">',r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${y("trading.derivative.nav")}</div><div>: ${Q.currency(i.nav)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${y("trading.derivative.maxVol")}</div><div>: ${Q.numberVnFormat(i.maxVol)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${y("trading.derivative.vm")}</div><div>: ${Q.currency(i.vm)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${y("trading.derivative.fee")}</div><div>: ${Q.currency(i.fee)}</div></div>`,r+="</div>",si(r,y("trading.derivative.accountInfo"))})}function $t(){pe.emit("checkPin",()=>p.dispatch("tradingDerivative/report"))}function Yt(){pe.emit("checkPin",()=>p.dispatch("tradingDerivative/export",c.chartDate))}function Nt(){Te.value.show()}function Xt(){pe.emit("checkPin",()=>p.dispatch("tradingDerivative/loginDnse"))}function S(i,r,t,o=!1){return r?o?i>=t:i>t:o?i<=t:i<t}function R(i){let r=e.data.whitespace.findIndex(t=>t.time==i);if(r==-1){const t=ae(new Date(i*1e3),"yyyy-MM-dd"),o=T(new Date(`${t}T11:30:00Z`)),n=T(new Date(`${t}T13:00:00Z`)),s=T(new Date(`${t}T14:30:00Z`));i>o&&i<n?i=o:i>s&&(i=s),r=e.data.whitespace.findIndex(u=>u.time==i)}return r}function oe(i){return e.data.whitespace[i].time}return(i,r)=>{const t=ni("DxToolbar");return ai(),Kt(ii,null,[m("div",fi,[le(t,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:i.$t("trading.derivative.buttons.report"),onClick:$t}},{location:"before",widget:"dxButton",options:{icon:"far fa-cloud-arrow-down small",hint:i.$t("trading.derivative.buttons.export"),onClick:Yt}},{location:"before",widget:"dxButton",options:{icon:"far fa-arrow-right-to-arc small",hint:i.$t("trading.derivative.buttons.loginVps"),onClick:Nt}},{visible:!1,location:"before",widget:"dxButton",options:{icon:"far fa-sign-in-alt small",hint:i.$t("trading.derivative.buttons.loginDnse"),onClick:Xt}}]},null,8,["items"]),m("div",{class:"order-chart-container",ref_key:"chartContainerRef",ref:O,onClick:Ue,onContextmenu:Ge},[m("div",{class:"chart-wrapper",ref_key:"orderChartRef",ref:we},[m("div",{class:"area data-area",onClick:be,onContextmenu:De},[m("div",{ref_key:"connectionRef",ref:Ye,class:E(["command",{yellow:D.value.pending}]),title:i.$t("trading.derivative.connection"),onClick:Ie},[m("i",{class:E(["far",{"fa-link-simple":D.value.connection,"fa-link-simple-slash":!D.value.connection,blink:c.isSocketWarning}])},null,2)],10,vi),m("div",{class:E(["command status",{green:D.value.position>0,red:D.value.position<0}]),title:i.$t("trading.derivative.position"),onClick:Vt},Me(D.value.position),11,mi),m("div",{class:"command clock",onClick:_e},Me(c.clock),1),q(m("input",{type:"date",class:"chart-date command",title:i.$t("trading.derivative.date"),"onUpdate:modelValue":r[0]||(r[0]=o=>c.chartDate=o),onChange:Wt},null,40,gi),[[ei,c.chartDate]]),m("div",{ref_key:"reloadToolRef",ref:ze,class:"command",title:i.$t("trading.derivative.reload"),onClick:Zt,onContextmenu:H},[m("i",{class:E(["far fa-sync-alt",{"fa-spin":je.value}])},null,2)],40,hi)],32),m("div",{class:"area tool-area",onClick:be,onContextmenu:De},[m("div",{ref_key:"fullscreenToolRef",ref:Ne,class:"command",title:i.$t("trading.derivative.fullscreen"),onClick:it},[m("i",{class:E(["far",{"fa-compress":c.isFullscreen,"fa-expand":!c.isFullscreen}])},null,2)],8,yi),m("div",{ref_key:"tradingviewRef",ref:Je,class:"command far fa-chart-candlestick",title:i.$t("trading.derivative.tradingview"),onClick:lt},null,8,xi),m("div",{class:E(["context command",{green:c.pattern}]),title:i.$t("trading.derivative.progressTool"),onClick:ct},[m("i",{class:E(["far",{"fa-badge-check":!c.pattern,[`fa-circle-${c.pattern}`]:c.pattern,blink:L.value.autoScan}])},null,2)],10,Si),m("div",{ref_key:"scanToolRef",ref:ve,class:"context command",title:i.$t("trading.derivative.scanTool"),onClick:dt,onContextmenu:pt},[m("i",{class:E(["far",{[`fa-angles-${c.scanSide}`]:!0}])},null,2),q(le(ci,{class:"contextmenu",modelValue:c.scanSide,"onUpdate:modelValue":r[1]||(r[1]=o=>c.scanSide=o)},null,8,["modelValue"]),[[ce,c.showScanContext]])],40,Ci),m("div",{ref_key:"patternToolRef",ref:ue,class:"command",title:i.$t("trading.derivative.patternTool"),onClick:gt,onContextmenu:ht},ki,40,wi),m("div",{ref_key:"lineToolRef",ref:U,class:"context command",title:i.$t("trading.derivative.lineTool"),onClick:kt,onContextmenu:bt},[Di,q(le(li,{class:"contextmenu",enable:c.showLineContext,title:c.lineTitle,"onUpdate:title":r[2]||(r[2]=o=>c.lineTitle=o),color:c.lineColor,"onUpdate:color":r[3]||(r[3]=o=>c.lineColor=o),onDeleteAllLine:Ee},null,8,["enable","title","color"]),[[ce,c.showLineContext]])],40,bi),m("div",{ref_key:"timeRangeToolRef",ref:G,class:"command",title:i.$t("trading.derivative.timeRangeTool"),onClick:St,onContextmenu:Ct},Li,40,Fi),m("div",{ref_key:"targetToolRef",ref:fe,class:"command",title:i.$t("trading.derivative.targetTool"),onClick:Ot,onContextmenu:Lt},Pi,40,Ri),q(m("div",{ref_key:"cancelOrderRef",ref:He,class:"cancel-order command",title:i.$t("trading.derivative.cancelTool"),onClick:It},[m("i",{class:E(["far fa-trash-alt",{blink:c.isOrderWarning}])},null,2)],8,Ei),[[ce,qe.value]])],32),m("div",null,[m("div",{ref_key:"entryOrderRef",ref:B,class:"order-button entry",onClick:Et}," Entry ",512),m("div",{ref_key:"tpslOrderRef",ref:z,class:"order-button tpsl",onClick:_t}," TP/SL ",512),m("div",{class:"chart-top command far fa-angle-double-right",onClick:Mt})]),q(m("iframe",{ref_key:"tradingviewChartRef",ref:Xe,class:"tradingview-chart",style:ti(c.tradingViewStyle),src:Qe.value},null,12,_i),[[ce,c.showTradingView]])],512)],544)]),le(di,{ref_key:"vpsOtpPopupRef",ref:Te},null,512)],64)}}};export{Ni as default};
