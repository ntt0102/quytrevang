import{x as B,y as i,z as I,f as u,w as p,O as z,C as V,D,r as O,o as f,e as x,d as h,B as E,bc as L,g as P,I as m}from"./app-ad45c997.js";const H={__name:"ChangeAvatarPopup",setup(F,{expose:d}){const c=V(),{t:s}=B(),g=D("bus"),a=i(null),e=i(null),l=i(null),o=I({isEnabled:!1,imgSrc:null});function b(){a.value.setOption("toolbarItems[0].options.disabled",!1),a.value.show()}function v(){g.emit("checkPin",()=>{let t=e.value.getCroppedCanvas().toDataURL();c.dispatch("userProfile/changeAvatar",t).then(n=>{n&&a.value.hide()})})}function w(){e.value.zoom(.2)}function C(){e.value.zoom(-.2)}function k(){e.value.rotate(-90)}function A(){e.value.rotate(90)}function R(t){const n=t.target.files[0];if(n.type.indexOf("image/")===-1){m.error(s("components.changeAvatar.error.imageType"));return}if(typeof FileReader=="function"){const r=new FileReader;r.onload=S=>{o.imgSrc=S.target.result},r.readAsDataURL(n)}else m.error(s("components.changeAvatar.error.fileReaderSupport"))}function _(){l.value.click()}function y(){o.isEnabled=!0,o.imgSrc=c.state.auth.user.avatar}function $(){o.isEnabled=!1}return d({show:b}),(t,n)=>{const r=O("DxScrollView");return f(),u(z,{ref_key:"popupRef",ref:a,width:t.$devices.generic?t.$screen.height*.6:null,height:t.$devices.generic?t.$screen.height*.8:null,class:"change-avatar-popup",title:t.$t("components.changeAvatar.title"),toolbarItems:[{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-folder-upload",hint:t.$t("components.changeAvatar.buttons.choose"),onClick:_}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-search-minus",hint:t.$t("components.changeAvatar.buttons.zoomOut"),onClick:C}},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-search-plus",hint:t.$t("components.changeAvatar.buttons.zoomIn"),onClick:w}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-undo",hint:t.$t("components.changeAvatar.buttons.rotateLeft"),onClick:k}},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-redo",hint:t.$t("components.changeAvatar.buttons.rotateRight"),onClick:A}},{toolbar:"bottom",location:"center",html:"|"},{toolbar:"bottom",location:"center",widget:"dxButton",options:{icon:"far fa-crop-alt",hint:t.$t("components.changeAvatar.buttons.crop"),onClick:v}}],onShown:y,onHidden:$},{default:p(()=>[x(r,null,{default:p(()=>[h("div",null,[o.isEnabled?(f(),u(E(L),{key:0,ref_key:"cropperRef",ref:e,style:{width:"100%",height:"400px"},src:o.imgSrc,initialAspectRatio:1/1},null,8,["src"])):P("",!0),h("input",{ref_key:"inputRef",ref:l,type:"file",accept:"images/*",onChange:R},null,544)])]),_:1})]),_:1},8,["width","height","title","toolbarItems"])}}};export{H as default};
