import{m as l,a as m,n as c}from"./app-089c7b72.js";import{D as u,a as p}from"./data-grid-9e4dd793.js";import"./ui.data_grid.row_dragging-13991560.js";import"./dialog-e8748e84.js";function d(){return{permissions:[]}}const g={permissions:t=>t.permissions},h={validateDuplicateName({state:t,rootGetters:e},s){const i=t.permissions.find(a=>a.id===s.data.id);return i&&s.value==i.name?Promise.resolve(!0):new Promise((a,n)=>{axios.post("settings/permissions/validate-duplicate-name",{name:s.value},{noLoading:!0}).then(o=>{a(o.data)})})},fetch({commit:t,dispatch:e,getters:s,state:i,rootGetters:a}){return new Promise((n,o)=>{axios.get("settings/permissions").then(r=>{t("setState",r.data),n()})})},save({commit:t,dispatch:e,getters:s,state:i,rootGetters:a},n){return new Promise((o,r)=>{axios.post("settings/permissions",{changes:n.changes}).then(w=>{o(),e("fetch")})})},resetState({commit:t}){t("resetState")}},v={setState(t,e){t.permissions=e.permissions},resetState(t){t=Object.assign(t,d())}},f={namespaced:!0,state:d,getters:g,actions:h,mutations:v};const _={components:{DxDataGrid:u,DxColumn:p},data(){return{gridData:null,validationRules:{name:[{type:"required",message:this.$t("settings.permissions.name")+this.$mt.validations.required},{type:"async",validationCallback:this.validateDuplicateName,message:this.$t("settings.permissions.name")+this.$mt.validations.duplicate}]}}},beforeCreate(){this.$store.registerModule("Settings.permissions",f)},created(){this.fetch()},destroyed(){this.$store.unregisterModule("Settings.permissions")},watch:{permissions(){this.cloneDeepData()}},computed:{...l("Settings.permissions",["permissions"]),dataGrid:function(){return this.$refs.dataGrid.instance}},methods:{...m("Settings.permissions",["fetch","save","validateDuplicateName","resetState"]),onSave(t){this.$bus.emit("checkPin",()=>this.save(t))},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.permissions)}}};var D=function(){var e=this,s=e._self._c;return s("div",{staticClass:"settings-page"},[s("h2",{staticClass:"content-block"},[e._v(" "+e._s(e.$t("settings.permissions.title"))+" ")]),s("div",{staticClass:"content-block dx-card responsive-paddings"},[s("DxDataGrid",{ref:"dataGrid",attrs:{"data-source":e.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,mode:"batch",startEditAction:"dblClick"}},on:{contentReady:function(i){return e.$mf.dataGridPreload(e.gridData,e.dataGrid)},saved:e.onSave},scopedSlots:e._u([{key:"commandCellTemplate",fn:function({data:i}){return[s("DxToolbar",{attrs:{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:e.$t("buttons.delete"),text:e.$t("buttons.delete"),onClick:()=>{e.dataGrid.deleteRow(i.rowIndex)}}}]}})]}}])},[s("DxColumn",{attrs:{fixed:!0,width:35,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t("titles.commandHeaderTitleShort")}}),s("DxColumn",{attrs:{"data-field":"name","header-filter":{allowSearch:!0},caption:e.$t("settings.permissions.name"),"validation-rules":e.validationRules.name}})],1)],1)])},x=[],S=c(_,D,x,!1,null,"ea2ead40",null,null);const y=S.exports;export{y as default};
