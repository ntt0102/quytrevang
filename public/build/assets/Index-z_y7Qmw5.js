import H from"./Chart-B-UU7fv2.js";import{h as x,u as B,k as C,r as e,c as I,a as F,w as q,o as h,p as b,f as _,d as R,v as A,e as d,g as v,D as G,z as W,_ as y,n as P,b as S,F as $,A as E,B as L,q as j,m as z}from"./app-cujJ0Z5s.js";import"./lightweight-charts.esm.development-DkjEgrHU.js";const K={ref:"submitRef",class:"display-none"},U={__name:"SettingPopup",setup(k,{expose:s}){const f=x(),{t}=B(),n=C("mt"),i=e(null),u=e(null),p=I(()=>f.state.tradingDerivative.config),a=F({formData:{},validationRules:{tpDefault:[{type:"required",message:t("trading.derivative.settingPopup.tpDefault")+n.validations.required}],slDefault:[{type:"required",message:t("trading.derivative.settingPopup.slDefault")+n.validations.required}]}});q(p,o);function r(){i.value.show()}function g(){f.dispatch("tradingDerivative/setting",a.formData).then(c=>{c?i.value.hide():(o(p.value),l())})}function o(c){a.formData={tpDefault:c.tpDefault,slDefault:c.slDefault}}function l(){setTimeout(()=>{u.value.instance.getEditor("tpDefault").focus()},0)}function m(){o(p.value),l()}function D(){}return s({show:r}),(c,O)=>(h(),b(y,{ref_key:"popupRef",ref:i,width:300,height:260,class:"der-setting-popup",title:c.$t("trading.derivative.buttons.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:c.$t("buttons.save"),onClick:()=>c.$refs.submitRef.click()}}],onShown:m,onHidden:D},{default:_(()=>[R("form",{onSubmit:A(g,["prevent"])},[R("button",K,null,512),d(v(G),{ref_key:"formRef",ref:u,labelLocation:"left","form-data":a.formData},{default:_(()=>[d(v(W.DxItem),{name:"tpDefault","data-field":"tpDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.tpDefault,label:{text:c.$t("trading.derivative.settingPopup.tpDefault")}},null,8,["validation-rules","label"]),d(v(W.DxItem),{name:"slDefault","data-field":"slDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.slDefault,label:{text:c.$t("trading.derivative.settingPopup.slDefault")}},null,8,["validation-rules","label"])]),_:1},8,["form-data"])],32)]),_:1},8,["title","toolbarItems"]))}},J={__name:"PendingOrdersPopup",setup(k,{expose:s}){const f=x(),t=e(null),n=e([]),i=[{field:"orderTime",minWidth:100},{field:"side",minWidth:100},{field:"volume",minWidth:100},{field:"matchVolume",minWidth:100},{field:"showPrice",minWidth:100},{field:"avgPrice",minWidth:100}];function u(){t.value.show()}function p(){n.value=f.state.tradingDerivative.status.pendingOrders}function a(){}return s({show:u}),(r,g)=>(h(),b(y,{ref_key:"popupRef",ref:t,class:"der-matched-orders-popup",title:r.$t("trading.derivative.pendingOrdersPopup.title"),onShown:p,onHidden:a},{default:_(()=>[d(v(P.DxDataGrid),{"data-source":n.value,"key-expr":"orderNo","show-borders":!0},{default:_(()=>[(h(),S($,null,E(i,o=>d(v(P.DxColumn),{"data-field":o.field,minWidth:o.minWidth,caption:r.$t(`trading.derivative.pendingOrdersPopup.${o.field}`)},null,8,["data-field","minWidth","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},Q={__name:"MatchedOrdersPopup",setup(k,{expose:s}){const f=x(),t=e(null),n=e([]),i=[{field:"orderTime",minWidth:100},{field:"side",minWidth:100},{field:"volume",minWidth:100},{field:"matchVolume",minWidth:100},{field:"showPrice",minWidth:100},{field:"avgPrice",minWidth:100}];function u(){t.value.show()}function p(){f.dispatch("tradingDerivative/getMatchedOrders").then(r=>{n.value=r})}function a(){}return s({show:u}),(r,g)=>(h(),b(y,{ref_key:"popupRef",ref:t,class:"der-matched-orders-popup",title:r.$t("trading.derivative.matchedOrdersPopup.title"),onShown:p,onHidden:a},{default:_(()=>[d(v(P.DxDataGrid),{"data-source":n.value,"key-expr":"orderNo","show-borders":!0},{default:_(()=>[(h(),S($,null,E(i,o=>d(v(P.DxColumn),{"data-field":o.field,minWidth:o.minWidth,caption:r.$t(`trading.derivative.matchedOrdersPopup.${o.field}`)},null,8,["data-field","minWidth","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},X={__name:"VpsOtpPopup",setup(k,{expose:s}){const f=x(),t=e(null),n=e(null),i=e(!1),u=e("");function p(){t.value.show(),setTimeout(a,500)}function a(){navigator.clipboard&&navigator.clipboard.readText().then(l=>{l=l.replace(/\s+/g,""),/^\d{6}$/.test(l)&&n.value.fillInput(l)})}function r(l){f.dispatch("tradingDerivative/loginVps",l).then(m=>{m&&t.value.hide(),n.value.clearInput()})}function g(){i.value=!0}function o(){i.value=!1}return s({show:p}),(l,m)=>(h(),b(y,{ref_key:"popupRef",ref:t,width:400,height:190,class:"vps-otp-popup",title:l.$t("trading.derivative.buttons.loginVps"),onShown:g,onHidden:o},{default:_(()=>[i.value?(h(),b(v(L),{key:0,ref_key:"otpInputRef",ref:n,value:u.value,"onUpdate:value":m[0]||(m[0]=D=>u.value=D),"input-classes":"otp-input",separator:"-","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",onOnComplete:r},null,8,["value"])):j("",!0)]),_:1},8,["title"]))}},Y={class:"derivative-page content-block dx-card responsive-paddings"},ne={__name:"Index",setup(k){const s=x(),{t:f}=B(),t=C("bus"),n=I(()=>s.state.tradingDerivative.config.source),i=e(null),u=e(null),p=e(null),a=e(null),r=e(null),g=e([{text:f("trading.derivative.buttons.downloadExport"),value:"download",icon:"far fa-cloud-arrow-down"},{text:f("trading.derivative.buttons.cloneExport"),value:"clone",icon:"far fa-file-export"}]),o=e([{name:"FIREANT",icon:"far fa-database small"},{name:"DNSE",icon:"far fa-database small"},{name:"VPS",icon:"far fa-database small"}]);function l(){u.value.show()}function m(){p.value.show()}function D(){a.value.show()}function c(){t.emit("checkPin",()=>s.dispatch("tradingDerivative/report"))}function O(){r.value.show()}function V(){t.emit("checkPin",()=>s.dispatch("tradingDerivative/export","download"))}function M({itemData:w}){t.emit("checkPin",()=>s.dispatch("tradingDerivative/export",w.value))}function N({item:{name:w}}){i.value.connectSocket(),s.dispatch("tradingDerivative/setSource",w)}return(w,Z)=>{const T=z("DxToolbar");return h(),S($,null,[R("div",Y,[d(T,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:w.$t("trading.derivative.buttons.report"),onClick:c}},{location:"before",widget:"dxButton",options:{icon:"far fa-arrow-right-to-arc small",hint:w.$t("trading.derivative.buttons.loginVps"),onClick:O}},{location:"before",widget:"dxDropDownButton",options:{splitButton:!0,items:g.value,displayExpr:"text",keyExpr:"value",icon:"far fa-cloud-arrow-down small",hint:w.$t("trading.derivative.buttons.downloadExport"),width:"60",dropDownOptions:{width:"160"},elementAttr:{class:"export"},onButtonClick:V,onItemClick:M}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:o.value,displayExpr:"name",keyExpr:"name",selectedItemKey:n.value,stylingMode:"text",useSelectMode:!0,width:"130",elementAttr:{class:"source"},onSelectionChanged:N}}]},null,8,["items"]),d(H,{ref_key:"chartRef",ref:i,onShowSetting:l,onShowPendingOrders:m,onShowMatchedOrders:D},null,512)]),d(U,{ref_key:"settingPopupRef",ref:u},null,512),d(J,{ref_key:"pendingOrdersPopupRef",ref:p},null,512),d(Q,{ref_key:"matchedOrdersPopupRef",ref:a},null,512),d(X,{ref_key:"vpsOtpPopupRef",ref:r},null,512)],64)}}};export{ne as default};
