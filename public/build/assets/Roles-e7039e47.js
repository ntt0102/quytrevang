import{_ as v,e6 as D,m as f,b as x,c as w,d as u,t as C,e as s,w as c,r,o as S}from"./app-4ce1eb1f.js";import{L as b}from"./ListTagBox-593a768b.js";import{D as _,a as k}from"./data-grid-3cdc16e0.js";import"./row_dragging-e1375391.js";import"./dialog-341a11a8.js";import"./exporter-6daaf42a.js";const $={components:{ListTagBox:b,DxDataGrid:_,DxColumn:k},data(){return{gridData:null,calculateFilterExpression:function(e,t,l){return l==="search"&&typeof e=="string"?[this.dataField,"contains",e]:function(i){return(i.permissions||[]).indexOf(e)!==-1}},validationRules:{name:[{type:"required",message:this.$t("settings.roles.name")+this.$mt.validations.required},{type:"async",validationCallback:this.validateDuplicateName,message:this.$t("settings.roles.name")+this.$mt.validations.duplicate}],permissions:[{type:"required",message:this.$t("settings.roles.permission")+this.$mt.validations.required}]}}},beforeCreate(){this.$store.registerModule("Settings.roles",D)},created(){this.fetch()},destroyed(){this.$store.unregisterModule("Settings.roles")},watch:{roles(){this.cloneDeepData()}},computed:{...f("Settings.roles",["roles","permissions"]),dataGrid:function(){return this.$refs.dataGrid.instance}},methods:{...x("Settings.roles",["fetch","save","validateDuplicateName","resetState"]),onSave(e){this.$bus.emit("checkPin",()=>this.save(e))},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.roles)},cellTemplate(e,t){var l="Â ",i=(t.value||[]).map(a=>t.column.lookup.calculateCellValue(a)).join(", ");e.textContent=i||l,e.title=i},onValueChanged(e,t){t.setValue(e),t.component.updateDimensions()}}},y={class:"settings-page"},G={class:"content-block"},T={class:"content-block dx-card responsive-paddings"};function B(e,t,l,i,a,n){const d=r("DxColumn"),m=r("ListTagBox"),p=r("DxToolbar"),g=r("DxDataGrid");return S(),w("div",y,[u("h2",G,C(e.$t("settings.roles.title")),1),u("div",T,[s(g,{ref:"dataGrid","data-source":a.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,mode:"batch",startEditAction:"dblClick"},onContentReady:t[0]||(t[0]=o=>e.$mf.dataGridPreload(a.gridData,n.dataGrid)),onSaved:n.onSave},{tagBoxEditor:c(({data:o})=>[s(m,{width:300,height:400,value:o.value,"on-value-changed":h=>n.onValueChanged(h,o),"data-source":e.permissions,"data-grid-component":o.component},null,8,["value","on-value-changed","data-source","data-grid-component"])]),commandCellTemplate:c(({data:o})=>[s(p,{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:e.$t("buttons.delete"),text:e.$t("buttons.delete"),onClick:()=>{n.dataGrid.deleteRow(o.rowIndex)}}}]},null,8,["items"])]),default:c(()=>[s(d,{fixed:!0,width:35,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t("titles.commandHeaderTitleShort")},null,8,["caption"]),s(d,{"data-field":"name","header-filter":{allowSearch:!0},caption:e.$t("settings.roles.name"),"validation-rules":a.validationRules.name},null,8,["caption","validation-rules"]),s(d,{"allow-sorting":!1,"data-field":"permissions","cell-template":n.cellTemplate,"calculate-filter-expression":a.calculateFilterExpression,"header-filter":{allowSearch:!0},"edit-cell-template":"tagBoxEditor",caption:e.$t("settings.roles.permission"),"validation-rules":a.validationRules.permissions,lookup:{dataSource:e.permissions}},null,8,["cell-template","calculate-filter-expression","caption","validation-rules","lookup"])]),_:1},8,["data-source","onSaved"])])])}const M=v($,[["render",B]]);export{M as default};
