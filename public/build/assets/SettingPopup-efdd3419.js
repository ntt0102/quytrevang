import{u as x,c as k,i as r,r as c,d as $,e as g,w as D,f as R,n as B,k as u,_ as V,o as I,j as t,h as p,l,R as q,S as s,s as N}from"./app-c2a8ad0e.js";const j=["onSubmit"],H={ref:"submitRef",class:"display-none"},F={__name:"SettingPopup",setup(M,{expose:m}){const a=x(),{t:n}=k(),f=r("bus"),d=r("mt"),v=r("mf"),i=c(null),b=c(null),o=$({formData:{},validationRules:{vpsCode:[{type:"required",message:n("models.copyist.vpsCode")+d.validations.required},{type:"async",validationCallback:e=>a.dispatch("userCopyist/validateVpsCode",e),message:n("models.copyist.vpsCode")+d.validations.duplicate}],volume:[{type:"required",message:n("models.copyist.volume")+d.validations.required}]}}),y=g(()=>a.state.auth.user.permissions);D(()=>a.state.userCopyist.copyist,e=>{o.formData=v.cloneDeep(e)});function h(){i.value.show()}function w(){f.emit("checkPin",()=>{a.dispatch("userCopyist/save",o.formData).then(e=>{e&&i.value.hide()})})}function _(){a.dispatch("userCopyist/getCopyist")}function S(){}return m({show:h}),(e,P)=>{const C=R("DxScrollView");return I(),B(V,{ref_key:"popupRef",ref:i,title:e.$t("user.copyist.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:e.$t("buttons.save"),onClick:()=>e.$refs.submitRef.click()}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:e.$t("buttons.cancel"),onClick:()=>i.value.hide()}}],onShown:_,onHidden:S},{default:u(()=>[t(C,null,{default:u(()=>[p("form",{onSubmit:N(w,["prevent"])},[p("button",H,null,512),t(l(q),{ref_key:"formRef",ref:b,"form-data":o.formData,"col-count":2,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:u(()=>[t(l(s),{colSpan:2,"data-field":"allow_copy","editor-type":"dxSwitch",label:{text:e.$t("models.copyist.allowCopy")}},null,8,["label"]),t(l(s),{visible:y.value.includes("stock@order"),colSpan:2,"data-field":"allow_share","editor-type":"dxSwitch",label:{text:e.$t("models.copyist.allowShare")}},null,8,["visible","label"]),t(l(s),{colSpan:2,"data-field":"vps_code","validation-rules":o.validationRules.vpsCode,label:{text:e.$t("models.copyist.vpsCode")}},null,8,["validation-rules","label"]),t(l(s),{"data-field":"allow_max_vol","editor-type":"dxSwitch",label:{text:e.$t("models.copyist.allowMaxVol")}},null,8,["label"]),t(l(s),{visible:!o.formData.allow_max_vol,"data-field":"volume","editor-type":"dxNumberBox","validation-rules":o.validationRules.volume,label:{text:e.$t("models.copyist.volume")}},null,8,["visible","validation-rules","label"])]),_:1},8,["form-data","label-location"])],40,j)]),_:1})]),_:1},8,["title","toolbarItems"])}}};export{F as default};
