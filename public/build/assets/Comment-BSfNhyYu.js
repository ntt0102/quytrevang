import{r as D,a as b,w as x,b as p,e as l,f as i,g as r,h as y,k as g,x as R,m as S,o as c,d as a,K as G,t as n,q as _,M as I,N,s as h,p as z,P as B,n as m}from"./app-C6_SGePJ.js";const P={class:"comments-page content-block dx-card responsive-paddings"},V={class:"comment"},$={class:"subject"},j={key:0,class:"far fa-paperclip"},L={class:"info"},T=a("i",{class:"dx-icon-tel"},null,-1),q={class:"content"},U={__name:"Comment",setup(A){const o=y(),f=g("mt"),v=g("mf"),u=D(null),s=b({gridData:null,selectedId:null});o.dispatch("adminComment/getComments"),x(()=>o.state.adminComment.comments,e=>{s.gridData=v.cloneDeep(e)});function C(e){e.columnIndex==0&&(s.selectedId=s.selectedId!=e.data.id?e.data.id:null,e.data.read!=1&&(e.data.read=1,o.dispatch("adminComment/markAsRead",e.data.id)))}function w(e){o.dispatch("adminComment/delete",e.changes.map(({key:d})=>d)).then(()=>{R.success(f.messages.success.saved)})}return(e,d)=>{const k=S("RouterLink");return c(),p("div",P,[l(r(m.DxDataGrid),{ref_key:"dataGridRef",ref:u,"data-source":s.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!0,mode:"batch"},showColumnHeaders:!1,showColumnLines:!0,onContentReady:d[0]||(d[0]=t=>e.$mf.dataGridPreload(s.gridData,u.value.instance)),onCellClick:C,onSaved:w},{dataCellTemplate:i(({data:t})=>[a("div",V,[a("div",$,[a("span",{class:G(t.data.read?"mark":"unread")},n(t.data.subject),3),t.data.url_images.length>0?(c(),p("i",j)):_("",!0)]),I(a("div",null,[a("div",L,[a("div",null,[a("em",null,n(t.data.sent_at),1)]),a("div",null,[a("b",null,n(t.data.name),1)]),a("div",null,[T,h(" "+n(e.$filters.phone(t.data.phone)),1)]),t.data.user_code?(c(),z(k,{key:0,to:{name:"admin-user",query:{code:t.data.user_code}}},{default:i(()=>[h(n(e.$t("admin.comments.viewUser",[t.data.user_code])),1)]),_:2},1032,["to"])):_("",!0)]),a("div",q,n(t.data.content),1),l(B,{images:t.data.url_images},null,8,["images"])],512),[[N,t.data.id==s.selectedId]])])]),default:i(()=>[l(r(m.DxColumn),{"cell-template":"dataCellTemplate"}),l(r(m.DxColumn),{width:50,type:"buttons",buttons:[{name:"delete"}],alignment:"center"})]),_:1},8,["data-source"])])}}};export{U as default};
