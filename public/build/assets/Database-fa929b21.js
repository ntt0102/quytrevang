import{_ as o,D as r,a as n,n as i}from"./app-f37d1114.js";import{D as l}from"./accordion-a197d8b3.js";import{a as u}from"./index-1ef70744.js";const c={components:{DxAccordion:l,DxForm:o,DxItem:r},data(){return{backupData:{sendMail:!0,download:!0},RESTORE_FILE_EXTENSION:"sql",restoreFileName:null}},beforeCreate(){this.$store.registerModule("Settings",u)},destroyed(){this.$store.unregisterModule("Settings")},methods:{...n("Settings",["backupDatabase","restoreDatabase"]),onBackupForm(){this.$bus.emit("checkPin",()=>this.backupDatabase(this.backupData))},onRestoreForm(){this.$bus.emit("checkPin",()=>{let a=new FormData;a.append("file",this.$refs.file.files[0]),this.restoreDatabase(a)})},onFileChange(a){var t=a.target.files[0].name;t.split(".").pop()===this.RESTORE_FILE_EXTENSION?this.restoreFileName=t:this.$toasted.show(this.$t("settings.database.notMatchExtension").replace("{extension}",this.RESTORE_FILE_EXTENSION))}}};var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"settings-page"},[e("h2",{staticClass:"content-block"},[t._v(" "+t._s(t.$t("settings.database.title"))+" ")]),e("div",{staticClass:"content-block dx-card responsive-paddings"},[e("div",{staticClass:"settings-database-tab"},[e("DxAccordion",{attrs:{collapsible:!0,items:[{title:t.$t("settings.database.backup"),template:"backupTemplate"},{title:t.$t("settings.database.restore"),template:"restoreTemplate"}]},scopedSlots:t._u([{key:"backupTemplate",fn:function(){return[e("form",{on:{submit:function(s){return s.preventDefault(),t.onBackupForm.apply(null,arguments)}}},[e("DxForm",{ref:"form",attrs:{"form-data":t.backupData,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[e("DxItem",{attrs:{"data-field":"sendMail","editor-type":"dxCheckBox",label:{location:"left",text:t.$t("settings.database.sendMail")}}}),e("DxItem",{attrs:{"data-field":"download","editor-type":"dxCheckBox",label:{location:"left",text:t.$t("settings.database.download")}}}),e("DxItem",{attrs:{"item-type":"button","button-options":{disabled:!t.backupData.sendMail&&!t.backupData.download,width:150,left:0,type:"default",icon:"far fa-copy",text:t.$t("buttons.backup"),useSubmitBehavior:!0}}})],1)],1)]},proxy:!0},{key:"restoreTemplate",fn:function(){return[e("form",{on:{submit:function(s){return s.preventDefault(),t.onRestoreForm.apply(null,arguments)}}},[e("DxForm",{ref:"form",attrs:{"form-data":t.backupData,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"upload-browser"},[e("input",{ref:"file",attrs:{type:"file",id:"restoreFile",accept:`.${t.RESTORE_FILE_EXTENSION}`},on:{change:t.onFileChange}}),e("label",{attrs:{for:"restoreFile"}},[e("i",{staticClass:"far fa-file-upload"}),t._v(" "+t._s(t.$t("buttons.chooseFile"))+" ")]),e("span",[t._v(t._s(t.restoreFileName))])])]},proxy:!0}])}),e("DxItem",{attrs:{"item-type":"button","button-options":{disabled:!t.restoreFileName,width:150,left:0,type:"default",icon:"far fa-undo",text:t.$t("buttons.restore"),useSubmitBehavior:!0}}})],1)],1)]},proxy:!0}])})],1)])])},p=[],f=i(c,d,p,!1,null,"fb8a3a79",null,null);const h=f.exports;export{h as default};
