import{bJ as u,a9 as g,ap as o,b6 as m,Q as p,bA as S,aQ as w}from"./app-yhzx4Rdz.js";var s=w(),l=u(),f={EXCEL:"xlsx",CSS:"css",PNG:"png",JPEG:"jpeg",GIF:"gif",SVG:"svg",PDF:"pdf"},h={CSS:"text/css",EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",PNG:"image/png",JPEG:"image/jpeg",GIF:"image/gif",SVG:"image/svg+xml",PDF:"application/pdf"},_={_revokeObjectURLTimeout:3e4,_getDataUri:function(e,t){var i=this._getMimeType(e);return"data:".concat(i,";base64,").concat(t)},_getMimeType:function(e){return h[e]||"application/octet-stream"},_linkDownloader:function(e,t){var i=g.createElement("a");return i.download=e,i.href=t,i.target="_blank",i},_winJSBlobSave:function(e,t,i){var n=new Windows.Storage.Pickers.FileSavePicker;n.suggestedStartLocation=Windows.Storage.Pickers.PickerLocationId.documentsLibrary;var a=f[i];if(a){var r=this._getMimeType(i);n.fileTypeChoices.insert(r,["."+a])}n.suggestedFileName=t,n.pickSaveFileAsync().then(function(v){v&&v.openAsync(Windows.Storage.FileAccessMode.readWrite).then(function(c){var d=e.msDetachStream();Windows.Storage.Streams.RandomAccessStream.copyAsync(d,c).then(function(){c.flushAsync().done(function(){d.close(),c.close()})})})})},_click:function(e){try{e.dispatchEvent(new MouseEvent("click",{cancelable:!0}))}catch{var t=g.getDocument().createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,s,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}},_saveBlobAs:function(e,t,i){if(this._blobSaved=!1,o(l.msSaveOrOpenBlob))l.msSaveOrOpenBlob(i,e),this._blobSaved=!0;else if(o(s.WinJS))this._winJSBlobSave(i,e,t),this._blobSaved=!0;else{var n=s.URL||s.webkitURL||s.mozURL||s.msURL||s.oURL;if(o(n)){var a=n.createObjectURL(i),r=this._linkDownloader(e,a);setTimeout(()=>{n.revokeObjectURL(a),this._objectUrlRevoked=!0},this._revokeObjectURLTimeout),this._click(r)}else m.warn("window.URL || window.webkitURL || window.mozURL || window.msURL || window.oURL is not defined")}},saveAs:function(e,t,i){var n=f[t];if(n&&(e+="."+n),p(s.Blob))this._saveBlobAs(e,t,i);else{o(l.userAgent.match(/iPad/i))||S.log("E1034");var a=this._linkDownloader(e,this._getDataUri(t,i));this._click(a)}}};export{_ as f};
