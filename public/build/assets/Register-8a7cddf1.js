import{u as B,r as E,a as S,x as D,E as P,b as T,e as a,f as r,g as t,s as V,h as O,i as j,j as L,k as _,l as I,o as M,a3 as i,d as v,q as l,t as d,bQ as N,a4 as H,v as K}from"./app-2a57e382.js";const Q={class:"policy-info"},U={class:"recaptcha-container"},z={class:"login-link"},F={__name:"Register",setup(X){const w=O(),b=j(),x=L(),{t:o}=B(),n=_("mt"),y=_("mf"),m=E(null),s=S({siteKey:"6LcjtyobAAAAAEEEa6vHHPQZU9Nf_SoaXBRsCRr5",formData:{name:null,email:null,password:null,password_confirmation:null},validationRules:{name:[{type:"required",message:o("models.user.name")+n.validations.required},{type:"stringLength",max:50,message:o("models.user.validations.name")}],email:[{type:"required",message:o("models.user.email")+n.validations.required},{type:"email",message:o("models.user.email")+n.validations.email},{type:"async",validationCallback:e=>w.dispatch("auth/validateDuplicateEmail",e),message:o("models.user.email")+n.validations.duplicate}],password:[{type:"required",message:o("models.user.password")+n.validations.required}],confirmPassword:[{type:"required",message:o("models.user.password")+n.validations.required},{type:"compare",comparisonTarget:k,message:o("models.user.password")+n.validations.match}]}});let u=!0,h=!1;D(()=>{setTimeout(()=>m.value.instance.getEditor("name").focus(),500),y.includeScript("on",{src:"https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit",id:"recaptcha"})}),P(()=>{y.includeScript("off","recaptcha")});function R(){q(s.formData.email).then(e=>{e&&(h?w.dispatch("auth/createAccount",s.formData).then(p=>{p&&b.push({name:x.query.redirect||"overview"})}):K.show(o("messages.warning.unVerifiedReCaptcha")))})}function k(){return s.formData.password}function g(){m.value.instance.itemOption("password",{editorOptions:{mode:u?"text":"password",buttons:[{options:{icon:u?"far fa-eye-slash":"far fa-eye",onClick:g},name:"btPw",location:"after"}]}}),m.value.instance.itemOption("password_confirmation",{editorOptions:{mode:u?"text":"password"}}),u=!u}function A(){h=!0}function $(){h=!1}function q(e){return new Promise((p,f)=>{fetch(`https://api.stopforumspam.org/api?email=${e}`).then(c=>c.text()).then(c=>{let C=c.substring(c.lastIndexOf("<appears>")+9,c.lastIndexOf("</appears>"));p(C==="no")})})}return(e,p)=>{const f=I("RouterLink");return M(),T("form",{class:"create-account-page",onSubmit:V(R,["prevent"])},[a(t(H),{ref_key:"formRef",ref:m,"form-data":s.formData,labelMode:"floating"},{default:r(()=>[a(t(i),{"data-field":"name","editor-type":"dxTextBox","validation-rules":s.validationRules.name,label:{text:e.$t("models.user.name")}},null,8,["validation-rules","label"]),a(t(i),{"data-field":"email","editor-type":"dxTextBox","editor-options":{mode:"email"},"validation-rules":s.validationRules.email,label:{text:e.$t("models.user.email")}},null,8,["validation-rules","label"]),a(t(i),{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:g},name:"password",location:"after"}]},"validation-rules":s.validationRules.password,label:{text:e.$t("models.user.password")}},null,8,["editor-options","validation-rules","label"]),a(t(i),{name:"password_confirmation","data-field":"password_confirmation","editor-type":"dxTextBox","editor-options":{mode:"password"},"validation-rules":s.validationRules.confirmPassword,label:{text:e.$t("models.user.confirmPassword")}},null,8,["validation-rules","label"]),a(t(i),null,{default:r(()=>[v("div",Q,[l(d(e.$t("auth.createAccount.policy"))+" ",1),a(f,{to:{name:"policy",hash:"#terms"}},{default:r(()=>[l(d(e.$t("policy.terms.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.and")),1),a(f,{to:{name:"policy",hash:"#privacy"}},{default:r(()=>[l(d(e.$t("policy.privacy.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.our")),1)])]),_:1}),a(t(i),null,{default:r(()=>[v("div",U,[a(t(N),{ref:"recaptcha",theme:"dark",size:"compact",onVerify:A,onExpired:$,sitekey:s.siteKey},null,8,["sitekey"])])]),_:1}),a(t(i),{"item-type":"button","button-options":{width:"100%",type:"default",text:e.$t("auth.createAccount.submit"),useSubmitBehavior:!0}},null,8,["button-options"]),a(t(i),null,{default:r(()=>[v("div",z,[l(d(e.$t("auth.createAccount.haveAccount"))+" ",1),a(f,{to:{name:"login"}},{default:r(()=>[l(d(e.$t("auth.createAccount.login")),1)]),_:1})])]),_:1})]),_:1},8,["form-data"])],32)}}};export{F as default};
