import{u as C,r as q,a as B,y as S,K as E,b as P,e as a,f as r,g as t,v as T,h as O,i as V,j,k as x,m as L,o as M,z as i,d as v,s as l,t as d,bW as N,D as K,x as z}from"./app-Bp6mN_pi.js";const H={class:"policy-info"},U={class:"recaptcha-container"},F={class:"login-link"},X={__name:"Register",setup(Q){const w=O(),b=V(),_=j(),{t:o}=C(),n=x("mt"),y=x("mf"),c=q(null),s=B({siteKey:"6LcjtyobAAAAAEEEa6vHHPQZU9Nf_SoaXBRsCRr5",formData:{name:null,email:null,password:null,password_confirmation:null},validationRules:{name:[{type:"required",message:o("models.user.name")+n.validations.required},{type:"stringLength",max:50,message:o("models.user.validations.name")}],email:[{type:"required",message:o("models.user.email")+n.validations.required},{type:"email",message:o("models.user.email")+n.validations.email},{type:"async",validationCallback:e=>w.dispatch("auth/validateDuplicateEmail",e),message:o("models.user.email")+n.validations.duplicate}],password:[{type:"required",message:o("models.user.password")+n.validations.required}],confirmPassword:[{type:"required",message:o("models.user.password")+n.validations.required},{type:"compare",comparisonTarget:R,message:o("models.user.password")+n.validations.match}]}});let u=!0,h=!1;S(()=>{setTimeout(()=>c.value.instance.getEditor("name").focus(),500),y.includeScript("on",{src:"https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit",id:"recaptcha"})}),E(()=>{y.includeScript("off","recaptcha")});function D(){$(s.formData.email).then(e=>{e&&(h?w.dispatch("auth/createAccount",s.formData).then(p=>{p&&b.push({name:_.query.redirect||"overview"})}):z.show(o("messages.warning.unVerifiedReCaptcha")))})}function R(){return s.formData.password}function g(){c.value.instance.itemOption("password",{editorOptions:{mode:u?"text":"password",buttons:[{options:{icon:u?"far fa-eye-slash":"far fa-eye",onClick:g},name:"btPw",location:"after"}]}}),c.value.instance.itemOption("password_confirmation",{editorOptions:{mode:u?"text":"password"}}),u=!u}function k(){h=!0}function A(){h=!1}function $(e){return new Promise((p,f)=>{fetch(`https://api.stopforumspam.org/api?email=${e}`).then(m=>m.text()).then(m=>{let I=m.substring(m.lastIndexOf("<appears>")+9,m.lastIndexOf("</appears>"));p(I==="no")})})}return(e,p)=>{const f=L("RouterLink");return M(),P("form",{class:"create-account-page",onSubmit:T(D,["prevent"])},[a(t(K),{ref_key:"formRef",ref:c,"form-data":s.formData,labelMode:"floating"},{default:r(()=>[a(t(i.DxItem),{"data-field":"name","editor-type":"dxTextBox","validation-rules":s.validationRules.name,label:{text:e.$t("models.user.name")}},null,8,["validation-rules","label"]),a(t(i.DxItem),{"data-field":"email","editor-type":"dxTextBox","editor-options":{mode:"email"},"validation-rules":s.validationRules.email,label:{text:e.$t("models.user.email")}},null,8,["validation-rules","label"]),a(t(i.DxItem),{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:g},name:"password",location:"after"}]},"validation-rules":s.validationRules.password,label:{text:e.$t("models.user.password")}},null,8,["editor-options","validation-rules","label"]),a(t(i.DxItem),{name:"password_confirmation","data-field":"password_confirmation","editor-type":"dxTextBox","editor-options":{mode:"password"},"validation-rules":s.validationRules.confirmPassword,label:{text:e.$t("models.user.confirmPassword")}},null,8,["validation-rules","label"]),a(t(i.DxItem),null,{default:r(()=>[v("div",H,[l(d(e.$t("auth.createAccount.policy"))+" ",1),a(f,{to:{name:"policy",hash:"#terms"}},{default:r(()=>[l(d(e.$t("policy.terms.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.and")),1),a(f,{to:{name:"policy",hash:"#privacy"}},{default:r(()=>[l(d(e.$t("policy.privacy.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.our")),1)])]),_:1}),a(t(i.DxItem),null,{default:r(()=>[v("div",U,[a(t(N),{ref:"recaptcha",theme:"dark",size:"compact",onVerify:k,onExpired:A,sitekey:s.siteKey},null,8,["sitekey"])])]),_:1}),a(t(i.DxItem),{"item-type":"button","button-options":{width:"100%",type:"default",text:e.$t("auth.createAccount.submit"),useSubmitBehavior:!0}},null,8,["button-options"]),a(t(i.DxItem),null,{default:r(()=>[v("div",F,[l(d(e.$t("auth.createAccount.haveAccount"))+" ",1),a(f,{to:{name:"login"}},{default:r(()=>[l(d(e.$t("auth.createAccount.login")),1)]),_:1})])]),_:1})]),_:1},8,["form-data"])],32)}}};export{X as default};
