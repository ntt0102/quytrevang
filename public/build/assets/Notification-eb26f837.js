import{x as k,N as D,y as $,z as m,A as O,B as R,G as q,c as g,d as x,e as i,w as l,D as o,i as B,o as f,R as n,F as S,s as N,f as w,Q as A}from"./app-99e81ed7.js";import{_ as I}from"./PickImagePopup-f42f550a.js";import"./FileManager-cfe6de9a.js";import"./exporter-e12c8c37.js";import"./row_dragging-e1bbb049.js";import"./dialog-d4ff6f0e.js";const C={class:"content-block dx-card responsive-paddings"},P=["onSubmit"],G={__name:"Notification",setup(T){const b=k(),v=D(),{t:s}=$(),y=m("bus"),r=m("mt"),p=O(null),t=R({formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:s("settings.notification.receiver")+r.validations.required}],title:[{type:"required",message:s("settings.notification.notificationTitle")+r.validations.required}],body:[{type:"required",message:s("settings.notification.body")+r.validations.required}]}});t.actionOptions=c(t.formData.actions),t.addActionOptions={icon:"add",text:s("buttons.add"),onClick:()=>{t.formData.actions.push(""),t.actionOptions=c(t.formData.actions)}},q(()=>{t.formData.receiver=v.query.codes||null,setTimeout(()=>{p.value.instance.getEditor("receiver").focus()},500)});function h(){y.emit("checkPin",()=>{b.dispatch("setting/sendNotification",t.formData)})}function c(e){let u=[];for(let a=0;a<e.length;a++)u.push(_(a));return u}function _(e){return{placeholder:s("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{t.formData.actions.splice(e,1),t.actionOptions=c(t.formData.actions)}}}]}}return(e,u)=>(f(),g("div",C,[x("form",{class:"setting-notification-page",onSubmit:B(h,["prevent"])},[i(o(A),{ref_key:"formRef",ref:p,"form-data":t.formData,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:l(()=>[i(o(n),{"item-type":"group"},{default:l(()=>[i(o(n),{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:e.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>e.$router.push({name:"users",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:e.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),i(o(n),{"data-field":"title","validation-rules":t.validationRules.title,label:{text:e.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"body","validation-rules":t.validationRules.body,label:{text:e.$t("settings.notification.body")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>e.$refs.pickImagePopupRef.show({clientPath:"notifications",callback:a=>t.formData.image=a})},name:"pickImage",location:"after"}]},label:{text:e.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),i(o(n),{"item-type":"group",caption:e.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[i(o(n),{"item-type":"group",name:"actions"},{default:l(()=>[(f(!0),g(S,null,N(t.actionOptions,(a,d)=>(f(),w(o(n),{key:"action"+(d+1),"data-field":"actions["+d+"]","editor-options":a,label:{text:e.$t("settings.notification.action.title")+" "+(d+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),i(o(n),{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),i(o(n),{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:e.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],40,P),i(I,{ref:"pickImagePopupRef"},null,512)]))}};export{G as default};
