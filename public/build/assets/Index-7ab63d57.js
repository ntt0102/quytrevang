import{y as Mt,u as It,b as Vt,c as qt,i as oe,r as y,d as Nt,e as we,x as Yt,z as jt,w as Fe,v as P,f as Wt,g as Xt,h as m,j as se,A as he,t as Ae,B as N,C as Ht,E as zt,G as W,F as Ut,H as Ee,I as Kt,o as Gt}from"./app-31534ac3.js";import Jt from"./CopyistStatusPopup-b28e3e6d.js";import{c as Zt,_ as Qt}from"./DailyCashFlowPopup-93e14450.js";import er from"./ColorPicker-696b557c.js";const tr="/build/assets/spinner-4da4a8c6.gif";class rr{constructor(){this.create()}create(){return new Promise((O,C)=>{const v=indexedDB.open("orderChart",1);v.onupgradeneeded=d=>{this.store=d.target.result,this.store.createObjectStore("order",{keyPath:"kind"}),this.store.createObjectStore("line",{keyPath:"price"}),this.store.createObjectStore("box",{keyPath:"point"}),this.store.createObjectStore("ruler",{keyPath:"point"}),this.store.createObjectStore("pattern1",{keyPath:"point"}),this.store.createObjectStore("pattern2",{keyPath:"point"}),this.store.createObjectStore("volprofile",{keyPath:"time"}),this.store.createObjectStore("alert",{keyPath:"price"}),this.store.createObjectStore("target",{keyPath:"price"}),O()},v.onsuccess=d=>{this.store=d.target.result,O()},v.onerror=()=>{location.reload(),C()}})}get(O){var C=this.store;return new Promise(function(d,B){var f=C.transaction(O,"readonly");if(Array.isArray(O)){var Y=O.map(E=>f.objectStore(E)),x=Y.map(v);Promise.all(x).then(E=>d(E))}else{var G=f.objectStore(O);v(G).then(E=>d(E))}});function v(d){return new Promise(function(B,f){const Y=d.getAll();Y.onsuccess=x=>B(x.target.result),Y.onerror=()=>f()})}}set(O,C){const v=this.store.transaction(O,"readwrite").objectStore(O);Array.isArray(C)?C.length>0&&C.forEach(d=>v.put(d)):v.put(C)}clear(O){var C=this.store;return new Promise(function(v,d){const B=C.transaction(O,"readwrite").objectStore(O).clear();B.onsuccess=()=>{v()},B.onerror=f=>{console.error(`Error to empty Object Store: ${O}`),d()}})}}const o=new rr,ir="/build/assets/alert-4d705e53.mp3";const or={class:"content-block dx-card responsive-paddings"},sr={class:"area data-area"},ar=["title"],nr=["title"],lr=["title"],cr={class:"area tool-area"},dr=["title"],pr=["title"],ur=["title"],fr=["title"],hr=["title"],mr=["title"],vr=["title"],gr=["title"],yr=["title"],xr=["title"],Cr=["title"],Or=["title"],br=["title"],kr=["src"],_e=3,Re=2,Pr="wss://datafeed.vps.com.vn/socket.io/?EIO=3&transport=websocket",Sr=120,Lr={__name:"Index",setup(De){const O={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.05,bottom:.4}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:0},timeScale:{timeVisible:!0,rightOffset:20,minBarSpacing:.01}},C=moment().format("YYYY-MM-DD"),v={START:moment(C+" 08:45:00").unix(),ATO:moment(C+" 09:00:00").unix(),ATC:moment(C+" 14:30:00").unix(),END:moment(C+" 14:45:00").unix()},d=It(),B=Vt(),{t:f}=qt(),Y=oe("devices"),x=oe("mf"),G=oe("bus"),E=oe("filters"),F=y(null),me=y(null),X=y(null),ve=y(null),ge=y(null),ye=y(null),xe=y(null),$e=y(null),H=y(null),J=y(null),ae=y(null),ne=y(null),le=y(null),Z=y(null),ce=y(null),z=y(null),M=y(null),U=y(null),Be=y(null);let e={chart:{},series:{},data:{whitespace:[],original:[],price:[],cash:[]},order:{side:0,entry:{},tp:{},sl:{}},lines:[],ruler:{l0:{},ln1:{},l1:{},l2:{},l3:{},l4:{},pointCount:0},target:{A:{},B:{},C:{},D:{}},pattern1:{A:{},B:{},C:{},X1:{},X2:{},Y1:{},Y2:{}},pattern2:{O:{}},box:[],alerts:[],crosshair:{},shark:null,loadWhitespace:!0,interval:null,interval60:null,websocket:null,isAutoOrdering:!1,socketStop:!1,volumeMax:0,socketRefreshTime:moment()};const h=Nt({chartDate:B.query.date??C,clock:moment().format("HH:mm:ss"),isFullscreen:!1,color:"#F44336",showColorPicker:!1,showTradingView:!1}),S=we(()=>d.state.tradingOrder.status),Me=we(()=>`https://chart.vps.com.vn/tv/?loadLastChart=true&symbol=VN30F1M&u=${d.state.tradingOrder.config.vpsCode}&s=${d.state.tradingOrder.config.vpsSession}&resolution=1`);d.dispatch("tradingOrder/getConfig").then(()=>{pe()}),d.dispatch("tradingOrder/getStatus"),e.interval=setInterval(Ge,1e3),e.interval60=setInterval(()=>d.dispatch("tradingOrder/getStatus"),6e4),o.create(),Yt(()=>{e.chart=Zt(me.value,O),F.value.addEventListener("click",Ve),F.value.addEventListener("contextmenu",Ie),e.chart.subscribeCrosshairMove(qe),e.chart.subscribeCustomPriceLineDragged(Ne),e.series.whitespace=e.chart.addLineSeries({priceScaleId:"whitespace",visible:!1}),e.series.box=e.chart.addHistogramSeries({priceScaleId:"box",scaleMargins:{top:0,bottom:0},color:"yellow",lastValueVisible:!1,priceLineVisible:!1}),e.series.cash=e.chart.addLineSeries({priceScaleId:"cash",scaleMargins:{top:.61,bottom:.01},color:"yellow",lastValueVisible:!1}),e.series.price=e.chart.addLineSeries({color:"#CCCCCC",priceFormat:{minMove:.1}}),new ResizeObserver(Ye).observe(F.value),document.addEventListener("keydown",je),document.addEventListener("fullscreenchange",We),d.dispatch("tradingOrder/getChartData",h.chartDate).then(()=>{He()})}),jt(()=>{clearInterval(e.interval),clearInterval(e.interval60),e.socketStop=!0,e.websocket.close(),e.websocket=null}),Fe(()=>d.state.tradingOrder.chartData,ze),Fe(()=>d.state.tradingOrder.isChartLoading,t=>{ve.value.style.display=t?"block":"none"});function Ie(t){Je(),t.preventDefault()}function Ve(){ue(),H.value.classList.contains("selected")?j():J.value.classList.contains("selected")?nt():ae.value.classList.contains("selected")?dt():ce.value.classList.contains("selected")?Le():ne.value.classList.contains("selected")?ft():le.value.classList.contains("selected")?Pe():Z.value.classList.contains("selected")&&xt()}function qe(t){if(t.time){let r=t.seriesPrices.get(e.series.price);e.crosshair.time=t.time,e.crosshair.price=r}else Y.phone||(e.crosshair.time=null,e.crosshair.price=null);t.point!=null&&(e.crosshair.x=t.point.x,e.crosshair.y=t.point.y)}function Ne(t){let r=t.customPriceLine,i=r.options();i.price=ee(i.price);const s=+t.fromPriceString,l=i.price;switch(i.lineType){case"order":if(l!=s){let p=!1;i.kind=="entry"?S.value.position||(p=!0,e.order[i.kind].price=l,d.dispatch("tradingOrder/executeOrder",{action:"entry",data:{cmd:"change",price:e.order.entry.price}}).then(c=>{c.isOk?(_(i.kind),P.success(f("trading.orderChart.changeEntrySuccess"))):(r.applyOptions({price:s}),T(c.message))})):(p=!0,e.order[i.kind].price=l,i.kind=="tp"?d.dispatch("tradingOrder/executeOrder",{action:"tp",data:{cmd:"change",price:e.order.tp.price}}).then(c=>{c.isOk?(_(i.kind),P.success(f("trading.orderChart.changeTpSuccess"))):(r.applyOptions({price:s}),T(c.message))}):d.dispatch("tradingOrder/executeOrder",{action:"sl",data:{cmd:"change",price:e.order.sl.price}}).then(c=>{c.isOk?(_(i.kind),P.success(f("trading.orderChart.changeSlSuccess"))):(r.applyOptions({price:s}),T(c.message))})),p||(r.applyOptions({price:s}),P.show(f("trading.orderChart.noChangeOrderLine")))}break;case"line":o.set("line",{price:s,removed:!0}),o.set("line",i),H.value.classList.remove("selected");break;case"ruler":switch(i.point){case"l0":if(o.set("ruler",i),e.ruler.pointCount==2){const A=+e.ruler.l1.options().title,q=+(l-A).toFixed(1);e.ruler.ln1.applyOptions({price:q}),o.set("ruler",e.ruler.ln1.options());const re=+(l+A).toFixed(1);e.ruler.l1.applyOptions({price:re}),o.set("ruler",e.ruler.l1.options());const ie=+(l+A*2).toFixed(1);e.ruler.l2.applyOptions({price:ie}),o.set("ruler",e.ruler.l2.options());const $t=+(l+A*3).toFixed(1);e.ruler.l3.applyOptions({price:$t}),o.set("ruler",e.ruler.l3.options());const Bt=+(l+A*4).toFixed(1);e.ruler.l4.applyOptions({price:Bt}),o.set("ruler",e.ruler.l4.options())}break;case"ln1":const p=+e.ruler.l0.options().price,c=l-p;r.applyOptions({title:c.toFixed(1)}),o.set("ruler",r.options()),e.ruler.l1.applyOptions({title:(-c).toFixed(1),price:+(p-c).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(-c*2).toFixed(1),price:+(p-c*2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(-c*3).toFixed(1),price:+(p-c*3).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(-c*4).toFixed(1),price:+(p-c*4).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l1":const u=+e.ruler.l0.options().price,b=l-u;r.applyOptions({title:b.toFixed(1)}),o.set("ruler",r.options()),e.ruler.ln1.applyOptions({title:(-b).toFixed(1),price:+(u-b).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l2.applyOptions({title:(b*2).toFixed(1),price:+(u+b*2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(b*3).toFixed(1),price:+(u+b*3).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(b*4).toFixed(1),price:+(u+b*4).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l2":const w=+e.ruler.l0.options().price,g=l-w;r.applyOptions({title:g.toFixed(1)}),o.set("ruler",r.options()),e.ruler.ln1.applyOptions({title:(-g*.5).toFixed(1),price:+(w-g*.5).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(g*.5).toFixed(1),price:+(w+g*.5).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l3.applyOptions({title:(g*1.5).toFixed(1),price:+(w+g*1.5).toFixed(1)}),o.set("ruler",e.ruler.l3.options()),e.ruler.l4.applyOptions({title:(g*2).toFixed(1),price:+(w+g*2).toFixed(1)}),o.set("ruler",e.ruler.l4.options());break;case"l3":const I=+e.ruler.l0.options().price,D=l-I;r.applyOptions({title:D.toFixed(1)}),o.set("ruler",r.options()),e.ruler.ln1.applyOptions({title:(-D/3).toFixed(1),price:+(I-D/3).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(D/3).toFixed(1),price:+(I+D/3).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(D*2/3).toFixed(1),price:+(I+D*2/3).toFixed(1)}),o.set("ruler",e.ruler.l2.options());break;case"l4":const V=+e.ruler.l0.options().price,k=l-V;r.applyOptions({title:k.toFixed(1)}),o.set("ruler",r.options()),e.ruler.ln1.applyOptions({title:(-k/4).toFixed(1),price:+(V-k/4).toFixed(1)}),o.set("ruler",e.ruler.ln1.options()),e.ruler.l1.applyOptions({title:(k/4).toFixed(1),price:+(V+k/4).toFixed(1)}),o.set("ruler",e.ruler.l1.options()),e.ruler.l2.applyOptions({title:(k/2).toFixed(1),price:+(V+k/2).toFixed(1)}),o.set("ruler",e.ruler.l2.options()),e.ruler.l3.applyOptions({title:(k*3/4).toFixed(1),price:+(V+k*3/4).toFixed(1)}),o.set("ruler",e.ruler.l3.options());break}break;case"pattern1":if(x.isSet(e.pattern1.C)){const p=+e.pattern1.A.options().price,u=+e.pattern1.B.options().price-p;e.pattern1.B.applyOptions({title:u.toFixed(1)}),o.set("pattern1",e.pattern1.B.options()),e.pattern1.C.applyOptions({price:+(p+.5*u).toFixed(1),title:(.5*u).toFixed(1)}),o.set("pattern1",e.pattern1.C.options()),e.pattern1.X1.applyOptions({price:+(p-.375*u).toFixed(1),title:(-.375*u).toFixed(1)}),o.set("pattern1",e.pattern1.X1.options()),e.pattern1.X2.applyOptions({price:+(p-.5*u).toFixed(1),title:(-.5*u).toFixed(1)}),o.set("pattern1",e.pattern1.X2.options()),e.pattern1.Y1.applyOptions({price:+(p-u).toFixed(1),title:-u.toFixed(1)}),o.set("pattern1",e.pattern1.Y1.options()),e.pattern1.Y2.applyOptions({price:+(p-2*u).toFixed(1),title:(-2*u).toFixed(1)}),o.set("pattern1",e.pattern1.Y2.options())}break;case"pattern2":if(x.isSet(e.pattern2.T)){const p=e.pattern2.E.options(),c=+p.price1,u=+p.price2,b=+p.price3,w=+p.price4,g=+p.price,I=b-u,D=c-w,V=b-w,k=g-w;let A,q;i.point=="S"?(q=+e.pattern2.S.options().price,A=g-q):(A=Math.abs(I)>Math.abs(k/2)?I:k/2,q=g-A,e.pattern2.S.applyOptions({price:+q.toFixed(1)}));const re=q+(Math.abs(k)>Math.abs(V)?Math.abs(k)>Math.abs(D)?1:1.5:2)*k,ie=re-g;e.pattern2.S.applyOptions({title:`SL=${(-A).toFixed(1)}`}),o.set("pattern2",e.pattern2.S.options()),e.pattern2.E.applyOptions({title:`RR=${(ie/A).toFixed(1)}`}),o.set("pattern2",e.pattern2.E.options()),e.pattern2.T.applyOptions({price:+re.toFixed(1),title:`TP=${ie.toFixed(1)}`}),o.set("pattern2",e.pattern2.T.options())}break;case"alert":o.set("alert",{price:s,removed:!0});const a=e.data.price.slice(-1)[0].value;let n=l>=a?">":"<";r.applyOptions({title:n}),o.set("alert",r.options()),Z.value.classList.remove("selected");break}}function Ye(){F.value&&(e.chart.resize(F.value.offsetWidth,F.value.offsetHeight),F.value.classList.contains("fullscreen")&&(document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"))}function je(t){if(t.ctrlKey||t.metaKey)switch(t.keyCode){case 38:e.chart.timeScale().applyOptions({barSpacing:e.chart.options().timeScale.barSpacing+.05});break;case 40:e.chart.timeScale().applyOptions({barSpacing:e.chart.options().timeScale.barSpacing-.05});break;case 37:e.chart.timeScale().scrollToPosition(e.chart.timeScale().scrollPosition()-10);break;case 39:e.chart.timeScale().scrollToPosition(e.chart.timeScale().scrollPosition()+10);break;case 96:J.value.click();break;case 97:H.value.click();break;case 98:ye.value.click();break;case 99:ge.value.click();case 100:xe.value.click();break}}function We(){F.value&&(document.fullscreenElement?(h.isFullscreen=!0,F.value.classList.add("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="hidden",document.querySelector(".header-component").style.visibility="hidden",document.querySelector(".sc-launcher").style.visibility="hidden",document.querySelector(".dx-drawer-content").style.transform="unset"):(h.isFullscreen=!1,F.value.classList.remove("fullscreen"),document.querySelector(".dx-drawer-panel-content").style.visibility="unset",document.querySelector(".header-component").style.visibility="unset",document.querySelector(".sc-launcher").style.visibility="unset",document.querySelector(".dx-drawer-content").style.transform="translate(0px, 0px)"))}function Xe(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function He(){return new Promise(async t=>{S.value.pending&&((await o.get("order")).map(u=>{e.order.side=u.side,e.order[u.kind].price=u.price,_(u.kind),R(!0)}),e.order.tp.hasOwnProperty("line")&&e.order.entry.line.applyOptions({draggable:!1})),(await o.get("line")).forEach(c=>{c.removed||e.lines.push(e.series.price.createPriceLine(c))});const i=await o.get("box");i.length==5&&(e.box=i,i.forEach((c,u)=>{e.series.box.update(c.x),e.box[u].y=e.series.cash.createPriceLine(c.y)}));const s=await o.get("ruler");s.length>0&&(e.ruler.pointCount=s.length>1?2:1,s.forEach(c=>{e.ruler[c.point]=e.series.price.createPriceLine(c)}));const l=await o.get("target");l.length>0&&l.forEach(c=>{e.target[c.point]=e.series.cash.createPriceLine(c)});const a=await o.get("pattern1");a.length>0&&a.forEach(c=>{e.pattern1[c.point]=e.series.price.createPriceLine(c)});const n=await o.get("pattern2");n.length>0&&n.forEach(c=>{e.pattern2[c.point]=e.series.price.createPriceLine(c)}),(await o.get("alert")).forEach(c=>{c.removed||e.alerts.push(e.series.price.createPriceLine(c))}),t()})}function ze(){e.loadWhitespace&&(d.state.tradingOrder.chartData.length>0&&(e.data.whitespace=de(e.data.whitespace,Ke())),e.series.whitespace.setData(e.data.whitespace),e.loadWhitespace=!1),e.data.original=de(d.state.tradingOrder.chartData,e.data.original);let t=e.data.original.reduce((r,i)=>{let s=i.price,l=0;r.price.length>0&&(s=r.price.slice(-1)[0].value,l=r.cash.slice(-1)[0].value);const a=i.price-s,n=a>0?1:a<0?-1:0;return r.price.push({time:i.time,value:i.price}),r.cash.push({time:i.time,value:l+n*i.volume}),r},{price:[],cash:[]});e.data.price=t.price,e.series.price.setData(t.price),e.data.cash=t.cash,e.series.cash.setData(t.cash)}function Ue(t){const r=e.data.original.length;if(e.data.original=de(e.data.original,[t]),e.data.original.length>r){const i=e.data.price.slice(-1)[0].value,s=e.data.cash.slice(-1)[0].value,l=t.price-i,a=l>0?1:l<0?-1:0,n={time:t.time,value:t.price},p={time:t.time,value:s+a*t.volume};e.data.price.push(n),e.series.price.update(n),e.data.cash.push(p),e.series.cash.update(p)}}function Ke(){const t=h.chartDate,r=moment(`${t} 09:00:00`).unix(),i=moment(`${t} 11:30:00`).unix(),s=moment(`${t} 13:00:00`).unix(),l=moment(`${t} 14:30:00`).unix();let a=[],n;for(n=r;n<=i;n++)a.push({time:n+7*60*60});for(n=s;n<=l;n++)a.push({time:n+7*60*60});return a}function de(t,r){return Array.from(new Map([...t,...r].sort((i,s)=>i.time-s.time).map(i=>[i.time,i])).values())}function pe(){e.websocket=new WebSocket(Pr),e.websocket.onopen=t=>{let r={action:"join",list:d.state.tradingOrder.config.symbol};e.websocket.send(`42${JSON.stringify(["regs",JSON.stringify(r)])}`)},e.websocket.onclose=t=>{if(e.socketStop)return!1;Q()&&(Ce(!0),pe(),moment().diff(e.socketRefreshTime,"seconds")>Sr&&fe())},e.websocket.onmessage=t=>{if(Ce(!1),t.data.substr(0,1)==4&&t.data.substr(1,1)==2){const r=JSON.parse(t.data.substr(2));if(r[0]=="stockps"){const i=r[1].data;i.id==3220&&(e.data.original.length>0&&Ue({time:moment(`${C} ${i.time}`).unix()+7*60*60,price:i.lastPrice,volume:i.lastVol}),wt(),Tt())}}}}function Ge(){const t=moment().unix();Q(t)&&(S.value.position&&t>v.ATC-5*60&&(Ze(),t>v.ATC-15&&e.order.tp.hasOwnProperty("line")&&d.dispatch("tradingOrder/executeOrder",{action:"cancel",tpData:{cmd:"cancel"},slData:{cmd:"delete"}}).then(r=>{r.isOk?(L("entry"),L("tp"),L("sl"),R(!1),o.clear("order"),P.success(f("trading.orderChart.autoCancelTpSlSuccess")),te()):T(r.message)})),t==v.START&&pe()),h.clock=moment().format("HH:mm:ss")}function Je(){if(d.state.tradingOrder.config.openingMarket){const t=moment().unix();if(Q(t)&&(e.order.tp.hasOwnProperty("line")||S.value.position&&t>v.ATO&&t<v.ATC&&(e.order.entry.price=e.data.price.slice(-1)[0].value,e.order.side=S.value.position,U.value.style.left=+(e.crosshair.x+(e.crosshair.x>innerWidth-61?-61:1))+"px",U.value.style.top=+(e.crosshair.y+(e.crosshair.y>innerHeight-51?-51:1))+"px",U.value.style.display="block"),!e.order.entry.hasOwnProperty("line"))){let r=null,i=0;S.value.position?(t<v.ATO?r="ATO":t>v.ATC&&(r="ATC"),r&&(e.order.entry.price=r,i=-S.value.position)):t>v.ATO&&t<v.ATC&&(r=$(e.crosshair.y),i=r>=e.data.price.slice(-1)[0].value?1:-1,e.order.side=i,e.order.entry.price=r),i&&(M.value.style.left=+(e.crosshair.x+(e.crosshair.x>innerWidth-71?-71:1))+"px",M.value.style.top=+(e.crosshair.y+(e.crosshair.y>innerHeight-61?-61:1))+"px",M.value.style.background=i>0?"green":"red",M.value.innerText=`${i>0?"LONG":"SHORT"} ${r}`,M.value.style.display="block")}}}function ue(){M.value.style.display="none",U.value.style.display="none"}function R(t){z.value.style.display=t?"block":"none"}function Ze(){z.value.classList.contains("blink")||z.value.classList.add("blink")}function Ce(t){t?X.value.classList.contains("blink")||X.value.classList.add("blink"):X.value.classList.contains("blink")&&X.value.classList.remove("blink")}function _(t){let r,i;switch(t){case"entry":r="yellow",i=e.order.side>0?"LONG":"SHORT";break;case"tp":r="lime",i=Math.abs(e.order.tp.price-e.order.entry.price).toFixed(1);break;case"sl":r="red",i=Math.abs(e.order.sl.price-e.order.entry.price).toFixed(1);break}e.order[t].hasOwnProperty("line")?e.order[t].line.applyOptions({price:e.order[t].price,title:i}):e.order[t].line=e.series.price.createPriceLine({lineType:"order",kind:t,price:e.order[t].price,color:r,lineWidth:1,lineStyle:0,title:i,draggable:!0}),o.set("order",{kind:t,price:+e.order[t].price,side:e.order.side})}function L(t){e.order[t].hasOwnProperty("line")&&(e.series.price.removePriceLine(e.order[t].line),delete e.order[t].line)}function Qe(t){h.showTradingView=!h.showTradingView,t.stopPropagation()}function et(t){h.showColorPicker=!h.showColorPicker,t.stopPropagation()}function tt(t){x.isSet(e.pattern1.X)&&(j(+e.pattern1.X.options().price),j(+e.pattern1.Y.options().price),j(+e.pattern1.Z.options().price),j(+e.pattern1.T.options().price)),t.preventDefault(),t.stopPropagation()}function rt(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||t.target.classList.add("selected"),t.stopPropagation()}function it(t){ot(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function j(t=null,r=!1,i=!1){const s="line";t||(t=ee($(e.crosshair.y)));const l=e.lines.length;if(e.lines=e.lines.filter(a=>{const n=a.options(),p=n.type=t==+n.price;return p&&(e.series.price.removePriceLine(a),o.set("line",{price:t,removed:!0})),!p}),e.lines.length==l&&!i||r){const a={lineType:s,price:t,color:h.color,lineWidth:1,lineStyle:1,draggable:!0};e.lines.push(e.series.price.createPriceLine(a)),o.set("line",a)}H.value.classList.remove("selected")}function ot(){e.lines.forEach(t=>e.series.price.removePriceLine(t)),e.lines=[],o.clear("line")}function st(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||(t.target.classList.add("selected"),Oe()),t.stopPropagation()}function at(t){Oe(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function nt(){const t=$(e.crosshair.y);let r={lineType:"ruler",price:t,lineWidth:1,lineStyle:1,draggable:!0};if(e.ruler.pointCount==0)r.point="l0",r.color="#F44336",r.title="0",e.ruler[r.point]=e.series.price.createPriceLine(r),e.ruler.pointCount++,o.set("ruler",r);else{const i=+e.ruler.l0.options().price,s=t-i;r.point="l1",r.color="#FF9800",r.title=s.toFixed(1),e.ruler[r.point]=e.series.price.createPriceLine(r),o.set("ruler",r);const l=-s;r.point="ln1",r.color="#FF9800",r.title=l.toFixed(1),r.price=+(i+l).toFixed(1),e.ruler[r.point]=e.series.price.createPriceLine(r),o.set("ruler",r);const a=2*s;r.point="l2",r.color="#FFEB3B",r.title=a.toFixed(1),r.price=+(i+a).toFixed(1),e.ruler[r.point]=e.series.price.createPriceLine(r),o.set("ruler",r);const n=3*s;r.point="l3",r.color="#4CAF50",r.title=n.toFixed(1),r.price=+(i+n).toFixed(1),e.ruler[r.point]=e.series.price.createPriceLine(r),o.set("ruler",r);const p=4*s;r.point="l4",r.color="#009688",r.title=p.toFixed(1),r.price=+(i+p).toFixed(1),e.ruler[r.point]=e.series.price.createPriceLine(r),o.set("ruler",r),e.ruler.pointCount++,J.value.classList.remove("selected")}}function Oe(){e.ruler.pointCount>0&&(e.series.price.removePriceLine(e.ruler.l0),e.ruler.pointCount>1&&(e.series.price.removePriceLine(e.ruler.ln1),e.series.price.removePriceLine(e.ruler.l1),e.series.price.removePriceLine(e.ruler.l2),e.series.price.removePriceLine(e.ruler.l3),e.series.price.removePriceLine(e.ruler.l4)),e.ruler={l0:{},ln1:{},l1:{},l2:{},l3:{},l4:{},pointCount:0},o.clear("ruler"))}function lt(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||(t.target.classList.add("selected"),be()),t.stopPropagation()}function ct(t){be(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function dt(){let r={lineType:"target",price:$(e.crosshair.y,"cash"),lineWidth:1,lineStyle:0,draggable:!1,axisLabelVisible:!1};if(x.isSet(e.target.A)?x.isSet(e.target.B)?(r.point="C",r.title="C",r.color="#9C27B0"):(r.point="B",r.title="B",r.color="#E91E63"):(r.point="A",r.title="A",r.color="#E91E63"),e.target[r.point]=e.series.cash.createPriceLine(r),o.set("target",r),r.point=="C"){const i=+e.target.A.options().price,s=+e.target.B.options().price,l=+e.target.C.options().price;r.point="D",r.price=+(l+s-i).toFixed(1),r.title="D",r.color="#9C27B0",e.target[r.point]=e.series.cash.createPriceLine(r),o.set("target",r),ae.value.classList.remove("selected")}}function be(){x.isSet(e.target.A)&&(e.series.cash.removePriceLine(e.target.A),x.isSet(e.target.B)&&(e.series.cash.removePriceLine(e.target.B),x.isSet(e.target.C)&&(e.series.cash.removePriceLine(e.target.C),e.series.cash.removePriceLine(e.target.D))),e.target={A:{},B:{},C:{},D:{}},o.clear("target"))}function pt(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||(t.target.classList.add("selected"),ke()),t.stopPropagation()}function ut(t){ke(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function ft(){const t=$(e.crosshair.y);let r={lineType:"pattern1",price:t,lineWidth:1,lineStyle:1,draggable:!0};if(x.isSet(e.pattern1.A)){const i=+e.pattern1.A.options().price,s=t-i;r.point="B",r.title=s.toFixed(1),r.color="#009688",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),r.point="C",r.price=+(i+.5*s).toFixed(1),r.title=(.5*s).toFixed(1),r.color="#009688",r.draggable=!1,e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),r.point="X1",r.price=+(i-.375*s).toFixed(1),r.title=(-.375*s).toFixed(1),r.color="#2196F3",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),r.point="X2",r.price=+(i-.5*s).toFixed(1),r.title=(-.5*s).toFixed(1),r.color="#2196F3",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),r.point="Y1",r.price=+(i-s).toFixed(1),r.title=-s.toFixed(1),r.color="#673AB7",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),r.point="Y2",r.price=+(i-2*s).toFixed(1),r.title=(-2*s).toFixed(1),r.color="#673AB7",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r),ne.value.classList.remove("selected")}else r.point="A",r.title="0",r.color="#009688",e.pattern1[r.point]=e.series.price.createPriceLine(r),o.set("pattern1",r)}function ke(){x.isSet(e.pattern1.A)&&(e.series.price.removePriceLine(e.pattern1.A),x.isSet(e.pattern1.B)&&(e.series.price.removePriceLine(e.pattern1.B),e.series.price.removePriceLine(e.pattern1.C),e.series.price.removePriceLine(e.pattern1.X1),e.series.price.removePriceLine(e.pattern1.X2),e.series.price.removePriceLine(e.pattern1.Y1),e.series.price.removePriceLine(e.pattern1.Y2)),e.pattern1={A:{},B:{},C:{},X1:{},X2:{},Y1:{},Y2:{}},o.clear("pattern1"))}function ht(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||(t.target.classList.add("selected"),Pe(!0)),t.stopPropagation()}function mt(t){Se(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function Pe(t=!1){let r={};if(x.isSet(e.pattern2.O)){const p=e.pattern2.O.options();r={time:p.time0,value:p.price0},Se()}else{if(t)return!1;r={time:e.crosshair.time,value:$(e.crosshair.y)}}const{price2:i,price3:s,price4:l,isAcc:a}=vt(r);console.log("price2",i),console.log("price3",s),console.log("price4",l);let n={lineType:"pattern2",lineWidth:1,lineStyle:1};console.log("isAcc",a),j(r.value,!a,a),n.time0=r.time,n.price0=r.value,n.point="O",n.price=l,n.title="O",n.color="#2196F3",n.draggable=!1,e.pattern2[n.point]=e.series.price.createPriceLine(n),o.set("pattern2",n),le.value.classList.remove("selected")}function vt(t){let r=t.value,i=t.value,s=t.value,l=!1;for(let a of e.data.price)if(a.time>=t.time){a.value<t.value?(r<=t.value&&a.value<r&&(r=a.value),i<=t.value&&r>t.value&&a.value<i&&(i=a.value)):a.value>t.value&&(r>=t.value&&a.value>r&&(r=a.value),i>=t.value&&r<t.value&&a.value>i&&(i=a.value));const n=a.value-i,p=t.value-i,c=r-i,u=Math.abs(p*2)>Math.abs(c/2)?p*2:c/2;if(s=+(i+u).toFixed(1),r!=t.value&&i!=t.value){if(Math.abs(n)>Math.abs(u)){l=!0;break}if(Math.abs(n)>Math.abs(p)*3)break}}return{price2:r,price3:i,price4:s,isAcc:l}}function Se(){x.isSet(e.pattern2.O)&&(e.series.price.removePriceLine(e.pattern2.O),e.pattern2={O:{}},o.clear("pattern2"))}function gt(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||t.target.classList.add("selected"),t.stopPropagation()}function yt(t){Ct(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function xt(){const t="alert",r=ee($(e.crosshair.y)),i=e.alerts.length;if(e.alerts=e.alerts.filter(s=>{const l=s.options(),a=l.type=r==+l.price;return a&&(e.series.price.removePriceLine(s),o.set("alert",{price:r,removed:!0})),!a}),e.alerts.length==i){const s={lineType:t,price:r,title:r>=e.data.price.slice(-1)[0].value?">":"<",color:"red",lineWidth:1,lineStyle:1,draggable:!0};e.alerts.push(e.series.price.createPriceLine(s)),o.set("alert",s)}Z.value.classList.remove("selected")}function Ct(){e.alerts.forEach(t=>e.series.price.removePriceLine(t)),e.alerts=[],o.clear("alert")}function Ot(t){h.showColorPicker=!1;const r=t.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command").forEach(i=>i.classList.remove("selected")),r||(t.target.classList.add("selected"),Le(!0)),t.stopPropagation()}function bt(t){Te(),t.target.classList.remove("selected"),t.preventDefault(),t.stopPropagation()}function Le(t=!1){let r={};if(t){if(e.box.length==0)return!1;r={time:+e.box[0].x.time,value:+e.box[0].y.options().price},Te()}else r={time:e.crosshair.time,value:$(e.crosshair.y,"cash")};const{point2:i,point3:s,point4:l,point5:a}=kt(r);let n={y:{lineWidth:1,lineStyle:0,draggable:!1,axisLabelVisible:!1},x:{value:1}};n.y.color="#E91E63",n.y.price=r.value,n.x.time=r.time,K(0,n),n.y.price=i.value,n.x.time=i.time,K(1,n),n.y.color="#9C27B0",n.y.price=s.value,n.x.time=s.time,K(2,n),n.y.price=l.value,n.x.time=l.time,K(3,n),n.y.price=a.value,n.x.time=a.time,K(4,n),ce.value.classList.remove("selected")}function kt(t){let r={...t},i={...t},s={...t},l={...t};for(let a of e.data.cash)if(a.time>t.time&&(a.value<t.value?(r.value<=t.value&&a.value<r.value&&(r=a,i.time=a.time,s.time=a.time,l.time=a.time),r.value>t.value&&(i.value<=t.value&&a.value<i.value&&(i.value==t.value&&(r.time=a.time),i=a),a.value<r.value&&i.value==t.value&&(i.time=a.time,s.time=a.time,l.time=a.time))):a.value>t.value&&(r.value>=t.value&&a.value>r.value&&(r=a,i.time=a.time,s.time=a.time,l.time=a.time),r.value<t.value&&(i.value>=t.value&&a.value>i.value&&(i.value==t.value&&(r.time=a.time),i=a),a.value>r.value&&i.value==t.value&&(i.time=a.time,s.time=a.time,l.time=a.time))),i.value!=t.value)){const n=e.data.whitespace.findIndex(g=>g.time===t.time),p=e.data.whitespace.findIndex(g=>g.time===r.time),c=e.data.whitespace.findIndex(g=>g.time===i.time),u=e.data.whitespace.findIndex(g=>g.time===a.time),b=c+p-n,w=c+2*(p-n);if(b<e.data.whitespace.length&&(s.time=e.data.whitespace[b].time,s.value=i.value+r.value-t.value),w<e.data.whitespace.length&&(l.time=e.data.whitespace[w].time,l.value=i.value+r.value-t.value),u>b)break}return{point2:r,point3:i,point4:s,point5:l}}function K(t,r){r.point=t,e.box.push({...r}),o.set("box",e.box[t]),e.series.box.update(e.box[t].x),e.box[t].y=e.series.cash.createPriceLine(e.box[t].y)}function Te(){e.box.forEach(t=>e.series.cash.removePriceLine(t.y)),e.series.box.setData([]),e.box=[],o.clear("box")}async function Pt(){e.order.entry.hasOwnProperty("line")&&(e.order.tp.hasOwnProperty("line")?d.dispatch("tradingOrder/executeOrder",{action:"exit",tpData:{cmd:"cancel"},slData:{cmd:"delete"},exitData:{cmd:"new",price:"MTL"}}).then(t=>{t.isOk?(L("entry"),L("tp"),L("sl"),R(!1),o.clear("order"),P.success(f("trading.orderChart.exitSuccess"))):(R(!0),T(t.message))}):d.dispatch("tradingOrder/executeOrder",{action:"entry",data:{cmd:"delete"}}).then(t=>{t.isOk?(L("entry"),R(!1),o.clear("order"),P.success(f("trading.orderChart.deleteEntrySuccess"))):(R(!0),T(t.message))}))}function St(){const t=moment().unix();Q(t)&&(t<v.ATO?Ee(f("trading.orderChart.atoOrder"),f("titles.confirm")).then(i=>{i&&d.dispatch("tradingOrder/executeOrder",{action:"exit",exitData:{cmd:"new",price:"ATO"}}).then(s=>{s.isOk?P.success(f("trading.orderChart.atoOrderSuccess")):T(s.message)})}):t<v.ATC?d.dispatch("tradingOrder/executeOrder",{action:"entry",data:{cmd:"new",side:e.order.side,price:e.order.entry.price}}).then(r=>{r.isOk?(_("entry"),R(!0),P.success(f("trading.orderChart.newEntrySuccess"))):T(r.message)}):Ee(f("trading.orderChart.atcOrder"),f("titles.confirm")).then(i=>{i&&d.dispatch("tradingOrder/executeOrder",{action:"exit",exitData:{cmd:"new",price:"ATC"}}).then(s=>{s.isOk?P.success(f("trading.orderChart.atcOrderSuccess")):T(s.message)})}))}function Lt(){e.order.tp.price=e.order.entry.price+e.order.side*_e,e.order.sl.price=e.order.entry.price-e.order.side*Re,d.dispatch("tradingOrder/executeOrder",{action:"tpsl",tpData:{cmd:"new",price:e.order.tp.price},slData:{cmd:"new",price:e.order.sl.price}}).then(t=>{t.isOk?(_("entry"),_("tp"),_("sl"),e.order.entry.line.applyOptions({draggable:!1}),P.success(f("trading.orderChart.newTpSlSuccess"))):T(t.message)})}function Tt(){if(e.order.entry.hasOwnProperty("line")){const t=e.data.price.slice(-1)[0].value;e.order.tp.hasOwnProperty("line")?((e.order.side>0&&t>=e.order.tp.price||e.order.side<0&&t<=e.order.tp.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,d.dispatch("tradingOrder/executeOrder",{action:"sl",data:{cmd:"delete"}}).then(r=>{r.isOk?(L("entry"),L("tp"),L("sl"),R(!1),o.clear("order"),P.success(f("trading.orderChart.deleteTpSuccess")),ue(),te()):T(r.message),e.isAutoOrdering=!1}))),(e.order.side>0&&t<=e.order.sl.price||e.order.side<0&&t>=e.order.sl.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,d.dispatch("tradingOrder/executeOrder",{action:"tp",data:{cmd:"cancel"}}).then(r=>{r.isOk?(L("entry"),L("tp"),L("sl"),R(!1),o.clear("order"),P.success(f("trading.orderChart.deleteSlSuccess")),ue(),te()):T(r.message),e.isAutoOrdering=!1})))):(e.order.side>0&&t>=e.order.entry.price||e.order.side<0&&t<=e.order.entry.price)&&(e.isAutoOrdering||(e.isAutoOrdering=!0,setTimeout(()=>{e.order.tp.price=e.order.entry.price+e.order.side*_e,e.order.sl.price=e.order.entry.price-e.order.side*Re,d.dispatch("tradingOrder/executeOrder",{action:"tpsl",tpData:{cmd:"new",price:e.order.tp.price},slData:{cmd:"new",price:e.order.sl.price}}).then(r=>{r.isOk?(_("tp"),_("sl"),e.order.entry.line.applyOptions({draggable:!1}),P.success(f("trading.orderChart.autoNewTpSlSuccess")),te()):T(r.message),e.isAutoOrdering=!1})},1e3)))}}function wt(){if(S.value.position&&x.isSet(e.target.X)){const t=e.data.cash.slice(-1)[0].value,r=+e.target.B.options().price,i=+e.target.X.options().price,s=i-r;(s>0&&t>=i||s<0&&t<=i)&&z.value.click()}}function Ft(){e.chart.timeScale().scrollToRealTime()}function Q(t=null){return t||(t=moment().unix()),t>=v.START&&t<=v.END}function $(t,r="price"){return ee(e.series[r].coordinateToPrice(t))}function ee(t){return t?+ +t.toFixed(1):0}function T(t){t||(t="unknown"),P.error(f(`trading.orderChart.${t}`))}function At(){e.loadWhitespace=!0,d.dispatch("tradingOrder/getChartData",h.chartDate)}function fe(){e.socketRefreshTime=moment(),e.loadWhitespace=!0,d.dispatch("tradingOrder/getChartData",h.chartDate)}function Et(){e.data.original=[],e.data.price=[],e.data.cash=[],e.data.whitespace=[],fe()}function te(){let t=new Audio(ir);t.crossOrigin="anonymous",t.addEventListener("canplaythrough",function(){t.play()})}function _t(){d.dispatch("tradingOrder/getAccountInfo").then(t=>{let r="";r+='<div style="width: 200px;">',r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${f("trading.orderChart.nav")}</div><div>: ${E.currency(t.nav)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${f("trading.orderChart.maxVol")}</div><div>: ${E.numberVnFormat(t.maxVol)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${f("trading.orderChart.vm")}</div><div>: ${E.currency(t.vm)}</div></div>`,r+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${f("trading.orderChart.fee")}</div><div>: ${E.currency(t.fee)}</div></div>`,r+="</div>",Kt(r,f("trading.orderChart.accountInfo"))})}function Rt(){G.emit("checkPin",()=>d.dispatch("tradingOrder/report"))}function Dt(){G.emit("checkPin",()=>d.dispatch("tradingOrder/export"))}return(t,r)=>{const i=Wt("DxToolbar");return Gt(),Xt(Ut,null,[m("div",or,[se(i,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-flag-checkered small",hint:t.$t("trading.orderChart.buttons.report"),onClick:Rt}},{location:"before",widget:"dxButton",options:{icon:"far fa-file-export small",hint:t.$t("trading.orderChart.buttons.export"),onClick:Dt}},{location:"before",widget:"dxButton",options:{icon:"far fa-chart-line small",hint:t.$t("trading.orderChart.buttons.cashflow"),onClick:()=>t.$refs.dailyCashFlowPopupRef.show()}}]},null,8,["items"]),m("div",{class:"order-chart-container",ref_key:"chartContainerRef",ref:F},[m("div",{class:"chart-wrapper",ref_key:"orderChartRef",ref:me},[m("div",sr,[m("div",{ref_key:"connectionRef",ref:X,class:he(`command far fa-${S.value.connection?"link":"unlink"}`),title:t.$t("trading.orderChart.connection"),onClick:r[0]||(r[0]=()=>t.$store.dispatch("tradingOrder/getStatus"))},null,10,ar),m("div",{class:he(["command status",{green:S.value.position>0,red:S.value.position<0,pending:S.value.pending}]),title:t.$t("trading.orderChart.position"),onClick:_t},Ae(S.value.position),11,nr),m("div",{class:"command clock",onClick:fe},Ae(h.clock),1),N(m("input",{type:"date",class:"chart-date command",title:t.$t("trading.orderChart.date"),"onUpdate:modelValue":r[1]||(r[1]=s=>h.chartDate=s),onChange:At},null,40,lr),[[Ht,h.chartDate]]),m("img",{ref_key:"spinnerRef",ref:ve,class:"command spinner",src:tr},null,512)]),m("div",cr,[m("div",{ref_key:"fullscreenToolRef",ref:ge,class:he(`command far fa-${h.isFullscreen?"compress":"expand"}`),title:t.$t("trading.orderChart.fullscreen"),onClick:Xe},null,10,dr),m("div",{ref_key:"reloadToolRef",ref:ye,class:"command far fa-sync-alt",title:t.$t("trading.orderChart.reload"),onClick:Et},null,8,pr),m("div",{ref_key:"tradingviewRef",ref:xe,class:"command far fa-chart-bar",title:t.$t("trading.orderChart.tradingview"),onClick:Qe},null,8,ur),m("div",{ref_key:"colorToolRef",ref:$e,class:"color command far fa-palette",style:zt({color:h.color}),title:t.$t("trading.orderChart.colorTool"),onClick:et,onContextmenu:tt},[N(se(er,{class:"color-picker",modelValue:h.color,"onUpdate:modelValue":r[2]||(r[2]=s=>h.color=s)},null,8,["modelValue"]),[[W,h.showColorPicker]])],44,fr),m("div",{ref_key:"lineToolRef",ref:H,class:"command far fa-horizontal-rule",title:t.$t("trading.orderChart.lineTool"),onClick:rt,onContextmenu:it},null,40,hr),m("div",{ref_key:"pattern1ToolRef",ref:ne,class:"command far fa-dot-circle",title:t.$t("trading.orderChart.pattern1Tool"),onClick:pt,onContextmenu:ut},null,40,mr),N(m("div",{ref_key:"pattern2ToolRef",ref:le,class:"command far fa-heart",title:t.$t("trading.orderChart.pattern2Tool"),onClick:ht,onContextmenu:mt},null,40,vr),[[W,!1]]),m("div",{ref_key:"rulerToolRef",ref:J,class:"command far fa-line-height",title:t.$t("trading.orderChart.rulerTool"),onClick:st,onContextmenu:at},null,40,gr),N(m("div",{ref_key:"targetToolRef",ref:ae,class:"command far fa-grip-lines",title:t.$t("trading.orderChart.targetTool"),onClick:lt,onContextmenu:ct},null,40,yr),[[W,!1]]),m("div",{ref_key:"boxToolRef",ref:ce,class:"command far fa-expand-alt",title:t.$t("trading.orderChart.boxTool"),onClick:Ot,onContextmenu:bt},null,40,xr),N(m("div",{ref_key:"alertToolRef",ref:Z,class:"command far fa-alarm-exclamation",title:t.$t("trading.orderChart.alertTool"),onClick:gt,onContextmenu:yt},null,40,Cr),[[W,!1]]),N(m("div",{class:"command far fa-info-circle",title:t.$t("trading.orderChart.copyistStatusPopup.title"),onClick:r[3]||(r[3]=()=>t.$refs.copyistStatusPopupRef.show())},null,8,Or),[[W,!1]]),m("div",{ref_key:"cancelOrderRef",ref:z,class:"cancel-order command far fa-trash-alt",title:t.$t("trading.orderChart.cancelTool"),onClick:Pt},null,8,br)]),m("div",null,[m("div",{ref_key:"entryOrderRef",ref:M,class:"order-button entry",onClick:St}," Entry ",512),m("div",{ref_key:"tpslOrderRef",ref:U,class:"order-button tpsl",onClick:Lt}," TP/SL ",512),m("div",{class:"chart-top command far fa-angle-double-right",onClick:Ft})]),N(m("iframe",{ref_key:"tradingviewChartRef",ref:Be,class:"tradingview-chart",src:Me.value},null,8,kr),[[W,h.showTradingView]])],512)],512)]),se(Jt,{ref:"copyistStatusPopupRef"},null,512),se(Qt,{ref:"dailyCashFlowPopupRef"},null,512)],64)}}},Er=Mt(Lr,[["__scopeId","data-v-102ea84c"]]);export{Er as default};
