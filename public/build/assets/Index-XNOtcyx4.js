import{r as _,c as d,y as k,b as p,d as o,e as s,g as b,P as R,t,q as w,h as y,i as C,j as B,k as D,m as f,o as m,bS as q,bT as T,bR as A,bU as I}from"./app-HEjbTcbK.js";import{_ as N}from"./UserDetailPopup-CY8AZ9OK.js";import S from"./EditProfilePopup-0e5RdA9f.js";import"./subDays-BfVJADkX.js";import"./subYears-CPT5-mZK.js";const V={class:"profile-page"},j={class:"content-block dx-card responsive-paddings"},M={class:"info"},O={class:"avatar"},U={class:"personal"},W={class:"name"},E={key:0},G={class:"content-block dx-card responsive-paddings change"},L={class:"title"},z={class:"content"},F={class:"content-block dx-card responsive-paddings delete"},H={class:"title"},J={class:"content"},oe={__name:"Index",setup(K){const a=y(),h=C(),v=B(),g=D("bus"),i=_(null),n=d(()=>a.state.auth.user);let r=d(()=>a.state.userProfile.profile);a.dispatch("userProfile/getProfile"),k(()=>{v.hash==="#detail"&&u()});function u(){i.value.show(r.value)}function $(){g.emit("checkPin",()=>{a.dispatch("userProfile/delete").then(e=>{e&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),a.dispatch("auth/clearData"),h.push({name:"login"}))})})}return(e,c)=>{const P=f("DxToolbar"),l=f("DxButton");return m(),p("div",V,[o("div",j,[s(P,{items:[{visible:!!e.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>{e.$router.push({name:e.$route.query.redirect})}}},{visible:n.value.level<5,location:"before",widget:"dxButton",options:{icon:"far fa-user-edit small",hint:e.$t("components.editProfile.title"),onClick:()=>e.$refs.editProfilePopupRef.show(b(r))}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:e.$t("components.changeAvatar.title"),onClick:()=>e.$refs.changeAvatarPopupRef.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:e.$t("components.changePin.title"),onClick:()=>e.$refs.changePinPopupRef.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:e.$t("components.changePassword.title"),onClick:()=>e.$refs.changePasswordPopupRef.show()}}]},null,8,["items"]),o("div",M,[o("div",O,[s(R,{images:[n.value.avatar]},null,8,["images"])]),o("div",U,[o("div",null,[o("span",null,t(e.$t("models.user.name"))+":",1),o("span",W,t(n.value.name),1)]),o("div",null,[o("span",null,t(e.$t("models.user.code"))+":",1),o("span",null,t(n.value.code),1)]),n.value.phone?(m(),p("div",E,[o("span",null,t(e.$t("models.user.phone"))+":",1),o("span",null,t(e.$filters.phone(n.value.phone)),1)])):w("",!0),o("div",null,[o("span",null,t(e.$t("models.user.email"))+":",1),o("span",null,t(n.value.email),1)]),s(l,{width:"170",class:"detail",type:"default","styling-mode":"outlined",text:e.$t("user.profile.detailInfo"),onClick:u},null,8,["text"])])])]),o("div",G,[o("div",L,t(e.$t("user.profile.changeRequest.title")),1),o("div",z,[o("div",null,t(e.$t("user.profile.changeRequest.desctiption")),1),s(l,{text:e.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained",onClick:c[0]||(c[0]=Q=>e.$refs.sendCommentPopupRef.show())},null,8,["text"])])]),o("div",F,[o("div",H,t(e.$t("user.profile.delete.title")),1),o("div",J,[o("div",null,t(e.$t("user.profile.delete.desctiption")),1),s(l,{text:e.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained",onClick:$},null,8,["text"])])]),s(q,{ref:"sendCommentPopupRef"},null,512),s(N,{ref_key:"userDetailPopupRef",ref:i},null,512),s(S,{ref:"editProfilePopupRef"},null,512),s(T,{ref:"changeAvatarPopupRef"},null,512),s(A,{ref:"changePinPopupRef"},null,512),s(I,{ref:"changePasswordPopupRef"},null,512)])}}};export{oe as default};
