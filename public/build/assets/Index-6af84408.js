import{u as v,c as w,i as d,r as h,d as y,w as T,f as $,g as R,j as a,k as p,l as n,o as S,D as o,m as D}from"./app-4daa0cbb.js";import C from"./TransactionFinbookPopup-e6f0cd4e.js";const F={class:"finbooks-page content-block dx-card responsive-paddings"},_={__name:"Index",setup(I){const r=v(),{t:i}=w(),m=d("bus"),l=d("mt"),f=d("mf"),u=h(null),t=y({gridData:null,validationRules:{name:[{type:"required",message:i("trading.finbooks.name")+l.validations.required}],balance:[{type:"required",message:i("trading.finbooks.balance")+l.validations.required}],lastTransaction:[{type:"required",message:i("trading.finbooks.lastTransaction")+l.validations.required}],display:[{type:"required",message:i("trading.finbooks.display")+l.validations.required}]}});r.dispatch("tradingFinbook/getFinbook"),T(()=>r.state.tradingFinbook.finbooks,e=>{t.gridData=f.cloneDeep(e)});function g(e){m.emit("checkPin",()=>r.dispatch("tradingFinbook/save",{changes:e.changes}))}function b(e){e.data.last_transaction=i("trading.finbooks.openNewBook")}return(e,c)=>{const k=$("DxToolbar");return S(),R("div",F,[a(n(D),{ref_key:"dataGridRef",ref:u,"data-source":t.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:c[0]||(c[0]=s=>e.$mf.dataGridPreload(t.gridData,u.value.instance)),onInitNewRow:b,onSaved:g},{commandCellTemplate:p(({data:s})=>[a(k,{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"far fa-envelope-open-dollar small",hint:e.$t("trading.finbooks.createTransaction"),text:e.$t("trading.finbooks.createTransaction"),onClick:()=>e.$refs.transactionFinbookPopupRef.show(s.data)}},{visible:s.data.balance==0,locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:e.$t("buttons.delete"),text:e.$t("buttons.delete"),onClick:()=>e.dataGrid.instance.deleteRow(s.rowIndex)}}]},null,8,["items"])]),default:p(()=>[a(n(o),{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:70,alignment:"center",type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),a(n(o),{"data-field":"display",dataType:"number",caption:e.$t("trading.finbooks.display"),"validation-rules":t.validationRules.display},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"name",dataType:"string","header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.name"),"validation-rules":t.validationRules.name},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"balance","data-type":"number",format:"#,##0 ₫","editor-options":{step:"1000000",format:"#,##0 ₫"},"header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.balance"),"validation-rules":t.validationRules.balance},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"last_transaction",dataType:"string","header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.lastTransaction"),"validation-rules":t.validationRules.lastTransaction},null,8,["caption","validation-rules"]),a(n(o),{"allow-editing":!1,"data-field":"updated_at","data-type":"date","editor-options":{dateSerializationFormat:e.$mc.DX_SERVER_DATE_FORMAT},caption:e.$t("trading.finbooks.updatedAt")},null,8,["editor-options","caption"])]),_:1},8,["data-source"]),a(C,{ref:"transactionFinbookPopupRef"},null,512)])}}};export{_ as default};
