import{_ as m,D as h,a as f,m as g,c as w,r as d,g as D,w as r,o as S,f as i}from"./app-b44850ea.js";const y={components:{DxDataGrid:h,DxColumn:f},data(){return{gridData:null}},computed:{...g("Admin.users",["deletedUsers"]),dataGrid:function(){return this.$refs.dataGrid.instance},popup(){return this.$refs.popup.instance}},watch:{deletedUsers(){this.cloneDeepData()}},methods:{...w("Admin.users",["save"]),show(){this.popup.show(),this.cloneDeepData(),this.$mf.pushPopupToHistoryState(()=>this.popup.hide())},onSavedDeletedUser(e){this.$bus.emit("checkPin",()=>{e.isDeleted=!0,this.save(e)})},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.deletedUsers)},isRowRestored(e){const o=this.dataGrid.option("editing.changes").find(a=>a.type=="update"&&a.key==e);return this.$mf.isSet(o)},unrestore(e){let o=this.dataGrid.option("editing.changes");o=o.filter(a=>!(a.type=="update"&&a.key==e)),this.dataGrid.option("editing.changes",o)},isRowDeleted(e){const o=this.dataGrid.option("editing.changes").find(a=>a.type=="remove"&&a.key==e);return this.$mf.isSet(o)}}};function G(e,o,a,b,l,t){const s=d("DxColumn"),u=d("DxToolbar"),p=d("DxDataGrid"),c=d("DxPopup");return S(),D(c,{ref:"popup",showCloseButton:!0,fullScreen:!!e.$screen.getScreenSizeInfo.isXSmall,"show-title":!0,title:e.$t("admin.users.deletedUsers"),onHiding:e.$mf.popRouteHistoryState},{content:r(()=>[i(p,{ref:"dataGrid","data-source":l.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:o[0]||(o[0]=n=>e.$mf.dataGridPreload(l.gridData,t.dataGrid)),onSaved:t.onSavedDeletedUser},{commandCellTemplate:r(({data:n})=>[i(u,{items:[{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{disabled:t.isRowDeleted(n.key),type:"default",icon:t.isRowRestored(n.key)?"undo":"repeat",hint:e.$t("admin.users.buttons.revert"),text:e.$t("admin.users.buttons.revert"),onClick:()=>{t.isRowRestored(n.key)?t.unrestore(n.key):t.dataGrid.cellValue(n.rowIndex,"deleted_at",null),t.dataGrid.repaintRows(n.rowIndex)}}},{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{type:"default",icon:t.isRowDeleted(n.key)?"undo":"clearsquare",hint:e.$t("admin.users.buttons.remove"),text:e.$t("admin.users.buttons.remove"),onClick:()=>{t.isRowDeleted(n.key)?t.dataGrid.undeleteRow(n.rowIndex):t.dataGrid.deleteRow(n.rowIndex)}}}]},null,8,["items"])]),default:r(()=>[i(s,{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:75,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),i(s,{"allow-editing":!1,"data-field":"code","data-type":"string",caption:e.$t("models.user.codeShort")},null,8,["caption"]),i(s,{"allow-editing":!1,"data-field":"name",caption:e.$t("models.user.name")},null,8,["caption"]),i(s,{"allow-editing":!1,"data-field":"phone",caption:e.$t("models.user.phone")},null,8,["caption"]),i(s,{"allow-editing":!1,visible:!1,"data-field":"deleted_at"})]),_:1},8,["data-source","onSaved"])]),_:1},8,["fullScreen","title","onHiding"])}const v=m(y,[["render",G]]);export{v as default};
