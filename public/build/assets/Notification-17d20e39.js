import{_ as a,D as s,a as r,n as c}from"./app-f37d1114.js";import{P as l}from"./PickImagePopup-6a96dc7d.js";import{a as d}from"./index-1ef70744.js";import"./FileManager-3d77f4f1.js";import"./ui.data_grid.row_dragging-72b50656.js";import"./dialog-42ea61b6.js";const m={components:{DxForm:a,DxItem:s,PickImagePopup:l},data(){return{formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:this.$t("settings.notification.receiver")+this.$mt.validations.required}],title:[{type:"required",message:this.$t("settings.notification.notificationTitle")+this.$mt.validations.required}],body:[{type:"required",message:this.$t("settings.notification.body")+this.$mt.validations.required}]}}},beforeCreate(){this.$store.registerModule("Settings",d)},created(){this.actionOptions=this.getActionsOptions(this.formData.actions),this.addActionOptions={icon:"add",text:this.$t("buttons.add"),onClick:()=>{this.formData.actions.push(""),this.actionOptions=this.getActionsOptions(this.formData.actions)}}},mounted(){this.formData.receiver=this.$route.query.codes||null,setTimeout(()=>this.form.getEditor("receiver").focus(),1e3)},destroyed(){this.$store.unregisterModule("Settings")},computed:{toolbar:function(){return this.$refs.toolbar.instance},form:function(){return this.$refs.form.instance}},methods:{...r("Settings",["sendNotification"]),onSubmit(){this.$bus.emit("checkPin",()=>{this.sendNotification(this.formData)})},getActionsOptions(o){let t=[];for(let i=0;i<o.length;i++)t.push(this.generateNewActionOptions(i));return t},generateNewActionOptions(o){return{placeholder:this.$t("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{this.formData.actions.splice(o,1),this.actionOptions=this.getActionsOptions(this.formData.actions)}}}]}}}};var u=function(){var t=this,i=t._self._c;return i("div",{staticClass:"settings-page"},[i("h2",{staticClass:"content-block"},[t._v(" "+t._s(t.$t("settings.notification.title"))+" ")]),i("div",{staticClass:"content-block dx-card responsive-paddings"},[i("div",[i("form",{staticClass:"setting-notification-tab",on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[i("DxForm",{ref:"form",attrs:{"form-data":t.formData,"label-location":t.$devices.phone?"top":"left","scrolling-enabled":!0}},[i("DxItem",{attrs:{"item-type":"group"}},[i("DxItem",{attrs:{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:t.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>t.$router.push({name:"users",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:t.$t("settings.notification.receiver")}}}),i("DxItem",{attrs:{"data-field":"title","validation-rules":t.validationRules.title,label:{text:t.$t("settings.notification.notificationTitle")}}}),i("DxItem",{attrs:{"data-field":"body","validation-rules":t.validationRules.body,label:{text:t.$t("settings.notification.body")}}}),i("DxItem",{attrs:{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>t.$refs.pickImagePopup.show({clientPath:"notifications",callback:e=>t.formData.image=e})},name:"pickImage",location:"after"}]},label:{text:t.$t("settings.notification.image")}}})],1),i("DxItem",{attrs:{"item-type":"group",caption:t.$t("settings.notification.action.title"),name:"actions-container"}},[i("DxItem",{attrs:{"item-type":"group",name:"actions"}},t._l(t.actionOptions,function(e,n){return i("DxItem",{key:"action"+(n+1),attrs:{"data-field":"actions["+n+"]","editor-options":e,label:{text:t.$t("settings.notification.action.title")+" "+(n+1)}}})}),1),i("DxItem",{attrs:{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"}})],1),i("DxItem",{attrs:{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:t.$t("buttons.send"),useSubmitBehavior:!0}}})],1)],1),i("PickImagePopup",{ref:"pickImagePopup"})],1)])])},p=[],f=c(m,u,p,!1,null,"c9d1f750",null,null);const D=f.exports;export{D as default};
