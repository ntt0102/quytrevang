import{u as S,a as B,b as D,c as E,i as g,r as V,d as P,x as T,z as O,f as j,g as L,j as a,k as r,l as t,s as M,o as I,U as i,h as v,q as l,t as d,bM as N,V as U,v as z}from"./app-ceb2964d.js";const H=["onSubmit"],K={class:"policy-info"},Q={class:"recaptcha-container"},X={class:"login-link"},G={__name:"Register",setup(Z){const w=S(),b=B(),x=D(),{t:o}=E(),n=g("mt"),y=g("mf"),m=V(null),s=P({siteKey:"6LcjtyobAAAAAEEEa6vHHPQZU9Nf_SoaXBRsCRr5",formData:{name:null,email:null,password:null,password_confirmation:null},validationRules:{name:[{type:"required",message:o("models.user.name")+n.validations.required},{type:"stringLength",max:50,message:o("models.user.validations.name")}],email:[{type:"required",message:o("models.user.email")+n.validations.required},{type:"email",message:o("models.user.email")+n.validations.email},{type:"async",validationCallback:e=>w.dispatch("auth/validateDuplicateEmail",e),message:o("models.user.email")+n.validations.duplicate}],password:[{type:"required",message:o("models.user.password")+n.validations.required}],confirmPassword:[{type:"required",message:o("models.user.password")+n.validations.required},{type:"compare",comparisonTarget:k,message:o("models.user.password")+n.validations.match}]}});let u=!0,h=!1;T(()=>{setTimeout(()=>m.value.instance.getEditor("name").focus(),500),y.includeScript("on",{src:"https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit",id:"recaptcha"})}),O(()=>{y.includeScript("off","recaptcha")});function R(){q(s.formData.email).then(e=>{e&&(h?w.dispatch("auth/createAccount",s.formData).then(p=>{p&&b.push({name:x.query.redirect||"overview"})}):z.show(o("messages.warning.unVerifiedReCaptcha")))})}function k(){return s.formData.password}function _(){m.value.instance.itemOption("password",{editorOptions:{mode:u?"text":"password",buttons:[{options:{icon:u?"far fa-eye-slash":"far fa-eye",onClick:_},name:"btPw",location:"after"}]}}),m.value.instance.itemOption("password_confirmation",{editorOptions:{mode:u?"text":"password"}}),u=!u}function A(){h=!0}function $(){h=!1}function q(e){return new Promise((p,f)=>{fetch(`https://api.stopforumspam.org/api?email=${e}`).then(c=>c.text()).then(c=>{let C=c.substring(c.lastIndexOf("<appears>")+9,c.lastIndexOf("</appears>"));p(C==="no")})})}return(e,p)=>{const f=j("RouterLink");return I(),L("form",{class:"create-account-page",onSubmit:M(R,["prevent"])},[a(t(U),{ref_key:"formRef",ref:m,"form-data":s.formData,labelMode:"floating"},{default:r(()=>[a(t(i),{"data-field":"name","editor-type":"dxTextBox","validation-rules":s.validationRules.name,label:{text:e.$t("models.user.name")}},null,8,["validation-rules","label"]),a(t(i),{"data-field":"email","editor-type":"dxTextBox","editor-options":{mode:"email"},"validation-rules":s.validationRules.email,label:{text:e.$t("models.user.email")}},null,8,["validation-rules","label"]),a(t(i),{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:_},name:"password",location:"after"}]},"validation-rules":s.validationRules.password,label:{text:e.$t("models.user.password")}},null,8,["editor-options","validation-rules","label"]),a(t(i),{name:"password_confirmation","data-field":"password_confirmation","editor-type":"dxTextBox","editor-options":{mode:"password"},"validation-rules":s.validationRules.confirmPassword,label:{text:e.$t("models.user.confirmPassword")}},null,8,["validation-rules","label"]),a(t(i),null,{default:r(()=>[v("div",K,[l(d(e.$t("auth.createAccount.policy"))+" ",1),a(f,{to:{name:"policy",hash:"#terms"}},{default:r(()=>[l(d(e.$t("policy.terms.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.and")),1),a(f,{to:{name:"policy",hash:"#privacy"}},{default:r(()=>[l(d(e.$t("policy.privacy.title")),1)]),_:1}),l(d(e.$t("auth.createAccount.our")),1)])]),_:1}),a(t(i),null,{default:r(()=>[v("div",Q,[a(t(N),{ref:"recaptcha",theme:"dark",size:"compact",onVerify:A,onExpired:$,sitekey:s.siteKey},null,8,["sitekey"])])]),_:1}),a(t(i),{"item-type":"button","button-options":{width:"100%",type:"default",text:e.$t("auth.createAccount.submit"),useSubmitBehavior:!0}},null,8,["button-options"]),a(t(i),null,{default:r(()=>[v("div",X,[l(d(e.$t("auth.createAccount.haveAccount"))+" ",1),a(f,{to:{name:"login"}},{default:r(()=>[l(d(e.$t("auth.createAccount.login")),1)]),_:1})])]),_:1})]),_:1},8,["form-data"])],40,H)}}};export{G as default};
