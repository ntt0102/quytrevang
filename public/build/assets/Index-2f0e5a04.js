import{S as a,h as i,C as n,j as r,m as l,a as o,n as p}from"./app-089c7b72.js";import{U as c}from"./UserDetailPopup-1783c829.js";import{E as d}from"./EditProfilePopup-95c3a293.js";const u={components:{SendCommentPopup:a,UserDetailPopup:c,EditProfilePopup:d,ChangeAvatarPopup:i,ChangePinPopup:n,ChangePasswordPopup:r},data(){return{isLoading:!0,formData:{}}},mounted(){this.$route.hash==="#detail"&&this.detailInfoClick()},computed:{...l("Auth",["name","code","phone","email","avatar","level"]),popup(){return this.$refs.popup.instance}},methods:{...o("Auth",["clearData"]),...o("User.profile",["fetch","save","delete"]),onSubmit(){this.$refs.editProfileForm.$refs.form.instance.validate().isValid&&(this.popup.option("toolbarItems[0].options.disabled",!0),this.save(this.formData).then(()=>{this.popup.hide(),this.$toasted.success(this.$mt.messages.success.saved)}))},cloneDeepData(){this.formData=this.$mf.cloneDeep(this.profile),this.isLoading=!1},validateBirthday(s){return moment(s.value).isBefore(moment().subtract(18,"years"))},validateIdIssuedOn(s){return moment(s.value).isBefore(moment().subtract(1,"day"))},detailInfoClick(){this.$refs.userDetailPopup.show({getUser:()=>this.fetch()})},onDeleteClick(){this.$bus.emit("checkPin",()=>{this.delete().then(s=>{s&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"LOGOUT"}),this.clearData(),this.$router.push({name:"login"}))})})}}};var f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"profile-page"},[t("h2",{staticClass:"content-block"},[e._v(" "+e._s(e.$t("user.profile.title"))+" ")]),t("div",{staticClass:"content-block dx-card responsive-paddings"},[t("DxToolbar",{attrs:{items:[{visible:!!e.$route.query.redirect,location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>{e.$router.push({name:e.$route.query.redirect})}}},{visible:e.level<5,location:"before",widget:"dxButton",cssClass:"guiding-step-2b",options:{icon:"far fa-user-edit small",hint:e.$t("components.editProfile.title"),onClick:()=>e.$refs.editProfilePopup.show()}},{location:"before",widget:"dxButton",options:{icon:"far fa-user-circle small",hint:e.$t("components.changeAvatar.title"),onClick:()=>e.$refs.changeAvatarPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-key small",hint:e.$t("components.changePin.title"),onClick:()=>e.$refs.changePinPopup.show()}},{location:"after",widget:"dxButton",options:{icon:"far fa-user-lock small",hint:e.$t("components.changePassword.title"),onClick:()=>e.$refs.changePasswordPopup.show()}}]}}),t("div",{staticClass:"info"},[t("div",{staticClass:"avatar"}),t("div",{staticClass:"personal"},[t("div",[t("span",[e._v(e._s(e.$t("models.user.name"))+":")]),t("span",{staticClass:"name"},[e._v(e._s(e.name))])]),t("div",[t("span",[e._v(e._s(e.$t("models.user.code"))+":")]),t("span",[e._v(e._s(e.code))])]),e.phone?t("div",[t("span",[e._v(e._s(e.$t("models.user.phone"))+":")]),t("span",[e._v(e._s(e._f("phone")(e.phone)))])]):e._e(),t("div",[t("span",[e._v(e._s(e.$t("models.user.email"))+":")]),t("span",[e._v(e._s(e.email))])]),t("DxButton",{staticClass:"detail",attrs:{width:"170",type:"default","styling-mode":"outlined",text:e.$t("user.profile.detailInfo")},on:{click:e.detailInfoClick}})],1)])],1),t("div",{staticClass:"content-block dx-card responsive-paddings change"},[t("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("user.profile.changeRequest.title"))+" ")]),t("div",{staticClass:"content"},[t("div",[e._v(e._s(e.$t("user.profile.changeRequest.desctiption")))]),t("DxButton",{attrs:{text:e.$t("user.profile.changeRequest.command"),icon:"far fa-share-square small",type:"default","styling-mode":"contained"},on:{click:function(v){return e.$refs.sendCommentPopup.show()}}})],1)]),t("div",{staticClass:"content-block dx-card responsive-paddings delete"},[t("div",{staticClass:"title"},[e._v(e._s(e.$t("user.profile.delete.title")))]),t("div",{staticClass:"content"},[t("div",[e._v(e._s(e.$t("user.profile.delete.desctiption")))]),t("DxButton",{attrs:{text:e.$t("user.profile.delete.command"),icon:"far fa-trash small",type:"danger","styling-mode":"contained"},on:{click:e.onDeleteClick}})],1)]),t("SendCommentPopup",{ref:"sendCommentPopup"}),t("UserDetailPopup",{ref:"userDetailPopup"}),t("EditProfilePopup",{ref:"editProfilePopup"}),t("ChangeAvatarPopup",{ref:"changeAvatarPopup"}),t("ChangePinPopup",{ref:"changePinPopup"}),t("ChangePasswordPopup",{ref:"changePasswordPopup"})],1)},m=[],h=p(u,f,m,!1,null,null,null,null);const C=h.exports;export{C as default};
