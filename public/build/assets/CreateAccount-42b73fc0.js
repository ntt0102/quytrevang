import{_ as o,D as r,bQ as n,a as d,n as l}from"./app-f37d1114.js";const c={components:{DxForm:o,DxItem:r,VueRecaptcha:n},data(){return{passwordMode:!0,siteKey:"6LcjtyobAAAAAEEEa6vHHPQZU9Nf_SoaXBRsCRr5",isReCaptchaVerified:!1,formData:{name:null,email:null,password:null,password_confirmation:null},validationRules:{name:[{type:"required",message:this.$t("models.user.name")+this.$mt.validations.required},{type:"stringLength",max:50,message:this.$t("models.user.validations.name")}],email:[{type:"required",message:this.$t("models.user.email")+this.$mt.validations.required},{type:"email",message:this.$t("models.user.email")+this.$mt.validations.email},{type:"async",validationCallback:this.validateDuplicateEmail,message:this.$t("models.user.email")+this.$mt.validations.duplicate}],password:[{type:"required",message:this.$t("models.user.password")+this.$mt.validations.required}],confirmPassword:[{type:"required",message:this.$t("models.user.password")+this.$mt.validations.required},{type:"compare",comparisonTarget:this.passwordComparison,message:this.$t("models.user.password")+this.$mt.validations.match}]}}},mounted(){setTimeout(()=>this.form.getEditor("name").focus(),500),this.$mf.includeScript("on",{src:"https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit",id:"recaptcha"})},destroyed(){this.$mf.includeScript("off","recaptcha")},computed:{form:function(){return this.$refs.form.instance}},methods:{...d("Auth",["createAccount","validateDuplicateEmail"]),onSubmit(){this.checkSpam(this.formData.email).then(s=>{s&&(this.isReCaptchaVerified?this.createAccount(this.formData).then(t=>{t&&this.$router.push({name:this.$route.query.redirect||"overview"})}):this.$toasted.show(this.$t("messages.warning.unVerifiedReCaptcha")))})},passwordComparison(){return this.formData.password},viewPasswordClick(){this.form.itemOption("password",{editorOptions:{mode:this.passwordMode?"text":"password",buttons:[{options:{icon:this.passwordMode?"far fa-eye-slash":"far fa-eye",onClick:this.viewPasswordClick},name:"btPw",location:"after"}]}}),this.form.itemOption("password_confirmation",{editorOptions:{mode:this.passwordMode?"text":"password"}}),this.passwordMode=!this.passwordMode},onVerify(s){this.isReCaptchaVerified=!0},onExpired(){this.isReCaptchaVerified=!1},checkSpam(s){return new Promise((t,e)=>{fetch(`https://api.stopforumspam.org/api?email=${s}`).then(a=>a.text()).then(a=>{let i=a.substring(a.lastIndexOf("<appears>")+9,a.lastIndexOf("</appears>"));t(i==="no")})})}}};var m=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("auth.createAccount.title")))])]),e("form",{staticClass:"create-account-form",on:{submit:function(a){return a.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("DxForm",{ref:"form",attrs:{"form-data":t.formData,labelMode:"floating"}},[e("DxItem",{attrs:{"data-field":"name","editor-type":"dxTextBox","validation-rules":t.validationRules.name,label:{text:t.$t("models.user.name")}}}),e("DxItem",{attrs:{"data-field":"email","editor-type":"dxTextBox","editor-options":{mode:"email"},"validation-rules":t.validationRules.email,label:{text:t.$t("models.user.email")}}}),e("DxItem",{attrs:{name:"password","data-field":"password","editor-type":"dxTextBox","editor-options":{mode:"password",buttons:[{options:{icon:"far fa-eye",onClick:t.viewPasswordClick},name:"password",location:"after"}]},"validation-rules":t.validationRules.password,label:{text:t.$t("models.user.password")}}}),e("DxItem",{attrs:{name:"password_confirmation","data-field":"password_confirmation","editor-type":"dxTextBox","editor-options":{mode:"password"},"validation-rules":t.validationRules.confirmPassword,label:{text:t.$t("models.user.confirmPassword")}}}),e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"policy-info"},[t._v(" "+t._s(t.$t("auth.createAccount.policy"))+" "),e("RouterLink",{attrs:{to:{name:"policy",hash:"#terms"}}},[t._v(t._s(t.$t("policy.terms.title")))]),t._v(t._s(t.$t("auth.createAccount.and"))),e("RouterLink",{attrs:{to:{name:"policy",hash:"#privacy"}}},[t._v(t._s(t.$t("policy.privacy.title")))]),t._v(t._s(t.$t("auth.createAccount.our"))+" ")],1)]},proxy:!0}])}),e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"recaptcha-container"},[e("VueRecaptcha",{ref:"recaptcha",attrs:{theme:"dark",size:"compact",sitekey:t.siteKey},on:{verify:t.onVerify,expired:t.onExpired}})],1)]},proxy:!0}])}),e("DxItem",{attrs:{"item-type":"button","button-options":{width:"100%",type:"default",text:t.$t("auth.createAccount.submit"),useSubmitBehavior:!0}}}),e("DxItem",{scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"login-link"},[t._v(" "+t._s(t.$t("auth.createAccount.haveAccount"))+" "),e("RouterLink",{attrs:{to:{name:"login"}}},[t._v(t._s(t.$t("auth.createAccount.login")))])],1)]},proxy:!0}])})],1)],1)])},u=[],p=l(c,m,u,!1,null,null,null,null);const f=p.exports;export{f as default};
