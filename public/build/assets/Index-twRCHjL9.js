import k from"./Chart-C1a7kVWJ.js";import{u as D,r as S,c as u,a as C,H as x,b as y,e as p,g as _,h as $,j as B,k as d,x as h,m as I,o as W}from"./app-oA7CH2ox.js";import{s as A}from"./subYears-Bsuz8AiA.js";import"./lightweight-charts.esm.development-LuwUeujF.js";const T={class:"share-page content-block dx-card responsive-paddings"},j={__name:"Index",setup(E){const a=$(),g=B(),{t:r}=D(),l=d("bus"),f=d("devices"),n=S(null),m=u(()=>a.state.tradingShare.groups),c=u(()=>a.state.tradingShare.symbols.length),e=C({group:g.query.list??"",fromDate:A(new Date,5),watchlistActions:[{icon:"far fa-heart-circle-plus small",text:r("trading.share.filterWatchList"),value:!0},{icon:"far fa-heart-circle-minus small",text:r("trading.share.deleteWatchList"),value:!1}]});a.dispatch("tradingShare/getGroups"),x(()=>{a.dispatch("tradingShare/resetState")});function s({component:t}){const o=t.option("value");e.group=o!==null?o.trim().toUpperCase():"",a.dispatch("tradingShare/getSymbols",e.group)}function b({value:t}){e.fromDate=t,n.value.getChartData(!0,t)}function v({itemData:t}){l.emit("checkPin",()=>{const o={multi:!0,group:e.group,add:t.value};a.dispatch("tradingShare/changeWatchlist",o).then(i=>{n.value.updateWatchlist(i)})})}function w(){const t=e.group;if(!t)return h.warning(r("trading.share.filterGroupWarning"));const o=n.value.getFilterTimes();if(o.length<2)return h.warning(r("trading.share.filterTimeWarning"));l.emit("checkPin",()=>{a.dispatch("tradingShare/filterSymbols",{group:t,filterTimes:o})})}return(t,o)=>{const i=I("DxToolbar");return W(),y("div",T,[p(i,{items:[{visible:t.$mf.isSet(t.$route.query),location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:t.$t("buttons.back"),onClick:()=>t.$router.go(-1)}},{location:"before",widget:"dxDateBox",options:{width:_(f).phone?"90":"120",type:"date",value:e.fromDate,onValueChanged:b}},{location:"before",widget:"dxAutocomplete",options:{width:"90",showClearButton:!0,openOnFieldClick:!0,minSearchLength:0,dataSource:m.value,value:e.group,elementAttr:{class:"symbol-group"},placeholder:t.$t("trading.share.group"),onEnterKey:s,onFocusOut:s,onItemClick:s}},{visible:c.value>0,location:"before",text:`(${c.value})`},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:e.watchlistActions,displayExpr:"text",keyExpr:"value",icon:"far fa-heart-circle-bolt small",dropDownOptions:{width:"220"},onItemClick:v}},{location:"after",widget:"dxButton",options:{icon:"far fa-filter small",hint:t.$t("trading.share.filterSymbols"),onClick:w}}]},null,8,["items"]),p(k,{fromDate:e.fromDate,group:e.group,ref_key:"chartRef",ref:n},null,8,["fromDate","group"])])}}};export{j as default};
