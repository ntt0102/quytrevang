import{_ as f,D as C,a as D,br as v,m as k,c as w,r as l,d as u,e as t,t as a,f as i,w as c,o as r,y as x,h,M as b,P as y,i as _,g as G}from"./app-b44850ea.js";const S={components:{DxDataGrid:C,DxColumn:D},data(){return{gridData:null,selectedId:null}},beforeCreate(){this.$store.registerModule("Admin.comments",v)},created(){this.fetch()},destroyed(){this.$store.unregisterModule("Admin.comments")},computed:{...k("Admin.comments",["comments"]),dataGrid:function(){return this.$refs.dataGrid.instance}},watch:{comments(){this.cloneDeepData()}},methods:{...w("Admin.comments",["fetch","markAsRead","delete","resetState"]),onCellClick(e){e.columnIndex==0&&(this.selectedId=this.selectedId!=e.data.id?e.data.id:null,console.log(e),e.data.read!=1&&(e.data.read=1,this.markAsRead(e.data.id)))},onSave(e){this.delete(e.changes.map(({key:n})=>n)).then(()=>{this.$toasted.success(this.$mt.messages.success.saved)})},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.comments)}}},A={class:"comments-page"},$={class:"content-block"},I={class:"content-block dx-card responsive-paddings"},R={class:"comment"},z={class:"subject"},B={key:0,class:"far fa-paperclip"},N={class:"info"},V=t("i",{class:"dx-icon-tel"},null,-1),L={class:"content"};function M(e,n,P,T,o,d){const m=l("DxColumn"),p=l("RouterLink"),g=l("DxDataGrid");return r(),u("div",A,[t("h2",$,a(e.$t("admin.comments.title")),1),t("div",I,[i(g,{ref:"dataGrid","data-source":o.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!0,mode:"batch"},showColumnHeaders:!1,showColumnLines:!0,onContentReady:n[0]||(n[0]=s=>e.$mf.dataGridPreload(o.gridData,d.dataGrid)),onCellClick:d.onCellClick,onSaved:d.onSave},{dataCellTemplate:c(({data:s})=>[t("div",R,[t("div",z,[t("span",{class:x(s.data.read?"mark":"unread")},a(s.data.subject),3),s.data.url_images.length>0?(r(),u("i",B)):h("",!0)]),b(t("div",null,[t("div",N,[t("div",null,[t("em",null,a(s.data.sent_at),1)]),t("div",null,[t("b",null,a(s.data.name),1)]),t("div",null,[V,_(" "+a(s.data.phone|e.phone),1)]),s.data.user_code?(r(),G(p,{key:0,to:{name:"users",query:{code:s.data.user_code}}},{default:c(()=>[_(a(e.$t("admin.comments.viewUser").replace("{code}",s.data.user_code)),1)]),_:2},1032,["to"])):h("",!0)]),t("div",L,a(s.data.content),1)],512),[[y,s.data.id==o.selectedId]])])]),default:c(()=>[i(m,{"cell-template":"dataCellTemplate"}),i(m,{width:50,type:"buttons",buttons:[{name:"delete"}],alignment:"center"})]),_:1},8,["data-source","onCellClick","onSaved"])])])}const U=f(S,[["render",M]]);export{U as default};
