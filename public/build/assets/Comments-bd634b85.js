import{_ as f,be as v,m as C,b as D,c as u,d as t,t as a,e as l,w as i,r,o as c,v as k,g as h,J as w,M as b,h as _,f as x}from"./app-7d2890ad.js";import{D as y,a as G}from"./data-grid-fa375ee2.js";import"./row_dragging-58358548.js";import"./dialog-81c627ab.js";import"./exporter-840113be.js";const S={components:{DxDataGrid:y,DxColumn:G},data(){return{gridData:null,selectedId:null}},beforeCreate(){this.$store.registerModule("Admin.comments",v)},created(){this.fetch()},destroyed(){this.$store.unregisterModule("Admin.comments")},computed:{...C("Admin.comments",["comments"]),dataGrid:function(){return this.$refs.dataGrid.instance}},watch:{comments(){this.cloneDeepData()}},methods:{...D("Admin.comments",["fetch","markAsRead","delete","resetState"]),onCellClick(e){e.columnIndex==0&&(this.selectedId=this.selectedId!=e.data.id?e.data.id:null,console.log(e),e.data.read!=1&&(e.data.read=1,this.markAsRead(e.data.id)))},onSave(e){this.delete(e.changes.map(({key:o})=>o)).then(()=>{this.$toasted.success(this.$mt.messages.success.saved)})},cloneDeepData(){this.gridData=this.$mf.cloneDeep(this.comments)}}},A={class:"comments-page"},$={class:"content-block"},I={class:"content-block dx-card responsive-paddings"},R={class:"comment"},z={class:"subject"},B={key:0,class:"far fa-paperclip"},N={class:"info"},V=t("i",{class:"dx-icon-tel"},null,-1),L={class:"content"};function M(e,o,T,j,n,d){const m=r("DxColumn"),p=r("RouterLink"),g=r("DxDataGrid");return c(),u("div",A,[t("h2",$,a(e.$t("admin.comments.title")),1),t("div",I,[l(g,{ref:"dataGrid","data-source":n.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!0,mode:"batch"},showColumnHeaders:!1,showColumnLines:!0,onContentReady:o[0]||(o[0]=s=>e.$mf.dataGridPreload(n.gridData,d.dataGrid)),onCellClick:d.onCellClick,onSaved:d.onSave},{dataCellTemplate:i(({data:s})=>[t("div",R,[t("div",z,[t("span",{class:k(s.data.read?"mark":"unread")},a(s.data.subject),3),s.data.url_images.length>0?(c(),u("i",B)):h("",!0)]),w(t("div",null,[t("div",N,[t("div",null,[t("em",null,a(s.data.sent_at),1)]),t("div",null,[t("b",null,a(s.data.name),1)]),t("div",null,[V,_(" "+a(s.data.phone|e.phone),1)]),s.data.user_code?(c(),x(p,{key:0,to:{name:"users",query:{code:s.data.user_code}}},{default:i(()=>[_(a(e.$t("admin.comments.viewUser").replace("{code}",s.data.user_code)),1)]),_:2},1032,["to"])):h("",!0)]),t("div",L,a(s.data.content),1)],512),[[b,s.data.id==n.selectedId]])])]),default:i(()=>[l(m,{"cell-template":"dataCellTemplate"}),l(m,{width:50,type:"buttons",buttons:[{name:"delete"}],alignment:"center"})]),_:1},8,["data-source","onCellClick","onSaved"])])])}const H=f(S,[["render",M]]);export{H as default};
