import N from"./Chart-DYE_Cwbb.js";import{h as x,u as B,k as C,r as t,c as I,a as T,w as F,o as w,p as _,f as b,d as y,v as H,e as c,g,D as q,z as P,_ as R,n as $,b as E,F as O,A,B as G,q as L,m as j}from"./app-CaWQ6rAi.js";import"./lightweight-charts.esm.development-CpFGw8bI.js";const z={ref:"submitRef",class:"display-none"},K={__name:"SettingPopup",setup(k,{expose:r}){const f=x(),{t:e}=B(),s=C("mt"),n=t(null),l=t(null),u=I(()=>f.state.tradingDerivative.config),a=T({formData:{},validationRules:{tpDefault:[{type:"required",message:e("trading.derivative.settingPopup.tpDefault")+s.validations.required}],slDefault:[{type:"required",message:e("trading.derivative.settingPopup.slDefault")+s.validations.required}]}});F(u,p);function d(){n.value.show()}function h(){f.dispatch("tradingDerivative/setting",a.formData).then(i=>{i?n.value.hide():(p(u.value),o())})}function p(i){a.formData={tpDefault:i.tpDefault,slDefault:i.slDefault}}function o(){setTimeout(()=>{l.value.instance.getEditor("tpDefault").focus()},0)}function m(){p(u.value),o()}function D(){}return r({show:d}),(i,S)=>(w(),_(R,{ref_key:"popupRef",ref:n,width:300,height:260,class:"der-setting-popup",title:i.$t("trading.derivative.buttons.setting"),toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:i.$t("buttons.save"),onClick:()=>i.$refs.submitRef.click()}}],onShown:m,onHidden:D},{default:b(()=>[y("form",{onSubmit:H(h,["prevent"])},[y("button",z,null,512),c(g(q),{ref_key:"formRef",ref:l,labelLocation:"left","form-data":a.formData},{default:b(()=>[c(g(P.DxItem),{name:"tpDefault","data-field":"tpDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.tpDefault,label:{text:i.$t("trading.derivative.settingPopup.tpDefault")}},null,8,["validation-rules","label"]),c(g(P.DxItem),{name:"slDefault","data-field":"slDefault","editor-type":"dxNumberBox","editor-options":{stylingMode:"outlined",showSpinButtons:!0},"validation-rules":a.validationRules.slDefault,label:{text:i.$t("trading.derivative.settingPopup.slDefault")}},null,8,["validation-rules","label"])]),_:1},8,["form-data"])],32)]),_:1},8,["title","toolbarItems"]))}},U={__name:"MatchedOrdersPopup",setup(k,{expose:r}){const f=x(),e=t(null),s=t([]),n=["orderTime","side","volume","matchVolume","showPrice","avgPrice"];function l(){e.value.show()}function u(){f.dispatch("tradingDerivative/getMatchedOrders").then(d=>{s.value=d})}function a(){}return r({show:l}),(d,h)=>(w(),_(R,{ref_key:"popupRef",ref:e,class:"der-matched-orders-popup",title:d.$t("trading.derivative.matchedOrders"),onShown:u,onHidden:a},{default:b(()=>[c(g($.DxDataGrid),{"data-source":s.value,"key-expr":"orderNo","show-borders":!0},{default:b(()=>[(w(),E(O,null,A(n,p=>c(g($.DxColumn),{"data-field":p,caption:d.$t(`trading.derivative.matchedOrdersPopup.${p}`)},null,8,["data-field","caption"])),64))]),_:1},8,["data-source"])]),_:1},8,["title"]))}},J={__name:"VpsOtpPopup",setup(k,{expose:r}){const f=x(),e=t(null),s=t(null),n=t(!1),l=t("");function u(){e.value.show(),setTimeout(a,500)}function a(){navigator.clipboard&&navigator.clipboard.readText().then(o=>{o=o.replace(/\s+/g,""),/^\d{6}$/.test(o)&&s.value.fillInput(o)})}function d(o){f.dispatch("tradingDerivative/loginVps",o).then(m=>{m&&e.value.hide(),s.value.clearInput()})}function h(){n.value=!0}function p(){n.value=!1}return r({show:u}),(o,m)=>(w(),_(R,{ref_key:"popupRef",ref:e,width:400,height:190,class:"vps-otp-popup",title:o.$t("trading.derivative.buttons.loginVps"),onShown:h,onHidden:p},{default:b(()=>[n.value?(w(),_(g(G),{key:0,ref_key:"otpInputRef",ref:s,value:l.value,"onUpdate:value":m[0]||(m[0]=D=>l.value=D),"input-classes":"otp-input",separator:"-","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",onOnComplete:d},null,8,["value"])):L("",!0)]),_:1},8,["title"]))}},Q={class:"derivative-page content-block dx-card responsive-paddings"},tt={__name:"Index",setup(k){const r=x(),{t:f}=B(),e=C("bus"),s=I(()=>r.state.tradingDerivative.config.source),n=t(null),l=t(null),u=t(null),a=t(null),d=t([{text:f("trading.derivative.buttons.downloadExport"),value:"download",icon:"far fa-cloud-arrow-down"},{text:f("trading.derivative.buttons.cloneExport"),value:"clone",icon:"far fa-file-export"}]),h=t([{name:"FIREANT",icon:"far fa-database small"},{name:"DNSE",icon:"far fa-database small"},{name:"VPS",icon:"far fa-database small"}]);function p(){l.value.show()}function o(){u.value.show()}function m(){e.emit("checkPin",()=>r.dispatch("tradingDerivative/report"))}function D(){a.value.show()}function i(){e.emit("checkPin",()=>r.dispatch("tradingDerivative/export","download"))}function S({itemData:v}){e.emit("checkPin",()=>r.dispatch("tradingDerivative/export",v.value))}function V({item:{name:v}}){n.value.connectSocket(),r.dispatch("tradingDerivative/setSource",v)}return(v,W)=>{const M=j("DxToolbar");return w(),E(O,null,[y("div",Q,[c(M,{items:[{location:"before",widget:"dxButton",options:{icon:"far fa-gear small",hint:v.$t("trading.derivative.buttons.setting"),onClick:v.setting}},{location:"before",widget:"dxButton",options:{icon:"far fa-file-chart-pie small",hint:v.$t("trading.derivative.buttons.report"),onClick:m}},{location:"before",widget:"dxButton",options:{icon:"far fa-arrow-right-to-arc small",hint:v.$t("trading.derivative.buttons.loginVps"),onClick:D}},{location:"before",widget:"dxDropDownButton",options:{splitButton:!0,items:d.value,displayExpr:"text",keyExpr:"value",icon:"far fa-cloud-arrow-down small",hint:v.$t("trading.derivative.buttons.downloadExport"),width:"60",dropDownOptions:{width:"160"},elementAttr:{class:"export"},onButtonClick:i,onItemClick:S}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:h.value,displayExpr:"name",keyExpr:"name",selectedItemKey:s.value,stylingMode:"text",useSelectMode:!0,width:"130",elementAttr:{class:"source"},onSelectionChanged:V}}]},null,8,["items"]),c(N,{ref_key:"chartRef",ref:n,onShowSetting:p,onShowMatchedOrders:o},null,512)]),c(K,{ref_key:"settingPopupRef",ref:l},null,512),c(U,{ref_key:"matchedOrdersPopupRef",ref:u},null,512),c(J,{ref_key:"vpsOtpPopupRef",ref:a},null,512)],64)}}};export{tt as default};
