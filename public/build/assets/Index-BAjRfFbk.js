import y from"./Chart-CVtMmPZd.js";import{u as k,r as C,c as s,a as x,H as _,b as A,e as d,g as B,h as I,j as $,k as h,x as p,m as W,o as T,l as E}from"./app-Bz1TvtsW.js";import{s as L}from"./subYears-Dx7ZvlZw.js";import"./lightweight-charts.esm.development-DGmdVqEx.js";const M={class:"share-page content-block dx-card responsive-paddings"},G={__name:"Index",setup(O){const o=I(),g=$(),{t:n}=k(),c=h("bus");h("devices");const r=C(null),m=s(()=>o.state.tradingShare.groups),u=s(()=>o.state.tradingShare.symbols.length),f=s(()=>o.state.tradingShare.source),w=s(()=>o.state.tradingShare.sources),e=x({group:g.query.list??"",fromDate:L(new Date,5),watchlistActions:[{icon:"far fa-heart-circle-plus small",text:n("trading.share.filterWatchList"),value:!0},{icon:"far fa-heart-circle-minus small",text:n("trading.share.deleteWatchList"),value:!1}]});o.dispatch("tradingShare/getGroups"),_(()=>{o.dispatch("tradingShare/resetState")});function i({component:t}){const a=t.option("value");e.group=a!==null?a.trim().toUpperCase():"",o.dispatch("tradingShare/getSymbols",e.group)}function v({value:t}){e.fromDate=t,r.value.getChartData(!0,t)}function b({item:t}){o.dispatch("tradingShare/setSource",t),r.value.getChartData(!0,e.fromDate)}function S({itemData:t}){c.emit("checkPin",()=>{const a={multi:!0,group:e.group,add:t.value};o.dispatch("tradingShare/changeWatchlist",a).then(l=>{r.value.updateWatchlist(l)})})}function D(){const t=e.group;if(!t)return p.warning(n("trading.share.filterGroupWarning"));const a=r.value.getFilterTimes();if(a.length<2)return p.warning(n("trading.share.filterTimeWarning"));c.emit("checkPin",()=>{o.dispatch("tradingShare/filterSymbols",{group:t,filterTimes:a})})}return(t,a)=>{const l=W("DxToolbar");return T(),A("div",M,[d(l,{items:[{visible:t.$mf.isSet(t.$route.query),location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:t.$t("buttons.back"),onClick:()=>t.$router.go(-1)}},{location:"before",widget:"dxDateBox",options:{width:"25",type:"date",elementAttr:{class:"from-date"},hint:B(E)(e.fromDate,"dd/MM/yyyy"),value:e.fromDate,onValueChanged:v}},{location:"before",widget:"dxAutocomplete",options:{width:"90",showClearButton:!0,openOnFieldClick:!0,minSearchLength:0,dataSource:m.value,value:e.group,elementAttr:{class:"symbol-group"},placeholder:t.$t("trading.share.group"),onEnterKey:i,onFocusOut:i,onItemClick:i}},{visible:u.value>0,location:"before",text:`(${u.value})`},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:w.value,selectedItemKey:f.value,stylingMode:"text",useSelectMode:!0,width:"50",dropDownOptions:{width:"70"},elementAttr:{class:"source"},onSelectionChanged:b}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:e.watchlistActions,displayExpr:"text",keyExpr:"value",icon:"far fa-heart-circle-bolt small",dropDownOptions:{width:"220"},onItemClick:S}},{location:"after",widget:"dxButton",options:{icon:"far fa-filter small",hint:t.$t("trading.share.filterSymbols"),onClick:D}}]},null,8,["items"]),d(y,{fromDate:e.fromDate,group:e.group,ref_key:"chartRef",ref:r},null,8,["fromDate","group"])])}}};export{G as default};
