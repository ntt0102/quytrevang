import{u as k,b as D,c as $,i as m,r as O,d as R,x as S,g,h as q,j as i,k as l,l as o,s as x,o as f,S as n,F as B,I,n as N,T}from"./app-c40e261c.js";import{_ as w}from"./PickImagePopup-e204c314.js";import"./FileManager-d8fbb36e.js";const A={class:"content-block dx-card responsive-paddings"},C=["onSubmit"],E={__name:"Notification",setup(P){const b=k(),v=D(),{t:s}=$(),y=m("bus"),r=m("mt"),p=O(null),t=R({formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:s("settings.notification.receiver")+r.validations.required}],title:[{type:"required",message:s("settings.notification.notificationTitle")+r.validations.required}],body:[{type:"required",message:s("settings.notification.body")+r.validations.required}]}});t.actionOptions=c(t.formData.actions),t.addActionOptions={icon:"add",text:s("buttons.add"),onClick:()=>{t.formData.actions.push(""),t.actionOptions=c(t.formData.actions)}},S(()=>{t.formData.receiver=v.query.codes||null,setTimeout(()=>{p.value.instance.getEditor("receiver").focus()},500)});function h(){y.emit("checkPin",()=>{b.dispatch("setting/sendNotification",t.formData)})}function c(e){let u=[];for(let a=0;a<e.length;a++)u.push(_(a));return u}function _(e){return{placeholder:s("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{t.formData.actions.splice(e,1),t.actionOptions=c(t.formData.actions)}}}]}}return(e,u)=>(f(),g("div",A,[q("form",{class:"setting-notification-page",onSubmit:x(h,["prevent"])},[i(o(T),{ref_key:"formRef",ref:p,"form-data":t.formData,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:l(()=>[i(o(n),{"item-type":"group"},{default:l(()=>[i(o(n),{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:e.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>e.$router.push({name:"admin-user",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:e.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),i(o(n),{"data-field":"title","validation-rules":t.validationRules.title,label:{text:e.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"body","validation-rules":t.validationRules.body,label:{text:e.$t("settings.notification.body")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>e.$refs.pickImagePopupRef.show({clientPath:"notifications",callback:a=>t.formData.image=a})},name:"pickImage",location:"after"}]},label:{text:e.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),i(o(n),{"item-type":"group",caption:e.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[i(o(n),{"item-type":"group",name:"actions"},{default:l(()=>[(f(!0),g(B,null,I(t.actionOptions,(a,d)=>(f(),N(o(n),{key:"action"+(d+1),"data-field":"actions["+d+"]","editor-options":a,label:{text:e.$t("settings.notification.action.title")+" "+(d+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),i(o(n),{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),i(o(n),{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:e.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],40,C),i(w,{ref:"pickImagePopupRef"},null,512)]))}};export{E as default};
