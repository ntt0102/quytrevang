var Br=Object.defineProperty;var vr=e=>{throw TypeError(e)};var Mr=(e,o,t)=>o in e?Br(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var It=(e,o,t)=>Mr(e,typeof o!="symbol"?o+"":o,t),hr=(e,o,t)=>o.has(e)||vr("Cannot "+t);var q=(e,o,t)=>(hr(e,o,"read from private field"),t?t.call(e):o.get(e)),ft=(e,o,t)=>o.has(e)?vr("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(e):o.set(e,t),Ge=(e,o,t,n)=>(hr(e,o,"write to private field"),n?n.call(e,t):o.set(e,t),t),Ze=(e,o,t)=>(hr(e,o,"access private method"),t);var Gt=(e,o,t,n)=>({set _(u){Ge(e,o,u,t)},get _(){return q(e,o,n)}});import{C as constructFrom,E as toDate,G as millisecondsInHour,H as addLeadingZeros,h as useStore,c as computed,r as ref,y as onMounted,I as __variableDynamicImportRuntimeHelper,J as __vitePreload,m as resolveComponent,o as openBlock,p as createBlock,f as withCtx,e as createVNode,d as createBaseVNode,K as normalizeClass,b as createElementBlock,F as Fragment,A as renderList,t as toDisplayString,u as useI18n,k as inject,L as onUnmounted,M as withDirectives,N as vShow,w as watch,g as unref,n as dataGridExports,x as l,O as confirm,Q as commonjsGlobal,l as format,a as reactive,R as differenceInSeconds,S as vModelText,j as useRoute,T as alert}from"./app-8IciXFN4.js";import{_ as _sfc_main$8,g as getUnixTime,c as createChart,a as _sfc_main$9,b as _sfc_main$a,d as _sfc_main$b,e as _sfc_main$c}from"./lightweight-charts.esm.development-Cx7wU-qU.js";function addMilliseconds(e,o,t){return constructFrom(e,+toDate(e)+o)}function addHours(e,o,t){return addMilliseconds(e,o*millisecondsInHour)}function addSeconds(e,o,t){return addMilliseconds(e,o*1e3)}function formatISO(e,o){const t=toDate(e,o==null?void 0:o.in);if(isNaN(+t))throw new RangeError("Invalid time value");let n="",u="";const r="-",i=":";{const s=addLeadingZeros(t.getDate(),2),a=addLeadingZeros(t.getMonth()+1,2);n=`${addLeadingZeros(t.getFullYear(),4)}${r}${a}${r}${s}`}{const s=t.getTimezoneOffset();if(s!==0){const b=Math.abs(s),w=addLeadingZeros(Math.trunc(b/60),2),E=addLeadingZeros(b%60,2);u=`${s<0?"+":"-"}${w}:${E}`}else u="Z";const a=addLeadingZeros(t.getHours(),2),c=addLeadingZeros(t.getMinutes(),2),h=addLeadingZeros(t.getSeconds(),2),d=n===""?"":"T",g=[a,c,h].join(i);n=`${n}${d}${g}${u}`}return n}function subSeconds(e,o,t){return addSeconds(e,-o)}const _sfc_main$7={__name:"ProgressContext",props:["progress","chartHeightEnough"],emits:["refreshPattern"],setup(e,{emit:o}){const t=useStore(),n=o,u=computed(()=>t.state.tradingDerivative.config.patternType),r=ref([]);onMounted(()=>{i()});function i(){__variableDynamicImportRuntimeHelper(Object.assign({"../../../../../lang/vi/derivative.js":()=>__vitePreload(()=>import("./derivative-LVTmuc9W.js"),[])}),`../../../../../lang/${window.lang}/derivative.js`,8).then(a=>{r.value=a.default||[]})}function s(){n("refreshPattern")}return(a,c)=>{const h=resolveComponent("DxButton");return openBlock(),createBlock(_sfc_main$8,{class:"pattern-context"},{default:withCtx(()=>[createVNode(h,{type:"success",stylingMode:"outlined",icon:"refresh",text:a.$t("buttons.refresh"),onClick:s},null,8,["text"]),createBaseVNode("div",{class:normalizeClass(["steps",{portrait:e.chartHeightEnough}])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value[u.value-1],(d,g)=>(openBlock(),createElementBlock("div",{key:g,class:normalizeClass(["step",[e.progress.step&&e.progress.step===g+1?e.progress.result?"success":"fail":""]])},[createBaseVNode("div",{class:normalizeClass(["name",[e.progress.steps?e.progress.steps[g].every(Boolean)?"success":"fail":""]])},toDisplayString(g+1)+". "+toDisplayString(d.name),3),createBaseVNode("div",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(d.conds,(b,w)=>(openBlock(),createElementBlock("div",{key:w,class:normalizeClass(["condition",[e.progress.steps?e.progress.steps[g][w]?"success":"fail":""]])},toDisplayString(w+1)+". "+toDisplayString(b),3))),128))])],2))),128))],2)]),_:1})}}},_hoisted_1$5=["title"],_sfc_main$6={__name:"ProgressTool",props:["chartHeightEnough"],emits:["refreshPattern","hideContext"],setup(e,{expose:o,emit:t}){const n=useStore(),{t:u}=useI18n(),r=inject("mf"),i=t,s=ref({}),a=ref(!1),c=computed(()=>n.state.tradingDerivative.config.autoRefresh);o({hide:d,set:g}),onMounted(()=>{window.addEventListener("keydown",R)}),onUnmounted(()=>{window.removeEventListener("keydown",R)});function h(){const I=a.value;i("hideContext"),a.value=!I}function d(I=!1){a.value=I}function g(I){E(I,s.value),s.value=I}function b(){i("refreshPattern")}function w(){n.dispatch("tradingDerivative/setAutoRefresh",!c.value)}function E(I,k){if(r.isSet(I)&&(I.step!==k.step||I.step===k.step&&I.result!==k.result)){let W="";I.result?W=u("trading.derivative.toasts.progressSuccess",I):W=u("trading.derivative.toasts.progressFail",I),T(W)}}function T(I){const k=new SpeechSynthesisUtterance(I);k.lang="vi-VN",speechSynthesis.speak(k)}function R(I){I.key==="F3"&&(h(),I.preventDefault())}return(I,k)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["context command",{green:s.value.result===!0,red:s.value.result===!1}]),title:I.$t("trading.derivative.tools.progress"),onClick:h,onContextmenu:w},[createBaseVNode("i",{class:normalizeClass(["far",{"fa-badge-check":!s.value.step,[`fa-circle-${s.value.step}`]:s.value.step,blink:c.value}])},null,2),withDirectives(createVNode(_sfc_main$7,{class:"contextmenu",progress:s.value,chartHeightEnough:e.chartHeightEnough,onRefreshPattern:b},null,8,["progress","chartHeightEnough"]),[[vShow,a.value]])],42,_hoisted_1$5))}},_hoisted_1$4=["title"],_hoisted_2$3=["title"],_hoisted_3$3=createBaseVNode("i",{class:"far fa-heart-rate"},null,-1),_hoisted_4$1=[_hoisted_3$3],symbol$2="VN30F1M",patternTypeCount=2,scanThreshold=1,phaseThreshold=.9,_sfc_main$5={__name:"PatternTool",props:["prices","bars","pickTimeToolRef","timeToIndex","indexToTime"],emits:["setProgress","setPatternOrder","hideContext"],setup(e,{expose:o,emit:t}){const n=useStore(),u=inject("mf"),r=e,i=t,s=ref(null),a=computed(()=>n.state.tradingDerivative.tools.pattern),c=computed(()=>n.state.tradingDerivative.config.patternType);let h={},d={},g={};const b={yellow:"rgba(255, 255, 0, 0.7)",orange:"rgba(255, 127, 0, 0.7)",red:"rgba(255, 0, 0, 0.7)",pink:"rgba(255, 20, 147, 0.7)",purple:"rgba(128, 0, 255, 0.7)",cyan:"rgba(0, 255, 255, 0.7)",green:"rgba(0, 255, 0, 0.7)"};o({isSelected:w,createSeries:E,draw:I,load:W,refresh:U,remove:ge}),watch(a,G=>{G&&setTimeout(()=>W(G,{isCheck:!0}),0)});function w(){return s.value.classList.contains("selected")}function E(G){if(!G)return!1;g.pattern=G.addLineSeries({color:"#F5F5F5",lastValueVisible:!1,priceLineVisible:!1}),g.timeMark=G.addHistogramSeries({priceScaleId:"timeMark",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1})}function T(G){i("hideContext");const ie=G.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(S=>S.classList.remove("selected")),ie||G.target.classList.add("selected")}function R(G){G.target.classList.remove("selected"),i("hideContext"),ge()}function I({time:G,price:ie}){let S={};if(u.isSet(d.X))S=u.cloneDeep(h),S.A={time:G,price:ie};else{const J=G?r.bars.filter(pe=>!u.cmp(pe.time,!0,G)):r.bars;S=k(J)}W(S,{isSave:!0}),s.value.classList.remove("selected")}function k(G){let ie,S,[J,pe,Te,Se]=Array(4).fill({});for(let P=G.length-1;P>=0;P--){const C=G[P].high,oe=G[P].low,Ce=G[P].time,ve=G[P].date,he=r.timeToIndex(Ce);if(P===G.length-1&&(ie={time:{t:Ce,d:ve,i:he},high:C,low:oe}),S===void 0){if(C<=ie.high&&oe>=ie.low||C>ie.high&&oe<ie.low)continue;C>ie.high&&oe>=ie.low&&(S=!0),oe<ie.low&&C<=ie.high&&(S=!1),Te={price:S?ie.low:ie.high,time:ie.time},[pe,J,Se]=Array(3).fill(null).map(()=>u.cloneDeep(Te))}const je=S?C:oe,Ie=S?oe:C;if(u.cmp(je,S,pe.price)&&(u.cmp(J.price,!S,Te.price)?([Te,pe]=[pe,J].map(L=>u.cloneDeep(L)),J={time:{t:Ce,d:ve,i:he},price:je},Se=u.cloneDeep(J),S=!S):pe={time:{t:Ce,d:ve,i:he},price:je}),u.cmp(Ie,!S,J.price,!0)&&(J={time:{t:Ce,d:ve,i:he},price:Ie},Se=u.cloneDeep(J)),u.cmp(je,S,Se.price)&&(Se={time:{t:Ce,d:ve,i:he},price:je}),Te.time.i>J.time.i&&u.cmp(Te.price,S,J.price)){const L=u.fmtNum(pe.price-Te.price,1,!0);if(L>=scanThreshold&&(J.time.i-Se.time.i>=Te.time.i-pe.time.i||u.fmtNum(J.price-Se.price,1,!0)>L))break}}return delete J.time.i,delete pe.time.i,delete Te.time.i,{A:J,B:pe,C:Te}}function W(G,{isSave:ie=!1,isCheck:S=!1}={}){h=u.cloneDeep(G),ie&&Le(),(S?xe(h):!0)&&(qe(),Q())}function Q(){let ie={lineType:"pattern",lineWidth:1,lineStyle:1,draggable:!1};const{target:[[S,J],[pe,Te],[Se,P],[C,oe]]}=D();ie.point="X",ie.price=u.fmtNum(S),ie.title=`X ${u.fmtNum(J)}`,ie.color="#FF1493",ie.draggable=!1,d[ie.point]=g.pattern.createPriceLine(ie),ie.point="Y",ie.price=u.fmtNum(pe),ie.title=`Y ${u.fmtNum(Te)}`,ie.color="#8000FF",ie.draggable=!1,d[ie.point]=g.pattern.createPriceLine(ie),ie.point="Z",ie.price=u.fmtNum(Se),ie.title=`Z ${u.fmtNum(P)}`,ie.color="#00FFFF",ie.draggable=!1,d[ie.point]=g.pattern.createPriceLine(ie),ie.point="T",ie.price=u.fmtNum(C),ie.title=`T ${u.fmtNum(oe)}`,ie.color="#FF7F00",ie.draggable=!1,d[ie.point]=g.pattern.createPriceLine(ie)}function U(G=!1){u.isSet(d.X)&&(G&&le(),qe(),Q())}function D(){let G={};switch(c.value){case 1:G=V();break;case 2:G=ae();break}return i("setProgress",G.progress),i("setPatternOrder",G.order),We(G.timeMark),g.pattern.setData(G.points),G}function V(){const{A:G,B:ie,C:S}=h,J=ie.price-S.price;let pe=J>0;const Te=r.pickTimeToolRef.get(),Se=$({side:pe,start:G,end:{time:Math.min(Te??ie.time.t,ie.time.t)}}),P=$({side:!pe,start:ie,end:{time:Math.min(Te??S.time.t,S.time.t)}}),C=r.indexToTime(6*P.R.time.i-5*Se.S.time.i),oe=$({side:pe,start:S,end:{time:Te??C}}),Ce=(oe.ext.pr<oe.pr||oe.ext.tr<phaseThreshold*oe.tr)&&(oe.ext.tr<oe.tr||oe.ext.pr<phaseThreshold*oe.pr),ve=Ce?oe.R1:oe.ext.R,he=Ce?oe.S1:oe.ext.S,je=$({side:!pe,start:ve,end:{time:Math.min(Te??he.time.t,he.time.t)}}),Ie=$({side:pe,start:he,end:{time:Te??C}}),L=(Ie.ext.pr<Ie.pr||Ie.ext.tr<phaseThreshold*Ie.tr)&&(Ie.ext.tr<Ie.tr||Ie.ext.pr<phaseThreshold*Ie.pr),z=L?Ie.R1:Ie.ext.R,ee=L?Ie.S1:Ie.ext.S,De=$({side:!pe,start:z,end:{time:Math.min(Te??ee.time.t,ee.time.t)}}),ke=$({side:pe,start:ee,end:{time:Te??C}}),de=(ke.ext.pr<ke.pr||ke.ext.tr<phaseThreshold*ke.tr)&&(ke.ext.tr<ke.tr||ke.ext.pr<phaseThreshold*ke.pr)?ke.R1:ke.ext.R;console.log("calcContinuePattern",[Se,P,oe,je,Ie,De,ke]);const F=u.fmtNum(ie.price-G.price,1,!0),te=u.fmtNum(J,1,!0),ue=u.fmtNum(ve.price-S.price,1,!0),Ue=u.fmtNum(he.price-ve.price,1,!0),p=u.fmtNum(z.price-he.price,1,!0),f=u.fmtNum(je.R.price1-he.price,1,!0),y=u.fmtNum(ee.price-z.price,1,!0),A=u.fmtNum(ee.price-he.price,1,!0),j=Ce?oe.pre.tr:oe.tr,se=L?Ie.pre.tr:Ie.tr,Ne=Se.R.time.i+Se.tr,Ke=P.R.time.i+P.tr,rt=P.R.time.i+(P.R.time.i-P.R.time1.i),st=ve.time.i+j,Ye=he.time.i+je.tr,et=he.time.i+(je.R.time.i-je.R.time1.i),Qe=z.time.i+se,yt=[ee.time.i+De.tr,Qe,Ye,st,Ke,Ne],mt=te/F,_t=ue/te,Re=Ue/ue,He=p/Ue,Ve=f/Ue,ze=y/p,at=A/Ue;let Xe={};Xe.steps=[[P.R.time1.i>Ne,te>=Se.pr,mt>=.3],[ve.time1.i>Ke,ve.time1.i>rt,_t>=.5,ue<=F,ve.price!==z.price],[he.time1.i>st,Re>=.5,Re>=1.25-_t,Ue<=te,Ve<.5,at<.5],[z.time1.i>Ye,z.time1.i>et,He>=.5,p<=ue],[ee.time1.i>Qe,ze>=.5,ze>=1.25-He,y<=Ue]];let ht=[];for(let Qt=0;Qt<Xe.steps.length;Qt++){const br=Xe.steps[Qt].every(Boolean);if(ht.push(br),!br){Xe.step=Qt+1,Xe.result=!1;break}}ht[4]?(Xe.step=5,Xe.result=!0):ht[2]&&(Xe.step=3,Xe.result=!0);const Dt=[{time:G.time.t,value:G.price,color:b.yellow},{time:Se.R.time1.t,value:Se.R.price,color:b.orange},{time:P.R.time1.t,value:P.R.price,color:b.red},{time:ve.time1.t,value:ve.price,color:b.pink},{time:he.time1.t,value:he.price,color:b.purple},{time:z.time1.t,value:z.price,color:b.cyan},{time:ee.time1.t,value:ee.price,color:b.green},{time:de.time1.t,value:de.price}],Rt=ve.price,[Ct]=N(ve.price,ue,pe),Ft=u.fmtNum(Ct-Rt,1),[zt]=N(ve.price,2*ue,pe),Yt=u.fmtNum(zt-Rt,1),Wt=ie.price+(pe?1:-1)*te,rr=u.fmtNum(Wt-Rt,1),qt=(z.price+ee.price)/2,$t=u.fmtNum(qt-Rt,1),Vt=u.cmp(z.price,pe,ve.price),yr=Vt?z.price:ve.price,xr=Vt?ee.price:he.price;let cr={};return Xe.result&&(cr={side:Ct>yr?1:-1,price:yr,tpPrice:Ct,slPrice:xr},console.log("order",cr)),{timeMark:yt,progress:Xe,order:cr,points:H(Dt),target:[[Ct,Ft],[zt,Yt],[Wt,rr],[qt,$t]]}}function ae(){const{A:G,B:ie}=h,S=G.price-ie.price;let J=S>0;const pe=r.pickTimeToolRef.get(),Te=$({side:!J,start:G,end:{time:Math.min(pe??ie.time.t,ie.time.t)}}),Se=r.indexToTime(6*Te.R.time.i-5*Te.S.time.i),P=$({side:J,start:ie,end:{time:pe??Se}}),C=(P.ext.pr<P.pr||P.ext.tr<phaseThreshold*P.tr)&&(P.ext.tr<P.tr||P.ext.pr<phaseThreshold*P.pr),oe=C?P.R1:P.ext.R,Ce=C?P.S1:P.ext.S,ve=$({side:!J,start:oe,end:{time:Math.min(pe??Ce.time.t,Ce.time.t)}}),he=$({side:J,start:Ce,end:{time:pe??Se}}),je=(he.ext.pr<he.pr||he.ext.tr<phaseThreshold*he.tr)&&(he.ext.tr<he.tr||he.ext.pr<phaseThreshold*he.pr),Ie=je?he.R1:he.ext.R,L=je?he.S1:he.ext.S,z=$({side:!J,start:Ie,end:{time:Math.min(pe??L.time.t,L.time.t)}}),ee=$({side:J,start:L,end:{time:pe??Se}}),ke=(ee.ext.pr<ee.pr||ee.ext.tr<phaseThreshold*ee.tr)&&(ee.ext.tr<ee.tr||ee.ext.pr<phaseThreshold*ee.pr)?ee.R1:ee.ext.R;console.log("calcReversalPattern",[Te,P,ve,he,z,ee]);const K=u.fmtNum(S,1,!0),de=u.fmtNum(oe.price-ie.price,1,!0),F=u.fmtNum(Ce.price-oe.price,1,!0),te=u.fmtNum(Ie.price-Ce.price,1,!0),ue=u.fmtNum(ve.R.price1-Ce.price,1,!0),Ue=u.fmtNum(L.price-Ie.price,1,!0),p=u.fmtNum(L.price-Ce.price,1,!0),f=C?P.pre.tr:P.tr,y=je?he.pre.tr:he.tr,A=Te.R.time.i+Te.tr,j=Te.R.time.i+(Te.R.time.i-Te.R.time1.i),se=oe.time.i+f,Ne=Ce.time.i+ve.tr,Ke=Ce.time.i+(ve.R.time.i-ve.R.time1.i),rt=Ie.time.i+y,Ye=[L.time.i+z.tr,rt,Ne,se,A],et=de/K,Qe=F/de,ct=te/F,yt=ue/F,mt=Ue/te,_t=p/F;let Re={};Re.steps=[[oe.time1.i>A,oe.time1.i>j,de>=Te.pr,et>=.3,oe.price!==Ie.price],[Ce.time1.i>se,Qe>=.7,F<=K,yt<.5,_t<.5],[Ie.time1.i>Ne,Ie.time1.i>Ke,ct>=.5,te<=de],[L.time1.i>rt,mt>=.5,mt>=1.25-ct,Ue<=F]];let He=[];for(let $t=0;$t<Re.steps.length;$t++){const Vt=Re.steps[$t].every(Boolean);if(He.push(Vt),!Vt){Re.step=$t+1,Re.result=!1;break}}He[3]?(Re.step=4,Re.result=!0):He[1]&&(Re.step=2,Re.result=!0);const Ve=[{time:G.time.t,value:G.price,color:b.orange},{time:Te.R.time1.t,value:ie.price,color:b.red},{time:oe.time1.t,value:oe.price,color:b.pink},{time:Ce.time1.t,value:Ce.price,color:b.purple},{time:Ie.time1.t,value:Ie.price,color:b.cyan},{time:L.time1.t,value:L.price,color:b.green},{time:ke.time1.t,value:ke.price}],ze=oe.price,[at]=N(oe.price,de,J),Xe=u.fmtNum(at-ze,1),[ht]=N(oe.price,2*de,J),Dt=u.fmtNum(ht-ze,1),Rt=G.price,Ct=u.fmtNum(Rt-ze,1),Ft=(Ie.price+L.price)/2,zt=u.fmtNum(Ft-ze,1),Yt=u.cmp(Ie.price,J,oe.price),Wt=Yt?Ie.price:oe.price,rr=Yt?L.price:Ce.price;let qt={};return Re.result&&(qt={side:at>Wt?1:-1,price:Wt,tpPrice:at,slPrice:rr}),{timeMark:Ye,progress:Re,order:qt,points:H(Ve),target:[[at,Xe],[ht,Dt],[Rt,Ct],[Ft,zt]]}}function $({side:G,start:ie,end:S}){let J=u.cloneDeep(ie),pe={},Te={},Se={},P={},C={};J.time.i=r.timeToIndex(J.time.t);const oe=r.bars.filter(Ce=>{let ve=Ce.time>=ie.time.t;return S.time&&(ve=ve&&Ce.time<=S.time),ve});return oe.length>0?(oe.every((Ce,ve)=>{const he=G?Ce.high:Ce.low,je=G?Ce.low:Ce.high,Ie=Ce.time,L=Ce.date,z=r.timeToIndex(Ie);if((ve===0||ie.price&&je===ie.price)&&(Te={R:{price:he,price1:he,time:{t:Ie,d:L,i:z},time1:{t:Ie,d:L,i:z}},S:{price:he,price1:he,time:{t:Ie,d:L,i:z},time1:{t:Ie,d:L,i:z}},pr:0,tr:0},Se=u.cloneDeep(Te)),ie.price&&u.cmp(je,!G,ie.price)||S.price&&u.cmp(he,G,S.price))return!1;if(u.cmp(he,G,Te.R.price,!0)){Te.pr>0&&(Te.pr>=Se.pr&&Te.tr>=phaseThreshold*Se.tr||Te.tr>=Se.tr&&Te.pr>=phaseThreshold*Se.pr)&&(P=u.cloneDeep(Se),Se=u.cloneDeep(Te),Se.tr<P.tr&&(Se.tr=P.tr),Se.pr<P.pr&&(Se.pr=P.pr));const ee=he===Te.R.price,De=G?Math.min(Te.R.price1,Te.S.price):Math.max(Te.R.price1,Te.S.price);Te={R:{price:he,price1:ee?De:he,time:{t:Ie,d:L,i:z},time1:ee?Te.R.time1:{t:Ie,d:L,i:z}},S:{price:he,price1:he,time:{t:Ie,d:L,i:z},time1:{t:Ie,d:L,i:z}},pr:0,tr:0}}else u.cmp(je,!G,Te.S.price,!0)?(Te.S.time={t:Ie,d:L,i:z},je!==Te.S.price&&(Te.S.price=je,Te.S.price1=je,Te.S.time1={t:Ie,d:L,i:z},Te.pr=u.fmtNum(Te.S.price-Te.R.price,1,!0),Te.tr=Te.S.time1.i-Te.R.time.i)):u.cmp(he,G,Te.S.price1)&&(Te.S.price1=he);return!0}),C=u.cloneDeep(Te),pe=u.cloneDeep(Te.R)):(pe=u.cloneDeep(J),Se={R:pe,S:{},pr:0,tr:0},P=u.cloneDeep(Se),C=u.cloneDeep(Se)),{S:J,R:pe,S1:Se.S,R1:Se.R,tr:Se.tr,pr:Se.pr,pre:P,ext:C}}function xe({A:G}){const ie=G.time.t;return ie>=r.bars[0].time&&ie<r.bars.at(-1).time}function N(G,ie,S){const J=G+(S?1:-1)*ie;let pe=u.fmtNum(J%1),Te=J;return S?pe>=.1&&pe<=.2?Te=Math.floor(J):pe>=.6&&pe<=.7&&(Te=Math.floor(J)+.5):pe>=.8&&pe<=.9?Te=Math.ceil(J):pe>=.3&&pe<=.4&&(Te=Math.floor(J)+.5),[Te,J]}function le(){if(r.pickTimeToolRef.get())return!1;const ie=h.B.price>h.A.price,S=r.bars.findIndex(pe=>pe.time===h.C.time.t);let J=u.cloneDeep(h.C);for(let pe=S;pe<r.bars.length;pe++){const Te=r.bars[pe].time,Se=r.bars[pe].date,P=ie?r.bars[pe].low:r.bars[pe].high;u.cmp(P,!ie,J.price,!0)&&(J.time={t:Te,d:Se},J.price=P)}J.time.t!==h.C.time.t&&(h.C=J,Le())}function Le(G=!1){let ie={isRemove:G,symbol:symbol$2,name:"pattern",points:[],data:[]};G?h={}:Object.entries(h).forEach(([S,J])=>{ie.points.push(S),ie.data.push(J)}),n.dispatch("tradingDerivative/drawTools",ie)}function ge(){Le(!0),r.pickTimeToolRef.remove(),qe(),We([]),i("setProgress",{}),i("setPatternOrder",{}),g.pattern.setData([])}function qe(){u.isSet(d.X)&&(g.pattern.removePriceLine(d.X),g.pattern.removePriceLine(d.Y),g.pattern.removePriceLine(d.Z),g.pattern.removePriceLine(d.T)),d={}}function We(G){const ie=[b.green,b.cyan,b.purple,b.pink,b.red,b.orange];let S=[];G.forEach((J,pe)=>{let Te=r.indexToTime(J);Te&&S.push({time:Te,value:1,color:ie[pe]})}),S.length&&(S=H(S),S.sort((J,pe)=>J.time-pe.time)),g.timeMark.setData(S)}function H(G){const ie=new Set;return G.map(S=>{let J={...S};for(;ie.has(J.time);)J.time++;return ie.add(J.time),J})}function ye(){const G=c.value>=patternTypeCount?1:c.value+1;n.dispatch("tradingDerivative/setPatternType",G),U()}return(G,ie)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{ref:"selectPatternRef",class:"context command",title:G.$t("trading.derivative.tools.selectPattern"),onClick:ye},[createBaseVNode("i",{class:normalizeClass(["far",{"fa-square-question":!c.value,[`fa-square-${c.value}`]:c.value}])},null,2)],8,_hoisted_1$4),createBaseVNode("div",{ref_key:"patternToolRef",ref:s,class:"context command",title:G.$t("trading.derivative.tools.pattern"),onClick:T,onContextmenu:R},_hoisted_4$1,40,_hoisted_2$3)],64))}},_hoisted_1$3=["title"],_hoisted_2$2=createBaseVNode("i",{class:"far fa-pipe"},null,-1),_hoisted_3$2=[_hoisted_2$2],symbol$1="VN30F1M",_sfc_main$4={__name:"PickTimeTool",emits:["refreshPattern","hideContext"],setup(e,{expose:o,emit:t}){const n=useStore(),u=t,r=ref(null),i=computed(()=>n.state.tradingDerivative.tools.pickTime);let s=null,a={};o({isSelected:c,createSeries:h,draw:w,remove:T,get:d}),watch(i,R=>{R&&E(R[0])});function c(){return r.value.classList.contains("selected")}function h(R){if(!R)return!1;a.pickTime=R.addHistogramSeries({priceScaleId:"pickTime",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1})}function d(){return s}function g(R){u("hideContext");const I=R.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(k=>k.classList.remove("selected")),I||R.target.classList.add("selected")}function b(R){R.target.classList.remove("selected"),T(),u("refreshPattern")}function w({time:R}){n.dispatch("tradingDerivative/drawTools",{isRemove:!1,symbol:symbol$1,name:"pickTime",points:[0],data:[R]}),E(R),u("refreshPattern"),r.value.classList.remove("selected")}function E(R){s=R,a.pickTime.setData([{time:R,value:1,color:"#007FFF"}])}function T(R=!0){R&&n.dispatch("tradingDerivative/drawTools",{isRemove:!0,symbol:symbol$1,name:"pickTime"}),a.pickTime.setData([]),s=null}return(R,I)=>(openBlock(),createElementBlock("div",{ref_key:"pickTimeToolRef",ref:r,class:"command",title:R.$t("trading.derivative.tools.pickTime"),onClick:g,onContextmenu:b},_hoisted_3$2,40,_hoisted_1$3))}},_hoisted_1$2=["title"],_hoisted_2$1=createBaseVNode("i",{class:"far fa-grip-lines-vertical"},null,-1),_hoisted_3$1=[_hoisted_2$1],symbol="VN30F1M",_sfc_main$3={__name:"TimeRangeTool",props:["timeToIndex","indexToTime"],emits:["hideContext"],setup(e,{expose:o,emit:t}){const n=useStore(),u=inject("mf"),r=e,i=t,s=ref(null),a=computed(()=>n.state.tradingDerivative.tools.timeRange);let c=[],h={};o({isSelected:d,createSeries:g,draw:E}),watch(a,k=>{k&&T(k)});function d(){return s.value.classList.contains("selected")}function g(k){if(!k)return!1;h.timeRange=k.addHistogramSeries({priceScaleId:"timeRange",scaleMargins:{top:0,bottom:0},lastValueVisible:!1,priceLineVisible:!1})}function b(k){i("hideContext");const W=k.target.classList.contains("selected");document.querySelectorAll(".tool-area > .command:not(.drawless)").forEach(Q=>Q.classList.remove("selected")),W||k.target.classList.add("selected")}function w(k){I(),k.target.classList.remove("selected")}function E({time:k}){let W={isRemove:!1,symbol,name:"timeRange",points:[],data:[]},Q={time:k,value:1};switch(c.length){case 0:Q.color="OrangeRed",c[0]=Q,W.points.push(0),W.data.push(k);break;case 1:Q.color="lime",c[1]=Q,W.points.push(1),W.data.push(k),s.value.classList.remove("selected");break;default:const U=r.timeToIndex(c[0].time),D=r.timeToIndex(c[1].time),ae=r.timeToIndex(k)+(D-U),$=r.indexToTime(ae);Q.color="OrangeRed",c[0]=u.cloneDeep(Q),W.points.push(0),W.data.push(k),Q.time=$,Q.color="lime",c[1]=Q,W.points.push(1),W.data.push($),s.value.classList.remove("selected");break}h.timeRange.setData(c),n.dispatch("tradingDerivative/drawTools",W)}function T(k){I(!1),R(k)}function R(k){let W,Q;if(k.length===2)W=k[0],Q=k[1];else if(k.length===3){const D=r.timeToIndex(k[0]),V=r.timeToIndex(k[1]),$=r.timeToIndex(k[2])+(V-D);W=k[2],Q=r.indexToTime($)}else return!1;let U=[{time:W,value:1,color:"OrangeRed"},{time:Q,value:1,color:"lime"}];c=U,h.timeRange.setData(U)}function I(k=!0){k&&n.dispatch("tradingDerivative/drawTools",{isRemove:!0,symbol,name:"timeRange"}),h.timeRange.setData([]),c=[]}return(k,W)=>(openBlock(),createElementBlock("div",{ref_key:"timeRangeToolRef",ref:s,class:"command",title:k.$t("trading.derivative.tools.timeRange"),onClick:b,onContextmenu:w},_hoisted_3$1,40,_hoisted_1$2))}},_sfc_main$2={__name:"OrderContext",props:["orders"],emits:["closeOrder","closeAllOrders","putOrder"],setup(e,{emit:o}){const t=e,n=o,u=computed(()=>Object.values(t.orders).map(c=>({id:c.id,side:c.side>0?"L":"S",price:c.entry_price}))),r=[{field:"id",minWidth:50},{field:"side",minWidth:90},{field:"price",minWidth:100}];function i(){n("closeAllOrders")}function s(c){const h=t.orders[c];n("closeOrder",h)}function a(){n("putOrder")}return(c,h)=>{const d=resolveComponent("DxButton"),g=resolveComponent("DxToolbar");return openBlock(),createBlock(_sfc_main$8,{class:"order-context"},{default:withCtx(()=>[createVNode(unref(dataGridExports.DxDataGrid),{"data-source":u.value,"key-expr":"id","show-borders":!0},{commandCellTemplate:withCtx(({data:b})=>[createVNode(d,{type:"danger",stylingMode:"text",icon:"trash",onClick:()=>s(b.data.id)},null,8,["onClick"])]),default:withCtx(()=>[createVNode(unref(dataGridExports.DxColumn),{width:50,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate"}),(openBlock(),createElementBlock(Fragment,null,renderList(r,b=>createVNode(unref(dataGridExports.DxColumn),{"data-field":b.field,minWidth:b.minWidth,caption:c.$t(`trading.derivative.orderContext.${b.field}`)},null,8,["data-field","minWidth","caption"])),64))]),_:1},8,["data-source"]),createVNode(g,{items:[{location:"before",widget:"dxButton",options:{type:"danger",stylingMode:"outlined",icon:"far fa-gavel",text:c.$t("trading.derivative.orderContext.putOrder"),onClick:a}},{location:"after",widget:"dxButton",options:{type:"danger",stylingMode:"outlined",icon:"trash",text:c.$t("trading.derivative.orderContext.closeAll"),onClick:i}}]},null,8,["items"])]),_:1})}}},_hoisted_1$1=["title"],_sfc_main$1={__name:"OrderTool",props:["position","drawPriceLine","inSession","TIME"],emits:["hideContext"],setup(e,{expose:o,emit:t}){const n=useStore(),{t:u}=useI18n(),r=inject("mf"),i=e,s=t,a=ref(null),c=ref(!1),h=ref(!1),d=ref({}),g=computed(()=>n.state.tradingDerivative.config.orders),b=computed(()=>n.state.tradingDerivative.status.position||n.state.tradingDerivative.status.pendingOrders.length>0||Object.keys(d.value).length>0);let w={},E={},T=!1;o({hide:I,scan:D,drag:xe,closeAllOrders:W,cancelWithoutClose:U,setPatternOrder:R}),onMounted(()=>{window.addEventListener("keydown",We)}),onUnmounted(()=>{window.removeEventListener("keydown",We)}),watch(g,H=>{r.isSet(H)&&V(H)});function R(H){w=H}function I(H=!1){h.value=H}function k(){let H=!1,ye=()=>{};if(i.inSession()){const G=getUnixTime(addHours(new Date,7));if(G<i.TIME.ATO)H=!0,ye=()=>{n.dispatch("tradingDerivative/executeOrder",{action:"cancel",exit:"ATO"}).then(ie=>{ie.isOk?l.success(u("trading.derivative.toasts.atoOrderSuccess")):ge(ie)})};else if(G>i.TIME.ATC)H=!0,ye=()=>{n.dispatch("tradingDerivative/executeOrder",{action:"cancel",exit:"ATC"}).then(ie=>{ie.isOk?l.success(u("trading.derivative.toasts.atcOrderSuccess")):ge(ie)})};else if(!i.position)r.isSet(w)&&(H=!0,ye=()=>{n.dispatch("tradingDerivative/executeOrder",{action:"entry",data:{cmd:"new",...w}}).then(ie=>{ie.isOk?(d.value[ie.order.id]=ie.order,E[ie.order.id]={},ae(["entry"],ie.order),l.success(u("trading.derivative.toasts.newEntrySuccess"))):ge(ie)})});else{const ie=Le(0);if(ie.length===1){const S=ie[0];H=!0,ye=()=>{n.dispatch("tradingDerivative/executeOrder",{action:"tpsl",orderId:S.id}).then(J=>{J.isOk?(d.value[S.id]=J.order,E[S.id].entry.applyOptions({draggable:!1}),ae(["tp","sl"],J.order),l.success(u("trading.derivative.toasts.newTpSlSuccess"))):ge(J)})}}}}H?confirm(u("trading.derivative.toasts.orderConfirm"),u("titles.confirm")).then(ie=>{ie&&ye()}):l.warning(u("trading.derivative.toasts.noPutOrder"))}function W(){const H=Object.values(d.value);H.length?H.forEach(ye=>Q(ye)):n.dispatch("tradingDerivative/executeOrder",{action:"cancel",exit:"MTL"}).then(ye=>{ye.isOk?l.success(u("trading.derivative.toasts.cancelSuccess")):ge(ye)})}function Q(H){n.dispatch("tradingDerivative/executeOrder",{action:"cancel",orderId:H.id,exit:H.status===1?"MTL":""}).then(ye=>{ye.isOk?($(["entry","tp","sl"],H.id),delete d.value[H.id],l.success(u("trading.derivative.toasts.cancelSuccess"))):ge(ye)})}function U(){if(i.inSession()&&i.position){const H=getUnixTime(addHours(new Date,7));H>i.TIME.ATC-5*60&&(c.value=!0,H>i.TIME.ATC-15&&Le(1).forEach(G=>{n.dispatch("tradingDerivative/executeOrder",{action:"cancel",orderId:G.id}).then(ie=>{ie.isOk?($(["entry","tp","sl"],G.id),delete d.value[G.id],l.success(u("trading.derivative.toasts.cancelNotExitSuccess"))):ge(ie)})}))}}function D(H){Object.values(d.value).forEach(ye=>{const G=ye.side>0;switch(ye.status){case 0:r.cmp(H,G,ye.entry_price,!0)&&(T||(T=!0,setTimeout(()=>{n.dispatch("tradingDerivative/executeOrder",{action:"tpsl",orderId:ye.id}).then(S=>{S.isOk?(d.value[ye.id]=S.order,E[ye.id].entry.applyOptions({draggable:!1}),ae(["tp","sl"],S.order),Object.keys(d.value).forEach(J=>{Number(J)!==ye.id&&d.value[J].status===0&&($(["entry"],J),delete d.value[J])}),l.success(u("trading.derivative.toasts.newTpSlSuccess"))):ge(S),T=!1})},1e3)));break;case 1:let ie="";r.cmp(H,G,ye.tp_price,!0)&&(ie="sl"),r.cmp(H,!G,ye.sl_price,!0)&&(ie="tp"),ie&&(T||(T=!0,n.dispatch("tradingDerivative/executeOrder",{action:"cancel",orderId:ye.id,kind:ie}).then(S=>{S.isOk?($(["entry","tp","sl"],ye.id),delete d.value[ye.id],l.success(u("trading.derivative.toasts.cancelSuccess"))):ge(S),T=!1})));break}})}function V(H){d.value=r.cloneDeep(H),Object.values(d.value).forEach(ye=>{let G=["entry"];ye.status===1&&G.push("tp","sl"),$(["entry","tp","sl"],ye.id),ae(G,ye)})}function ae(H,ye){let G,ie;H.forEach(S=>{switch(S){case"entry":G="yellow",ie=`${ye.side>0?"LONG":"SHORT"}[${ye.id}]`;break;case"tp":G="lime",ie=`TP[${ye.id}] ${r.fmtNum(ye.tp_price-ye.entry_price,1,!0)}`;break;case"sl":G="red",ie=`SL[${ye.id}] ${r.fmtNum(ye.sl_price-ye.entry_price,1,!0)}`;break}if(r.isSet(E[ye.id])||(E[ye.id]={}),r.isSet(E[ye.id][S]))E[ye.id][S].applyOptions({title:ie});else{const J={lineType:"order",kind:S,price:ye[`${S}_price`],color:G,lineWidth:1,lineStyle:0,title:ie,draggable:!(S==="entry"&&ye.status===1)};E[ye.id][S]=i.drawPriceLine(J)}})}function $(H,ye){r.isSet(E[ye])&&(H.forEach(G=>{r.isSet(E[ye][G])&&i.drawPriceLine(E[ye][G],!0)}),delete E[ye])}function xe({line:H,lineOptions:ye,oldPrice:G,newPrice:ie}){if(ie!==G){const S=ye.kind;if(S!=="entry"||!i.position){const pe=`change${r.capitalize(S)}Success`,Te=le(S,G);if(!r.isSet(Te))return!1;n.dispatch("tradingDerivative/executeOrder",{action:S,orderId:Te.id,data:{cmd:"change",orderNo:String(Te[`${S}_no`]),price:ie}}).then(Se=>{Se.isOk?(d.value[Te.id]=Se.order,ae([S],Se.order),l.success(u(`trading.derivative.toasts.${pe}`))):(H.applyOptions({price:G}),ge(Se))})}else H.applyOptions({price:G}),l.show(u("trading.derivative.toasts.noChangeOrderLine"))}}function N(){n.dispatch("tradingDerivative/cleanOldOrders")}function le(H,ye){return Object.values(d.value).find(G=>G[`${H}_price`]===ye)}function Le(H,ye=!1){const G=Object.values(d.value).filter(ie=>ie.status===H);return ye?G.length>0:G}function ge(H){let ye=H.error??H.message??"unknown";l.error(u(`trading.derivative.toasts.${ye}`))}function qe(){const H=h.value;s("hideContext"),h.value=!H}function We(H){H.key==="F4"&&(qe(),H.preventDefault())}return(H,ye)=>(openBlock(),createElementBlock("div",{ref_key:"orderToolRef",ref:a,class:normalizeClass(["cancel-order context command",{red:b.value}]),title:H.$t("trading.derivative.tools.order"),onClick:qe,onContextmenu:N},[createBaseVNode("i",{class:normalizeClass(["far fa-gavel",{blink:c.value}])},null,2),withDirectives(createVNode(_sfc_main$2,{class:"contextmenu",orders:d.value,onCloseOrder:Q,onCloseAllOrders:W,onPutOrder:k},null,8,["orders"]),[[vShow,h.value]])],42,_hoisted_1$1))}};var ys=Object.defineProperty,Kg=Object.getOwnPropertyDescriptor,Gg=Object.getOwnPropertyNames,Qg=Object.prototype.hasOwnProperty,_e=(e,o)=>()=>(e&&(o=e(e=0)),o),M=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports),Jt=(e,o)=>{for(var t in o)ys(e,t,{get:o[t],enumerable:!0})},Yg=(e,o,t,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let u of Gg(o))!Qg.call(e,u)&&u!==t&&ys(e,u,{get:()=>o[u],enumerable:!(n=Kg(o,u))||n.enumerable});return e},X=e=>Yg(ys({},"__esModule",{value:!0}),e),_=_e(()=>{}),B={};Jt(B,{_debugEnd:()=>yu,_debugProcess:()=>gu,_events:()=>Ou,_eventsCount:()=>xu,_exiting:()=>Yl,_fatalExceptions:()=>cu,_getActiveHandles:()=>eu,_getActiveRequests:()=>Zl,_kill:()=>ru,_linkedBinding:()=>Gl,_maxListeners:()=>ku,_preload_modules:()=>Cu,_rawDebug:()=>zl,_startProfilerIdleNotifier:()=>bu,_stopProfilerIdleNotifier:()=>wu,_tickCallback:()=>pu,abort:()=>Eu,addListener:()=>Mu,allowedNodeEnvironmentFlags:()=>lu,arch:()=>xl,argv:()=>Ul,argv0:()=>Ru,assert:()=>uu,binding:()=>Fl,chdir:()=>Hl,config:()=>Jl,cpuUsage:()=>$i,cwd:()=>$l,debugPort:()=>Tu,default:()=>$u,dlopen:()=>Xl,domain:()=>Ql,emit:()=>Du,emitWarning:()=>jl,env:()=>Ll,execArgv:()=>Nl,execPath:()=>Iu,exit:()=>ou,features:()=>fu,hasUncaughtExceptionCaptureCallback:()=>du,hrtime:()=>Wi,kill:()=>su,listeners:()=>Wu,memoryUsage:()=>nu,moduleLoadList:()=>Kl,nextTick:()=>Pl,off:()=>Uu,on:()=>wt,once:()=>Lu,openStdin:()=>au,pid:()=>Su,platform:()=>Ml,ppid:()=>Au,prependListener:()=>ju,prependOnceListener:()=>Fu,reallyExit:()=>tu,release:()=>Vl,removeAllListeners:()=>qu,removeListener:()=>Nu,resourceUsage:()=>iu,setSourceMapsEnabled:()=>Bu,setUncaughtExceptionCaptureCallback:()=>hu,stderr:()=>mu,stdin:()=>vu,stdout:()=>_u,title:()=>Ol,umask:()=>Wl,uptime:()=>Pu,version:()=>ql,versions:()=>Dl});function _s(e){throw new Error("Node.js process "+e+" is not supported by JSPM core outside of Node.js")}function Jg(){!Lr||!Xt||(Lr=!1,Xt.length?bt=Xt.concat(bt):Fi=-1,bt.length&&Bl())}function Bl(){if(!Lr){var e=setTimeout(Jg,0);Lr=!0;for(var o=bt.length;o;){for(Xt=bt,bt=[];++Fi<o;)Xt&&Xt[Fi].run();Fi=-1,o=bt.length}Xt=null,Lr=!1,clearTimeout(e)}}function Pl(e){var o=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)o[t-1]=arguments[t];bt.push(new kl(e,o)),bt.length===1&&!Lr&&setTimeout(Bl,0)}function kl(e,o){this.fun=e,this.array=o}function Ee(){}function Gl(e){_s("_linkedBinding")}function Xl(e){_s("dlopen")}function Zl(){return[]}function eu(){return[]}function uu(e,o){if(!e)throw new Error(o||"assertion error")}function du(){return!1}function Pu(){return Lt.now()/1e3}function Wi(e){var o=Math.floor((Date.now()-Lt.now())*.001),t=Lt.now()*.001,n=Math.floor(t)+o,u=Math.floor(t%1*1e9);return e&&(n=n-e[0],u=u-e[1],u<0&&(n--,u+=ws)),[n,u]}function wt(){return $u}function Wu(e){return[]}var bt,Lr,Xt,Fi,Ol,xl,Ml,Ll,Ul,Nl,ql,Dl,jl,Fl,Wl,$l,Hl,Vl,zl,Kl,Ql,Yl,Jl,tu,ru,$i,iu,nu,su,ou,au,lu,fu,cu,hu,pu,gu,yu,bu,wu,_u,mu,vu,Eu,Su,Au,Iu,Tu,Ru,Cu,Bu,Lt,bs,ws,ku,Ou,xu,Mu,Lu,Uu,Nu,qu,Du,ju,Fu,$u,Hu=_e(()=>{_(),v(),m(),bt=[],Lr=!1,Fi=-1,kl.prototype.run=function(){this.fun.apply(null,this.array)},Ol="browser",xl="x64",Ml="browser",Ll={PATH:"/usr/bin",LANG:navigator.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},Ul=["/usr/bin/node"],Nl=[],ql="v16.8.0",Dl={},jl=function(e,o){console.warn((o?o+": ":"")+e)},Fl=function(e){_s("binding")},Wl=function(e){return 0},$l=function(){return"/"},Hl=function(e){},Vl={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},zl=Ee,Kl=[],Ql={},Yl=!1,Jl={},tu=Ee,ru=Ee,$i=function(){return{}},iu=$i,nu=$i,su=Ee,ou=Ee,au=Ee,lu={},fu={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},cu=Ee,hu=Ee,pu=Ee,gu=Ee,yu=Ee,bu=Ee,wu=Ee,_u=void 0,mu=void 0,vu=void 0,Eu=Ee,Su=2,Au=1,Iu="/bin/usr/node",Tu=9229,Ru="node",Cu=[],Bu=Ee,Lt={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},Lt.now===void 0&&(bs=Date.now(),Lt.timing&&Lt.timing.navigationStart&&(bs=Lt.timing.navigationStart),Lt.now=()=>Date.now()-bs),ws=1e9,Wi.bigint=function(e){var o=Wi(e);return typeof BigInt>"u"?o[0]*ws+o[1]:BigInt(o[0]*ws)+BigInt(o[1])},ku=10,Ou={},xu=0,Mu=wt,Lu=wt,Uu=wt,Nu=wt,qu=wt,Du=Ee,ju=wt,Fu=wt,$u={version:ql,versions:Dl,arch:xl,platform:Ml,release:Vl,_rawDebug:zl,moduleLoadList:Kl,binding:Fl,_linkedBinding:Gl,_events:Ou,_eventsCount:xu,_maxListeners:ku,on:wt,addListener:Mu,once:Lu,off:Uu,removeListener:Nu,removeAllListeners:qu,emit:Du,prependListener:ju,prependOnceListener:Fu,listeners:Wu,domain:Ql,_exiting:Yl,config:Jl,dlopen:Xl,uptime:Pu,_getActiveRequests:Zl,_getActiveHandles:eu,reallyExit:tu,_kill:ru,cpuUsage:$i,resourceUsage:iu,memoryUsage:nu,kill:su,exit:ou,openStdin:au,allowedNodeEnvironmentFlags:lu,assert:uu,features:fu,_fatalExceptions:cu,setUncaughtExceptionCaptureCallback:hu,hasUncaughtExceptionCaptureCallback:du,emitWarning:jl,nextTick:Pl,_tickCallback:pu,_debugProcess:gu,_debugEnd:yu,_startProfilerIdleNotifier:bu,_stopProfilerIdleNotifier:wu,stdout:_u,stdin:vu,stderr:mu,abort:Eu,umask:Wl,chdir:Hl,cwd:$l,env:Ll,title:Ol,argv:Ul,execArgv:Nl,pid:Su,ppid:Au,execPath:Iu,debugPort:Tu,hrtime:Wi,argv0:Ru,_preload_modules:Cu,setSourceMapsEnabled:Bu}}),m=_e(()=>{Hu()}),me={};Jt(me,{Buffer:()=>x,INSPECT_MAX_BYTES:()=>ty,default:()=>Ut,kMaxLength:()=>ry});function Xg(){if(Vu)return ci;Vu=!0,ci.byteLength=s,ci.toByteArray=c,ci.fromByteArray=g;for(var e=[],o=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,r=n.length;u<r;++u)e[u]=n[u],o[n.charCodeAt(u)]=u;o[45]=62,o[95]=63;function i(b){var w=b.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=b.indexOf("=");E===-1&&(E=w);var T=E===w?0:4-E%4;return[E,T]}function s(b){var w=i(b),E=w[0],T=w[1];return(E+T)*3/4-T}function a(b,w,E){return(w+E)*3/4-E}function c(b){var w,E=i(b),T=E[0],R=E[1],I=new t(a(b,T,R)),k=0,W=R>0?T-4:T,Q;for(Q=0;Q<W;Q+=4)w=o[b.charCodeAt(Q)]<<18|o[b.charCodeAt(Q+1)]<<12|o[b.charCodeAt(Q+2)]<<6|o[b.charCodeAt(Q+3)],I[k++]=w>>16&255,I[k++]=w>>8&255,I[k++]=w&255;return R===2&&(w=o[b.charCodeAt(Q)]<<2|o[b.charCodeAt(Q+1)]>>4,I[k++]=w&255),R===1&&(w=o[b.charCodeAt(Q)]<<10|o[b.charCodeAt(Q+1)]<<4|o[b.charCodeAt(Q+2)]>>2,I[k++]=w>>8&255,I[k++]=w&255),I}function h(b){return e[b>>18&63]+e[b>>12&63]+e[b>>6&63]+e[b&63]}function d(b,w,E){for(var T,R=[],I=w;I<E;I+=3)T=(b[I]<<16&16711680)+(b[I+1]<<8&65280)+(b[I+2]&255),R.push(h(T));return R.join("")}function g(b){for(var w,E=b.length,T=E%3,R=[],I=16383,k=0,W=E-T;k<W;k+=I)R.push(d(b,k,k+I>W?W:k+I));return T===1?(w=b[E-1],R.push(e[w>>2]+e[w<<4&63]+"==")):T===2&&(w=(b[E-2]<<8)+b[E-1],R.push(e[w>>10]+e[w>>4&63]+e[w<<2&63]+"=")),R.join("")}return ci}function Zg(){return zu?Hi:(zu=!0,Hi.read=function(e,o,t,n,u){var r,i,s=u*8-n-1,a=(1<<s)-1,c=a>>1,h=-7,d=t?u-1:0,g=t?-1:1,b=e[o+d];for(d+=g,r=b&(1<<-h)-1,b>>=-h,h+=s;h>0;r=r*256+e[o+d],d+=g,h-=8);for(i=r&(1<<-h)-1,r>>=-h,h+=n;h>0;i=i*256+e[o+d],d+=g,h-=8);if(r===0)r=1-c;else{if(r===a)return i?NaN:(b?-1:1)*(1/0);i=i+Math.pow(2,n),r=r-c}return(b?-1:1)*i*Math.pow(2,r-n)},Hi.write=function(e,o,t,n,u,r){var i,s,a,c=r*8-u-1,h=(1<<c)-1,d=h>>1,g=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:r-1,w=n?1:-1,E=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(s=isNaN(o)?1:0,i=h):(i=Math.floor(Math.log(o)/Math.LN2),o*(a=Math.pow(2,-i))<1&&(i--,a*=2),i+d>=1?o+=g/a:o+=g*Math.pow(2,1-d),o*a>=2&&(i++,a/=2),i+d>=h?(s=0,i=h):i+d>=1?(s=(o*a-1)*Math.pow(2,u),i=i+d):(s=o*Math.pow(2,d-1)*Math.pow(2,u),i=0));u>=8;e[t+b]=s&255,b+=w,s/=256,u-=8);for(i=i<<u|s,c+=u;c>0;e[t+b]=i&255,b+=w,i/=256,c-=8);e[t+b-w]|=E*128},Hi)}function ey(){if(Ku)return Zt;Ku=!0;let e=Xg(),o=Zg(),t=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Zt.Buffer=i,Zt.SlowBuffer=R,Zt.INSPECT_MAX_BYTES=50;let n=2147483647;Zt.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=u(),!i.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{let p=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(p,f),p.foo()===42}catch{return!1}}Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}});function r(p){if(p>n)throw new RangeError('The value "'+p+'" is invalid for option "size"');let f=new Uint8Array(p);return Object.setPrototypeOf(f,i.prototype),f}function i(p,f,y){if(typeof p=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(p)}return s(p,f,y)}i.poolSize=8192;function s(p,f,y){if(typeof p=="string")return d(p,f);if(ArrayBuffer.isView(p))return b(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(de(p,ArrayBuffer)||p&&de(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(de(p,SharedArrayBuffer)||p&&de(p.buffer,SharedArrayBuffer)))return w(p,f,y);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let A=p.valueOf&&p.valueOf();if(A!=null&&A!==p)return i.from(A,f,y);let j=E(p);if(j)return j;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return i.from(p[Symbol.toPrimitive]("string"),f,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}i.from=function(p,f,y){return s(p,f,y)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array);function a(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function c(p,f,y){return a(p),p<=0?r(p):f!==void 0?typeof y=="string"?r(p).fill(f,y):r(p).fill(f):r(p)}i.alloc=function(p,f,y){return c(p,f,y)};function h(p){return a(p),r(p<0?0:T(p)|0)}i.allocUnsafe=function(p){return h(p)},i.allocUnsafeSlow=function(p){return h(p)};function d(p,f){if((typeof f!="string"||f==="")&&(f="utf8"),!i.isEncoding(f))throw new TypeError("Unknown encoding: "+f);let y=I(p,f)|0,A=r(y),j=A.write(p,f);return j!==y&&(A=A.slice(0,j)),A}function g(p){let f=p.length<0?0:T(p.length)|0,y=r(f);for(let A=0;A<f;A+=1)y[A]=p[A]&255;return y}function b(p){if(de(p,Uint8Array)){let f=new Uint8Array(p);return w(f.buffer,f.byteOffset,f.byteLength)}return g(p)}function w(p,f,y){if(f<0||p.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<f+(y||0))throw new RangeError('"length" is outside of buffer bounds');let A;return f===void 0&&y===void 0?A=new Uint8Array(p):y===void 0?A=new Uint8Array(p,f):A=new Uint8Array(p,f,y),Object.setPrototypeOf(A,i.prototype),A}function E(p){if(i.isBuffer(p)){let f=T(p.length)|0,y=r(f);return y.length===0||p.copy(y,0,0,f),y}if(p.length!==void 0)return typeof p.length!="number"||F(p.length)?r(0):g(p);if(p.type==="Buffer"&&Array.isArray(p.data))return g(p.data)}function T(p){if(p>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return p|0}function R(p){return+p!=p&&(p=0),i.alloc(+p)}i.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==i.prototype},i.compare=function(p,f){if(de(p,Uint8Array)&&(p=i.from(p,p.offset,p.byteLength)),de(f,Uint8Array)&&(f=i.from(f,f.offset,f.byteLength)),!i.isBuffer(p)||!i.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===f)return 0;let y=p.length,A=f.length;for(let j=0,se=Math.min(y,A);j<se;++j)if(p[j]!==f[j]){y=p[j],A=f[j];break}return y<A?-1:A<y?1:0},i.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(p,f){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return i.alloc(0);let y;if(f===void 0)for(f=0,y=0;y<p.length;++y)f+=p[y].length;let A=i.allocUnsafe(f),j=0;for(y=0;y<p.length;++y){let se=p[y];if(de(se,Uint8Array))j+se.length>A.length?(i.isBuffer(se)||(se=i.from(se)),se.copy(A,j)):Uint8Array.prototype.set.call(A,se,j);else if(i.isBuffer(se))se.copy(A,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=se.length}return A};function I(p,f){if(i.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||de(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);let y=p.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&y===0)return 0;let j=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return z(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y*2;case"hex":return y>>>1;case"base64":return ke(p).length;default:if(j)return A?-1:z(p).length;f=(""+f).toLowerCase(),j=!0}}i.byteLength=I;function k(p,f,y){let A=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((y===void 0||y>this.length)&&(y=this.length),y<=0)||(y>>>=0,f>>>=0,y<=f))return"";for(p||(p="utf8");;)switch(p){case"hex":return H(this,f,y);case"utf8":case"utf-8":return le(this,f,y);case"ascii":return qe(this,f,y);case"latin1":case"binary":return We(this,f,y);case"base64":return N(this,f,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,f,y);default:if(A)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),A=!0}}i.prototype._isBuffer=!0;function W(p,f,y){let A=p[f];p[f]=p[y],p[y]=A}i.prototype.swap16=function(){let p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<p;f+=2)W(this,f,f+1);return this},i.prototype.swap32=function(){let p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<p;f+=4)W(this,f,f+3),W(this,f+1,f+2);return this},i.prototype.swap64=function(){let p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<p;f+=8)W(this,f,f+7),W(this,f+1,f+6),W(this,f+2,f+5),W(this,f+3,f+4);return this},i.prototype.toString=function(){let p=this.length;return p===0?"":arguments.length===0?le(this,0,p):k.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(p){if(!i.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:i.compare(this,p)===0},i.prototype.inspect=function(){let p="",f=Zt.INSPECT_MAX_BYTES;return p=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(p+=" ... "),"<Buffer "+p+">"},t&&(i.prototype[t]=i.prototype.inspect),i.prototype.compare=function(p,f,y,A,j){if(de(p,Uint8Array)&&(p=i.from(p,p.offset,p.byteLength)),!i.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(f===void 0&&(f=0),y===void 0&&(y=p?p.length:0),A===void 0&&(A=0),j===void 0&&(j=this.length),f<0||y>p.length||A<0||j>this.length)throw new RangeError("out of range index");if(A>=j&&f>=y)return 0;if(A>=j)return-1;if(f>=y)return 1;if(f>>>=0,y>>>=0,A>>>=0,j>>>=0,this===p)return 0;let se=j-A,Ne=y-f,Ke=Math.min(se,Ne),rt=this.slice(A,j),st=p.slice(f,y);for(let Ye=0;Ye<Ke;++Ye)if(rt[Ye]!==st[Ye]){se=rt[Ye],Ne=st[Ye];break}return se<Ne?-1:Ne<se?1:0};function Q(p,f,y,A,j){if(p.length===0)return-1;if(typeof y=="string"?(A=y,y=0):y>2147483647?y=2147483647:y<-2147483648&&(y=-2147483648),y=+y,F(y)&&(y=j?0:p.length-1),y<0&&(y=p.length+y),y>=p.length){if(j)return-1;y=p.length-1}else if(y<0)if(j)y=0;else return-1;if(typeof f=="string"&&(f=i.from(f,A)),i.isBuffer(f))return f.length===0?-1:U(p,f,y,A,j);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(p,f,y):Uint8Array.prototype.lastIndexOf.call(p,f,y):U(p,[f],y,A,j);throw new TypeError("val must be string, number or Buffer")}function U(p,f,y,A,j){let se=1,Ne=p.length,Ke=f.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(p.length<2||f.length<2)return-1;se=2,Ne/=2,Ke/=2,y/=2}function rt(Ye,et){return se===1?Ye[et]:Ye.readUInt16BE(et*se)}let st;if(j){let Ye=-1;for(st=y;st<Ne;st++)if(rt(p,st)===rt(f,Ye===-1?0:st-Ye)){if(Ye===-1&&(Ye=st),st-Ye+1===Ke)return Ye*se}else Ye!==-1&&(st-=st-Ye),Ye=-1}else for(y+Ke>Ne&&(y=Ne-Ke),st=y;st>=0;st--){let Ye=!0;for(let et=0;et<Ke;et++)if(rt(p,st+et)!==rt(f,et)){Ye=!1;break}if(Ye)return st}return-1}i.prototype.includes=function(p,f,y){return this.indexOf(p,f,y)!==-1},i.prototype.indexOf=function(p,f,y){return Q(this,p,f,y,!0)},i.prototype.lastIndexOf=function(p,f,y){return Q(this,p,f,y,!1)};function D(p,f,y,A){y=Number(y)||0;let j=p.length-y;A?(A=Number(A),A>j&&(A=j)):A=j;let se=f.length;A>se/2&&(A=se/2);let Ne;for(Ne=0;Ne<A;++Ne){let Ke=parseInt(f.substr(Ne*2,2),16);if(F(Ke))return Ne;p[y+Ne]=Ke}return Ne}function V(p,f,y,A){return K(z(f,p.length-y),p,y,A)}function ae(p,f,y,A){return K(ee(f),p,y,A)}function $(p,f,y,A){return K(ke(f),p,y,A)}function xe(p,f,y,A){return K(De(f,p.length-y),p,y,A)}i.prototype.write=function(p,f,y,A){if(f===void 0)A="utf8",y=this.length,f=0;else if(y===void 0&&typeof f=="string")A=f,y=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(y)?(y=y>>>0,A===void 0&&(A="utf8")):(A=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let j=this.length-f;if((y===void 0||y>j)&&(y=j),p.length>0&&(y<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let se=!1;for(;;)switch(A){case"hex":return D(this,p,f,y);case"utf8":case"utf-8":return V(this,p,f,y);case"ascii":case"latin1":case"binary":return ae(this,p,f,y);case"base64":return $(this,p,f,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xe(this,p,f,y);default:if(se)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),se=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(p,f,y){return f===0&&y===p.length?e.fromByteArray(p):e.fromByteArray(p.slice(f,y))}function le(p,f,y){y=Math.min(p.length,y);let A=[],j=f;for(;j<y;){let se=p[j],Ne=null,Ke=se>239?4:se>223?3:se>191?2:1;if(j+Ke<=y){let rt,st,Ye,et;switch(Ke){case 1:se<128&&(Ne=se);break;case 2:rt=p[j+1],(rt&192)===128&&(et=(se&31)<<6|rt&63,et>127&&(Ne=et));break;case 3:rt=p[j+1],st=p[j+2],(rt&192)===128&&(st&192)===128&&(et=(se&15)<<12|(rt&63)<<6|st&63,et>2047&&(et<55296||et>57343)&&(Ne=et));break;case 4:rt=p[j+1],st=p[j+2],Ye=p[j+3],(rt&192)===128&&(st&192)===128&&(Ye&192)===128&&(et=(se&15)<<18|(rt&63)<<12|(st&63)<<6|Ye&63,et>65535&&et<1114112&&(Ne=et))}}Ne===null?(Ne=65533,Ke=1):Ne>65535&&(Ne-=65536,A.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),A.push(Ne),j+=Ke}return ge(A)}let Le=4096;function ge(p){let f=p.length;if(f<=Le)return String.fromCharCode.apply(String,p);let y="",A=0;for(;A<f;)y+=String.fromCharCode.apply(String,p.slice(A,A+=Le));return y}function qe(p,f,y){let A="";y=Math.min(p.length,y);for(let j=f;j<y;++j)A+=String.fromCharCode(p[j]&127);return A}function We(p,f,y){let A="";y=Math.min(p.length,y);for(let j=f;j<y;++j)A+=String.fromCharCode(p[j]);return A}function H(p,f,y){let A=p.length;(!f||f<0)&&(f=0),(!y||y<0||y>A)&&(y=A);let j="";for(let se=f;se<y;++se)j+=te[p[se]];return j}function ye(p,f,y){let A=p.slice(f,y),j="";for(let se=0;se<A.length-1;se+=2)j+=String.fromCharCode(A[se]+A[se+1]*256);return j}i.prototype.slice=function(p,f){let y=this.length;p=~~p,f=f===void 0?y:~~f,p<0?(p+=y,p<0&&(p=0)):p>y&&(p=y),f<0?(f+=y,f<0&&(f=0)):f>y&&(f=y),f<p&&(f=p);let A=this.subarray(p,f);return Object.setPrototypeOf(A,i.prototype),A};function G(p,f,y){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+f>y)throw new RangeError("Trying to access beyond buffer length")}i.prototype.readUintLE=i.prototype.readUIntLE=function(p,f,y){p=p>>>0,f=f>>>0,y||G(p,f,this.length);let A=this[p],j=1,se=0;for(;++se<f&&(j*=256);)A+=this[p+se]*j;return A},i.prototype.readUintBE=i.prototype.readUIntBE=function(p,f,y){p=p>>>0,f=f>>>0,y||G(p,f,this.length);let A=this[p+--f],j=1;for(;f>0&&(j*=256);)A+=this[p+--f]*j;return A},i.prototype.readUint8=i.prototype.readUInt8=function(p,f){return p=p>>>0,f||G(p,1,this.length),this[p]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(p,f){return p=p>>>0,f||G(p,2,this.length),this[p]|this[p+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(p,f){return p=p>>>0,f||G(p,2,this.length),this[p]<<8|this[p+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(p,f){return p=p>>>0,f||G(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(p,f){return p=p>>>0,f||G(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},i.prototype.readBigUInt64LE=ue(function(p){p=p>>>0,he(p,"offset");let f=this[p],y=this[p+7];(f===void 0||y===void 0)&&je(p,this.length-8);let A=f+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24,j=this[++p]+this[++p]*2**8+this[++p]*2**16+y*2**24;return BigInt(A)+(BigInt(j)<<BigInt(32))}),i.prototype.readBigUInt64BE=ue(function(p){p=p>>>0,he(p,"offset");let f=this[p],y=this[p+7];(f===void 0||y===void 0)&&je(p,this.length-8);let A=f*2**24+this[++p]*2**16+this[++p]*2**8+this[++p],j=this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+y;return(BigInt(A)<<BigInt(32))+BigInt(j)}),i.prototype.readIntLE=function(p,f,y){p=p>>>0,f=f>>>0,y||G(p,f,this.length);let A=this[p],j=1,se=0;for(;++se<f&&(j*=256);)A+=this[p+se]*j;return j*=128,A>=j&&(A-=Math.pow(2,8*f)),A},i.prototype.readIntBE=function(p,f,y){p=p>>>0,f=f>>>0,y||G(p,f,this.length);let A=f,j=1,se=this[p+--A];for(;A>0&&(j*=256);)se+=this[p+--A]*j;return j*=128,se>=j&&(se-=Math.pow(2,8*f)),se},i.prototype.readInt8=function(p,f){return p=p>>>0,f||G(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},i.prototype.readInt16LE=function(p,f){p=p>>>0,f||G(p,2,this.length);let y=this[p]|this[p+1]<<8;return y&32768?y|4294901760:y},i.prototype.readInt16BE=function(p,f){p=p>>>0,f||G(p,2,this.length);let y=this[p+1]|this[p]<<8;return y&32768?y|4294901760:y},i.prototype.readInt32LE=function(p,f){return p=p>>>0,f||G(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},i.prototype.readInt32BE=function(p,f){return p=p>>>0,f||G(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},i.prototype.readBigInt64LE=ue(function(p){p=p>>>0,he(p,"offset");let f=this[p],y=this[p+7];(f===void 0||y===void 0)&&je(p,this.length-8);let A=this[p+4]+this[p+5]*2**8+this[p+6]*2**16+(y<<24);return(BigInt(A)<<BigInt(32))+BigInt(f+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24)}),i.prototype.readBigInt64BE=ue(function(p){p=p>>>0,he(p,"offset");let f=this[p],y=this[p+7];(f===void 0||y===void 0)&&je(p,this.length-8);let A=(f<<24)+this[++p]*2**16+this[++p]*2**8+this[++p];return(BigInt(A)<<BigInt(32))+BigInt(this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+y)}),i.prototype.readFloatLE=function(p,f){return p=p>>>0,f||G(p,4,this.length),o.read(this,p,!0,23,4)},i.prototype.readFloatBE=function(p,f){return p=p>>>0,f||G(p,4,this.length),o.read(this,p,!1,23,4)},i.prototype.readDoubleLE=function(p,f){return p=p>>>0,f||G(p,8,this.length),o.read(this,p,!0,52,8)},i.prototype.readDoubleBE=function(p,f){return p=p>>>0,f||G(p,8,this.length),o.read(this,p,!1,52,8)};function ie(p,f,y,A,j,se){if(!i.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>j||f<se)throw new RangeError('"value" argument is out of bounds');if(y+A>p.length)throw new RangeError("Index out of range")}i.prototype.writeUintLE=i.prototype.writeUIntLE=function(p,f,y,A){if(p=+p,f=f>>>0,y=y>>>0,!A){let Ne=Math.pow(2,8*y)-1;ie(this,p,f,y,Ne,0)}let j=1,se=0;for(this[f]=p&255;++se<y&&(j*=256);)this[f+se]=p/j&255;return f+y},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(p,f,y,A){if(p=+p,f=f>>>0,y=y>>>0,!A){let Ne=Math.pow(2,8*y)-1;ie(this,p,f,y,Ne,0)}let j=y-1,se=1;for(this[f+j]=p&255;--j>=0&&(se*=256);)this[f+j]=p/se&255;return f+y},i.prototype.writeUint8=i.prototype.writeUInt8=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,1,255,0),this[f]=p&255,f+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,2,65535,0),this[f]=p&255,this[f+1]=p>>>8,f+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,2,65535,0),this[f]=p>>>8,this[f+1]=p&255,f+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,4,4294967295,0),this[f+3]=p>>>24,this[f+2]=p>>>16,this[f+1]=p>>>8,this[f]=p&255,f+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,4,4294967295,0),this[f]=p>>>24,this[f+1]=p>>>16,this[f+2]=p>>>8,this[f+3]=p&255,f+4};function S(p,f,y,A,j){ve(f,A,j,p,y,7);let se=Number(f&BigInt(4294967295));p[y++]=se,se=se>>8,p[y++]=se,se=se>>8,p[y++]=se,se=se>>8,p[y++]=se;let Ne=Number(f>>BigInt(32)&BigInt(4294967295));return p[y++]=Ne,Ne=Ne>>8,p[y++]=Ne,Ne=Ne>>8,p[y++]=Ne,Ne=Ne>>8,p[y++]=Ne,y}function J(p,f,y,A,j){ve(f,A,j,p,y,7);let se=Number(f&BigInt(4294967295));p[y+7]=se,se=se>>8,p[y+6]=se,se=se>>8,p[y+5]=se,se=se>>8,p[y+4]=se;let Ne=Number(f>>BigInt(32)&BigInt(4294967295));return p[y+3]=Ne,Ne=Ne>>8,p[y+2]=Ne,Ne=Ne>>8,p[y+1]=Ne,Ne=Ne>>8,p[y]=Ne,y+8}i.prototype.writeBigUInt64LE=ue(function(p,f=0){return S(this,p,f,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeBigUInt64BE=ue(function(p,f=0){return J(this,p,f,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeIntLE=function(p,f,y,A){if(p=+p,f=f>>>0,!A){let Ke=Math.pow(2,8*y-1);ie(this,p,f,y,Ke-1,-Ke)}let j=0,se=1,Ne=0;for(this[f]=p&255;++j<y&&(se*=256);)p<0&&Ne===0&&this[f+j-1]!==0&&(Ne=1),this[f+j]=(p/se>>0)-Ne&255;return f+y},i.prototype.writeIntBE=function(p,f,y,A){if(p=+p,f=f>>>0,!A){let Ke=Math.pow(2,8*y-1);ie(this,p,f,y,Ke-1,-Ke)}let j=y-1,se=1,Ne=0;for(this[f+j]=p&255;--j>=0&&(se*=256);)p<0&&Ne===0&&this[f+j+1]!==0&&(Ne=1),this[f+j]=(p/se>>0)-Ne&255;return f+y},i.prototype.writeInt8=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,1,127,-128),p<0&&(p=255+p+1),this[f]=p&255,f+1},i.prototype.writeInt16LE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,2,32767,-32768),this[f]=p&255,this[f+1]=p>>>8,f+2},i.prototype.writeInt16BE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,2,32767,-32768),this[f]=p>>>8,this[f+1]=p&255,f+2},i.prototype.writeInt32LE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,4,2147483647,-2147483648),this[f]=p&255,this[f+1]=p>>>8,this[f+2]=p>>>16,this[f+3]=p>>>24,f+4},i.prototype.writeInt32BE=function(p,f,y){return p=+p,f=f>>>0,y||ie(this,p,f,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[f]=p>>>24,this[f+1]=p>>>16,this[f+2]=p>>>8,this[f+3]=p&255,f+4},i.prototype.writeBigInt64LE=ue(function(p,f=0){return S(this,p,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),i.prototype.writeBigInt64BE=ue(function(p,f=0){return J(this,p,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function pe(p,f,y,A,j,se){if(y+A>p.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("Index out of range")}function Te(p,f,y,A,j){return f=+f,y=y>>>0,j||pe(p,f,y,4),o.write(p,f,y,A,23,4),y+4}i.prototype.writeFloatLE=function(p,f,y){return Te(this,p,f,!0,y)},i.prototype.writeFloatBE=function(p,f,y){return Te(this,p,f,!1,y)};function Se(p,f,y,A,j){return f=+f,y=y>>>0,j||pe(p,f,y,8),o.write(p,f,y,A,52,8),y+8}i.prototype.writeDoubleLE=function(p,f,y){return Se(this,p,f,!0,y)},i.prototype.writeDoubleBE=function(p,f,y){return Se(this,p,f,!1,y)},i.prototype.copy=function(p,f,y,A){if(!i.isBuffer(p))throw new TypeError("argument should be a Buffer");if(y||(y=0),!A&&A!==0&&(A=this.length),f>=p.length&&(f=p.length),f||(f=0),A>0&&A<y&&(A=y),A===y||p.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),p.length-f<A-y&&(A=p.length-f+y);let j=A-y;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,y,A):Uint8Array.prototype.set.call(p,this.subarray(y,A),f),j},i.prototype.fill=function(p,f,y,A){if(typeof p=="string"){if(typeof f=="string"?(A=f,f=0,y=this.length):typeof y=="string"&&(A=y,y=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!i.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(p.length===1){let se=p.charCodeAt(0);(A==="utf8"&&se<128||A==="latin1")&&(p=se)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(f<0||this.length<f||this.length<y)throw new RangeError("Out of range index");if(y<=f)return this;f=f>>>0,y=y===void 0?this.length:y>>>0,p||(p=0);let j;if(typeof p=="number")for(j=f;j<y;++j)this[j]=p;else{let se=i.isBuffer(p)?p:i.from(p,A),Ne=se.length;if(Ne===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(j=0;j<y-f;++j)this[j+f]=se[j%Ne]}return this};let P={};function C(p,f,y){P[p]=class extends y{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${p}]`,this.stack,delete this.name}get code(){return p}set code(A){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:A,writable:!0})}toString(){return`${this.name} [${p}]: ${this.message}`}}}C("ERR_BUFFER_OUT_OF_BOUNDS",function(p){return p?`${p} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),C("ERR_INVALID_ARG_TYPE",function(p,f){return`The "${p}" argument must be of type number. Received type ${typeof f}`},TypeError),C("ERR_OUT_OF_RANGE",function(p,f,y){let A=`The value of "${p}" is out of range.`,j=y;return Number.isInteger(y)&&Math.abs(y)>2**32?j=oe(String(y)):typeof y=="bigint"&&(j=String(y),(y>BigInt(2)**BigInt(32)||y<-(BigInt(2)**BigInt(32)))&&(j=oe(j)),j+="n"),A+=` It must be ${f}. Received ${j}`,A},RangeError);function oe(p){let f="",y=p.length,A=p[0]==="-"?1:0;for(;y>=A+4;y-=3)f=`_${p.slice(y-3,y)}${f}`;return`${p.slice(0,y)}${f}`}function Ce(p,f,y){he(f,"offset"),(p[f]===void 0||p[f+y]===void 0)&&je(f,p.length-(y+1))}function ve(p,f,y,A,j,se){if(p>y||p<f){let Ne=typeof f=="bigint"?"n":"",Ke;throw f===0||f===BigInt(0)?Ke=`>= 0${Ne} and < 2${Ne} ** ${(se+1)*8}${Ne}`:Ke=`>= -(2${Ne} ** ${(se+1)*8-1}${Ne}) and < 2 ** ${(se+1)*8-1}${Ne}`,new P.ERR_OUT_OF_RANGE("value",Ke,p)}Ce(A,j,se)}function he(p,f){if(typeof p!="number")throw new P.ERR_INVALID_ARG_TYPE(f,"number",p)}function je(p,f,y){throw Math.floor(p)!==p?(he(p,y),new P.ERR_OUT_OF_RANGE("offset","an integer",p)):f<0?new P.ERR_BUFFER_OUT_OF_BOUNDS:new P.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,p)}let Ie=/[^+/0-9A-Za-z-_]/g;function L(p){if(p=p.split("=")[0],p=p.trim().replace(Ie,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function z(p,f){f=f||1/0;let y,A=p.length,j=null,se=[];for(let Ne=0;Ne<A;++Ne){if(y=p.charCodeAt(Ne),y>55295&&y<57344){if(!j){if(y>56319){(f-=3)>-1&&se.push(239,191,189);continue}else if(Ne+1===A){(f-=3)>-1&&se.push(239,191,189);continue}j=y;continue}if(y<56320){(f-=3)>-1&&se.push(239,191,189),j=y;continue}y=(j-55296<<10|y-56320)+65536}else j&&(f-=3)>-1&&se.push(239,191,189);if(j=null,y<128){if((f-=1)<0)break;se.push(y)}else if(y<2048){if((f-=2)<0)break;se.push(y>>6|192,y&63|128)}else if(y<65536){if((f-=3)<0)break;se.push(y>>12|224,y>>6&63|128,y&63|128)}else if(y<1114112){if((f-=4)<0)break;se.push(y>>18|240,y>>12&63|128,y>>6&63|128,y&63|128)}else throw new Error("Invalid code point")}return se}function ee(p){let f=[];for(let y=0;y<p.length;++y)f.push(p.charCodeAt(y)&255);return f}function De(p,f){let y,A,j,se=[];for(let Ne=0;Ne<p.length&&!((f-=2)<0);++Ne)y=p.charCodeAt(Ne),A=y>>8,j=y%256,se.push(j),se.push(A);return se}function ke(p){return e.toByteArray(L(p))}function K(p,f,y,A){let j;for(j=0;j<A&&!(j+y>=f.length||j>=p.length);++j)f[j+y]=p[j];return j}function de(p,f){return p instanceof f||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===f.name}function F(p){return p!==p}let te=function(){let p="0123456789abcdef",f=new Array(256);for(let y=0;y<16;++y){let A=y*16;for(let j=0;j<16;++j)f[A+j]=p[y]+p[j]}return f}();function ue(p){return typeof BigInt>"u"?Ue:p}function Ue(){throw new Error("BigInt not supported")}return Zt}var ci,Vu,Hi,zu,Zt,Ku,Ut,x,ty,ry,be=_e(()=>{_(),v(),m(),ci={},Vu=!1,Hi={},zu=!1,Zt={},Ku=!1,Ut=ey(),Ut.Buffer,Ut.SlowBuffer,Ut.INSPECT_MAX_BYTES,Ut.kMaxLength,x=Ut.Buffer,ty=Ut.INSPECT_MAX_BYTES,ry=Ut.kMaxLength}),v=_e(()=>{be()}),Gu=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=class{constructor(t){this.aliasToTopic={},this.max=t}put(t,n){return n===0||n>this.max?!1:(this.aliasToTopic[n]=t,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(t){return this.aliasToTopic[t]}clear(){this.aliasToTopic={}}};e.default=o}),ce=M((e,o)=>{_(),v(),m(),o.exports={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,u){return t.slice(n,u)},Error,FunctionPrototypeCall(t,n,...u){return t.call(n,...u)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,u){return Object.defineProperty(t,n,u)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,u){return t.then(n,u)},PromiseReject(t){return Promise.reject(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,u){return t.slice(n,u)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(t,n,u){return t.set(n,u)},Uint8Array}}),Je=M((e,o)=>{_(),v(),m();var t=(be(),X(me)),n=Object.getPrototypeOf(async function(){}).constructor,u=globalThis.Blob||t.Blob,r=typeof u<"u"?function(s){return s instanceof u}:function(s){return!1},i=class extends Error{constructor(s){if(!Array.isArray(s))throw new TypeError(`Expected input to be an Array, got ${typeof s}`);let a="";for(let c=0;c<s.length;c++)a+=`    ${s[c].stack}
`;super(a),this.name="AggregateError",this.errors=s}};o.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(s){let a=!1;return function(...c){a||(a=!0,s.apply(this,c))}},createDeferredPromise:function(){let s,a;return{promise:new Promise((c,h)=>{s=c,a=h}),resolve:s,reject:a}},promisify(s){return new Promise((a,c)=>{s((h,...d)=>h?c(h):a(...d))})},debuglog(){return function(){}},format(s,...a){return s.replace(/%([sdifj])/g,function(...[c,h]){let d=a.shift();return h==="f"?d.toFixed(6):h==="j"?JSON.stringify(d):h==="s"&&typeof d=="object"?`${d.constructor!==Object?d.constructor.name:""} {}`.trim():d.toString()})},inspect(s){switch(typeof s){case"string":if(s.includes("'"))if(s.includes('"')){if(!s.includes("`")&&!s.includes("${"))return`\`${s}\``}else return`"${s}"`;return`'${s}'`;case"number":return isNaN(s)?"NaN":Object.is(s,-0)?String(s):s;case"bigint":return`${String(s)}n`;case"boolean":case"undefined":return String(s);case"object":return"{}"}},types:{isAsyncFunction(s){return s instanceof n},isArrayBufferView(s){return ArrayBuffer.isView(s)}},isBlob:r},o.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),zi=M((e,o)=>{_(),v(),m();var{AbortController:t,AbortSignal:n}=typeof self<"u"?self:typeof window<"u"?window:void 0;o.exports=t,o.exports.AbortSignal=n,o.exports.default=t}),Ae=M((e,o)=>{_(),v(),m();var{format:t,inspect:n,AggregateError:u}=Je(),r=globalThis.AggregateError||u,i=Symbol("kIsNodeError"),s=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,c="__node_internal_",h={};function d(I,k){if(!I)throw new h.ERR_INTERNAL_ASSERTION(k)}function g(I){let k="",W=I.length,Q=I[0]==="-"?1:0;for(;W>=Q+4;W-=3)k=`_${I.slice(W-3,W)}${k}`;return`${I.slice(0,W)}${k}`}function b(I,k,W){if(typeof k=="function")return d(k.length<=W.length,`Code: ${I}; The provided arguments length (${W.length}) does not match the required ones (${k.length}).`),k(...W);let Q=(k.match(/%[dfijoOs]/g)||[]).length;return d(Q===W.length,`Code: ${I}; The provided arguments length (${W.length}) does not match the required ones (${Q}).`),W.length===0?k:t(k,...W)}function w(I,k,W){W||(W=Error);class Q extends W{constructor(...D){super(b(I,k,D))}toString(){return`${this.name} [${I}]: ${this.message}`}}Object.defineProperties(Q.prototype,{name:{value:W.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${I}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),Q.prototype.code=I,Q.prototype[i]=!0,h[I]=Q}function E(I){let k=c+I.name;return Object.defineProperty(I,"name",{value:k}),I}function T(I,k){if(I&&k&&I!==k){if(Array.isArray(k.errors))return k.errors.push(I),k;let W=new r([k,I],k.message);return W.code=k.code,W}return I||k}var R=class extends Error{constructor(I="The operation was aborted",k=void 0){if(k!==void 0&&typeof k!="object")throw new h.ERR_INVALID_ARG_TYPE("options","Object",k);super(I,k),this.code="ABORT_ERR",this.name="AbortError"}};w("ERR_ASSERTION","%s",Error),w("ERR_INVALID_ARG_TYPE",(I,k,W)=>{d(typeof I=="string","'name' must be a string"),Array.isArray(k)||(k=[k]);let Q="The ";I.endsWith(" argument")?Q+=`${I} `:Q+=`"${I}" ${I.includes(".")?"property":"argument"} `,Q+="must be ";let U=[],D=[],V=[];for(let $ of k)d(typeof $=="string","All expected entries have to be of type string"),s.includes($)?U.push($.toLowerCase()):a.test($)?D.push($):(d($!=="object",'The value "object" should be written as "Object"'),V.push($));if(D.length>0){let $=U.indexOf("object");$!==-1&&(U.splice(U,$,1),D.push("Object"))}if(U.length>0){switch(U.length){case 1:Q+=`of type ${U[0]}`;break;case 2:Q+=`one of type ${U[0]} or ${U[1]}`;break;default:{let $=U.pop();Q+=`one of type ${U.join(", ")}, or ${$}`}}(D.length>0||V.length>0)&&(Q+=" or ")}if(D.length>0){switch(D.length){case 1:Q+=`an instance of ${D[0]}`;break;case 2:Q+=`an instance of ${D[0]} or ${D[1]}`;break;default:{let $=D.pop();Q+=`an instance of ${D.join(", ")}, or ${$}`}}V.length>0&&(Q+=" or ")}switch(V.length){case 0:break;case 1:V[0].toLowerCase()!==V[0]&&(Q+="an "),Q+=`${V[0]}`;break;case 2:Q+=`one of ${V[0]} or ${V[1]}`;break;default:{let $=V.pop();Q+=`one of ${V.join(", ")}, or ${$}`}}if(W==null)Q+=`. Received ${W}`;else if(typeof W=="function"&&W.name)Q+=`. Received function ${W.name}`;else if(typeof W=="object"){var ae;if((ae=W.constructor)!==null&&ae!==void 0&&ae.name)Q+=`. Received an instance of ${W.constructor.name}`;else{let $=n(W,{depth:-1});Q+=`. Received ${$}`}}else{let $=n(W,{colors:!1});$.length>25&&($=`${$.slice(0,25)}...`),Q+=`. Received type ${typeof W} (${$})`}return Q},TypeError),w("ERR_INVALID_ARG_VALUE",(I,k,W="is invalid")=>{let Q=n(k);return Q.length>128&&(Q=Q.slice(0,128)+"..."),`The ${I.includes(".")?"property":"argument"} '${I}' ${W}. Received ${Q}`},TypeError),w("ERR_INVALID_RETURN_VALUE",(I,k,W)=>{var Q;let U=W!=null&&(Q=W.constructor)!==null&&Q!==void 0&&Q.name?`instance of ${W.constructor.name}`:`type ${typeof W}`;return`Expected ${I} to be returned from the "${k}" function but got ${U}.`},TypeError),w("ERR_MISSING_ARGS",(...I)=>{d(I.length>0,"At least one arg needs to be specified");let k,W=I.length;switch(I=(Array.isArray(I)?I:[I]).map(Q=>`"${Q}"`).join(" or "),W){case 1:k+=`The ${I[0]} argument`;break;case 2:k+=`The ${I[0]} and ${I[1]} arguments`;break;default:{let Q=I.pop();k+=`The ${I.join(", ")}, and ${Q} arguments`}break}return`${k} must be specified`},TypeError),w("ERR_OUT_OF_RANGE",(I,k,W)=>{d(k,'Missing "range" argument');let Q;return Number.isInteger(W)&&Math.abs(W)>2**32?Q=g(String(W)):typeof W=="bigint"?(Q=String(W),(W>2n**32n||W<-(2n**32n))&&(Q=g(Q)),Q+="n"):Q=n(W),`The value of "${I}" is out of range. It must be ${k}. Received ${Q}`},RangeError),w("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),w("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),w("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),w("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),w("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),w("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),w("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),w("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),w("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),w("ERR_STREAM_WRITE_AFTER_END","write after end",Error),w("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),o.exports={AbortError:R,aggregateTwoErrors:E(T),hideStackFrames:E,codes:h}}),hi=M((e,o)=>{_(),v(),m();var{ArrayIsArray:t,ArrayPrototypeIncludes:n,ArrayPrototypeJoin:u,ArrayPrototypeMap:r,NumberIsInteger:i,NumberIsNaN:s,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:c,NumberParseInt:h,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:g,String:b,StringPrototypeToUpperCase:w,StringPrototypeTrim:E}=ce(),{hideStackFrames:T,codes:{ERR_SOCKET_BAD_PORT:R,ERR_INVALID_ARG_TYPE:I,ERR_INVALID_ARG_VALUE:k,ERR_OUT_OF_RANGE:W,ERR_UNKNOWN_SIGNAL:Q}}=Ae(),{normalizeEncoding:U}=Je(),{isAsyncFunction:D,isArrayBufferView:V}=Je().types,ae={};function $(K){return K===(K|0)}function xe(K){return K===K>>>0}var N=/^[0-7]+$/,le="must be a 32-bit unsigned integer or an octal string";function Le(K,de,F){if(typeof K>"u"&&(K=F),typeof K=="string"){if(g(N,K)===null)throw new k(de,K,le);K=h(K,8)}return We(K,de),K}var ge=T((K,de,F=c,te=a)=>{if(typeof K!="number")throw new I(de,"number",K);if(!i(K))throw new W(de,"an integer",K);if(K<F||K>te)throw new W(de,`>= ${F} && <= ${te}`,K)}),qe=T((K,de,F=-2147483648,te=2147483647)=>{if(typeof K!="number")throw new I(de,"number",K);if(!i(K))throw new W(de,"an integer",K);if(K<F||K>te)throw new W(de,`>= ${F} && <= ${te}`,K)}),We=T((K,de,F=!1)=>{if(typeof K!="number")throw new I(de,"number",K);if(!i(K))throw new W(de,"an integer",K);let te=F?1:0,ue=4294967295;if(K<te||K>ue)throw new W(de,`>= ${te} && <= ${ue}`,K)});function H(K,de){if(typeof K!="string")throw new I(de,"string",K)}function ye(K,de,F=void 0,te){if(typeof K!="number")throw new I(de,"number",K);if(F!=null&&K<F||te!=null&&K>te||(F!=null||te!=null)&&s(K))throw new W(de,`${F!=null?`>= ${F}`:""}${F!=null&&te!=null?" && ":""}${te!=null?`<= ${te}`:""}`,K)}var G=T((K,de,F)=>{if(!n(F,K)){let te="must be one of: "+u(r(F,ue=>typeof ue=="string"?`'${ue}'`:b(ue)),", ");throw new k(de,K,te)}});function ie(K,de){if(typeof K!="boolean")throw new I(de,"boolean",K)}function S(K,de,F){return K==null||!d(K,de)?F:K[de]}var J=T((K,de,F=null)=>{let te=S(F,"allowArray",!1),ue=S(F,"allowFunction",!1);if(!S(F,"nullable",!1)&&K===null||!te&&t(K)||typeof K!="object"&&(!ue||typeof K!="function"))throw new I(de,"Object",K)}),pe=T((K,de)=>{if(K!=null&&typeof K!="object"&&typeof K!="function")throw new I(de,"a dictionary",K)}),Te=T((K,de,F=0)=>{if(!t(K))throw new I(de,"Array",K);if(K.length<F){let te=`must be longer than ${F}`;throw new k(de,K,te)}});function Se(K,de){Te(K,de);for(let F=0;F<K.length;F++)H(K[F],`${de}[${F}]`)}function P(K,de){Te(K,de);for(let F=0;F<K.length;F++)ie(K[F],`${de}[${F}]`)}function C(K,de="signal"){if(H(K,de),ae[K]===void 0)throw ae[w(K)]!==void 0?new Q(K+" (signals must use all capital letters)"):new Q(K)}var oe=T((K,de="buffer")=>{if(!V(K))throw new I(de,["Buffer","TypedArray","DataView"],K)});function Ce(K,de){let F=U(de),te=K.length;if(F==="hex"&&te%2!==0)throw new k("encoding",de,`is invalid for data of length ${te}`)}function ve(K,de="Port",F=!0){if(typeof K!="number"&&typeof K!="string"||typeof K=="string"&&E(K).length===0||+K!==+K>>>0||K>65535||K===0&&!F)throw new R(de,K,F);return K|0}var he=T((K,de)=>{if(K!==void 0&&(K===null||typeof K!="object"||!("aborted"in K)))throw new I(de,"AbortSignal",K)}),je=T((K,de)=>{if(typeof K!="function")throw new I(de,"Function",K)}),Ie=T((K,de)=>{if(typeof K!="function"||D(K))throw new I(de,"Function",K)}),L=T((K,de)=>{if(K!==void 0)throw new I(de,"undefined",K)});function z(K,de,F){if(!n(F,K))throw new I(de,`('${u(F,"|")}')`,K)}var ee=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function De(K,de){if(typeof K>"u"||!g(ee,K))throw new k(de,K,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ke(K){if(typeof K=="string")return De(K,"hints"),K;if(t(K)){let de=K.length,F="";if(de===0)return F;for(let te=0;te<de;te++){let ue=K[te];De(ue,"hints"),F+=ue,te!==de-1&&(F+=", ")}return F}throw new k("hints",K,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}o.exports={isInt32:$,isUint32:xe,parseFileMode:Le,validateArray:Te,validateStringArray:Se,validateBooleanArray:P,validateBoolean:ie,validateBuffer:oe,validateDictionary:pe,validateEncoding:Ce,validateFunction:je,validateInt32:qe,validateInteger:ge,validateNumber:ye,validateObject:J,validateOneOf:G,validatePlainFunction:Ie,validatePort:ve,validateSignalName:C,validateString:H,validateUint32:We,validateUndefined:L,validateUnion:z,validateAbortSignal:he,validateLinkHeaderValue:ke}}),Nt=M((e,o)=>{_(),v(),m();var t=o.exports={},n,u;function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?n=setTimeout:n=r}catch{n=r}try{typeof clearTimeout=="function"?u=clearTimeout:u=i}catch{u=i}})();function s(R){if(n===setTimeout)return setTimeout(R,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(R,0);try{return n(R,0)}catch{try{return n.call(null,R,0)}catch{return n.call(this,R,0)}}}function a(R){if(u===clearTimeout)return clearTimeout(R);if((u===i||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(R);try{return u(R)}catch{try{return u.call(null,R)}catch{return u.call(this,R)}}}var c=[],h=!1,d,g=-1;function b(){!h||!d||(h=!1,d.length?c=d.concat(c):g=-1,c.length&&w())}function w(){if(!h){var R=s(b);h=!0;for(var I=c.length;I;){for(d=c,c=[];++g<I;)d&&d[g].run();g=-1,I=c.length}d=null,h=!1,a(R)}}t.nextTick=function(R){var I=new Array(arguments.length-1);if(arguments.length>1)for(var k=1;k<arguments.length;k++)I[k-1]=arguments[k];c.push(new E(R,I)),c.length===1&&!h&&s(w)};function E(R,I){this.fun=R,this.array=I}E.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function T(){}t.on=T,t.addListener=T,t.once=T,t.off=T,t.removeListener=T,t.removeAllListeners=T,t.emit=T,t.prependListener=T,t.prependOnceListener=T,t.listeners=function(R){return[]},t.binding=function(R){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(R){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}}),tt=M((e,o)=>{_(),v(),m();var{Symbol:t,SymbolAsyncIterator:n,SymbolIterator:u,SymbolFor:r}=ce(),i=t("kDestroyed"),s=t("kIsErrored"),a=t("kIsReadable"),c=t("kIsDisturbed"),h=r("nodejs.webstream.isClosedPromise"),d=r("nodejs.webstream.controllerErrorFunction");function g(S,J=!1){var pe;return!!(S&&typeof S.pipe=="function"&&typeof S.on=="function"&&(!J||typeof S.pause=="function"&&typeof S.resume=="function")&&(!S._writableState||((pe=S._readableState)===null||pe===void 0?void 0:pe.readable)!==!1)&&(!S._writableState||S._readableState))}function b(S){var J;return!!(S&&typeof S.write=="function"&&typeof S.on=="function"&&(!S._readableState||((J=S._writableState)===null||J===void 0?void 0:J.writable)!==!1))}function w(S){return!!(S&&typeof S.pipe=="function"&&S._readableState&&typeof S.on=="function"&&typeof S.write=="function")}function E(S){return S&&(S._readableState||S._writableState||typeof S.write=="function"&&typeof S.on=="function"||typeof S.pipe=="function"&&typeof S.on=="function")}function T(S){return!!(S&&!E(S)&&typeof S.pipeThrough=="function"&&typeof S.getReader=="function"&&typeof S.cancel=="function")}function R(S){return!!(S&&!E(S)&&typeof S.getWriter=="function"&&typeof S.abort=="function")}function I(S){return!!(S&&!E(S)&&typeof S.readable=="object"&&typeof S.writable=="object")}function k(S){return T(S)||R(S)||I(S)}function W(S,J){return S==null?!1:J===!0?typeof S[n]=="function":J===!1?typeof S[u]=="function":typeof S[n]=="function"||typeof S[u]=="function"}function Q(S){if(!E(S))return null;let J=S._writableState,pe=S._readableState,Te=J||pe;return!!(S.destroyed||S[i]||Te!=null&&Te.destroyed)}function U(S){if(!b(S))return null;if(S.writableEnded===!0)return!0;let J=S._writableState;return J!=null&&J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function D(S,J){if(!b(S))return null;if(S.writableFinished===!0)return!0;let pe=S._writableState;return pe!=null&&pe.errored?!1:typeof(pe==null?void 0:pe.finished)!="boolean"?null:!!(pe.finished||J===!1&&pe.ended===!0&&pe.length===0)}function V(S){if(!g(S))return null;if(S.readableEnded===!0)return!0;let J=S._readableState;return!J||J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function ae(S,J){if(!g(S))return null;let pe=S._readableState;return pe!=null&&pe.errored?!1:typeof(pe==null?void 0:pe.endEmitted)!="boolean"?null:!!(pe.endEmitted||J===!1&&pe.ended===!0&&pe.length===0)}function $(S){return S&&S[a]!=null?S[a]:typeof(S==null?void 0:S.readable)!="boolean"?null:Q(S)?!1:g(S)&&S.readable&&!ae(S)}function xe(S){return typeof(S==null?void 0:S.writable)!="boolean"?null:Q(S)?!1:b(S)&&S.writable&&!U(S)}function N(S,J){return E(S)?Q(S)?!0:!((J==null?void 0:J.readable)!==!1&&$(S)||(J==null?void 0:J.writable)!==!1&&xe(S)):null}function le(S){var J,pe;return E(S)?S.writableErrored?S.writableErrored:(J=(pe=S._writableState)===null||pe===void 0?void 0:pe.errored)!==null&&J!==void 0?J:null:null}function Le(S){var J,pe;return E(S)?S.readableErrored?S.readableErrored:(J=(pe=S._readableState)===null||pe===void 0?void 0:pe.errored)!==null&&J!==void 0?J:null:null}function ge(S){if(!E(S))return null;if(typeof S.closed=="boolean")return S.closed;let J=S._writableState,pe=S._readableState;return typeof(J==null?void 0:J.closed)=="boolean"||typeof(pe==null?void 0:pe.closed)=="boolean"?(J==null?void 0:J.closed)||(pe==null?void 0:pe.closed):typeof S._closed=="boolean"&&qe(S)?S._closed:null}function qe(S){return typeof S._closed=="boolean"&&typeof S._defaultKeepAlive=="boolean"&&typeof S._removedConnection=="boolean"&&typeof S._removedContLen=="boolean"}function We(S){return typeof S._sent100=="boolean"&&qe(S)}function H(S){var J;return typeof S._consuming=="boolean"&&typeof S._dumped=="boolean"&&((J=S.req)===null||J===void 0?void 0:J.upgradeOrConnect)===void 0}function ye(S){if(!E(S))return null;let J=S._writableState,pe=S._readableState,Te=J||pe;return!Te&&We(S)||!!(Te&&Te.autoDestroy&&Te.emitClose&&Te.closed===!1)}function G(S){var J;return!!(S&&((J=S[c])!==null&&J!==void 0?J:S.readableDidRead||S.readableAborted))}function ie(S){var J,pe,Te,Se,P,C,oe,Ce,ve,he;return!!(S&&((J=(pe=(Te=(Se=(P=(C=S[s])!==null&&C!==void 0?C:S.readableErrored)!==null&&P!==void 0?P:S.writableErrored)!==null&&Se!==void 0?Se:(oe=S._readableState)===null||oe===void 0?void 0:oe.errorEmitted)!==null&&Te!==void 0?Te:(Ce=S._writableState)===null||Ce===void 0?void 0:Ce.errorEmitted)!==null&&pe!==void 0?pe:(ve=S._readableState)===null||ve===void 0?void 0:ve.errored)!==null&&J!==void 0?J:!((he=S._writableState)===null||he===void 0)&&he.errored))}o.exports={kDestroyed:i,isDisturbed:G,kIsDisturbed:c,isErrored:ie,kIsErrored:s,isReadable:$,kIsReadable:a,kIsClosedPromise:h,kControllerErrorFunction:d,isClosed:ge,isDestroyed:Q,isDuplexNodeStream:w,isFinished:N,isIterable:W,isReadableNodeStream:g,isReadableStream:T,isReadableEnded:V,isReadableFinished:ae,isReadableErrored:Le,isNodeStream:E,isWebStream:k,isWritable:xe,isWritableNodeStream:b,isWritableStream:R,isWritableEnded:U,isWritableFinished:D,isWritableErrored:le,isServerRequest:H,isServerResponse:We,willEmitClose:ye,isTransformStream:I}}),vt=M((e,o)=>{_(),v(),m();var t=Nt(),{AbortError:n,codes:u}=Ae(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:i}=u,{kEmptyObject:s,once:a}=Je(),{validateAbortSignal:c,validateFunction:h,validateObject:d,validateBoolean:g}=hi(),{Promise:b,PromisePrototypeThen:w}=ce(),{isClosed:E,isReadable:T,isReadableNodeStream:R,isReadableStream:I,isReadableFinished:k,isReadableErrored:W,isWritable:Q,isWritableNodeStream:U,isWritableStream:D,isWritableFinished:V,isWritableErrored:ae,isNodeStream:$,willEmitClose:xe,kIsClosedPromise:N}=tt();function le(H){return H.setHeader&&typeof H.abort=="function"}var Le=()=>{};function ge(H,ye,G){var ie,S;if(arguments.length===2?(G=ye,ye=s):ye==null?ye=s:d(ye,"options"),h(G,"callback"),c(ye.signal,"options.signal"),G=a(G),I(H)||D(H))return qe(H,ye,G);if(!$(H))throw new r("stream",["ReadableStream","WritableStream","Stream"],H);let J=(ie=ye.readable)!==null&&ie!==void 0?ie:R(H),pe=(S=ye.writable)!==null&&S!==void 0?S:U(H),Te=H._writableState,Se=H._readableState,P=()=>{H.writable||Ce()},C=xe(H)&&R(H)===J&&U(H)===pe,oe=V(H,!1),Ce=()=>{oe=!0,H.destroyed&&(C=!1),!(C&&(!H.readable||J))&&(!J||ve)&&G.call(H)},ve=k(H,!1),he=()=>{ve=!0,H.destroyed&&(C=!1),!(C&&(!H.writable||pe))&&(!pe||oe)&&G.call(H)},je=ke=>{G.call(H,ke)},Ie=E(H),L=()=>{Ie=!0;let ke=ae(H)||W(H);if(ke&&typeof ke!="boolean")return G.call(H,ke);if(J&&!ve&&R(H,!0)&&!k(H,!1))return G.call(H,new i);if(pe&&!oe&&!V(H,!1))return G.call(H,new i);G.call(H)},z=()=>{Ie=!0;let ke=ae(H)||W(H);if(ke&&typeof ke!="boolean")return G.call(H,ke);G.call(H)},ee=()=>{H.req.on("finish",Ce)};le(H)?(H.on("complete",Ce),C||H.on("abort",L),H.req?ee():H.on("request",ee)):pe&&!Te&&(H.on("end",P),H.on("close",P)),!C&&typeof H.aborted=="boolean"&&H.on("aborted",L),H.on("end",he),H.on("finish",Ce),ye.error!==!1&&H.on("error",je),H.on("close",L),Ie?t.nextTick(L):Te!=null&&Te.errorEmitted||Se!=null&&Se.errorEmitted?C||t.nextTick(z):(!J&&(!C||T(H))&&(oe||Q(H)===!1)||!pe&&(!C||Q(H))&&(ve||T(H)===!1)||Se&&H.req&&H.aborted)&&t.nextTick(z);let De=()=>{G=Le,H.removeListener("aborted",L),H.removeListener("complete",Ce),H.removeListener("abort",L),H.removeListener("request",ee),H.req&&H.req.removeListener("finish",Ce),H.removeListener("end",P),H.removeListener("close",P),H.removeListener("finish",Ce),H.removeListener("end",he),H.removeListener("error",je),H.removeListener("close",L)};if(ye.signal&&!Ie){let ke=()=>{let K=G;De(),K.call(H,new n(void 0,{cause:ye.signal.reason}))};if(ye.signal.aborted)t.nextTick(ke);else{let K=G;G=a((...de)=>{ye.signal.removeEventListener("abort",ke),K.apply(H,de)}),ye.signal.addEventListener("abort",ke)}}return De}function qe(H,ye,G){let ie=!1,S=Le;if(ye.signal)if(S=()=>{ie=!0,G.call(H,new n(void 0,{cause:ye.signal.reason}))},ye.signal.aborted)t.nextTick(S);else{let pe=G;G=a((...Te)=>{ye.signal.removeEventListener("abort",S),pe.apply(H,Te)}),ye.signal.addEventListener("abort",S)}let J=(...pe)=>{ie||t.nextTick(()=>G.apply(H,pe))};return w(H[N].promise,J,J),Le}function We(H,ye){var G;let ie=!1;return ye===null&&(ye=s),(G=ye)!==null&&G!==void 0&&G.cleanup&&(g(ye.cleanup,"cleanup"),ie=ye.cleanup),new b((S,J)=>{let pe=ge(H,ye,Te=>{ie&&pe(),Te?J(Te):S()})})}o.exports=ge,o.exports.finished=We}),ir=M((e,o)=>{_(),v(),m();var t=Nt(),{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:u},AbortError:r}=Ae(),{Symbol:i}=ce(),{kDestroyed:s,isDestroyed:a,isFinished:c,isServerRequest:h}=tt(),d=i("kDestroy"),g=i("kConstruct");function b(N,le,Le){N&&(N.stack,le&&!le.errored&&(le.errored=N),Le&&!Le.errored&&(Le.errored=N))}function w(N,le){let Le=this._readableState,ge=this._writableState,qe=ge||Le;return ge!=null&&ge.destroyed||Le!=null&&Le.destroyed?(typeof le=="function"&&le(),this):(b(N,ge,Le),ge&&(ge.destroyed=!0),Le&&(Le.destroyed=!0),qe.constructed?E(this,N,le):this.once(d,function(We){E(this,n(We,N),le)}),this)}function E(N,le,Le){let ge=!1;function qe(We){if(ge)return;ge=!0;let H=N._readableState,ye=N._writableState;b(We,ye,H),ye&&(ye.closed=!0),H&&(H.closed=!0),typeof Le=="function"&&Le(We),We?t.nextTick(T,N,We):t.nextTick(R,N)}try{N._destroy(le||null,qe)}catch(We){qe(We)}}function T(N,le){I(N,le),R(N)}function R(N){let le=N._readableState,Le=N._writableState;Le&&(Le.closeEmitted=!0),le&&(le.closeEmitted=!0),(Le!=null&&Le.emitClose||le!=null&&le.emitClose)&&N.emit("close")}function I(N,le){let Le=N._readableState,ge=N._writableState;ge!=null&&ge.errorEmitted||Le!=null&&Le.errorEmitted||(ge&&(ge.errorEmitted=!0),Le&&(Le.errorEmitted=!0),N.emit("error",le))}function k(){let N=this._readableState,le=this._writableState;N&&(N.constructed=!0,N.closed=!1,N.closeEmitted=!1,N.destroyed=!1,N.errored=null,N.errorEmitted=!1,N.reading=!1,N.ended=N.readable===!1,N.endEmitted=N.readable===!1),le&&(le.constructed=!0,le.destroyed=!1,le.closed=!1,le.closeEmitted=!1,le.errored=null,le.errorEmitted=!1,le.finalCalled=!1,le.prefinished=!1,le.ended=le.writable===!1,le.ending=le.writable===!1,le.finished=le.writable===!1)}function W(N,le,Le){let ge=N._readableState,qe=N._writableState;if(qe!=null&&qe.destroyed||ge!=null&&ge.destroyed)return this;ge!=null&&ge.autoDestroy||qe!=null&&qe.autoDestroy?N.destroy(le):le&&(le.stack,qe&&!qe.errored&&(qe.errored=le),ge&&!ge.errored&&(ge.errored=le),Le?t.nextTick(I,N,le):I(N,le))}function Q(N,le){if(typeof N._construct!="function")return;let Le=N._readableState,ge=N._writableState;Le&&(Le.constructed=!1),ge&&(ge.constructed=!1),N.once(g,le),!(N.listenerCount(g)>1)&&t.nextTick(U,N)}function U(N){let le=!1;function Le(ge){if(le){W(N,ge??new u);return}le=!0;let qe=N._readableState,We=N._writableState,H=We||qe;qe&&(qe.constructed=!0),We&&(We.constructed=!0),H.destroyed?N.emit(d,ge):ge?W(N,ge,!0):t.nextTick(D,N)}try{N._construct(ge=>{t.nextTick(Le,ge)})}catch(ge){t.nextTick(Le,ge)}}function D(N){N.emit(g)}function V(N){return(N==null?void 0:N.setHeader)&&typeof N.abort=="function"}function ae(N){N.emit("close")}function $(N,le){N.emit("error",le),t.nextTick(ae,N)}function xe(N,le){!N||a(N)||(!le&&!c(N)&&(le=new r),h(N)?(N.socket=null,N.destroy(le)):V(N)?N.abort():V(N.req)?N.req.abort():typeof N.destroy=="function"?N.destroy(le):typeof N.close=="function"?N.close():le?t.nextTick($,N,le):t.nextTick(ae,N),N.destroyed||(N[s]=!0))}o.exports={construct:Q,destroyer:xe,destroy:w,undestroy:k,errorOrDestroy:W}});function Y(){Y.init.call(this)}function en(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function nc(e){return e._maxListeners===void 0?Y.defaultMaxListeners:e._maxListeners}function Xf(e,o,t,n){var u,r,i,s;if(en(t),(r=e._events)===void 0?(r=e._events=Object.create(null),e._eventsCount=0):(r.newListener!==void 0&&(e.emit("newListener",o,t.listener?t.listener:t),r=e._events),i=r[o]),i===void 0)i=r[o]=t,++e._eventsCount;else if(typeof i=="function"?i=r[o]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),(u=nc(e))>0&&i.length>u&&!i.warned){i.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(o)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=o,a.count=i.length,s=a,console&&console.warn&&console.warn(s)}return e}function Gb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zf(e,o,t){var n={fired:!1,wrapFn:void 0,target:e,type:o,listener:t},u=Gb.bind(n);return u.listener=t,n.wrapFn=u,u}function ec(e,o,t){var n=e._events;if(n===void 0)return[];var u=n[o];return u===void 0?[]:typeof u=="function"?t?[u.listener||u]:[u]:t?function(r){for(var i=new Array(r.length),s=0;s<i.length;++s)i[s]=r[s].listener||r[s];return i}(u):sc(u,u.length)}function tc(e){var o=this._events;if(o!==void 0){var t=o[e];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}function sc(e,o){for(var t=new Array(o),n=0;n<o;++n)t[n]=e[n];return t}var rc,ic,qr,Qf,Yf,Jf,Be,Fs=_e(()=>{_(),v(),m(),qr=typeof Reflect=="object"?Reflect:null,Qf=qr&&typeof qr.apply=="function"?qr.apply:function(e,o,t){return Function.prototype.apply.call(e,o,t)},ic=qr&&typeof qr.ownKeys=="function"?qr.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},Yf=Number.isNaN||function(e){return e!=e},rc=Y,Y.EventEmitter=Y,Y.prototype._events=void 0,Y.prototype._eventsCount=0,Y.prototype._maxListeners=void 0,Jf=10,Object.defineProperty(Y,"defaultMaxListeners",{enumerable:!0,get:function(){return Jf},set:function(e){if(typeof e!="number"||e<0||Yf(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Jf=e}}),Y.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Y.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Yf(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Y.prototype.getMaxListeners=function(){return nc(this)},Y.prototype.emit=function(e){for(var o=[],t=1;t<arguments.length;t++)o.push(arguments[t]);var n=e==="error",u=this._events;if(u!==void 0)n=n&&u.error===void 0;else if(!n)return!1;if(n){var r;if(o.length>0&&(r=o[0]),r instanceof Error)throw r;var i=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw i.context=r,i}var s=u[e];if(s===void 0)return!1;if(typeof s=="function")Qf(s,this,o);else{var a=s.length,c=sc(s,a);for(t=0;t<a;++t)Qf(c[t],this,o)}return!0},Y.prototype.addListener=function(e,o){return Xf(this,e,o,!1)},Y.prototype.on=Y.prototype.addListener,Y.prototype.prependListener=function(e,o){return Xf(this,e,o,!0)},Y.prototype.once=function(e,o){return en(o),this.on(e,Zf(this,e,o)),this},Y.prototype.prependOnceListener=function(e,o){return en(o),this.prependListener(e,Zf(this,e,o)),this},Y.prototype.removeListener=function(e,o){var t,n,u,r,i;if(en(o),(n=this._events)===void 0)return this;if((t=n[e])===void 0)return this;if(t===o||t.listener===o)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,t.listener||o));else if(typeof t!="function"){for(u=-1,r=t.length-1;r>=0;r--)if(t[r]===o||t[r].listener===o){i=t[r].listener,u=r;break}if(u<0)return this;u===0?t.shift():function(s,a){for(;a+1<s.length;a++)s[a]=s[a+1];s.pop()}(t,u),t.length===1&&(n[e]=t[0]),n.removeListener!==void 0&&this.emit("removeListener",e,i||o)}return this},Y.prototype.off=Y.prototype.removeListener,Y.prototype.removeAllListeners=function(e){var o,t,n;if((t=this._events)===void 0)return this;if(t.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):t[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete t[e]),this;if(arguments.length===0){var u,r=Object.keys(t);for(n=0;n<r.length;++n)(u=r[n])!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(o=t[e])=="function")this.removeListener(e,o);else if(o!==void 0)for(n=o.length-1;n>=0;n--)this.removeListener(e,o[n]);return this},Y.prototype.listeners=function(e){return ec(this,e,!0)},Y.prototype.rawListeners=function(e){return ec(this,e,!1)},Y.listenerCount=function(e,o){return typeof e.listenerCount=="function"?e.listenerCount(o):tc.call(e,o)},Y.prototype.listenerCount=tc,Y.prototype.eventNames=function(){return this._eventsCount>0?ic(this._events):[]},Be=rc,Be.EventEmitter,Be.defaultMaxListeners,Be.init,Be.listenerCount,Be.EventEmitter,Be.defaultMaxListeners,Be.init,Be.listenerCount}),nr={};Jt(nr,{EventEmitter:()=>Qb,default:()=>Be,defaultMaxListeners:()=>Yb,init:()=>Jb,listenerCount:()=>Xb,on:()=>Zb,once:()=>ew});var Qb,Yb,Jb,Xb,Zb,ew,sr=_e(()=>{_(),v(),m(),Fs(),Fs(),Be.once=function(e,o){return new Promise((t,n)=>{function u(...i){r!==void 0&&e.removeListener("error",r),t(i)}let r;o!=="error"&&(r=i=>{e.removeListener(name,u),n(i)},e.once("error",r)),e.once(o,u)})},Be.on=function(e,o){let t=[],n=[],u=null,r=!1,i={async next(){let c=t.shift();if(c)return createIterResult(c,!1);if(u){let h=Promise.reject(u);return u=null,h}return r?createIterResult(void 0,!0):new Promise((h,d)=>n.push({resolve:h,reject:d}))},async return(){e.removeListener(o,s),e.removeListener("error",a),r=!0;for(let c of n)c.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(c){u=c,e.removeListener(o,s),e.removeListener("error",a)},[Symbol.asyncIterator](){return this}};return e.on(o,s),e.on("error",a),i;function s(...c){let h=n.shift();h?h.resolve(createIterResult(c,!1)):t.push(c)}function a(c){r=!0;let h=n.shift();h?h.reject(c):u=c,i.return()}},{EventEmitter:Qb,defaultMaxListeners:Yb,init:Jb,listenerCount:Xb,on:Zb,once:ew}=Be}),nn=M((e,o)=>{_(),v(),m();var{ArrayIsArray:t,ObjectSetPrototypeOf:n}=ce(),{EventEmitter:u}=(sr(),X(nr));function r(s){u.call(this,s)}n(r.prototype,u.prototype),n(r,u),r.prototype.pipe=function(s,a){let c=this;function h(R){s.writable&&s.write(R)===!1&&c.pause&&c.pause()}c.on("data",h);function d(){c.readable&&c.resume&&c.resume()}s.on("drain",d),!s._isStdio&&(!a||a.end!==!1)&&(c.on("end",b),c.on("close",w));let g=!1;function b(){g||(g=!0,s.end())}function w(){g||(g=!0,typeof s.destroy=="function"&&s.destroy())}function E(R){T(),u.listenerCount(this,"error")===0&&this.emit("error",R)}i(c,"error",E),i(s,"error",E);function T(){c.removeListener("data",h),s.removeListener("drain",d),c.removeListener("end",b),c.removeListener("close",w),c.removeListener("error",E),s.removeListener("error",E),c.removeListener("end",T),c.removeListener("close",T),s.removeListener("close",T)}return c.on("end",T),c.on("close",T),s.on("close",T),s.emit("pipe",c),s};function i(s,a,c){if(typeof s.prependListener=="function")return s.prependListener(a,c);!s._events||!s._events[a]?s.on(a,c):t(s._events[a])?s._events[a].unshift(c):s._events[a]=[c,s._events[a]]}o.exports={Stream:r,prependListener:i}}),di=M((e,o)=>{_(),v(),m();var{AbortError:t,codes:n}=Ae(),{isNodeStream:u,isWebStream:r,kControllerErrorFunction:i}=tt(),s=vt(),{ERR_INVALID_ARG_TYPE:a}=n,c=(h,d)=>{if(typeof h!="object"||!("aborted"in h))throw new a(d,"AbortSignal",h)};o.exports.addAbortSignal=function(h,d){if(c(h,"signal"),!u(d)&&!r(d))throw new a("stream",["ReadableStream","WritableStream","Stream"],d);return o.exports.addAbortSignalNoValidate(h,d)},o.exports.addAbortSignalNoValidate=function(h,d){if(typeof h!="object"||!("aborted"in h))return d;let g=u(d)?()=>{d.destroy(new t(void 0,{cause:h.reason}))}:()=>{d[i](new t(void 0,{cause:h.reason}))};return h.aborted?g():(h.addEventListener("abort",g),s(d,()=>h.removeEventListener("abort",g))),d}}),dc=M((e,o)=>{_(),v(),m();var{StringPrototypeSlice:t,SymbolIterator:n,TypedArrayPrototypeSet:u,Uint8Array:r}=ce(),{Buffer:i}=(be(),X(me)),{inspect:s}=Je();o.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(a){let c={data:a,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length}unshift(a){let c={data:a,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length}shift(){if(this.length===0)return;let a=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,a}clear(){this.head=this.tail=null,this.length=0}join(a){if(this.length===0)return"";let c=this.head,h=""+c.data;for(;(c=c.next)!==null;)h+=a+c.data;return h}concat(a){if(this.length===0)return i.alloc(0);let c=i.allocUnsafe(a>>>0),h=this.head,d=0;for(;h;)u(c,h.data,d),d+=h.data.length,h=h.next;return c}consume(a,c){let h=this.head.data;if(a<h.length){let d=h.slice(0,a);return this.head.data=h.slice(a),d}return a===h.length?this.shift():c?this._getString(a):this._getBuffer(a)}first(){return this.head.data}*[n](){for(let a=this.head;a;a=a.next)yield a.data}_getString(a){let c="",h=this.head,d=0;do{let g=h.data;if(a>g.length)c+=g,a-=g.length;else{a===g.length?(c+=g,++d,h.next?this.head=h.next:this.head=this.tail=null):(c+=t(g,0,a),this.head=h,h.data=t(g,a));break}++d}while((h=h.next)!==null);return this.length-=d,c}_getBuffer(a){let c=i.allocUnsafe(a),h=a,d=this.head,g=0;do{let b=d.data;if(a>b.length)u(c,b,h-a),a-=b.length;else{a===b.length?(u(c,b,h-a),++g,d.next?this.head=d.next:this.head=this.tail=null):(u(c,new r(b.buffer,b.byteOffset,a),h-a),this.head=d,d.data=b.slice(a));break}++g}while((d=d.next)!==null);return this.length-=g,c}[Symbol.for("nodejs.util.inspect.custom")](a,c){return s(this,{...c,depth:0,customInspect:!1})}}}),an=M((e,o)=>{_(),v(),m();var{MathFloor:t,NumberIsInteger:n}=ce(),{ERR_INVALID_ARG_VALUE:u}=Ae().codes;function r(a,c,h){return a.highWaterMark!=null?a.highWaterMark:c?a[h]:null}function i(a){return a?16:16*1024}function s(a,c,h,d){let g=r(c,d,h);if(g!=null){if(!n(g)||g<0){let b=d?`options.${h}`:"options.highWaterMark";throw new u(b,g)}return t(g)}return i(a.objectMode)}o.exports={getHighWaterMark:s,getDefaultHighWaterMark:i}});function wc(e){var o=e.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");return t===-1&&(t=o),[t,t===o?0:4-t%4]}function gw(e,o,t){for(var n,u,r=[],i=o;i<t;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),r.push($e[(u=n)>>18&63]+$e[u>>12&63]+$e[u>>6&63]+$e[63&u]);return r.join("")}function Et(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var o=new Uint8Array(e);return Object.setPrototypeOf(o,O.prototype),o}function O(e,o,t){if(typeof e=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Ks(e)}return Cc(e,o,t)}function Cc(e,o,t){if(typeof e=="string")return function(r,i){if(typeof i=="string"&&i!==""||(i="utf8"),!O.isEncoding(i))throw new TypeError("Unknown encoding: "+i);var s=0|Pc(r,i),a=Et(s),c=a.write(r,i);return c!==s&&(a=a.slice(0,c)),a}(e,o);if(ArrayBuffer.isView(e))return Hs(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(St(e,ArrayBuffer)||e&&St(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(St(e,SharedArrayBuffer)||e&&St(e.buffer,SharedArrayBuffer)))return mc(e,o,t);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(n!=null&&n!==e)return O.from(n,o,t);var u=function(r){if(O.isBuffer(r)){var i=0|Ys(r.length),s=Et(i);return s.length===0||r.copy(s,0,0,i),s}if(r.length!==void 0)return typeof r.length!="number"||Js(r.length)?Et(0):Hs(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Hs(r.data)}(e);if(u)return u;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return O.from(e[Symbol.toPrimitive]("string"),o,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function Bc(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Ks(e){return Bc(e),Et(e<0?0:0|Ys(e))}function Hs(e){for(var o=e.length<0?0:0|Ys(e.length),t=Et(o),n=0;n<o;n+=1)t[n]=255&e[n];return t}function mc(e,o,t){if(o<0||e.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<o+(t||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=o===void 0&&t===void 0?new Uint8Array(e):t===void 0?new Uint8Array(e,o):new Uint8Array(e,o,t),Object.setPrototypeOf(n,O.prototype),n}function Ys(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function Pc(e,o){if(O.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||St(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var t=e.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;for(var u=!1;;)switch(o){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Gs(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Mc(e).length;default:if(u)return n?-1:Gs(e).length;o=(""+o).toLowerCase(),u=!0}}function bw(e,o,t){var n=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0)<=(o>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Tw(this,o,t);case"utf8":case"utf-8":return Oc(this,o,t);case"ascii":return Aw(this,o,t);case"latin1":case"binary":return Iw(this,o,t);case"base64":return Sw(this,o,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rw(this,o,t);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function ar(e,o,t){var n=e[o];e[o]=e[t],e[t]=n}function vc(e,o,t,n,u){if(e.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),Js(t=+t)&&(t=u?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(u)return-1;t=e.length-1}else if(t<0){if(!u)return-1;t=0}if(typeof o=="string"&&(o=O.from(o,n)),O.isBuffer(o))return o.length===0?-1:Ec(e,o,t,n,u);if(typeof o=="number")return o&=255,typeof Uint8Array.prototype.indexOf=="function"?u?Uint8Array.prototype.indexOf.call(e,o,t):Uint8Array.prototype.lastIndexOf.call(e,o,t):Ec(e,[o],t,n,u);throw new TypeError("val must be string, number or Buffer")}function Ec(e,o,t,n,u){var r,i=1,s=e.length,a=o.length;if(n!==void 0&&((n=String(n).toLowerCase())==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(e.length<2||o.length<2)return-1;i=2,s/=2,a/=2,t/=2}function c(b,w){return i===1?b[w]:b.readUInt16BE(w*i)}if(u){var h=-1;for(r=t;r<s;r++)if(c(e,r)===c(o,h===-1?0:r-h)){if(h===-1&&(h=r),r-h+1===a)return h*i}else h!==-1&&(r-=r-h),h=-1}else for(t+a>s&&(t=s-a),r=t;r>=0;r--){for(var d=!0,g=0;g<a;g++)if(c(e,r+g)!==c(o,g)){d=!1;break}if(d)return r}return-1}function ww(e,o,t,n){t=Number(t)||0;var u=e.length-t;n?(n=Number(n))>u&&(n=u):n=u;var r=o.length;n>r/2&&(n=r/2);for(var i=0;i<n;++i){var s=parseInt(o.substr(2*i,2),16);if(Js(s))return i;e[t+i]=s}return i}function _w(e,o,t,n){return cn(Gs(o,e.length-t),e,t,n)}function kc(e,o,t,n){return cn(function(u){for(var r=[],i=0;i<u.length;++i)r.push(255&u.charCodeAt(i));return r}(o),e,t,n)}function mw(e,o,t,n){return kc(e,o,t,n)}function vw(e,o,t,n){return cn(Mc(o),e,t,n)}function Ew(e,o,t,n){return cn(function(u,r){for(var i,s,a,c=[],h=0;h<u.length&&!((r-=2)<0);++h)i=u.charCodeAt(h),s=i>>8,a=i%256,c.push(a),c.push(s);return c}(o,e.length-t),e,t,n)}function Sw(e,o,t){return o===0&&t===e.length?zs.fromByteArray(e):zs.fromByteArray(e.slice(o,t))}function Oc(e,o,t){t=Math.min(e.length,t);for(var n=[],u=o;u<t;){var r,i,s,a,c=e[u],h=null,d=c>239?4:c>223?3:c>191?2:1;if(u+d<=t)switch(d){case 1:c<128&&(h=c);break;case 2:(192&(r=e[u+1]))==128&&(a=(31&c)<<6|63&r)>127&&(h=a);break;case 3:r=e[u+1],i=e[u+2],(192&r)==128&&(192&i)==128&&(a=(15&c)<<12|(63&r)<<6|63&i)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:r=e[u+1],i=e[u+2],s=e[u+3],(192&r)==128&&(192&i)==128&&(192&s)==128&&(a=(15&c)<<18|(63&r)<<12|(63&i)<<6|63&s)>65535&&a<1114112&&(h=a)}h===null?(h=65533,d=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),u+=d}return function(g){var b=g.length;if(b<=4096)return String.fromCharCode.apply(String,g);for(var w="",E=0;E<b;)w+=String.fromCharCode.apply(String,g.slice(E,E+=4096));return w}(n)}function Aw(e,o,t){var n="";t=Math.min(e.length,t);for(var u=o;u<t;++u)n+=String.fromCharCode(127&e[u]);return n}function Iw(e,o,t){var n="";t=Math.min(e.length,t);for(var u=o;u<t;++u)n+=String.fromCharCode(e[u]);return n}function Tw(e,o,t){var n=e.length;(!o||o<0)&&(o=0),(!t||t<0||t>n)&&(t=n);for(var u="",r=o;r<t;++r)u+=Bw[e[r]];return u}function Rw(e,o,t){for(var n=e.slice(o,t),u="",r=0;r<n.length;r+=2)u+=String.fromCharCode(n[r]+256*n[r+1]);return u}function we(e,o,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+o>t)throw new RangeError("Trying to access beyond buffer length")}function Pe(e,o,t,n,u,r){if(!O.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>u||o<r)throw new RangeError('"value" argument is out of bounds');if(t+n>e.length)throw new RangeError("Index out of range")}function xc(e,o,t,n,u,r){if(t+n>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Sc(e,o,t,n,u){return o=+o,t>>>=0,u||xc(e,0,t,4),Dr.write(e,o,t,n,23,4),t+4}function Ac(e,o,t,n,u){return o=+o,t>>>=0,u||xc(e,0,t,8),Dr.write(e,o,t,n,52,8),t+8}function Gs(e,o){var t;o=o||1/0;for(var n=e.length,u=null,r=[],i=0;i<n;++i){if((t=e.charCodeAt(i))>55295&&t<57344){if(!u){if(t>56319){(o-=3)>-1&&r.push(239,191,189);continue}if(i+1===n){(o-=3)>-1&&r.push(239,191,189);continue}u=t;continue}if(t<56320){(o-=3)>-1&&r.push(239,191,189),u=t;continue}t=65536+(u-55296<<10|t-56320)}else u&&(o-=3)>-1&&r.push(239,191,189);if(u=null,t<128){if((o-=1)<0)break;r.push(t)}else if(t<2048){if((o-=2)<0)break;r.push(t>>6|192,63&t|128)}else if(t<65536){if((o-=3)<0)break;r.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((o-=4)<0)break;r.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return r}function Mc(e){return zs.toByteArray(function(o){if((o=(o=o.split("=")[0]).trim().replace(Cw,"")).length<2)return"";for(;o.length%4!=0;)o+="=";return o}(e))}function cn(e,o,t,n){for(var u=0;u<n&&!(u+t>=o.length||u>=e.length);++u)o[u+t]=e[u];return u}function St(e,o){return e instanceof o||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===o.name}function Js(e){return e!=e}function Ic(e,o){for(var t in e)o[t]=e[t]}function lr(e,o,t){return it(e,o,t)}function pi(e){var o;switch(this.encoding=function(t){var n=function(u){if(!u)return"utf8";for(var r;;)switch(u){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return u;default:if(r)return;u=(""+u).toLowerCase(),r=!0}}(t);if(typeof n!="string"&&(Qs.isEncoding===Tc||!Tc(t)))throw new Error("Unknown encoding: "+t);return n||t}(e),this.encoding){case"utf16le":this.text=Ow,this.end=xw,o=4;break;case"utf8":this.fillLast=kw,o=4;break;case"base64":this.text=Mw,this.end=Lw,o=3;break;default:return this.write=Uw,this.end=Nw,void 0}this.lastNeed=0,this.lastTotal=0,this.lastChar=Qs.allocUnsafe(o)}function Vs(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function kw(e){var o=this.lastTotal-this.lastNeed,t=function(n,u,r){if((192&u[0])!=128)return n.lastNeed=0,"�";if(n.lastNeed>1&&u.length>1){if((192&u[1])!=128)return n.lastNeed=1,"�";if(n.lastNeed>2&&u.length>2&&(192&u[2])!=128)return n.lastNeed=2,"�"}}(this,e);return t!==void 0?t:this.lastNeed<=e.length?(e.copy(this.lastChar,o,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,o,0,e.length),this.lastNeed-=e.length,void 0)}function Ow(e,o){if((e.length-o)%2==0){var t=e.toString("utf16le",o);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",o,e.length-1)}function xw(e){var o=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return o+this.lastChar.toString("utf16le",0,t)}return o}function Mw(e,o){var t=(e.length-o)%3;return t===0?e.toString("base64",o):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",o,e.length-t))}function Lw(e){var o=e&&e.length?this.write(e):"";return this.lastNeed?o+this.lastChar.toString("base64",0,3-this.lastNeed):o}function Uw(e){return e.toString(this.encoding)}function Nw(e){return e&&e.length?this.write(e):""}var Rc,$e,Oe,yc,ln,or,bc,yw,At,zs,Dr,_c,Cw,Bw,un,fn,it,Pw,ur,Qs,Tc,Xs=_e(()=>{for(_(),v(),m(),Rc={byteLength:function(e){var o=wc(e),t=o[0],n=o[1];return 3*(t+n)/4-n},toByteArray:function(e){var o,t,n=wc(e),u=n[0],r=n[1],i=new yc(function(c,h,d){return 3*(h+d)/4-d}(0,u,r)),s=0,a=r>0?u-4:u;for(t=0;t<a;t+=4)o=Oe[e.charCodeAt(t)]<<18|Oe[e.charCodeAt(t+1)]<<12|Oe[e.charCodeAt(t+2)]<<6|Oe[e.charCodeAt(t+3)],i[s++]=o>>16&255,i[s++]=o>>8&255,i[s++]=255&o;return r===2&&(o=Oe[e.charCodeAt(t)]<<2|Oe[e.charCodeAt(t+1)]>>4,i[s++]=255&o),r===1&&(o=Oe[e.charCodeAt(t)]<<10|Oe[e.charCodeAt(t+1)]<<4|Oe[e.charCodeAt(t+2)]>>2,i[s++]=o>>8&255,i[s++]=255&o),i},fromByteArray:function(e){for(var o,t=e.length,n=t%3,u=[],r=0,i=t-n;r<i;r+=16383)u.push(gw(e,r,r+16383>i?i:r+16383));return n===1?(o=e[t-1],u.push($e[o>>2]+$e[o<<4&63]+"==")):n===2&&(o=(e[t-2]<<8)+e[t-1],u.push($e[o>>10]+$e[o>>4&63]+$e[o<<2&63]+"=")),u.join("")}},$e=[],Oe=[],yc=typeof Uint8Array<"u"?Uint8Array:Array,ln="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",or=0,bc=ln.length;or<bc;++or)$e[or]=ln[or],Oe[ln.charCodeAt(or)]=or;Oe[45]=62,Oe[95]=63,yw={read:function(e,o,t,n,u){var r,i,s=8*u-n-1,a=(1<<s)-1,c=a>>1,h=-7,d=t?u-1:0,g=t?-1:1,b=e[o+d];for(d+=g,r=b&(1<<-h)-1,b>>=-h,h+=s;h>0;r=256*r+e[o+d],d+=g,h-=8);for(i=r&(1<<-h)-1,r>>=-h,h+=n;h>0;i=256*i+e[o+d],d+=g,h-=8);if(r===0)r=1-c;else{if(r===a)return i?NaN:1/0*(b?-1:1);i+=Math.pow(2,n),r-=c}return(b?-1:1)*i*Math.pow(2,r-n)},write:function(e,o,t,n,u,r){var i,s,a,c=8*r-u-1,h=(1<<c)-1,d=h>>1,g=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:r-1,w=n?1:-1,E=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(s=isNaN(o)?1:0,i=h):(i=Math.floor(Math.log(o)/Math.LN2),o*(a=Math.pow(2,-i))<1&&(i--,a*=2),(o+=i+d>=1?g/a:g*Math.pow(2,1-d))*a>=2&&(i++,a/=2),i+d>=h?(s=0,i=h):i+d>=1?(s=(o*a-1)*Math.pow(2,u),i+=d):(s=o*Math.pow(2,d-1)*Math.pow(2,u),i=0));u>=8;e[t+b]=255&s,b+=w,s/=256,u-=8);for(i=i<<u|s,c+=u;c>0;e[t+b]=255&i,b+=w,i/=256,c-=8);e[t+b-w]|=128*E}},At={},zs=Rc,Dr=yw,_c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,At.Buffer=O,At.SlowBuffer=function(e){return+e!=e&&(e=0),O.alloc(+e)},At.INSPECT_MAX_BYTES=50,At.kMaxLength=2147483647,O.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(e,o),e.foo()===42}catch{return!1}}(),O.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(O.prototype,"parent",{enumerable:!0,get:function(){if(O.isBuffer(this))return this.buffer}}),Object.defineProperty(O.prototype,"offset",{enumerable:!0,get:function(){if(O.isBuffer(this))return this.byteOffset}}),O.poolSize=8192,O.from=function(e,o,t){return Cc(e,o,t)},Object.setPrototypeOf(O.prototype,Uint8Array.prototype),Object.setPrototypeOf(O,Uint8Array),O.alloc=function(e,o,t){return function(n,u,r){return Bc(n),n<=0?Et(n):u!==void 0?typeof r=="string"?Et(n).fill(u,r):Et(n).fill(u):Et(n)}(e,o,t)},O.allocUnsafe=function(e){return Ks(e)},O.allocUnsafeSlow=function(e){return Ks(e)},O.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==O.prototype},O.compare=function(e,o){if(St(e,Uint8Array)&&(e=O.from(e,e.offset,e.byteLength)),St(o,Uint8Array)&&(o=O.from(o,o.offset,o.byteLength)),!O.isBuffer(e)||!O.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===o)return 0;for(var t=e.length,n=o.length,u=0,r=Math.min(t,n);u<r;++u)if(e[u]!==o[u]){t=e[u],n=o[u];break}return t<n?-1:n<t?1:0},O.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},O.concat=function(e,o){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return O.alloc(0);var t;if(o===void 0)for(o=0,t=0;t<e.length;++t)o+=e[t].length;var n=O.allocUnsafe(o),u=0;for(t=0;t<e.length;++t){var r=e[t];if(St(r,Uint8Array)&&(r=O.from(r)),!O.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(n,u),u+=r.length}return n},O.byteLength=Pc,O.prototype._isBuffer=!0,O.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var o=0;o<e;o+=2)ar(this,o,o+1);return this},O.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var o=0;o<e;o+=4)ar(this,o,o+3),ar(this,o+1,o+2);return this},O.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var o=0;o<e;o+=8)ar(this,o,o+7),ar(this,o+1,o+6),ar(this,o+2,o+5),ar(this,o+3,o+4);return this},O.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?Oc(this,0,e):bw.apply(this,arguments)},O.prototype.toLocaleString=O.prototype.toString,O.prototype.equals=function(e){if(!O.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||O.compare(this,e)===0},O.prototype.inspect=function(){var e="",o=At.INSPECT_MAX_BYTES;return e=this.toString("hex",0,o).replace(/(.{2})/g,"$1 ").trim(),this.length>o&&(e+=" ... "),"<Buffer "+e+">"},_c&&(O.prototype[_c]=O.prototype.inspect),O.prototype.compare=function(e,o,t,n,u){if(St(e,Uint8Array)&&(e=O.from(e,e.offset,e.byteLength)),!O.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(o===void 0&&(o=0),t===void 0&&(t=e?e.length:0),n===void 0&&(n=0),u===void 0&&(u=this.length),o<0||t>e.length||n<0||u>this.length)throw new RangeError("out of range index");if(n>=u&&o>=t)return 0;if(n>=u)return-1;if(o>=t)return 1;if(this===e)return 0;for(var r=(u>>>=0)-(n>>>=0),i=(t>>>=0)-(o>>>=0),s=Math.min(r,i),a=this.slice(n,u),c=e.slice(o,t),h=0;h<s;++h)if(a[h]!==c[h]){r=a[h],i=c[h];break}return r<i?-1:i<r?1:0},O.prototype.includes=function(e,o,t){return this.indexOf(e,o,t)!==-1},O.prototype.indexOf=function(e,o,t){return vc(this,e,o,t,!0)},O.prototype.lastIndexOf=function(e,o,t){return vc(this,e,o,t,!1)},O.prototype.write=function(e,o,t,n){if(o===void 0)n="utf8",t=this.length,o=0;else if(t===void 0&&typeof o=="string")n=o,t=this.length,o=0;else{if(!isFinite(o))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");o>>>=0,isFinite(t)?(t>>>=0,n===void 0&&(n="utf8")):(n=t,t=void 0)}var u=this.length-o;if((t===void 0||t>u)&&(t=u),e.length>0&&(t<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r=!1;;)switch(n){case"hex":return ww(this,e,o,t);case"utf8":case"utf-8":return _w(this,e,o,t);case"ascii":return kc(this,e,o,t);case"latin1":case"binary":return mw(this,e,o,t);case"base64":return vw(this,e,o,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ew(this,e,o,t);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),r=!0}},O.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},O.prototype.slice=function(e,o){var t=this.length;(e=~~e)<0?(e+=t)<0&&(e=0):e>t&&(e=t),(o=o===void 0?t:~~o)<0?(o+=t)<0&&(o=0):o>t&&(o=t),o<e&&(o=e);var n=this.subarray(e,o);return Object.setPrototypeOf(n,O.prototype),n},O.prototype.readUIntLE=function(e,o,t){e>>>=0,o>>>=0,t||we(e,o,this.length);for(var n=this[e],u=1,r=0;++r<o&&(u*=256);)n+=this[e+r]*u;return n},O.prototype.readUIntBE=function(e,o,t){e>>>=0,o>>>=0,t||we(e,o,this.length);for(var n=this[e+--o],u=1;o>0&&(u*=256);)n+=this[e+--o]*u;return n},O.prototype.readUInt8=function(e,o){return e>>>=0,o||we(e,1,this.length),this[e]},O.prototype.readUInt16LE=function(e,o){return e>>>=0,o||we(e,2,this.length),this[e]|this[e+1]<<8},O.prototype.readUInt16BE=function(e,o){return e>>>=0,o||we(e,2,this.length),this[e]<<8|this[e+1]},O.prototype.readUInt32LE=function(e,o){return e>>>=0,o||we(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},O.prototype.readUInt32BE=function(e,o){return e>>>=0,o||we(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},O.prototype.readIntLE=function(e,o,t){e>>>=0,o>>>=0,t||we(e,o,this.length);for(var n=this[e],u=1,r=0;++r<o&&(u*=256);)n+=this[e+r]*u;return n>=(u*=128)&&(n-=Math.pow(2,8*o)),n},O.prototype.readIntBE=function(e,o,t){e>>>=0,o>>>=0,t||we(e,o,this.length);for(var n=o,u=1,r=this[e+--n];n>0&&(u*=256);)r+=this[e+--n]*u;return r>=(u*=128)&&(r-=Math.pow(2,8*o)),r},O.prototype.readInt8=function(e,o){return e>>>=0,o||we(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},O.prototype.readInt16LE=function(e,o){e>>>=0,o||we(e,2,this.length);var t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},O.prototype.readInt16BE=function(e,o){e>>>=0,o||we(e,2,this.length);var t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},O.prototype.readInt32LE=function(e,o){return e>>>=0,o||we(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},O.prototype.readInt32BE=function(e,o){return e>>>=0,o||we(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},O.prototype.readFloatLE=function(e,o){return e>>>=0,o||we(e,4,this.length),Dr.read(this,e,!0,23,4)},O.prototype.readFloatBE=function(e,o){return e>>>=0,o||we(e,4,this.length),Dr.read(this,e,!1,23,4)},O.prototype.readDoubleLE=function(e,o){return e>>>=0,o||we(e,8,this.length),Dr.read(this,e,!0,52,8)},O.prototype.readDoubleBE=function(e,o){return e>>>=0,o||we(e,8,this.length),Dr.read(this,e,!1,52,8)},O.prototype.writeUIntLE=function(e,o,t,n){e=+e,o>>>=0,t>>>=0,n||Pe(this,e,o,t,Math.pow(2,8*t)-1,0);var u=1,r=0;for(this[o]=255&e;++r<t&&(u*=256);)this[o+r]=e/u&255;return o+t},O.prototype.writeUIntBE=function(e,o,t,n){e=+e,o>>>=0,t>>>=0,n||Pe(this,e,o,t,Math.pow(2,8*t)-1,0);var u=t-1,r=1;for(this[o+u]=255&e;--u>=0&&(r*=256);)this[o+u]=e/r&255;return o+t},O.prototype.writeUInt8=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,1,255,0),this[o]=255&e,o+1},O.prototype.writeUInt16LE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,2,65535,0),this[o]=255&e,this[o+1]=e>>>8,o+2},O.prototype.writeUInt16BE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,2,65535,0),this[o]=e>>>8,this[o+1]=255&e,o+2},O.prototype.writeUInt32LE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,4,4294967295,0),this[o+3]=e>>>24,this[o+2]=e>>>16,this[o+1]=e>>>8,this[o]=255&e,o+4},O.prototype.writeUInt32BE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,4,4294967295,0),this[o]=e>>>24,this[o+1]=e>>>16,this[o+2]=e>>>8,this[o+3]=255&e,o+4},O.prototype.writeIntLE=function(e,o,t,n){if(e=+e,o>>>=0,!n){var u=Math.pow(2,8*t-1);Pe(this,e,o,t,u-1,-u)}var r=0,i=1,s=0;for(this[o]=255&e;++r<t&&(i*=256);)e<0&&s===0&&this[o+r-1]!==0&&(s=1),this[o+r]=(e/i>>0)-s&255;return o+t},O.prototype.writeIntBE=function(e,o,t,n){if(e=+e,o>>>=0,!n){var u=Math.pow(2,8*t-1);Pe(this,e,o,t,u-1,-u)}var r=t-1,i=1,s=0;for(this[o+r]=255&e;--r>=0&&(i*=256);)e<0&&s===0&&this[o+r+1]!==0&&(s=1),this[o+r]=(e/i>>0)-s&255;return o+t},O.prototype.writeInt8=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,1,127,-128),e<0&&(e=255+e+1),this[o]=255&e,o+1},O.prototype.writeInt16LE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,2,32767,-32768),this[o]=255&e,this[o+1]=e>>>8,o+2},O.prototype.writeInt16BE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,2,32767,-32768),this[o]=e>>>8,this[o+1]=255&e,o+2},O.prototype.writeInt32LE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,4,2147483647,-2147483648),this[o]=255&e,this[o+1]=e>>>8,this[o+2]=e>>>16,this[o+3]=e>>>24,o+4},O.prototype.writeInt32BE=function(e,o,t){return e=+e,o>>>=0,t||Pe(this,e,o,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[o]=e>>>24,this[o+1]=e>>>16,this[o+2]=e>>>8,this[o+3]=255&e,o+4},O.prototype.writeFloatLE=function(e,o,t){return Sc(this,e,o,!0,t)},O.prototype.writeFloatBE=function(e,o,t){return Sc(this,e,o,!1,t)},O.prototype.writeDoubleLE=function(e,o,t){return Ac(this,e,o,!0,t)},O.prototype.writeDoubleBE=function(e,o,t){return Ac(this,e,o,!1,t)},O.prototype.copy=function(e,o,t,n){if(!O.isBuffer(e))throw new TypeError("argument should be a Buffer");if(t||(t=0),n||n===0||(n=this.length),o>=e.length&&(o=e.length),o||(o=0),n>0&&n<t&&(n=t),n===t||e.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-o<n-t&&(n=e.length-o+t);var u=n-t;if(this===e&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(o,t,n);else if(this===e&&t<o&&o<n)for(var r=u-1;r>=0;--r)e[r+o]=this[r+t];else Uint8Array.prototype.set.call(e,this.subarray(t,n),o);return u},O.prototype.fill=function(e,o,t,n){if(typeof e=="string"){if(typeof o=="string"?(n=o,o=0,t=this.length):typeof t=="string"&&(n=t,t=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!O.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){var u=e.charCodeAt(0);(n==="utf8"&&u<128||n==="latin1")&&(e=u)}}else typeof e=="number"?e&=255:typeof e=="boolean"&&(e=Number(e));if(o<0||this.length<o||this.length<t)throw new RangeError("Out of range index");if(t<=o)return this;var r;if(o>>>=0,t=t===void 0?this.length:t>>>0,e||(e=0),typeof e=="number")for(r=o;r<t;++r)this[r]=e;else{var i=O.isBuffer(e)?e:O.from(e,n),s=i.length;if(s===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<t-o;++r)this[r+o]=i[r%s]}return this},Cw=/[^+/0-9A-Za-z-_]/g,Bw=function(){for(var e=new Array(256),o=0;o<16;++o)for(var t=16*o,n=0;n<16;++n)e[t+n]="0123456789abcdef"[o]+"0123456789abcdef"[n];return e}(),At.Buffer,At.INSPECT_MAX_BYTES,At.kMaxLength,un={},fn=At,it=fn.Buffer,it.from&&it.alloc&&it.allocUnsafe&&it.allocUnsafeSlow?un=fn:(Ic(fn,un),un.Buffer=lr),lr.prototype=Object.create(it.prototype),Ic(it,lr),lr.from=function(e,o,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return it(e,o,t)},lr.alloc=function(e,o,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=it(e);return o!==void 0?typeof t=="string"?n.fill(o,t):n.fill(o):n.fill(0),n},lr.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return it(e)},lr.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return fn.SlowBuffer(e)},Pw=un,ur={},Qs=Pw.Buffer,Tc=Qs.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},ur.StringDecoder=pi,pi.prototype.write=function(e){if(e.length===0)return"";var o,t;if(this.lastNeed){if((o=this.fillLast(e))===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?o?o+this.text(e,t):this.text(e,t):o||""},pi.prototype.end=function(e){var o=e&&e.length?this.write(e):"";return this.lastNeed?o+"�":o},pi.prototype.text=function(e,o){var t=function(u,r,i){var s=r.length-1;if(s<i)return 0;var a=Vs(r[s]);return a>=0?(a>0&&(u.lastNeed=a-1),a):--s<i||a===-2?0:(a=Vs(r[s]))>=0?(a>0&&(u.lastNeed=a-2),a):--s<i||a===-2?0:(a=Vs(r[s]))>=0?(a>0&&(a===2?a=0:u.lastNeed=a-3),a):0}(this,e,o);if(!this.lastNeed)return e.toString("utf8",o);this.lastTotal=t;var n=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",o,n)},pi.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},ur.StringDecoder,ur.StringDecoder}),Lc={};Jt(Lc,{StringDecoder:()=>qw,default:()=>ur});var qw,Uc=_e(()=>{_(),v(),m(),Xs(),Xs(),qw=ur.StringDecoder}),Zs=M((e,o)=>{_(),v(),m();var t=Nt(),{PromisePrototypeThen:n,SymbolAsyncIterator:u,SymbolIterator:r}=ce(),{Buffer:i}=(be(),X(me)),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_NULL_VALUES:a}=Ae().codes;function c(h,d,g){let b;if(typeof d=="string"||d instanceof i)return new h({objectMode:!0,...g,read(){this.push(d),this.push(null)}});let w;if(d&&d[u])w=!0,b=d[u]();else if(d&&d[r])w=!1,b=d[r]();else throw new s("iterable",["Iterable"],d);let E=new h({objectMode:!0,highWaterMark:1,...g}),T=!1;E._read=function(){T||(T=!0,I())},E._destroy=function(k,W){n(R(k),()=>t.nextTick(W,k),Q=>t.nextTick(W,Q||k))};async function R(k){let W=k!=null,Q=typeof b.throw=="function";if(W&&Q){let{value:U,done:D}=await b.throw(k);if(await U,D)return}if(typeof b.return=="function"){let{value:U}=await b.return();await U}}async function I(){for(;;){try{let{value:k,done:W}=w?await b.next():b.next();if(W)E.push(null);else{let Q=k&&typeof k.then=="function"?await k:k;if(Q===null)throw T=!1,new a;if(E.push(Q))continue;T=!1}}catch(k){E.destroy(k)}break}}return E}o.exports=c}),gi=M((e,o)=>{_(),v(),m();var t=Nt(),{ArrayPrototypeIndexOf:n,NumberIsInteger:u,NumberIsNaN:r,NumberParseInt:i,ObjectDefineProperties:s,ObjectKeys:a,ObjectSetPrototypeOf:c,Promise:h,SafeSet:d,SymbolAsyncIterator:g,Symbol:b}=ce();o.exports=S,S.ReadableState=ie;var{EventEmitter:w}=(sr(),X(nr)),{Stream:E,prependListener:T}=nn(),{Buffer:R}=(be(),X(me)),{addAbortSignal:I}=di(),k=vt(),W=Je().debuglog("stream",f=>{W=f}),Q=dc(),U=ir(),{getHighWaterMark:D,getDefaultHighWaterMark:V}=an(),{aggregateTwoErrors:ae,codes:{ERR_INVALID_ARG_TYPE:$,ERR_METHOD_NOT_IMPLEMENTED:xe,ERR_OUT_OF_RANGE:N,ERR_STREAM_PUSH_AFTER_EOF:le,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:Le}}=Ae(),{validateObject:ge}=hi(),qe=b("kPaused"),{StringDecoder:We}=(Uc(),X(Lc)),H=Zs();c(S.prototype,E.prototype),c(S,E);var ye=()=>{},{errorOrDestroy:G}=U;function ie(f,y,A){typeof A!="boolean"&&(A=y instanceof nt()),this.objectMode=!!(f&&f.objectMode),A&&(this.objectMode=this.objectMode||!!(f&&f.readableObjectMode)),this.highWaterMark=f?D(this,f,"readableHighWaterMark",A):V(!1),this.buffer=new Q,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[qe]=null,this.errorEmitted=!1,this.emitClose=!f||f.emitClose!==!1,this.autoDestroy=!f||f.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=f&&f.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,f&&f.encoding&&(this.decoder=new We(f.encoding),this.encoding=f.encoding)}function S(f){if(!(this instanceof S))return new S(f);let y=this instanceof nt();this._readableState=new ie(f,this,y),f&&(typeof f.read=="function"&&(this._read=f.read),typeof f.destroy=="function"&&(this._destroy=f.destroy),typeof f.construct=="function"&&(this._construct=f.construct),f.signal&&!y&&I(f.signal,this)),E.call(this,f),U.construct(this,()=>{this._readableState.needReadable&&ve(this,this._readableState)})}S.prototype.destroy=U.destroy,S.prototype._undestroy=U.undestroy,S.prototype._destroy=function(f,y){y(f)},S.prototype[w.captureRejectionSymbol]=function(f){this.destroy(f)},S.prototype.push=function(f,y){return J(this,f,y,!1)},S.prototype.unshift=function(f,y){return J(this,f,y,!0)};function J(f,y,A,j){W("readableAddChunk",y);let se=f._readableState,Ne;if(se.objectMode||(typeof y=="string"?(A=A||se.defaultEncoding,se.encoding!==A&&(j&&se.encoding?y=R.from(y,A).toString(se.encoding):(y=R.from(y,A),A=""))):y instanceof R?A="":E._isUint8Array(y)?(y=E._uint8ArrayToBuffer(y),A=""):y!=null&&(Ne=new $("chunk",["string","Buffer","Uint8Array"],y))),Ne)G(f,Ne);else if(y===null)se.reading=!1,C(f,se);else if(se.objectMode||y&&y.length>0)if(j)if(se.endEmitted)G(f,new Le);else{if(se.destroyed||se.errored)return!1;pe(f,se,y,!0)}else if(se.ended)G(f,new le);else{if(se.destroyed||se.errored)return!1;se.reading=!1,se.decoder&&!A?(y=se.decoder.write(y),se.objectMode||y.length!==0?pe(f,se,y,!1):ve(f,se)):pe(f,se,y,!1)}else j||(se.reading=!1,ve(f,se));return!se.ended&&(se.length<se.highWaterMark||se.length===0)}function pe(f,y,A,j){y.flowing&&y.length===0&&!y.sync&&f.listenerCount("data")>0?(y.multiAwaitDrain?y.awaitDrainWriters.clear():y.awaitDrainWriters=null,y.dataEmitted=!0,f.emit("data",A)):(y.length+=y.objectMode?1:A.length,j?y.buffer.unshift(A):y.buffer.push(A),y.needReadable&&oe(f)),ve(f,y)}S.prototype.isPaused=function(){let f=this._readableState;return f[qe]===!0||f.flowing===!1},S.prototype.setEncoding=function(f){let y=new We(f);this._readableState.decoder=y,this._readableState.encoding=this._readableState.decoder.encoding;let A=this._readableState.buffer,j="";for(let se of A)j+=y.write(se);return A.clear(),j!==""&&A.push(j),this._readableState.length=j.length,this};var Te=1073741824;function Se(f){if(f>Te)throw new N("size","<= 1GiB",f);return f--,f|=f>>>1,f|=f>>>2,f|=f>>>4,f|=f>>>8,f|=f>>>16,f++,f}function P(f,y){return f<=0||y.length===0&&y.ended?0:y.objectMode?1:r(f)?y.flowing&&y.length?y.buffer.first().length:y.length:f<=y.length?f:y.ended?y.length:0}S.prototype.read=function(f){W("read",f),f===void 0?f=NaN:u(f)||(f=i(f,10));let y=this._readableState,A=f;if(f>y.highWaterMark&&(y.highWaterMark=Se(f)),f!==0&&(y.emittedReadable=!1),f===0&&y.needReadable&&((y.highWaterMark!==0?y.length>=y.highWaterMark:y.length>0)||y.ended))return W("read: emitReadable",y.length,y.ended),y.length===0&&y.ended?F(this):oe(this),null;if(f=P(f,y),f===0&&y.ended)return y.length===0&&F(this),null;let j=y.needReadable;if(W("need readable",j),(y.length===0||y.length-f<y.highWaterMark)&&(j=!0,W("length less than watermark",j)),y.ended||y.reading||y.destroyed||y.errored||!y.constructed)j=!1,W("reading, ended or constructing",j);else if(j){W("do read"),y.reading=!0,y.sync=!0,y.length===0&&(y.needReadable=!0);try{this._read(y.highWaterMark)}catch(Ne){G(this,Ne)}y.sync=!1,y.reading||(f=P(A,y))}let se;return f>0?se=de(f,y):se=null,se===null?(y.needReadable=y.length<=y.highWaterMark,f=0):(y.length-=f,y.multiAwaitDrain?y.awaitDrainWriters.clear():y.awaitDrainWriters=null),y.length===0&&(y.ended||(y.needReadable=!0),A!==f&&y.ended&&F(this)),se!==null&&!y.errorEmitted&&!y.closeEmitted&&(y.dataEmitted=!0,this.emit("data",se)),se};function C(f,y){if(W("onEofChunk"),!y.ended){if(y.decoder){let A=y.decoder.end();A&&A.length&&(y.buffer.push(A),y.length+=y.objectMode?1:A.length)}y.ended=!0,y.sync?oe(f):(y.needReadable=!1,y.emittedReadable=!0,Ce(f))}}function oe(f){let y=f._readableState;W("emitReadable",y.needReadable,y.emittedReadable),y.needReadable=!1,y.emittedReadable||(W("emitReadable",y.flowing),y.emittedReadable=!0,t.nextTick(Ce,f))}function Ce(f){let y=f._readableState;W("emitReadable_",y.destroyed,y.length,y.ended),!y.destroyed&&!y.errored&&(y.length||y.ended)&&(f.emit("readable"),y.emittedReadable=!1),y.needReadable=!y.flowing&&!y.ended&&y.length<=y.highWaterMark,De(f)}function ve(f,y){!y.readingMore&&y.constructed&&(y.readingMore=!0,t.nextTick(he,f,y))}function he(f,y){for(;!y.reading&&!y.ended&&(y.length<y.highWaterMark||y.flowing&&y.length===0);){let A=y.length;if(W("maybeReadMore read 0"),f.read(0),A===y.length)break}y.readingMore=!1}S.prototype._read=function(f){throw new xe("_read()")},S.prototype.pipe=function(f,y){let A=this,j=this._readableState;j.pipes.length===1&&(j.multiAwaitDrain||(j.multiAwaitDrain=!0,j.awaitDrainWriters=new d(j.awaitDrainWriters?[j.awaitDrainWriters]:[]))),j.pipes.push(f),W("pipe count=%d opts=%j",j.pipes.length,y);let se=(!y||y.end!==!1)&&f!==t.stdout&&f!==t.stderr?Ke:_t;j.endEmitted?t.nextTick(se):A.once("end",se),f.on("unpipe",Ne);function Ne(Re,He){W("onunpipe"),Re===A&&He&&He.hasUnpiped===!1&&(He.hasUnpiped=!0,Ye())}function Ke(){W("onend"),f.end()}let rt,st=!1;function Ye(){W("cleanup"),f.removeListener("close",yt),f.removeListener("finish",mt),rt&&f.removeListener("drain",rt),f.removeListener("error",ct),f.removeListener("unpipe",Ne),A.removeListener("end",Ke),A.removeListener("end",_t),A.removeListener("data",Qe),st=!0,rt&&j.awaitDrainWriters&&(!f._writableState||f._writableState.needDrain)&&rt()}function et(){st||(j.pipes.length===1&&j.pipes[0]===f?(W("false write response, pause",0),j.awaitDrainWriters=f,j.multiAwaitDrain=!1):j.pipes.length>1&&j.pipes.includes(f)&&(W("false write response, pause",j.awaitDrainWriters.size),j.awaitDrainWriters.add(f)),A.pause()),rt||(rt=je(A,f),f.on("drain",rt))}A.on("data",Qe);function Qe(Re){W("ondata");let He=f.write(Re);W("dest.write",He),He===!1&&et()}function ct(Re){if(W("onerror",Re),_t(),f.removeListener("error",ct),f.listenerCount("error")===0){let He=f._writableState||f._readableState;He&&!He.errorEmitted?G(f,Re):f.emit("error",Re)}}T(f,"error",ct);function yt(){f.removeListener("finish",mt),_t()}f.once("close",yt);function mt(){W("onfinish"),f.removeListener("close",yt),_t()}f.once("finish",mt);function _t(){W("unpipe"),A.unpipe(f)}return f.emit("pipe",A),f.writableNeedDrain===!0?j.flowing&&et():j.flowing||(W("pipe resume"),A.resume()),f};function je(f,y){return function(){let A=f._readableState;A.awaitDrainWriters===y?(W("pipeOnDrain",1),A.awaitDrainWriters=null):A.multiAwaitDrain&&(W("pipeOnDrain",A.awaitDrainWriters.size),A.awaitDrainWriters.delete(y)),(!A.awaitDrainWriters||A.awaitDrainWriters.size===0)&&f.listenerCount("data")&&f.resume()}}S.prototype.unpipe=function(f){let y=this._readableState,A={hasUnpiped:!1};if(y.pipes.length===0)return this;if(!f){let se=y.pipes;y.pipes=[],this.pause();for(let Ne=0;Ne<se.length;Ne++)se[Ne].emit("unpipe",this,{hasUnpiped:!1});return this}let j=n(y.pipes,f);return j===-1?this:(y.pipes.splice(j,1),y.pipes.length===0&&this.pause(),f.emit("unpipe",this,A),this)},S.prototype.on=function(f,y){let A=E.prototype.on.call(this,f,y),j=this._readableState;return f==="data"?(j.readableListening=this.listenerCount("readable")>0,j.flowing!==!1&&this.resume()):f==="readable"&&!j.endEmitted&&!j.readableListening&&(j.readableListening=j.needReadable=!0,j.flowing=!1,j.emittedReadable=!1,W("on readable",j.length,j.reading),j.length?oe(this):j.reading||t.nextTick(L,this)),A},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(f,y){let A=E.prototype.removeListener.call(this,f,y);return f==="readable"&&t.nextTick(Ie,this),A},S.prototype.off=S.prototype.removeListener,S.prototype.removeAllListeners=function(f){let y=E.prototype.removeAllListeners.apply(this,arguments);return(f==="readable"||f===void 0)&&t.nextTick(Ie,this),y};function Ie(f){let y=f._readableState;y.readableListening=f.listenerCount("readable")>0,y.resumeScheduled&&y[qe]===!1?y.flowing=!0:f.listenerCount("data")>0?f.resume():y.readableListening||(y.flowing=null)}function L(f){W("readable nexttick read 0"),f.read(0)}S.prototype.resume=function(){let f=this._readableState;return f.flowing||(W("resume"),f.flowing=!f.readableListening,z(this,f)),f[qe]=!1,this};function z(f,y){y.resumeScheduled||(y.resumeScheduled=!0,t.nextTick(ee,f,y))}function ee(f,y){W("resume",y.reading),y.reading||f.read(0),y.resumeScheduled=!1,f.emit("resume"),De(f),y.flowing&&!y.reading&&f.read(0)}S.prototype.pause=function(){return W("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(W("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[qe]=!0,this};function De(f){let y=f._readableState;for(W("flow",y.flowing);y.flowing&&f.read()!==null;);}S.prototype.wrap=function(f){let y=!1;f.on("data",j=>{!this.push(j)&&f.pause&&(y=!0,f.pause())}),f.on("end",()=>{this.push(null)}),f.on("error",j=>{G(this,j)}),f.on("close",()=>{this.destroy()}),f.on("destroy",()=>{this.destroy()}),this._read=()=>{y&&f.resume&&(y=!1,f.resume())};let A=a(f);for(let j=1;j<A.length;j++){let se=A[j];this[se]===void 0&&typeof f[se]=="function"&&(this[se]=f[se].bind(f))}return this},S.prototype[g]=function(){return ke(this)},S.prototype.iterator=function(f){return f!==void 0&&ge(f,"options"),ke(this,f)};function ke(f,y){typeof f.read!="function"&&(f=S.wrap(f,{objectMode:!0}));let A=K(f,y);return A.stream=f,A}async function*K(f,y){let A=ye;function j(Ke){this===f?(A(),A=ye):A=Ke}f.on("readable",j);let se,Ne=k(f,{writable:!1},Ke=>{se=Ke?ae(se,Ke):null,A(),A=ye});try{for(;;){let Ke=f.destroyed?null:f.read();if(Ke!==null)yield Ke;else{if(se)throw se;if(se===null)return;await new h(j)}}}catch(Ke){throw se=ae(se,Ke),se}finally{(se||(y==null?void 0:y.destroyOnReturn)!==!1)&&(se===void 0||f._readableState.autoDestroy)?U.destroyer(f,null):(f.off("readable",j),Ne())}}s(S.prototype,{readable:{__proto__:null,get(){let f=this._readableState;return!!f&&f.readable!==!1&&!f.destroyed&&!f.errorEmitted&&!f.endEmitted},set(f){this._readableState&&(this._readableState.readable=!!f)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(f){this._readableState&&(this._readableState.flowing=f)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(f){this._readableState&&(this._readableState.destroyed=f)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(ie.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[qe]!==!1},set(f){this[qe]=!!f}}}),S._fromList=de;function de(f,y){if(y.length===0)return null;let A;return y.objectMode?A=y.buffer.shift():!f||f>=y.length?(y.decoder?A=y.buffer.join(""):y.buffer.length===1?A=y.buffer.first():A=y.buffer.concat(y.length),y.buffer.clear()):A=y.buffer.consume(f,y.decoder),A}function F(f){let y=f._readableState;W("endReadable",y.endEmitted),y.endEmitted||(y.ended=!0,t.nextTick(te,y,f))}function te(f,y){if(W("endReadableNT",f.endEmitted,f.length),!f.errored&&!f.closeEmitted&&!f.endEmitted&&f.length===0){if(f.endEmitted=!0,y.emit("end"),y.writable&&y.allowHalfOpen===!1)t.nextTick(ue,y);else if(f.autoDestroy){let A=y._writableState;(!A||A.autoDestroy&&(A.finished||A.writable===!1))&&y.destroy()}}}function ue(f){f.writable&&!f.writableEnded&&!f.destroyed&&f.end()}S.from=function(f,y){return H(S,f,y)};var Ue;function p(){return Ue===void 0&&(Ue={}),Ue}S.fromWeb=function(f,y){return p().newStreamReadableFromReadableStream(f,y)},S.toWeb=function(f,y){return p().newReadableStreamFromStreamReadable(f,y)},S.wrap=function(f,y){var A,j;return new S({objectMode:(A=(j=f.readableObjectMode)!==null&&j!==void 0?j:f.objectMode)!==null&&A!==void 0?A:!0,...y,destroy(se,Ne){U.destroyer(f,se),Ne(se)}}).wrap(f)}}),ho=M((e,o)=>{_(),v(),m();var t=Nt(),{ArrayPrototypeSlice:n,Error:u,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:i,ObjectDefineProperties:s,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:c,Symbol:h,SymbolHasInstance:d}=ce();o.exports=We,We.WritableState=ge;var{EventEmitter:g}=(sr(),X(nr)),b=nn().Stream,{Buffer:w}=(be(),X(me)),E=ir(),{addAbortSignal:T}=di(),{getHighWaterMark:R,getDefaultHighWaterMark:I}=an(),{ERR_INVALID_ARG_TYPE:k,ERR_METHOD_NOT_IMPLEMENTED:W,ERR_MULTIPLE_CALLBACK:Q,ERR_STREAM_CANNOT_PIPE:U,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:V,ERR_STREAM_NULL_VALUES:ae,ERR_STREAM_WRITE_AFTER_END:$,ERR_UNKNOWN_ENCODING:xe}=Ae().codes,{errorOrDestroy:N}=E;a(We.prototype,b.prototype),a(We,b);function le(){}var Le=h("kOnFinished");function ge(L,z,ee){typeof ee!="boolean"&&(ee=z instanceof nt()),this.objectMode=!!(L&&L.objectMode),ee&&(this.objectMode=this.objectMode||!!(L&&L.writableObjectMode)),this.highWaterMark=L?R(this,L,"writableHighWaterMark",ee):I(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let De=!!(L&&L.decodeStrings===!1);this.decodeStrings=!De,this.defaultEncoding=L&&L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=S.bind(void 0,z),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,qe(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!L||L.emitClose!==!1,this.autoDestroy=!L||L.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Le]=[]}function qe(L){L.buffered=[],L.bufferedIndex=0,L.allBuffers=!0,L.allNoop=!0}ge.prototype.getBuffer=function(){return n(this.buffered,this.bufferedIndex)},i(ge.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function We(L){let z=this instanceof nt();if(!z&&!r(We,this))return new We(L);this._writableState=new ge(L,this,z),L&&(typeof L.write=="function"&&(this._write=L.write),typeof L.writev=="function"&&(this._writev=L.writev),typeof L.destroy=="function"&&(this._destroy=L.destroy),typeof L.final=="function"&&(this._final=L.final),typeof L.construct=="function"&&(this._construct=L.construct),L.signal&&T(L.signal,this)),b.call(this,L),E.construct(this,()=>{let ee=this._writableState;ee.writing||Se(this,ee),Ce(this,ee)})}i(We,d,{__proto__:null,value:function(L){return r(this,L)?!0:this!==We?!1:L&&L._writableState instanceof ge}}),We.prototype.pipe=function(){N(this,new U)};function H(L,z,ee,De){let ke=L._writableState;if(typeof ee=="function")De=ee,ee=ke.defaultEncoding;else{if(!ee)ee=ke.defaultEncoding;else if(ee!=="buffer"&&!w.isEncoding(ee))throw new xe(ee);typeof De!="function"&&(De=le)}if(z===null)throw new ae;if(!ke.objectMode)if(typeof z=="string")ke.decodeStrings!==!1&&(z=w.from(z,ee),ee="buffer");else if(z instanceof w)ee="buffer";else if(b._isUint8Array(z))z=b._uint8ArrayToBuffer(z),ee="buffer";else throw new k("chunk",["string","Buffer","Uint8Array"],z);let K;return ke.ending?K=new $:ke.destroyed&&(K=new D("write")),K?(t.nextTick(De,K),N(L,K,!0),K):(ke.pendingcb++,ye(L,ke,z,ee,De))}We.prototype.write=function(L,z,ee){return H(this,L,z,ee)===!0},We.prototype.cork=function(){this._writableState.corked++},We.prototype.uncork=function(){let L=this._writableState;L.corked&&(L.corked--,L.writing||Se(this,L))},We.prototype.setDefaultEncoding=function(L){if(typeof L=="string"&&(L=c(L)),!w.isEncoding(L))throw new xe(L);return this._writableState.defaultEncoding=L,this};function ye(L,z,ee,De,ke){let K=z.objectMode?1:ee.length;z.length+=K;let de=z.length<z.highWaterMark;return de||(z.needDrain=!0),z.writing||z.corked||z.errored||!z.constructed?(z.buffered.push({chunk:ee,encoding:De,callback:ke}),z.allBuffers&&De!=="buffer"&&(z.allBuffers=!1),z.allNoop&&ke!==le&&(z.allNoop=!1)):(z.writelen=K,z.writecb=ke,z.writing=!0,z.sync=!0,L._write(ee,De,z.onwrite),z.sync=!1),de&&!z.errored&&!z.destroyed}function G(L,z,ee,De,ke,K,de){z.writelen=De,z.writecb=de,z.writing=!0,z.sync=!0,z.destroyed?z.onwrite(new D("write")):ee?L._writev(ke,z.onwrite):L._write(ke,K,z.onwrite),z.sync=!1}function ie(L,z,ee,De){--z.pendingcb,De(ee),Te(z),N(L,ee)}function S(L,z){let ee=L._writableState,De=ee.sync,ke=ee.writecb;if(typeof ke!="function"){N(L,new Q);return}ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0,z?(z.stack,ee.errored||(ee.errored=z),L._readableState&&!L._readableState.errored&&(L._readableState.errored=z),De?t.nextTick(ie,L,ee,z,ke):ie(L,ee,z,ke)):(ee.buffered.length>ee.bufferedIndex&&Se(L,ee),De?ee.afterWriteTickInfo!==null&&ee.afterWriteTickInfo.cb===ke?ee.afterWriteTickInfo.count++:(ee.afterWriteTickInfo={count:1,cb:ke,stream:L,state:ee},t.nextTick(J,ee.afterWriteTickInfo)):pe(L,ee,1,ke))}function J({stream:L,state:z,count:ee,cb:De}){return z.afterWriteTickInfo=null,pe(L,z,ee,De)}function pe(L,z,ee,De){for(!z.ending&&!L.destroyed&&z.length===0&&z.needDrain&&(z.needDrain=!1,L.emit("drain"));ee-- >0;)z.pendingcb--,De();z.destroyed&&Te(z),Ce(L,z)}function Te(L){if(L.writing)return;for(let ke=L.bufferedIndex;ke<L.buffered.length;++ke){var z;let{chunk:K,callback:de}=L.buffered[ke],F=L.objectMode?1:K.length;L.length-=F,de((z=L.errored)!==null&&z!==void 0?z:new D("write"))}let ee=L[Le].splice(0);for(let ke=0;ke<ee.length;ke++){var De;ee[ke]((De=L.errored)!==null&&De!==void 0?De:new D("end"))}qe(L)}function Se(L,z){if(z.corked||z.bufferProcessing||z.destroyed||!z.constructed)return;let{buffered:ee,bufferedIndex:De,objectMode:ke}=z,K=ee.length-De;if(!K)return;let de=De;if(z.bufferProcessing=!0,K>1&&L._writev){z.pendingcb-=K-1;let F=z.allNoop?le:ue=>{for(let Ue=de;Ue<ee.length;++Ue)ee[Ue].callback(ue)},te=z.allNoop&&de===0?ee:n(ee,de);te.allBuffers=z.allBuffers,G(L,z,!0,z.length,te,"",F),qe(z)}else{do{let{chunk:F,encoding:te,callback:ue}=ee[de];ee[de++]=null;let Ue=ke?1:F.length;G(L,z,!1,Ue,F,te,ue)}while(de<ee.length&&!z.writing);de===ee.length?qe(z):de>256?(ee.splice(0,de),z.bufferedIndex=0):z.bufferedIndex=de}z.bufferProcessing=!1}We.prototype._write=function(L,z,ee){if(this._writev)this._writev([{chunk:L,encoding:z}],ee);else throw new W("_write()")},We.prototype._writev=null,We.prototype.end=function(L,z,ee){let De=this._writableState;typeof L=="function"?(ee=L,L=null,z=null):typeof z=="function"&&(ee=z,z=null);let ke;if(L!=null){let K=H(this,L,z);K instanceof u&&(ke=K)}return De.corked&&(De.corked=1,this.uncork()),ke||(!De.errored&&!De.ending?(De.ending=!0,Ce(this,De,!0),De.ended=!0):De.finished?ke=new V("end"):De.destroyed&&(ke=new D("end"))),typeof ee=="function"&&(ke||De.finished?t.nextTick(ee,ke):De[Le].push(ee)),this};function P(L){return L.ending&&!L.destroyed&&L.constructed&&L.length===0&&!L.errored&&L.buffered.length===0&&!L.finished&&!L.writing&&!L.errorEmitted&&!L.closeEmitted}function C(L,z){let ee=!1;function De(ke){if(ee){N(L,ke??Q());return}if(ee=!0,z.pendingcb--,ke){let K=z[Le].splice(0);for(let de=0;de<K.length;de++)K[de](ke);N(L,ke,z.sync)}else P(z)&&(z.prefinished=!0,L.emit("prefinish"),z.pendingcb++,t.nextTick(ve,L,z))}z.sync=!0,z.pendingcb++;try{L._final(De)}catch(ke){De(ke)}z.sync=!1}function oe(L,z){!z.prefinished&&!z.finalCalled&&(typeof L._final=="function"&&!z.destroyed?(z.finalCalled=!0,C(L,z)):(z.prefinished=!0,L.emit("prefinish")))}function Ce(L,z,ee){P(z)&&(oe(L,z),z.pendingcb===0&&(ee?(z.pendingcb++,t.nextTick((De,ke)=>{P(ke)?ve(De,ke):ke.pendingcb--},L,z)):P(z)&&(z.pendingcb++,ve(L,z))))}function ve(L,z){z.pendingcb--,z.finished=!0;let ee=z[Le].splice(0);for(let De=0;De<ee.length;De++)ee[De]();if(L.emit("finish"),z.autoDestroy){let De=L._readableState;(!De||De.autoDestroy&&(De.endEmitted||De.readable===!1))&&L.destroy()}}s(We.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(L){this._writableState&&(this._writableState.destroyed=L)}},writable:{__proto__:null,get(){let L=this._writableState;return!!L&&L.writable!==!1&&!L.destroyed&&!L.errored&&!L.ending&&!L.ended},set(L){this._writableState&&(this._writableState.writable=!!L)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let L=this._writableState;return L?!L.destroyed&&!L.ending&&L.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var he=E.destroy;We.prototype.destroy=function(L,z){let ee=this._writableState;return!ee.destroyed&&(ee.bufferedIndex<ee.buffered.length||ee[Le].length)&&t.nextTick(Te,ee),he.call(this,L,z),this},We.prototype._undestroy=E.undestroy,We.prototype._destroy=function(L,z){z(L)},We.prototype[g.captureRejectionSymbol]=function(L){this.destroy(L)};var je;function Ie(){return je===void 0&&(je={}),je}We.fromWeb=function(L,z){return Ie().newStreamWritableFromWritableStream(L,z)},We.toWeb=function(L){return Ie().newWritableStreamFromStreamWritable(L)}}),Sh=M((e,o)=>{_(),v(),m();var t=Nt(),n=(be(),X(me)),{isReadable:u,isWritable:r,isIterable:i,isNodeStream:s,isReadableNodeStream:a,isWritableNodeStream:c,isDuplexNodeStream:h}=tt(),d=vt(),{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:b,ERR_INVALID_RETURN_VALUE:w}}=Ae(),{destroyer:E}=ir(),T=nt(),R=gi(),{createDeferredPromise:I}=Je(),k=Zs(),W=globalThis.Blob||n.Blob,Q=typeof W<"u"?function(xe){return xe instanceof W}:function(xe){return!1},U=globalThis.AbortController||zi().AbortController,{FunctionPrototypeCall:D}=ce(),V=class extends T{constructor(xe){super(xe),(xe==null?void 0:xe.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(xe==null?void 0:xe.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};o.exports=function xe(N,le){if(h(N))return N;if(a(N))return $({readable:N});if(c(N))return $({writable:N});if(s(N))return $({writable:!1,readable:!1});if(typeof N=="function"){let{value:ge,write:qe,final:We,destroy:H}=ae(N);if(i(ge))return k(V,ge,{objectMode:!0,write:qe,final:We,destroy:H});let ye=ge==null?void 0:ge.then;if(typeof ye=="function"){let G,ie=D(ye,ge,S=>{if(S!=null)throw new w("nully","body",S)},S=>{E(G,S)});return G=new V({objectMode:!0,readable:!1,write:qe,final(S){We(async()=>{try{await ie,t.nextTick(S,null)}catch(J){t.nextTick(S,J)}})},destroy:H})}throw new w("Iterable, AsyncIterable or AsyncFunction",le,ge)}if(Q(N))return xe(N.arrayBuffer());if(i(N))return k(V,N,{objectMode:!0,writable:!1});if(typeof(N==null?void 0:N.writable)=="object"||typeof(N==null?void 0:N.readable)=="object"){let ge=N!=null&&N.readable?a(N==null?void 0:N.readable)?N==null?void 0:N.readable:xe(N.readable):void 0,qe=N!=null&&N.writable?c(N==null?void 0:N.writable)?N==null?void 0:N.writable:xe(N.writable):void 0;return $({readable:ge,writable:qe})}let Le=N==null?void 0:N.then;if(typeof Le=="function"){let ge;return D(Le,N,qe=>{qe!=null&&ge.push(qe),ge.push(null)},qe=>{E(ge,qe)}),ge=new V({objectMode:!0,writable:!1,read(){}})}throw new b(le,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],N)};function ae(xe){let{promise:N,resolve:le}=I(),Le=new U,ge=Le.signal;return{value:xe(async function*(){for(;;){let qe=N;N=null;let{chunk:We,done:H,cb:ye}=await qe;if(t.nextTick(ye),H)return;if(ge.aborted)throw new g(void 0,{cause:ge.reason});({promise:N,resolve:le}=I()),yield We}}(),{signal:ge}),write(qe,We,H){let ye=le;le=null,ye({chunk:qe,done:!1,cb:H})},final(qe){let We=le;le=null,We({done:!0,cb:qe})},destroy(qe,We){Le.abort(),We(qe)}}}function $(xe){let N=xe.readable&&typeof xe.readable.read!="function"?R.wrap(xe.readable):xe.readable,le=xe.writable,Le=!!u(N),ge=!!r(le),qe,We,H,ye,G;function ie(S){let J=ye;ye=null,J?J(S):S&&G.destroy(S)}return G=new V({readableObjectMode:!!(N!=null&&N.readableObjectMode),writableObjectMode:!!(le!=null&&le.writableObjectMode),readable:Le,writable:ge}),ge&&(d(le,S=>{ge=!1,S&&E(N,S),ie(S)}),G._write=function(S,J,pe){le.write(S,J)?pe():qe=pe},G._final=function(S){le.end(),We=S},le.on("drain",function(){if(qe){let S=qe;qe=null,S()}}),le.on("finish",function(){if(We){let S=We;We=null,S()}})),Le&&(d(N,S=>{Le=!1,S&&E(N,S),ie(S)}),N.on("readable",function(){if(H){let S=H;H=null,S()}}),N.on("end",function(){G.push(null)}),G._read=function(){for(;;){let S=N.read();if(S===null){H=G._read;return}if(!G.push(S))return}}),G._destroy=function(S,J){!S&&ye!==null&&(S=new g),H=null,qe=null,We=null,ye===null?J(S):(ye=J,E(le,S),E(N,S))},G}}),nt=M((e,o)=>{_(),v(),m();var{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:n,ObjectKeys:u,ObjectSetPrototypeOf:r}=ce();o.exports=a;var i=gi(),s=ho();r(a.prototype,i.prototype),r(a,i);{let g=u(s.prototype);for(let b=0;b<g.length;b++){let w=g[b];a.prototype[w]||(a.prototype[w]=s.prototype[w])}}function a(g){if(!(this instanceof a))return new a(g);i.call(this,g),s.call(this,g),g?(this.allowHalfOpen=g.allowHalfOpen!==!1,g.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),g.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(a.prototype,{writable:{__proto__:null,...n(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...n(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...n(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...n(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...n(s.prototype,"writableLength")},writableFinished:{__proto__:null,...n(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...n(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...n(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...n(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(g){this._readableState&&this._writableState&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}});var c;function h(){return c===void 0&&(c={}),c}a.fromWeb=function(g,b){return h().newStreamDuplexFromReadableWritablePair(g,b)},a.toWeb=function(g){return h().newReadableWritablePairFromDuplex(g)};var d;a.from=function(g){return d||(d=Sh()),d(g,"body")}}),mo=M((e,o)=>{_(),v(),m();var{ObjectSetPrototypeOf:t,Symbol:n}=ce();o.exports=a;var{ERR_METHOD_NOT_IMPLEMENTED:u}=Ae().codes,r=nt(),{getHighWaterMark:i}=an();t(a.prototype,r.prototype),t(a,r);var s=n("kCallback");function a(d){if(!(this instanceof a))return new a(d);let g=d?i(this,d,"readableHighWaterMark",!0):null;g===0&&(d={...d,highWaterMark:null,readableHighWaterMark:g,writableHighWaterMark:d.writableHighWaterMark||0}),r.call(this,d),this._readableState.sync=!1,this[s]=null,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",h)}function c(d){typeof this._flush=="function"&&!this.destroyed?this._flush((g,b)=>{if(g){d?d(g):this.destroy(g);return}b!=null&&this.push(b),this.push(null),d&&d()}):(this.push(null),d&&d())}function h(){this._final!==c&&c.call(this)}a.prototype._final=c,a.prototype._transform=function(d,g,b){throw new u("_transform()")},a.prototype._write=function(d,g,b){let w=this._readableState,E=this._writableState,T=w.length;this._transform(d,g,(R,I)=>{if(R){b(R);return}I!=null&&this.push(I),E.ended||T===w.length||w.length<w.highWaterMark?b():this[s]=b})},a.prototype._read=function(){if(this[s]){let d=this[s];this[s]=null,d()}}}),Eo=M((e,o)=>{_(),v(),m();var{ObjectSetPrototypeOf:t}=ce();o.exports=u;var n=mo();t(u.prototype,n.prototype),t(u,n);function u(r){if(!(this instanceof u))return new u(r);n.call(this,r)}u.prototype._transform=function(r,i,s){s(null,r)}}),En=M((e,o)=>{_(),v(),m();var t=Nt(),{ArrayIsArray:n,Promise:u,SymbolAsyncIterator:r}=ce(),i=vt(),{once:s}=Je(),a=ir(),c=nt(),{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:g,ERR_MISSING_ARGS:b,ERR_STREAM_DESTROYED:w,ERR_STREAM_PREMATURE_CLOSE:E},AbortError:T}=Ae(),{validateFunction:R,validateAbortSignal:I}=hi(),{isIterable:k,isReadable:W,isReadableNodeStream:Q,isNodeStream:U,isTransformStream:D,isWebStream:V,isReadableStream:ae,isReadableEnded:$}=tt(),xe=globalThis.AbortController||zi().AbortController,N,le;function Le(J,pe,Te){let Se=!1;J.on("close",()=>{Se=!0});let P=i(J,{readable:pe,writable:Te},C=>{Se=!C});return{destroy:C=>{Se||(Se=!0,a.destroyer(J,C||new w("pipe")))},cleanup:P}}function ge(J){return R(J[J.length-1],"streams[stream.length - 1]"),J.pop()}function qe(J){if(k(J))return J;if(Q(J))return We(J);throw new d("val",["Readable","Iterable","AsyncIterable"],J)}async function*We(J){le||(le=gi()),yield*le.prototype[r].call(J)}async function H(J,pe,Te,{end:Se}){let P,C=null,oe=he=>{if(he&&(P=he),C){let je=C;C=null,je()}},Ce=()=>new u((he,je)=>{P?je(P):C=()=>{P?je(P):he()}});pe.on("drain",oe);let ve=i(pe,{readable:!1},oe);try{pe.writableNeedDrain&&await Ce();for await(let he of J)pe.write(he)||await Ce();Se&&pe.end(),await Ce(),Te()}catch(he){Te(P!==he?h(P,he):he)}finally{ve(),pe.off("drain",oe)}}async function ye(J,pe,Te,{end:Se}){D(pe)&&(pe=pe.writable);let P=pe.getWriter();try{for await(let C of J)await P.ready,P.write(C).catch(()=>{});await P.ready,Se&&await P.close(),Te()}catch(C){try{await P.abort(C),Te(C)}catch(oe){Te(oe)}}}function G(...J){return ie(J,s(ge(J)))}function ie(J,pe,Te){if(J.length===1&&n(J[0])&&(J=J[0]),J.length<2)throw new b("streams");let Se=new xe,P=Se.signal,C=Te==null?void 0:Te.signal,oe=[];I(C,"options.signal");function Ce(){z(new T)}C==null||C.addEventListener("abort",Ce);let ve,he,je=[],Ie=0;function L(K){z(K,--Ie===0)}function z(K,de){if(K&&(!ve||ve.code==="ERR_STREAM_PREMATURE_CLOSE")&&(ve=K),!(!ve&&!de)){for(;je.length;)je.shift()(ve);C==null||C.removeEventListener("abort",Ce),Se.abort(),de&&(ve||oe.forEach(F=>F()),t.nextTick(pe,ve,he))}}let ee;for(let K=0;K<J.length;K++){let de=J[K],F=K<J.length-1,te=K>0,ue=F||(Te==null?void 0:Te.end)!==!1,Ue=K===J.length-1;if(U(de)){let p=function(f){f&&f.name!=="AbortError"&&f.code!=="ERR_STREAM_PREMATURE_CLOSE"&&L(f)};if(ue){let{destroy:f,cleanup:y}=Le(de,F,te);je.push(f),W(de)&&Ue&&oe.push(y)}de.on("error",p),W(de)&&Ue&&oe.push(()=>{de.removeListener("error",p)})}if(K===0)if(typeof de=="function"){if(ee=de({signal:P}),!k(ee))throw new g("Iterable, AsyncIterable or Stream","source",ee)}else k(de)||Q(de)||D(de)?ee=de:ee=c.from(de);else if(typeof de=="function"){if(D(ee)){var De;ee=qe((De=ee)===null||De===void 0?void 0:De.readable)}else ee=qe(ee);if(ee=de(ee,{signal:P}),F){if(!k(ee,!0))throw new g("AsyncIterable",`transform[${K-1}]`,ee)}else{var ke;N||(N=Eo());let p=new N({objectMode:!0}),f=(ke=ee)===null||ke===void 0?void 0:ke.then;if(typeof f=="function")Ie++,f.call(ee,j=>{he=j,j!=null&&p.write(j),ue&&p.end(),t.nextTick(L)},j=>{p.destroy(j),t.nextTick(L,j)});else if(k(ee,!0))Ie++,H(ee,p,L,{end:ue});else if(ae(ee)||D(ee)){let j=ee.readable||ee;Ie++,H(j,p,L,{end:ue})}else throw new g("AsyncIterable or Promise","destination",ee);ee=p;let{destroy:y,cleanup:A}=Le(ee,!1,!0);je.push(y),Ue&&oe.push(A)}}else if(U(de)){if(Q(ee)){Ie+=2;let p=S(ee,de,L,{end:ue});W(de)&&Ue&&oe.push(p)}else if(D(ee)||ae(ee)){let p=ee.readable||ee;Ie++,H(p,de,L,{end:ue})}else if(k(ee))Ie++,H(ee,de,L,{end:ue});else throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ee);ee=de}else if(V(de)){if(Q(ee))Ie++,ye(qe(ee),de,L,{end:ue});else if(ae(ee)||k(ee))Ie++,ye(ee,de,L,{end:ue});else if(D(ee))Ie++,ye(ee.readable,de,L,{end:ue});else throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ee);ee=de}else ee=c.from(de)}return(P!=null&&P.aborted||C!=null&&C.aborted)&&t.nextTick(Ce),ee}function S(J,pe,Te,{end:Se}){let P=!1;if(pe.on("close",()=>{P||Te(new E)}),J.pipe(pe,{end:!1}),Se){let C=function(){P=!0,pe.end()};$(J)?t.nextTick(C):J.once("end",C)}else Te();return i(J,{readable:!0,writable:!1},C=>{let oe=J._readableState;C&&C.code==="ERR_STREAM_PREMATURE_CLOSE"&&oe&&oe.ended&&!oe.errored&&!oe.errorEmitted?J.once("end",Te).once("error",Te):Te(C)}),i(pe,{readable:!1,writable:!0},Te)}o.exports={pipelineImpl:ie,pipeline:G}}),Oo=M((e,o)=>{_(),v(),m();var{pipeline:t}=En(),n=nt(),{destroyer:u}=ir(),{isNodeStream:r,isReadable:i,isWritable:s,isWebStream:a,isTransformStream:c,isWritableStream:h,isReadableStream:d}=tt(),{AbortError:g,codes:{ERR_INVALID_ARG_VALUE:b,ERR_MISSING_ARGS:w}}=Ae(),E=vt();o.exports=function(...T){if(T.length===0)throw new w("streams");if(T.length===1)return n.from(T[0]);let R=[...T];if(typeof T[0]=="function"&&(T[0]=n.from(T[0])),typeof T[T.length-1]=="function"){let N=T.length-1;T[N]=n.from(T[N])}for(let N=0;N<T.length;++N)if(!(!r(T[N])&&!a(T[N]))){if(N<T.length-1&&!(i(T[N])||d(T[N])||c(T[N])))throw new b(`streams[${N}]`,R[N],"must be readable");if(N>0&&!(s(T[N])||h(T[N])||c(T[N])))throw new b(`streams[${N}]`,R[N],"must be writable")}let I,k,W,Q,U;function D(N){let le=Q;Q=null,le?le(N):N?U.destroy(N):!xe&&!$&&U.destroy()}let V=T[0],ae=t(T,D),$=!!(s(V)||h(V)||c(V)),xe=!!(i(ae)||d(ae)||c(ae));if(U=new n({writableObjectMode:!!(V!=null&&V.writableObjectMode),readableObjectMode:!!(ae!=null&&ae.writableObjectMode),writable:$,readable:xe}),$){if(r(V))U._write=function(le,Le,ge){V.write(le,Le)?ge():I=ge},U._final=function(le){V.end(),k=le},V.on("drain",function(){if(I){let le=I;I=null,le()}});else if(a(V)){let le=(c(V)?V.writable:V).getWriter();U._write=async function(Le,ge,qe){try{await le.ready,le.write(Le).catch(()=>{}),qe()}catch(We){qe(We)}},U._final=async function(Le){try{await le.ready,le.close().catch(()=>{}),k=Le}catch(ge){Le(ge)}}}let N=c(ae)?ae.readable:ae;E(N,()=>{if(k){let le=k;k=null,le()}})}if(xe){if(r(ae))ae.on("readable",function(){if(W){let N=W;W=null,N()}}),ae.on("end",function(){U.push(null)}),U._read=function(){for(;;){let N=ae.read();if(N===null){W=U._read;return}if(!U.push(N))return}};else if(a(ae)){let N=(c(ae)?ae.readable:ae).getReader();U._read=async function(){for(;;)try{let{value:le,done:Le}=await N.read();if(!U.push(le))return;if(Le){U.push(null);return}}catch{return}}}}return U._destroy=function(N,le){!N&&Q!==null&&(N=new g),W=null,I=null,k=null,Q===null?le(N):(Q=le,r(ae)&&u(ae,N))},U}}),Qh=M((e,o)=>{_(),v(),m();var t=globalThis.AbortController||zi().AbortController,{codes:{ERR_INVALID_ARG_VALUE:n,ERR_INVALID_ARG_TYPE:u,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:i},AbortError:s}=Ae(),{validateAbortSignal:a,validateInteger:c,validateObject:h}=hi(),d=ce().Symbol("kWeak"),{finished:g}=vt(),b=Oo(),{addAbortSignalNoValidate:w}=di(),{isWritable:E,isNodeStream:T}=tt(),{ArrayPrototypePush:R,MathFloor:I,Number:k,NumberIsNaN:W,Promise:Q,PromiseReject:U,PromisePrototypeThen:D,Symbol:V}=ce(),ae=V("kEmpty"),$=V("kEof");function xe(Se,P){if(P!=null&&h(P,"options"),(P==null?void 0:P.signal)!=null&&a(P.signal,"options.signal"),T(Se)&&!E(Se))throw new n("stream",Se,"must be writable");let C=b(this,Se);return P!=null&&P.signal&&w(P.signal,C),C}function N(Se,P){if(typeof Se!="function")throw new u("fn",["Function","AsyncFunction"],Se);P!=null&&h(P,"options"),(P==null?void 0:P.signal)!=null&&a(P.signal,"options.signal");let C=1;return(P==null?void 0:P.concurrency)!=null&&(C=I(P.concurrency)),c(C,"concurrency",1),(async function*(){var oe,Ce;let ve=new t,he=this,je=[],Ie=ve.signal,L={signal:Ie},z=()=>ve.abort();P!=null&&(oe=P.signal)!==null&&oe!==void 0&&oe.aborted&&z(),P==null||(Ce=P.signal)===null||Ce===void 0||Ce.addEventListener("abort",z);let ee,De,ke=!1;function K(){ke=!0}async function de(){try{for await(let ue of he){var F;if(ke)return;if(Ie.aborted)throw new s;try{ue=Se(ue,L)}catch(Ue){ue=U(Ue)}ue!==ae&&(typeof((F=ue)===null||F===void 0?void 0:F.catch)=="function"&&ue.catch(K),je.push(ue),ee&&(ee(),ee=null),!ke&&je.length&&je.length>=C&&await new Q(Ue=>{De=Ue}))}je.push($)}catch(ue){let Ue=U(ue);D(Ue,void 0,K),je.push(Ue)}finally{var te;ke=!0,ee&&(ee(),ee=null),P==null||(te=P.signal)===null||te===void 0||te.removeEventListener("abort",z)}}de();try{for(;;){for(;je.length>0;){let F=await je[0];if(F===$)return;if(Ie.aborted)throw new s;F!==ae&&(yield F),je.shift(),De&&(De(),De=null)}await new Q(F=>{ee=F})}}finally{ve.abort(),ke=!0,De&&(De(),De=null)}}).call(this)}function le(Se=void 0){return Se!=null&&h(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let P=0;for await(let oe of this){var C;if(Se!=null&&(C=Se.signal)!==null&&C!==void 0&&C.aborted)throw new s({cause:Se.signal.reason});yield[P++,oe]}}).call(this)}async function Le(Se,P=void 0){for await(let C of H.call(this,Se,P))return!0;return!1}async function ge(Se,P=void 0){if(typeof Se!="function")throw new u("fn",["Function","AsyncFunction"],Se);return!await Le.call(this,async(...C)=>!await Se(...C),P)}async function qe(Se,P){for await(let C of H.call(this,Se,P))return C}async function We(Se,P){if(typeof Se!="function")throw new u("fn",["Function","AsyncFunction"],Se);async function C(oe,Ce){return await Se(oe,Ce),ae}for await(let oe of N.call(this,C,P));}function H(Se,P){if(typeof Se!="function")throw new u("fn",["Function","AsyncFunction"],Se);async function C(oe,Ce){return await Se(oe,Ce)?oe:ae}return N.call(this,C,P)}var ye=class extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function G(Se,P,C){var oe;if(typeof Se!="function")throw new u("reducer",["Function","AsyncFunction"],Se);C!=null&&h(C,"options"),(C==null?void 0:C.signal)!=null&&a(C.signal,"options.signal");let Ce=arguments.length>1;if(C!=null&&(oe=C.signal)!==null&&oe!==void 0&&oe.aborted){let L=new s(void 0,{cause:C.signal.reason});throw this.once("error",()=>{}),await g(this.destroy(L)),L}let ve=new t,he=ve.signal;if(C!=null&&C.signal){let L={once:!0,[d]:this};C.signal.addEventListener("abort",()=>ve.abort(),L)}let je=!1;try{for await(let L of this){var Ie;if(je=!0,C!=null&&(Ie=C.signal)!==null&&Ie!==void 0&&Ie.aborted)throw new s;Ce?P=await Se(P,L,{signal:he}):(P=L,Ce=!0)}if(!je&&!Ce)throw new ye}finally{ve.abort()}return P}async function ie(Se){Se!=null&&h(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");let P=[];for await(let oe of this){var C;if(Se!=null&&(C=Se.signal)!==null&&C!==void 0&&C.aborted)throw new s(void 0,{cause:Se.signal.reason});R(P,oe)}return P}function S(Se,P){let C=N.call(this,Se,P);return(async function*(){for await(let oe of C)yield*oe}).call(this)}function J(Se){if(Se=k(Se),W(Se))return 0;if(Se<0)throw new i("number",">= 0",Se);return Se}function pe(Se,P=void 0){return P!=null&&h(P,"options"),(P==null?void 0:P.signal)!=null&&a(P.signal,"options.signal"),Se=J(Se),(async function*(){var C;if(P!=null&&(C=P.signal)!==null&&C!==void 0&&C.aborted)throw new s;for await(let Ce of this){var oe;if(P!=null&&(oe=P.signal)!==null&&oe!==void 0&&oe.aborted)throw new s;Se--<=0&&(yield Ce)}}).call(this)}function Te(Se,P=void 0){return P!=null&&h(P,"options"),(P==null?void 0:P.signal)!=null&&a(P.signal,"options.signal"),Se=J(Se),(async function*(){var C;if(P!=null&&(C=P.signal)!==null&&C!==void 0&&C.aborted)throw new s;for await(let Ce of this){var oe;if(P!=null&&(oe=P.signal)!==null&&oe!==void 0&&oe.aborted)throw new s;if(Se-- >0)yield Ce;else return}}).call(this)}o.exports.streamReturningOperators={asIndexedPairs:le,drop:pe,filter:H,flatMap:S,map:N,take:Te,compose:xe},o.exports.promiseReturningOperators={every:ge,forEach:We,reduce:G,toArray:ie,some:Le,find:qe}}),Uo=M((e,o)=>{_(),v(),m();var{ArrayPrototypePop:t,Promise:n}=ce(),{isIterable:u,isNodeStream:r,isWebStream:i}=tt(),{pipelineImpl:s}=En(),{finished:a}=vt();No();function c(...h){return new n((d,g)=>{let b,w,E=h[h.length-1];if(E&&typeof E=="object"&&!r(E)&&!u(E)&&!i(E)){let T=t(h);b=T.signal,w=T.end}s(h,(T,R)=>{T?g(T):d(R)},{signal:b,end:w})})}o.exports={finished:a,pipeline:c}}),No=M((e,o)=>{_(),v(),m();var{Buffer:t}=(be(),X(me)),{ObjectDefineProperty:n,ObjectKeys:u,ReflectApply:r}=ce(),{promisify:{custom:i}}=Je(),{streamReturningOperators:s,promiseReturningOperators:a}=Qh(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=Ae(),h=Oo(),{pipeline:d}=En(),{destroyer:g}=ir(),b=vt(),w=Uo(),E=tt(),T=o.exports=nn().Stream;T.isDisturbed=E.isDisturbed,T.isErrored=E.isErrored,T.isReadable=E.isReadable,T.Readable=gi();for(let I of u(s)){let k=function(...Q){if(new.target)throw c();return T.Readable.from(r(W,this,Q))},W=s[I];n(k,"name",{__proto__:null,value:W.name}),n(k,"length",{__proto__:null,value:W.length}),n(T.Readable.prototype,I,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(let I of u(a)){let k=function(...Q){if(new.target)throw c();return r(W,this,Q)},W=a[I];n(k,"name",{__proto__:null,value:W.name}),n(k,"length",{__proto__:null,value:W.length}),n(T.Readable.prototype,I,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}T.Writable=ho(),T.Duplex=nt(),T.Transform=mo(),T.PassThrough=Eo(),T.pipeline=d;var{addAbortSignal:R}=di();T.addAbortSignal=R,T.finished=b,T.destroy=g,T.compose=h,n(T,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return w}}),n(d,i,{__proto__:null,enumerable:!0,get(){return w.pipeline}}),n(b,i,{__proto__:null,enumerable:!0,get(){return w.finished}}),T.Stream=T,T._isUint8Array=function(I){return I instanceof Uint8Array},T._uint8ArrayToBuffer=function(I){return t.from(I.buffer,I.byteOffset,I.byteLength)}}),jt=M((e,o)=>{_(),v(),m();var t=No(),n=Uo(),u=t.Readable.destroy;o.exports=t.Readable,o.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,o.exports._isUint8Array=t._isUint8Array,o.exports.isDisturbed=t.isDisturbed,o.exports.isErrored=t.isErrored,o.exports.isReadable=t.isReadable,o.exports.Readable=t.Readable,o.exports.Writable=t.Writable,o.exports.Duplex=t.Duplex,o.exports.Transform=t.Transform,o.exports.PassThrough=t.PassThrough,o.exports.addAbortSignal=t.addAbortSignal,o.exports.finished=t.finished,o.exports.destroy=t.destroy,o.exports.destroy=u,o.exports.pipeline=t.pipeline,o.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),o.exports.Stream=t.Stream,o.exports.default=o.exports}),od=M((e,o)=>{_(),v(),m(),typeof Object.create=="function"?o.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:o.exports=function(t,n){if(n){t.super_=n;var u=function(){};u.prototype=n.prototype,t.prototype=new u,t.prototype.constructor=t}}}),ud=M((e,o)=>{_(),v(),m();var{Buffer:t}=(be(),X(me)),n=Symbol.for("BufferList");function u(r){if(!(this instanceof u))return new u(r);u._init.call(this,r)}u._init=function(r){Object.defineProperty(this,n,{value:!0}),this._bufs=[],this.length=0,r&&this.append(r)},u.prototype._new=function(r){return new u(r)},u.prototype._offset=function(r){if(r===0)return[0,0];let i=0;for(let s=0;s<this._bufs.length;s++){let a=i+this._bufs[s].length;if(r<a||s===this._bufs.length-1)return[s,r-i];i=a}},u.prototype._reverseOffset=function(r){let i=r[0],s=r[1];for(let a=0;a<i;a++)s+=this._bufs[a].length;return s},u.prototype.get=function(r){if(r>this.length||r<0)return;let i=this._offset(r);return this._bufs[i[0]][i[1]]},u.prototype.slice=function(r,i){return typeof r=="number"&&r<0&&(r+=this.length),typeof i=="number"&&i<0&&(i+=this.length),this.copy(null,0,r,i)},u.prototype.copy=function(r,i,s,a){if((typeof s!="number"||s<0)&&(s=0),(typeof a!="number"||a>this.length)&&(a=this.length),s>=this.length||a<=0)return r||t.alloc(0);let c=!!r,h=this._offset(s),d=a-s,g=d,b=c&&i||0,w=h[1];if(s===0&&a===this.length){if(!c)return this._bufs.length===1?this._bufs[0]:t.concat(this._bufs,this.length);for(let E=0;E<this._bufs.length;E++)this._bufs[E].copy(r,b),b+=this._bufs[E].length;return r}if(g<=this._bufs[h[0]].length-w)return c?this._bufs[h[0]].copy(r,i,w,w+g):this._bufs[h[0]].slice(w,w+g);c||(r=t.allocUnsafe(d));for(let E=h[0];E<this._bufs.length;E++){let T=this._bufs[E].length-w;if(g>T)this._bufs[E].copy(r,b,w),b+=T;else{this._bufs[E].copy(r,b,w,w+g),b+=T;break}g-=T,w&&(w=0)}return r.length>b?r.slice(0,b):r},u.prototype.shallowSlice=function(r,i){if(r=r||0,i=typeof i!="number"?this.length:i,r<0&&(r+=this.length),i<0&&(i+=this.length),r===i)return this._new();let s=this._offset(r),a=this._offset(i),c=this._bufs.slice(s[0],a[0]+1);return a[1]===0?c.pop():c[c.length-1]=c[c.length-1].slice(0,a[1]),s[1]!==0&&(c[0]=c[0].slice(s[1])),this._new(c)},u.prototype.toString=function(r,i,s){return this.slice(i,s).toString(r)},u.prototype.consume=function(r){if(r=Math.trunc(r),Number.isNaN(r)||r<=0)return this;for(;this._bufs.length;)if(r>=this._bufs[0].length)r-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(r),this.length-=r;break}return this},u.prototype.duplicate=function(){let r=this._new();for(let i=0;i<this._bufs.length;i++)r.append(this._bufs[i]);return r},u.prototype.append=function(r){if(r==null)return this;if(r.buffer)this._appendBuffer(t.from(r.buffer,r.byteOffset,r.byteLength));else if(Array.isArray(r))for(let i=0;i<r.length;i++)this.append(r[i]);else if(this._isBufferList(r))for(let i=0;i<r._bufs.length;i++)this.append(r._bufs[i]);else typeof r=="number"&&(r=r.toString()),this._appendBuffer(t.from(r));return this},u.prototype._appendBuffer=function(r){this._bufs.push(r),this.length+=r.length},u.prototype.indexOf=function(r,i,s){if(s===void 0&&typeof i=="string"&&(s=i,i=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=t.from([r]):typeof r=="string"?r=t.from(r,s):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=t.from(r.buffer,r.byteOffset,r.byteLength):t.isBuffer(r)||(r=t.from(r)),i=Number(i||0),isNaN(i)&&(i=0),i<0&&(i=this.length+i),i<0&&(i=0),r.length===0)return i>this.length?this.length:i;let a=this._offset(i),c=a[0],h=a[1];for(;c<this._bufs.length;c++){let d=this._bufs[c];for(;h<d.length;)if(d.length-h>=r.length){let g=d.indexOf(r,h);if(g!==-1)return this._reverseOffset([c,g]);h=d.length-r.length+1}else{let g=this._reverseOffset([c,h]);if(this._match(g,r))return g;h++}h=0}return-1},u.prototype._match=function(r,i){if(this.length-r<i.length)return!1;for(let s=0;s<i.length;s++)if(this.get(r+s)!==i[s])return!1;return!0},function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let i in r)(function(s){r[s]===null?u.prototype[s]=function(a,c){return this.slice(a,a+c)[s](0,c)}:u.prototype[s]=function(a=0){return this.slice(a,a+r[s])[s](0)}})(i)}(),u.prototype._isBufferList=function(r){return r instanceof u||u.isBufferList(r)},u.isBufferList=function(r){return r!=null&&r[n]},o.exports=u}),fd=M((e,o)=>{_(),v(),m();var t=jt().Duplex,n=od(),u=ud();function r(i){if(!(this instanceof r))return new r(i);if(typeof i=="function"){this._callback=i;let s=(function(a){this._callback&&(this._callback(a),this._callback=null)}).bind(this);this.on("pipe",function(a){a.on("error",s)}),this.on("unpipe",function(a){a.removeListener("error",s)}),i=null}u._init.call(this,i),t.call(this)}n(r,t),Object.assign(r.prototype,u.prototype),r.prototype._new=function(i){return new r(i)},r.prototype._write=function(i,s,a){this._appendBuffer(i),typeof a=="function"&&a()},r.prototype._read=function(i){if(!this.length)return this.push(null);i=Math.min(i,this.length),this.push(this.slice(0,i)),this.consume(i)},r.prototype.end=function(i){t.prototype.end.call(this,i),this._callback&&(this._callback(null,this.slice()),this._callback=null)},r.prototype._destroy=function(i,s){this._bufs.length=0,this.length=0,s(i)},r.prototype._isBufferList=function(i){return i instanceof r||i instanceof u||r.isBufferList(i)},r.isBufferList=u.isBufferList,o.exports=r,o.exports.BufferListStream=r,o.exports.BufferList=u}),hd=M((e,o)=>{_(),v(),m();var t=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};o.exports=t}),Ho=M((e,o)=>{_(),v(),m();var t=o.exports,{Buffer:n}=(be(),X(me));t.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},t.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},t.requiredHeaderFlagsErrors={};for(let r in t.requiredHeaderFlags){let i=t.requiredHeaderFlags[r];t.requiredHeaderFlagsErrors[r]="Invalid header flag bits, must be 0x"+i.toString(16)+" for "+t.types[r]+" packet"}t.codes={};for(let r in t.types){let i=t.types[r];t.codes[i]=r}t.CMD_SHIFT=4,t.CMD_MASK=240,t.DUP_MASK=8,t.QOS_MASK=3,t.QOS_SHIFT=1,t.RETAIN_MASK=1,t.VARBYTEINT_MASK=127,t.VARBYTEINT_FIN_MASK=128,t.VARBYTEINT_MAX=268435455,t.SESSIONPRESENT_MASK=1,t.SESSIONPRESENT_HEADER=n.from([t.SESSIONPRESENT_MASK]),t.CONNACK_HEADER=n.from([t.codes.connack<<t.CMD_SHIFT]),t.USERNAME_MASK=128,t.PASSWORD_MASK=64,t.WILL_RETAIN_MASK=32,t.WILL_QOS_MASK=24,t.WILL_QOS_SHIFT=3,t.WILL_FLAG_MASK=4,t.CLEAN_SESSION_MASK=2,t.CONNECT_HEADER=n.from([t.codes.connect<<t.CMD_SHIFT]),t.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},t.propertiesCodes={};for(let r in t.properties){let i=t.properties[r];t.propertiesCodes[i]=r}t.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function u(r){return[0,1,2].map(i=>[0,1].map(s=>[0,1].map(a=>{let c=n.alloc(1);return c.writeUInt8(t.codes[r]<<t.CMD_SHIFT|(s?t.DUP_MASK:0)|i<<t.QOS_SHIFT|a,0,!0),c})))}t.PUBLISH_HEADER=u("publish"),t.SUBSCRIBE_HEADER=u("subscribe"),t.SUBSCRIBE_OPTIONS_QOS_MASK=3,t.SUBSCRIBE_OPTIONS_NL_MASK=1,t.SUBSCRIBE_OPTIONS_NL_SHIFT=2,t.SUBSCRIBE_OPTIONS_RAP_MASK=1,t.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,t.SUBSCRIBE_OPTIONS_RH_MASK=3,t.SUBSCRIBE_OPTIONS_RH_SHIFT=4,t.SUBSCRIBE_OPTIONS_RH=[0,16,32],t.SUBSCRIBE_OPTIONS_NL=4,t.SUBSCRIBE_OPTIONS_RAP=8,t.SUBSCRIBE_OPTIONS_QOS=[0,1,2],t.UNSUBSCRIBE_HEADER=u("unsubscribe"),t.ACKS={unsuback:u("unsuback"),puback:u("puback"),pubcomp:u("pubcomp"),pubrel:u("pubrel"),pubrec:u("pubrec")},t.SUBACK_HEADER=n.from([t.codes.suback<<t.CMD_SHIFT]),t.VERSION3=n.from([3]),t.VERSION4=n.from([4]),t.VERSION5=n.from([5]),t.VERSION131=n.from([131]),t.VERSION132=n.from([132]),t.QOS=[0,1,2].map(r=>n.from([r])),t.EMPTY={pingreq:n.from([t.codes.pingreq<<4,0]),pingresp:n.from([t.codes.pingresp<<4,0]),disconnect:n.from([t.codes.disconnect<<4,0])},t.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},t.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},t.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},t.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),gd=M((e,o)=>{_(),v(),m();var t=1e3,n=t*60,u=n*60,r=u*24,i=r*7,s=r*365.25;o.exports=function(g,b){b=b||{};var w=typeof g;if(w==="string"&&g.length>0)return a(g);if(w==="number"&&isFinite(g))return b.long?h(g):c(g);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(g))};function a(g){if(g=String(g),!(g.length>100)){var b=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(b){var w=parseFloat(b[1]),E=(b[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return w*s;case"weeks":case"week":case"w":return w*i;case"days":case"day":case"d":return w*r;case"hours":case"hour":case"hrs":case"hr":case"h":return w*u;case"minutes":case"minute":case"mins":case"min":case"m":return w*n;case"seconds":case"second":case"secs":case"sec":case"s":return w*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}function c(g){var b=Math.abs(g);return b>=r?Math.round(g/r)+"d":b>=u?Math.round(g/u)+"h":b>=n?Math.round(g/n)+"m":b>=t?Math.round(g/t)+"s":g+"ms"}function h(g){var b=Math.abs(g);return b>=r?d(g,b,r,"day"):b>=u?d(g,b,u,"hour"):b>=n?d(g,b,n,"minute"):b>=t?d(g,b,t,"second"):g+" ms"}function d(g,b,w,E){var T=b>=w*1.5;return Math.round(g/w)+" "+E+(T?"s":"")}}),bd=M((e,o)=>{_(),v(),m();function t(n){r.debug=r,r.default=r,r.coerce=d,r.disable=a,r.enable=s,r.enabled=c,r.humanize=gd(),r.destroy=g,Object.keys(n).forEach(b=>{r[b]=n[b]}),r.names=[],r.skips=[],r.formatters={};function u(b){let w=0;for(let E=0;E<b.length;E++)w=(w<<5)-w+b.charCodeAt(E),w|=0;return r.colors[Math.abs(w)%r.colors.length]}r.selectColor=u;function r(b){let w,E=null,T,R;function I(...k){if(!I.enabled)return;let W=I,Q=Number(new Date),U=Q-(w||Q);W.diff=U,W.prev=w,W.curr=Q,w=Q,k[0]=r.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let D=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(V,ae)=>{if(V==="%%")return"%";D++;let $=r.formatters[ae];if(typeof $=="function"){let xe=k[D];V=$.call(W,xe),k.splice(D,1),D--}return V}),r.formatArgs.call(W,k),(W.log||r.log).apply(W,k)}return I.namespace=b,I.useColors=r.useColors(),I.color=r.selectColor(b),I.extend=i,I.destroy=r.destroy,Object.defineProperty(I,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(T!==r.namespaces&&(T=r.namespaces,R=r.enabled(b)),R),set:k=>{E=k}}),typeof r.init=="function"&&r.init(I),I}function i(b,w){let E=r(this.namespace+(typeof w>"u"?":":w)+b);return E.log=this.log,E}function s(b){r.save(b),r.namespaces=b,r.names=[],r.skips=[];let w,E=(typeof b=="string"?b:"").split(/[\s,]+/),T=E.length;for(w=0;w<T;w++)E[w]&&(b=E[w].replace(/\*/g,".*?"),b[0]==="-"?r.skips.push(new RegExp("^"+b.slice(1)+"$")):r.names.push(new RegExp("^"+b+"$")))}function a(){let b=[...r.names.map(h),...r.skips.map(h).map(w=>"-"+w)].join(",");return r.enable(""),b}function c(b){if(b[b.length-1]==="*")return!0;let w,E;for(w=0,E=r.skips.length;w<E;w++)if(r.skips[w].test(b))return!1;for(w=0,E=r.names.length;w<E;w++)if(r.names[w].test(b))return!0;return!1}function h(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}function d(b){return b instanceof Error?b.stack||b.message:b}function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}o.exports=t}),ot=M((e,o)=>{_(),v(),m(),e.formatArgs=n,e.save=u,e.load=r,e.useColors=t,e.storage=i(),e.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;a.splice(1,0,c,"color: inherit");let h=0,d=0;a[0].replace(/%[a-zA-Z%]/g,g=>{g!=="%%"&&(h++,g==="%c"&&(d=h))}),a.splice(d,0,c)}e.log=console.debug||console.log||(()=>{});function u(a){try{a?e.storage.setItem("debug",a):e.storage.removeItem("debug")}catch{}}function r(){let a;try{a=e.storage.getItem("debug")}catch{}return!a&&typeof B<"u"&&"env"in B&&(a=B.env.DEBUG),a}function i(){try{return localStorage}catch{}}o.exports=bd()(e);var{formatters:s}=o.exports;s.j=function(a){try{return JSON.stringify(a)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}),md=M((e,o)=>{_(),v(),m();var t=fd(),{EventEmitter:n}=(sr(),X(nr)),u=hd(),r=Ho(),i=ot()("mqtt-packet:parser"),s=class fr extends n{constructor(){super(),this.parser=this.constructor.parser}static parser(c){return this instanceof fr?(this.settings=c||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new fr().parser(c)}_resetState(){i("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new u,this.error=null,this._list=t(),this._stateCounter=0}parse(c){for(this.error&&this._resetState(),this._list.append(c),i("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,i("parse: state complete. _stateCounter is now: %d",this._stateCounter),i("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return i("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let c=this._list.readUInt8(0),h=c>>r.CMD_SHIFT;this.packet.cmd=r.types[h];let d=c&15,g=r.requiredHeaderFlags[h];return g!=null&&d!==g?this._emitError(new Error(r.requiredHeaderFlagsErrors[h])):(this.packet.retain=(c&r.RETAIN_MASK)!==0,this.packet.qos=c>>r.QOS_SHIFT&r.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(c&r.DUP_MASK)!==0,i("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let c=this._parseVarByteNum(!0);return c&&(this.packet.length=c.value,this._list.consume(c.bytes)),i("_parseLength %d",c.value),!!c}_parsePayload(){i("_parsePayload: payload %O",this._list);let c=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}c=!0}return i("_parsePayload complete result: %s",c),c}_parseConnect(){i("_parseConnect");let c,h,d,g,b={},w=this.packet,E=this._parseString();if(E===null)return this._emitError(new Error("Cannot parse protocolId"));if(E!=="MQTT"&&E!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(w.protocolId=E,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(w.protocolVersion=this._list.readUInt8(this._pos),w.protocolVersion>=128&&(w.bridgeMode=!0,w.protocolVersion=w.protocolVersion-128),w.protocolVersion!==3&&w.protocolVersion!==4&&w.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));b.username=this._list.readUInt8(this._pos)&r.USERNAME_MASK,b.password=this._list.readUInt8(this._pos)&r.PASSWORD_MASK,b.will=this._list.readUInt8(this._pos)&r.WILL_FLAG_MASK;let T=!!(this._list.readUInt8(this._pos)&r.WILL_RETAIN_MASK),R=(this._list.readUInt8(this._pos)&r.WILL_QOS_MASK)>>r.WILL_QOS_SHIFT;if(b.will)w.will={},w.will.retain=T,w.will.qos=R;else{if(T)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(R)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(w.clean=(this._list.readUInt8(this._pos)&r.CLEAN_SESSION_MASK)!==0,this._pos++,w.keepalive=this._parseNum(),w.keepalive===-1)return this._emitError(new Error("Packet too short"));if(w.protocolVersion===5){let k=this._parseProperties();Object.getOwnPropertyNames(k).length&&(w.properties=k)}let I=this._parseString();if(I===null)return this._emitError(new Error("Packet too short"));if(w.clientId=I,i("_parseConnect: packet.clientId: %s",w.clientId),b.will){if(w.protocolVersion===5){let k=this._parseProperties();Object.getOwnPropertyNames(k).length&&(w.will.properties=k)}if(c=this._parseString(),c===null)return this._emitError(new Error("Cannot parse will topic"));if(w.will.topic=c,i("_parseConnect: packet.will.topic: %s",w.will.topic),h=this._parseBuffer(),h===null)return this._emitError(new Error("Cannot parse will payload"));w.will.payload=h,i("_parseConnect: packet.will.paylaod: %s",w.will.payload)}if(b.username){if(g=this._parseString(),g===null)return this._emitError(new Error("Cannot parse username"));w.username=g,i("_parseConnect: packet.username: %s",w.username)}if(b.password){if(d=this._parseBuffer(),d===null)return this._emitError(new Error("Cannot parse password"));w.password=d}return this.settings=w,i("_parseConnect: complete"),w}_parseConnack(){i("_parseConnack");let c=this.packet;if(this._list.length<1)return null;let h=this._list.readUInt8(this._pos++);if(h>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(c.sessionPresent=!!(h&r.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?c.reasonCode=this._list.readUInt8(this._pos++):c.reasonCode=0;else{if(this._list.length<2)return null;c.returnCode=this._list.readUInt8(this._pos++)}if(c.returnCode===-1||c.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(c.properties=d)}i("_parseConnack: complete")}_parsePublish(){i("_parsePublish");let c=this.packet;if(c.topic=this._parseString(),c.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(c.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let h=this._parseProperties();Object.getOwnPropertyNames(h).length&&(c.properties=h)}c.payload=this._list.slice(this._pos,c.length),i("_parsePublish: payload from buffer list: %o",c.payload)}}_parseSubscribe(){i("_parseSubscribe");let c=this.packet,h,d,g,b,w,E,T;if(c.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let R=this._parseProperties();Object.getOwnPropertyNames(R).length&&(c.properties=R)}if(c.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<c.length;){if(h=this._parseString(),h===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=c.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(d=this._parseByte(),this.settings.protocolVersion===5){if(d&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(d&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(g=d&r.SUBSCRIBE_OPTIONS_QOS_MASK,g>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(E=(d>>r.SUBSCRIBE_OPTIONS_NL_SHIFT&r.SUBSCRIBE_OPTIONS_NL_MASK)!==0,w=(d>>r.SUBSCRIBE_OPTIONS_RAP_SHIFT&r.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,b=d>>r.SUBSCRIBE_OPTIONS_RH_SHIFT&r.SUBSCRIBE_OPTIONS_RH_MASK,b>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));T={topic:h,qos:g},this.settings.protocolVersion===5?(T.nl=E,T.rap=w,T.rh=b):this.settings.bridgeMode&&(T.rh=0,T.rap=!0,T.nl=!0),i("_parseSubscribe: push subscription `%s` to subscription",T),c.subscriptions.push(T)}}}_parseSuback(){i("_parseSuback");let c=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let h=this._parseProperties();Object.getOwnPropertyNames(h).length&&(c.properties=h)}if(c.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let h=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!r.MQTT5_SUBACK_CODES[h])return this._emitError(new Error("Invalid suback code"))}else if(h>2&&h!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(h)}}}_parseUnsubscribe(){i("_parseUnsubscribe");let c=this.packet;if(c.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let h=this._parseProperties();Object.getOwnPropertyNames(h).length&&(c.properties=h)}if(c.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<c.length;){let h=this._parseString();if(h===null)return this._emitError(new Error("Cannot parse topic"));i("_parseUnsubscribe: push topic `%s` to unsubscriptions",h),c.unsubscriptions.push(h)}}}_parseUnsuback(){i("_parseUnsuback");let c=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&c.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(c.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let h=this._parseProperties();for(Object.getOwnPropertyNames(h).length&&(c.properties=h),c.granted=[];this._pos<this.packet.length;){let d=this._list.readUInt8(this._pos++);if(!r.MQTT5_UNSUBACK_CODES[d])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(d)}}}_parseConfirmation(){i("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let c=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(c.length>2){switch(c.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!r.MQTT5_PUBACK_PUBREC_CODES[c.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!r.MQTT5_PUBREL_PUBCOMP_CODES[c.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}i("_parseConfirmation: packet.reasonCode `%d`",c.reasonCode)}else c.reasonCode=0;if(c.length>3){let h=this._parseProperties();Object.getOwnPropertyNames(h).length&&(c.properties=h)}}return!0}_parseDisconnect(){let c=this.packet;if(i("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(c.reasonCode=this._parseByte(),r.MQTT5_DISCONNECT_CODES[c.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):c.reasonCode=0;let h=this._parseProperties();Object.getOwnPropertyNames(h).length&&(c.properties=h)}return i("_parseDisconnect result: true"),!0}_parseAuth(){i("_parseAuth");let c=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(c.reasonCode=this._parseByte(),!r.MQTT5_AUTH_CODES[c.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let h=this._parseProperties();return Object.getOwnPropertyNames(h).length&&(c.properties=h),i("_parseAuth: result: true"),!0}_parseMessageId(){let c=this.packet;return c.messageId=this._parseNum(),c.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(i("_parseMessageId: packet.messageId %d",c.messageId),!0)}_parseString(c){let h=this._parseNum(),d=h+this._pos;if(h===-1||d>this._list.length||d>this.packet.length)return null;let g=this._list.toString("utf8",this._pos,d);return this._pos+=h,i("_parseString: result: %s",g),g}_parseStringPair(){return i("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let c=this._parseNum(),h=c+this._pos;if(c===-1||h>this._list.length||h>this.packet.length)return null;let d=this._list.slice(this._pos,h);return this._pos+=c,i("_parseBuffer: result: %o",d),d}_parseNum(){if(this._list.length-this._pos<2)return-1;let c=this._list.readUInt16BE(this._pos);return this._pos+=2,i("_parseNum: result: %s",c),c}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let c=this._list.readUInt32BE(this._pos);return this._pos+=4,i("_parse4ByteNum: result: %s",c),c}_parseVarByteNum(c){i("_parseVarByteNum");let h=4,d=0,g=1,b=0,w=!1,E,T=this._pos?this._pos:0;for(;d<h&&T+d<this._list.length;){if(E=this._list.readUInt8(T+d++),b+=g*(E&r.VARBYTEINT_MASK),g*=128,!(E&r.VARBYTEINT_FIN_MASK)){w=!0;break}if(this._list.length<=d)break}return!w&&d===h&&this._list.length>=d&&this._emitError(new Error("Invalid variable byte integer")),T&&(this._pos+=d),w?c?w={bytes:d,value:b}:w=b:w=!1,i("_parseVarByteNum: result: %o",w),w}_parseByte(){let c;return this._pos<this._list.length&&(c=this._list.readUInt8(this._pos),this._pos++),i("_parseByte: result: %o",c),c}_parseByType(c){switch(i("_parseByType: type: %s",c),c){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){i("_parseProperties");let c=this._parseVarByteNum(),h=this._pos+c,d={};for(;this._pos<h;){let g=this._parseByte();if(!g)return this._emitError(new Error("Cannot parse property code type")),!1;let b=r.propertiesCodes[g];if(!b)return this._emitError(new Error("Unknown property")),!1;if(b==="userProperties"){d[b]||(d[b]=Object.create(null));let w=this._parseByType(r.propertiesTypes[b]);if(d[b][w.name])if(Array.isArray(d[b][w.name]))d[b][w.name].push(w.value);else{let E=d[b][w.name];d[b][w.name]=[E],d[b][w.name].push(w.value)}else d[b][w.name]=w.value;continue}d[b]?Array.isArray(d[b])?d[b].push(this._parseByType(r.propertiesTypes[b])):(d[b]=[d[b]],d[b].push(this._parseByType(r.propertiesTypes[b]))):d[b]=this._parseByType(r.propertiesTypes[b])}return d}_newPacket(){return i("_newPacket"),this.packet&&(this._list.consume(this.packet.length),i("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),i("_newPacket: new packet"),this.packet=new u,this._pos=0,!0}_emitError(c){i("_emitError",c),this.error=c,this.emit("error",c)}};o.exports=s}),Ad=M((e,o)=>{_(),v(),m();var{Buffer:t}=(be(),X(me)),n=65536,u={},r=t.isBuffer(t.from([1,2]).subarray(0,1));function i(h){let d=t.allocUnsafe(2);return d.writeUInt8(h>>8,0),d.writeUInt8(h&255,1),d}function s(){for(let h=0;h<n;h++)u[h]=i(h)}function a(h){let d=0,g=0,b=t.allocUnsafe(4);do d=h%128|0,h=h/128|0,h>0&&(d=d|128),b.writeUInt8(d,g++);while(h>0&&g<4);return h>0&&(g=0),r?b.subarray(0,g):b.slice(0,g)}function c(h){let d=t.allocUnsafe(4);return d.writeUInt32BE(h,0),d}o.exports={cache:u,generateCache:s,generateNumber:i,genBufVariableByteInt:a,generate4ByteBuffer:c}}),Id=M((e,o)=>{_(),v(),m(),typeof B>"u"||!B.version||B.version.indexOf("v0.")===0||B.version.indexOf("v1.")===0&&B.version.indexOf("v1.8.")!==0?o.exports={nextTick:t}:o.exports=B;function t(n,u,r,i){if(typeof n!="function")throw new TypeError('"callback" argument must be a function');var s=arguments.length,a,c;switch(s){case 0:case 1:return B.nextTick(n);case 2:return B.nextTick(function(){n.call(null,u)});case 3:return B.nextTick(function(){n.call(null,u,r)});case 4:return B.nextTick(function(){n.call(null,u,r,i)});default:for(a=new Array(s-1),c=0;c<a.length;)a[c++]=arguments[c];return B.nextTick(function(){n.apply(null,a)})}}}),Qo=M((e,o)=>{_(),v(),m();var t=Ho(),{Buffer:n}=(be(),X(me)),u=n.allocUnsafe(0),r=n.from([0]),i=Ad(),s=Id().nextTick,a=ot()("mqtt-packet:writeToStream"),c=i.cache,h=i.generateNumber,d=i.generateCache,g=i.genBufVariableByteInt,b=i.generate4ByteBuffer,w=We,E=!0;function T(P,C,oe){switch(a("generate called"),C.cork&&(C.cork(),s(R,C)),E&&(E=!1,d()),a("generate: packet.cmd: %s",P.cmd),P.cmd){case"connect":return I(P,C);case"connack":return k(P,C,oe);case"publish":return W(P,C,oe);case"puback":case"pubrec":case"pubrel":case"pubcomp":return Q(P,C,oe);case"subscribe":return U(P,C,oe);case"suback":return D(P,C,oe);case"unsubscribe":return V(P,C,oe);case"unsuback":return ae(P,C,oe);case"pingreq":case"pingresp":return $(P,C);case"disconnect":return xe(P,C,oe);case"auth":return N(P,C,oe);default:return C.destroy(new Error("Unknown command")),!1}}Object.defineProperty(T,"cacheNumbers",{get(){return w===We},set(P){P?((!c||Object.keys(c).length===0)&&(E=!0),w=We):(E=!1,w=H)}});function R(P){P.uncork()}function I(P,C,oe){let Ce=P||{},ve=Ce.protocolId||"MQTT",he=Ce.protocolVersion||4,je=Ce.will,Ie=Ce.clean,L=Ce.keepalive||0,z=Ce.clientId||"",ee=Ce.username,De=Ce.password,ke=Ce.properties;Ie===void 0&&(Ie=!0);let K=0;if(!ve||typeof ve!="string"&&!n.isBuffer(ve))return C.destroy(new Error("Invalid protocolId")),!1;if(K+=ve.length+2,he!==3&&he!==4&&he!==5)return C.destroy(new Error("Invalid protocol version")),!1;if(K+=1,(typeof z=="string"||n.isBuffer(z))&&(z||he>=4)&&(z||Ie))K+=n.byteLength(z)+2;else{if(he<4)return C.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(Ie*1===0)return C.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof L!="number"||L<0||L>65535||L%1!==0)return C.destroy(new Error("Invalid keepalive")),!1;K+=2,K+=1;let de,F;if(he===5){if(de=ie(C,ke),!de)return!1;K+=de.length}if(je){if(typeof je!="object")return C.destroy(new Error("Invalid will")),!1;if(!je.topic||typeof je.topic!="string")return C.destroy(new Error("Invalid will topic")),!1;if(K+=n.byteLength(je.topic)+2,K+=2,je.payload)if(je.payload.length>=0)typeof je.payload=="string"?K+=n.byteLength(je.payload):K+=je.payload.length;else return C.destroy(new Error("Invalid will payload")),!1;if(F={},he===5){if(F=ie(C,je.properties),!F)return!1;K+=F.length}}let te=!1;if(ee!=null)if(Se(ee))te=!0,K+=n.byteLength(ee)+2;else return C.destroy(new Error("Invalid username")),!1;if(De!=null){if(!te)return C.destroy(new Error("Username is required to use password")),!1;if(Se(De))K+=Te(De)+2;else return C.destroy(new Error("Invalid password")),!1}C.write(t.CONNECT_HEADER),Le(C,K),G(C,ve),Ce.bridgeMode&&(he+=128),C.write(he===131?t.VERSION131:he===132?t.VERSION132:he===4?t.VERSION4:he===5?t.VERSION5:t.VERSION3);let ue=0;return ue|=ee!=null?t.USERNAME_MASK:0,ue|=De!=null?t.PASSWORD_MASK:0,ue|=je&&je.retain?t.WILL_RETAIN_MASK:0,ue|=je&&je.qos?je.qos<<t.WILL_QOS_SHIFT:0,ue|=je?t.WILL_FLAG_MASK:0,ue|=Ie?t.CLEAN_SESSION_MASK:0,C.write(n.from([ue])),w(C,L),he===5&&de.write(),G(C,z),je&&(he===5&&F.write(),ge(C,je.topic),G(C,je.payload)),ee!=null&&G(C,ee),De!=null&&G(C,De),!0}function k(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=Ce===5?ve.reasonCode:ve.returnCode,je=ve.properties,Ie=2;if(typeof he!="number")return C.destroy(new Error("Invalid return code")),!1;let L=null;if(Ce===5){if(L=ie(C,je),!L)return!1;Ie+=L.length}return C.write(t.CONNACK_HEADER),Le(C,Ie),C.write(ve.sessionPresent?t.SESSIONPRESENT_HEADER:r),C.write(n.from([he])),L==null||L.write(),!0}function W(P,C,oe){a("publish: packet: %o",P);let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.qos||0,je=ve.retain?t.RETAIN_MASK:0,Ie=ve.topic,L=ve.payload||u,z=ve.messageId,ee=ve.properties,De=0;if(typeof Ie=="string")De+=n.byteLength(Ie)+2;else if(n.isBuffer(Ie))De+=Ie.length+2;else return C.destroy(new Error("Invalid topic")),!1;if(n.isBuffer(L)?De+=L.length:De+=n.byteLength(L),he&&typeof z!="number")return C.destroy(new Error("Invalid messageId")),!1;he&&(De+=2);let ke=null;if(Ce===5){if(ke=ie(C,ee),!ke)return!1;De+=ke.length}return C.write(t.PUBLISH_HEADER[he][ve.dup?1:0][je?1:0]),Le(C,De),w(C,Te(Ie)),C.write(Ie),he>0&&w(C,z),ke==null||ke.write(),a("publish: payload: %o",L),C.write(L)}function Q(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.cmd||"puback",je=ve.messageId,Ie=ve.dup&&he==="pubrel"?t.DUP_MASK:0,L=0,z=ve.reasonCode,ee=ve.properties,De=Ce===5?3:2;if(he==="pubrel"&&(L=1),typeof je!="number")return C.destroy(new Error("Invalid messageId")),!1;let ke=null;if(Ce===5&&typeof ee=="object"){if(ke=S(C,ee,oe,De),!ke)return!1;De+=ke.length}return C.write(t.ACKS[he][L][Ie][0]),De===3&&(De+=z!==0?1:-1),Le(C,De),w(C,je),Ce===5&&De!==2&&C.write(n.from([z])),ke!==null?ke.write():De===4&&C.write(n.from([0])),!0}function U(P,C,oe){a("subscribe: packet: ");let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.dup?t.DUP_MASK:0,je=ve.messageId,Ie=ve.subscriptions,L=ve.properties,z=0;if(typeof je!="number")return C.destroy(new Error("Invalid messageId")),!1;z+=2;let ee=null;if(Ce===5){if(ee=ie(C,L),!ee)return!1;z+=ee.length}if(typeof Ie=="object"&&Ie.length)for(let ke=0;ke<Ie.length;ke+=1){let K=Ie[ke].topic,de=Ie[ke].qos;if(typeof K!="string")return C.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof de!="number")return C.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(Ce===5){if(typeof(Ie[ke].nl||!1)!="boolean")return C.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(Ie[ke].rap||!1)!="boolean")return C.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let F=Ie[ke].rh||0;if(typeof F!="number"||F>2)return C.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}z+=n.byteLength(K)+2+1}else return C.destroy(new Error("Invalid subscriptions")),!1;a("subscribe: writing to stream: %o",t.SUBSCRIBE_HEADER),C.write(t.SUBSCRIBE_HEADER[1][he?1:0][0]),Le(C,z),w(C,je),ee!==null&&ee.write();let De=!0;for(let ke of Ie){let K=ke.topic,de=ke.qos,F=+ke.nl,te=+ke.rap,ue=ke.rh,Ue;ge(C,K),Ue=t.SUBSCRIBE_OPTIONS_QOS[de],Ce===5&&(Ue|=F?t.SUBSCRIBE_OPTIONS_NL:0,Ue|=te?t.SUBSCRIBE_OPTIONS_RAP:0,Ue|=ue?t.SUBSCRIBE_OPTIONS_RH[ue]:0),De=C.write(n.from([Ue]))}return De}function D(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.messageId,je=ve.granted,Ie=ve.properties,L=0;if(typeof he!="number")return C.destroy(new Error("Invalid messageId")),!1;if(L+=2,typeof je=="object"&&je.length)for(let ee=0;ee<je.length;ee+=1){if(typeof je[ee]!="number")return C.destroy(new Error("Invalid qos vector")),!1;L+=1}else return C.destroy(new Error("Invalid qos vector")),!1;let z=null;if(Ce===5){if(z=S(C,Ie,oe,L),!z)return!1;L+=z.length}return C.write(t.SUBACK_HEADER),Le(C,L),w(C,he),z!==null&&z.write(),C.write(n.from(je))}function V(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.messageId,je=ve.dup?t.DUP_MASK:0,Ie=ve.unsubscriptions,L=ve.properties,z=0;if(typeof he!="number")return C.destroy(new Error("Invalid messageId")),!1;if(z+=2,typeof Ie=="object"&&Ie.length)for(let ke=0;ke<Ie.length;ke+=1){if(typeof Ie[ke]!="string")return C.destroy(new Error("Invalid unsubscriptions")),!1;z+=n.byteLength(Ie[ke])+2}else return C.destroy(new Error("Invalid unsubscriptions")),!1;let ee=null;if(Ce===5){if(ee=ie(C,L),!ee)return!1;z+=ee.length}C.write(t.UNSUBSCRIBE_HEADER[1][je?1:0][0]),Le(C,z),w(C,he),ee!==null&&ee.write();let De=!0;for(let ke=0;ke<Ie.length;ke++)De=ge(C,Ie[ke]);return De}function ae(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.messageId,je=ve.dup?t.DUP_MASK:0,Ie=ve.granted,L=ve.properties,z=ve.cmd,ee=0,De=2;if(typeof he!="number")return C.destroy(new Error("Invalid messageId")),!1;if(Ce===5)if(typeof Ie=="object"&&Ie.length)for(let K=0;K<Ie.length;K+=1){if(typeof Ie[K]!="number")return C.destroy(new Error("Invalid qos vector")),!1;De+=1}else return C.destroy(new Error("Invalid qos vector")),!1;let ke=null;if(Ce===5){if(ke=S(C,L,oe,De),!ke)return!1;De+=ke.length}return C.write(t.ACKS[z][ee][je][0]),Le(C,De),w(C,he),ke!==null&&ke.write(),Ce===5&&C.write(n.from(Ie)),!0}function $(P,C,oe){return C.write(t.EMPTY[P.cmd])}function xe(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.reasonCode,je=ve.properties,Ie=Ce===5?1:0,L=null;if(Ce===5){if(L=S(C,je,oe,Ie),!L)return!1;Ie+=L.length}return C.write(n.from([t.codes.disconnect<<4])),Le(C,Ie),Ce===5&&C.write(n.from([he])),L!==null&&L.write(),!0}function N(P,C,oe){let Ce=oe?oe.protocolVersion:4,ve=P||{},he=ve.reasonCode,je=ve.properties,Ie=Ce===5?1:0;Ce!==5&&C.destroy(new Error("Invalid mqtt version for auth packet"));let L=S(C,je,oe,Ie);return L?(Ie+=L.length,C.write(n.from([t.codes.auth<<4])),Le(C,Ie),C.write(n.from([he])),L!==null&&L.write(),!0):!1}var le={};function Le(P,C){if(C>t.VARBYTEINT_MAX)return P.destroy(new Error(`Invalid variable byte integer: ${C}`)),!1;let oe=le[C];return oe||(oe=g(C),C<16384&&(le[C]=oe)),a("writeVarByteInt: writing to stream: %o",oe),P.write(oe)}function ge(P,C){let oe=n.byteLength(C);return w(P,oe),a("writeString: %s",C),P.write(C,"utf8")}function qe(P,C,oe){ge(P,C),ge(P,oe)}function We(P,C){return a("writeNumberCached: number: %d",C),a("writeNumberCached: %o",c[C]),P.write(c[C])}function H(P,C){let oe=h(C);return a("writeNumberGenerated: %o",oe),P.write(oe)}function ye(P,C){let oe=b(C);return a("write4ByteNumber: %o",oe),P.write(oe)}function G(P,C){typeof C=="string"?ge(P,C):C?(w(P,C.length),P.write(C)):w(P,0)}function ie(P,C){if(typeof C!="object"||C.length!=null)return{length:1,write(){pe(P,{},0)}};let oe=0;function Ce(ve,he){let je=t.propertiesTypes[ve],Ie=0;switch(je){case"byte":{if(typeof he!="boolean")return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=2;break}case"int8":{if(typeof he!="number"||he<0||he>255)return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=2;break}case"binary":{if(he&&he===null)return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=1+n.byteLength(he)+2;break}case"int16":{if(typeof he!="number"||he<0||he>65535)return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=3;break}case"int32":{if(typeof he!="number"||he<0||he>4294967295)return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=5;break}case"var":{if(typeof he!="number"||he<0||he>268435455)return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=1+n.byteLength(g(he));break}case"string":{if(typeof he!="string")return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=3+n.byteLength(he.toString());break}case"pair":{if(typeof he!="object")return P.destroy(new Error(`Invalid ${ve}: ${he}`)),!1;Ie+=Object.getOwnPropertyNames(he).reduce((L,z)=>{let ee=he[z];return Array.isArray(ee)?L+=ee.reduce((De,ke)=>(De+=3+n.byteLength(z.toString())+2+n.byteLength(ke.toString()),De),0):L+=3+n.byteLength(z.toString())+2+n.byteLength(he[z].toString()),L},0);break}default:return P.destroy(new Error(`Invalid property ${ve}: ${he}`)),!1}return Ie}if(C)for(let ve in C){let he=0,je=0,Ie=C[ve];if(Array.isArray(Ie))for(let L=0;L<Ie.length;L++){if(je=Ce(ve,Ie[L]),!je)return!1;he+=je}else{if(je=Ce(ve,Ie),!je)return!1;he=je}if(!he)return!1;oe+=he}return{length:n.byteLength(g(oe))+oe,write(){pe(P,C,oe)}}}function S(P,C,oe,Ce){let ve=["reasonString","userProperties"],he=oe&&oe.properties&&oe.properties.maximumPacketSize?oe.properties.maximumPacketSize:0,je=ie(P,C);if(he)for(;Ce+je.length>he;){let Ie=ve.shift();if(Ie&&C[Ie])delete C[Ie],je=ie(P,C);else return!1}return je}function J(P,C,oe){switch(t.propertiesTypes[C]){case"byte":{P.write(n.from([t.properties[C]])),P.write(n.from([+oe]));break}case"int8":{P.write(n.from([t.properties[C]])),P.write(n.from([oe]));break}case"binary":{P.write(n.from([t.properties[C]])),G(P,oe);break}case"int16":{P.write(n.from([t.properties[C]])),w(P,oe);break}case"int32":{P.write(n.from([t.properties[C]])),ye(P,oe);break}case"var":{P.write(n.from([t.properties[C]])),Le(P,oe);break}case"string":{P.write(n.from([t.properties[C]])),ge(P,oe);break}case"pair":{Object.getOwnPropertyNames(oe).forEach(Ce=>{let ve=oe[Ce];Array.isArray(ve)?ve.forEach(he=>{P.write(n.from([t.properties[C]])),qe(P,Ce.toString(),he.toString())}):(P.write(n.from([t.properties[C]])),qe(P,Ce.toString(),ve.toString()))});break}default:return P.destroy(new Error(`Invalid property ${C} value: ${oe}`)),!1}}function pe(P,C,oe){Le(P,oe);for(let Ce in C)if(Object.prototype.hasOwnProperty.call(C,Ce)&&C[Ce]!==null){let ve=C[Ce];if(Array.isArray(ve))for(let he=0;he<ve.length;he++)J(P,Ce,ve[he]);else J(P,Ce,ve)}}function Te(P){return P?P instanceof n?P.length:n.byteLength(P):0}function Se(P){return typeof P=="string"||P instanceof n}o.exports=T}),Ud=M((e,o)=>{_(),v(),m();var t=Qo(),{EventEmitter:n}=(sr(),X(nr)),{Buffer:u}=(be(),X(me));function r(s,a){let c=new i;return t(s,c,a),c.concat()}var i=class extends n{constructor(){super(),this._array=new Array(20),this._i=0}write(s){return this._array[this._i++]=s,!0}concat(){let s=0,a=new Array(this._array.length),c=this._array,h=0,d;for(d=0;d<c.length&&c[d]!==void 0;d++)typeof c[d]!="string"?a[d]=c[d].length:a[d]=u.byteLength(c[d]),s+=a[d];let g=u.allocUnsafe(s);for(d=0;d<c.length&&c[d]!==void 0;d++)typeof c[d]!="string"?(c[d].copy(g,h),h+=a[d]):(g.write(c[d],h),h+=a[d]);return g}destroy(s){s&&this.emit("error",s)}};o.exports=r}),Nd=M(e=>{_(),v(),m(),e.parser=md().parser,e.generate=Ud(),e.writeToStream=Qo()}),Zo=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=class{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let t=this.nextId++;return this.nextId===65536&&(this.nextId=1),t}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(t){return!0}deallocate(t){}clear(){}};e.default=o}),Dd=M((e,o)=>{_(),v(),m(),o.exports=n;function t(r){return r instanceof x?x.from(r):new r.constructor(r.buffer.slice(),r.byteOffset,r.length)}function n(r){if(r=r||{},r.circles)return u(r);return r.proto?a:s;function i(c,h){for(var d=Object.keys(c),g=new Array(d.length),b=0;b<d.length;b++){var w=d[b],E=c[w];typeof E!="object"||E===null?g[w]=E:E instanceof Date?g[w]=new Date(E):ArrayBuffer.isView(E)?g[w]=t(E):g[w]=h(E)}return g}function s(c){if(typeof c!="object"||c===null)return c;if(c instanceof Date)return new Date(c);if(Array.isArray(c))return i(c,s);if(c instanceof Map)return new Map(i(Array.from(c),s));if(c instanceof Set)return new Set(i(Array.from(c),s));var h={};for(var d in c)if(Object.hasOwnProperty.call(c,d)!==!1){var g=c[d];typeof g!="object"||g===null?h[d]=g:g instanceof Date?h[d]=new Date(g):g instanceof Map?h[d]=new Map(i(Array.from(g),s)):g instanceof Set?h[d]=new Set(i(Array.from(g),s)):ArrayBuffer.isView(g)?h[d]=t(g):h[d]=s(g)}return h}function a(c){if(typeof c!="object"||c===null)return c;if(c instanceof Date)return new Date(c);if(Array.isArray(c))return i(c,a);if(c instanceof Map)return new Map(i(Array.from(c),a));if(c instanceof Set)return new Set(i(Array.from(c),a));var h={};for(var d in c){var g=c[d];typeof g!="object"||g===null?h[d]=g:g instanceof Date?h[d]=new Date(g):g instanceof Map?h[d]=new Map(i(Array.from(g),a)):g instanceof Set?h[d]=new Set(i(Array.from(g),a)):ArrayBuffer.isView(g)?h[d]=t(g):h[d]=a(g)}return h}}function u(r){var i=[],s=[];return r.proto?h:c;function a(d,g){for(var b=Object.keys(d),w=new Array(b.length),E=0;E<b.length;E++){var T=b[E],R=d[T];if(typeof R!="object"||R===null)w[T]=R;else if(R instanceof Date)w[T]=new Date(R);else if(ArrayBuffer.isView(R))w[T]=t(R);else{var I=i.indexOf(R);I!==-1?w[T]=s[I]:w[T]=g(R)}}return w}function c(d){if(typeof d!="object"||d===null)return d;if(d instanceof Date)return new Date(d);if(Array.isArray(d))return a(d,c);if(d instanceof Map)return new Map(a(Array.from(d),c));if(d instanceof Set)return new Set(a(Array.from(d),c));var g={};i.push(d),s.push(g);for(var b in d)if(Object.hasOwnProperty.call(d,b)!==!1){var w=d[b];if(typeof w!="object"||w===null)g[b]=w;else if(w instanceof Date)g[b]=new Date(w);else if(w instanceof Map)g[b]=new Map(a(Array.from(w),c));else if(w instanceof Set)g[b]=new Set(a(Array.from(w),c));else if(ArrayBuffer.isView(w))g[b]=t(w);else{var E=i.indexOf(w);E!==-1?g[b]=s[E]:g[b]=c(w)}}return i.pop(),s.pop(),g}function h(d){if(typeof d!="object"||d===null)return d;if(d instanceof Date)return new Date(d);if(Array.isArray(d))return a(d,h);if(d instanceof Map)return new Map(a(Array.from(d),h));if(d instanceof Set)return new Set(a(Array.from(d),h));var g={};i.push(d),s.push(g);for(var b in d){var w=d[b];if(typeof w!="object"||w===null)g[b]=w;else if(w instanceof Date)g[b]=new Date(w);else if(w instanceof Map)g[b]=new Map(a(Array.from(w),h));else if(w instanceof Set)g[b]=new Set(a(Array.from(w),h));else if(ArrayBuffer.isView(w))g[b]=t(w);else{var E=i.indexOf(w);E!==-1?g[b]=s[E]:g[b]=h(w)}}return i.pop(),s.pop(),g}}}),Fd=M((e,o)=>{_(),v(),m(),o.exports=Dd()()}),$d=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.validateTopics=e.validateTopic=void 0;function o(n){let u=n.split("/");for(let r=0;r<u.length;r++)if(u[r]!=="+"){if(u[r]==="#")return r===u.length-1;if(u[r].indexOf("+")!==-1||u[r].indexOf("#")!==-1)return!1}return!0}e.validateTopic=o;function t(n){if(n.length===0)return"empty_topic_list";for(let u=0;u<n.length;u++)if(!o(n[u]))return n[u];return null}e.validateTopics=t}),ra=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=jt(),t={objectMode:!0},n={clean:!0},u=class{constructor(r){this.options=r||{},this.options=Object.assign(Object.assign({},n),r),this._inflights=new Map}put(r,i){return this._inflights.set(r.messageId,r),i&&i(),this}createStream(){let r=new o.Readable(t),i=[],s=!1,a=0;return this._inflights.forEach((c,h)=>{i.push(c)}),r._read=()=>{!s&&a<i.length?r.push(i[a++]):r.push(null)},r.destroy=c=>{if(!s)return s=!0,setTimeout(()=>{r.emit("close")},0),r},r}del(r,i){let s=this._inflights.get(r.messageId);return s?(this._inflights.delete(r.messageId),i(null,s)):i&&i(new Error("missing packet")),this}get(r,i){let s=this._inflights.get(r.messageId);return s?i(null,s):i&&i(new Error("missing packet")),this}close(r){this.options.clean&&(this._inflights=null),r&&r()}};e.default=u}),Vd=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=[0,16,128,131,135,144,145,151,153],t=(n,u,r)=>{n.log("handlePublish: packet %o",u),r=typeof r<"u"?r:n.noop;let i=u.topic.toString(),s=u.payload,{qos:a}=u,{messageId:c}=u,{options:h}=n;if(n.options.protocolVersion===5){let d;if(u.properties&&(d=u.properties.topicAlias),typeof d<"u")if(i.length===0)if(d>0&&d<=65535){let g=n.topicAliasRecv.getTopicByAlias(d);if(g)i=g,n.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",i,d);else{n.log("handlePublish :: unregistered topic alias. alias: %d",d),n.emit("error",new Error("Received unregistered Topic Alias"));return}}else{n.log("handlePublish :: topic alias out of range. alias: %d",d),n.emit("error",new Error("Received Topic Alias is out of range"));return}else if(n.topicAliasRecv.put(i,d))n.log("handlePublish :: registered topic: %s - alias: %d",i,d);else{n.log("handlePublish :: topic alias out of range. alias: %d",d),n.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(n.log("handlePublish: qos %d",a),a){case 2:{h.customHandleAcks(i,s,u,(d,g)=>{if(typeof d=="number"&&(g=d,d=null),d)return n.emit("error",d);if(o.indexOf(g)===-1)return n.emit("error",new Error("Wrong reason code for pubrec"));g?n._sendPacket({cmd:"pubrec",messageId:c,reasonCode:g},r):n.incomingStore.put(u,()=>{n._sendPacket({cmd:"pubrec",messageId:c},r)})});break}case 1:{h.customHandleAcks(i,s,u,(d,g)=>{if(typeof d=="number"&&(g=d,d=null),d)return n.emit("error",d);if(o.indexOf(g)===-1)return n.emit("error",new Error("Wrong reason code for puback"));g||n.emit("message",i,s,u),n.handleMessage(u,b=>{if(b)return r&&r(b);n._sendPacket({cmd:"puback",messageId:c,reasonCode:g},r)})});break}case 0:n.emit("message",i,s,u),n.handleMessage(u,r);break;default:n.log("handlePublish: unknown QoS. Doing nothing.");break}};e.default=t}),zd=M((e,o)=>{o.exports={version:"5.10.3"}}),_r=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.MQTTJS_VERSION=e.nextTick=e.applyMixin=e.ErrorWithReasonCode=void 0;var o=class wr extends Error{constructor(u,r){super(u),this.code=r,Object.setPrototypeOf(this,wr.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};e.ErrorWithReasonCode=o;function t(n,u,r=!1){var i;let s=[u];for(;;){let a=s[0],c=Object.getPrototypeOf(a);if(c!=null&&c.prototype)s.unshift(c);else break}for(let a of s)for(let c of Object.getOwnPropertyNames(a.prototype))(r||c!=="constructor")&&Object.defineProperty(n.prototype,c,(i=Object.getOwnPropertyDescriptor(a.prototype,c))!==null&&i!==void 0?i:Object.create(null))}e.applyMixin=t,e.nextTick=typeof(B==null?void 0:B.nextTick)=="function"?B.nextTick:n=>{setTimeout(n,0)},e.MQTTJS_VERSION=zd().version}),Ti=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=void 0;var o=_r();e.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var t=(n,u)=>{let{messageId:r}=u,i=u.cmd,s=null,a=n.outgoing[r]?n.outgoing[r].cb:null,c=null;if(!a){n.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(n.log("_handleAck :: packet type",i),i){case"pubcomp":case"puback":{let h=u.reasonCode;h&&h>0&&h!==16?(c=new o.ErrorWithReasonCode(`Publish error: ${e.ReasonCodes[h]}`,h),n._removeOutgoingAndStoreMessage(r,()=>{a(c,u)})):n._removeOutgoingAndStoreMessage(r,a);break}case"pubrec":{s={cmd:"pubrel",qos:2,messageId:r};let h=u.reasonCode;h&&h>0&&h!==16?(c=new o.ErrorWithReasonCode(`Publish error: ${e.ReasonCodes[h]}`,h),n._removeOutgoingAndStoreMessage(r,()=>{a(c,u)})):n._sendPacket(s);break}case"suback":{delete n.outgoing[r],n.messageIdProvider.deallocate(r);let h=u.granted;for(let d=0;d<h.length;d++){let g=h[d];if(g&128){c=new Error(`Subscribe error: ${e.ReasonCodes[g]}`),c.code=g;let b=n.messageIdToTopic[r];b&&b.forEach(w=>{delete n._resubscribeTopics[w]})}}delete n.messageIdToTopic[r],n._invokeStoreProcessingQueue(),a(c,u);break}case"unsuback":{delete n.outgoing[r],n.messageIdProvider.deallocate(r),n._invokeStoreProcessingQueue(),a(null,u);break}default:n.emit("error",new Error("unrecognized packet type"))}n.disconnecting&&Object.keys(n.outgoing).length===0&&n.emit("outgoingEmpty")};e.default=t}),Qd=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=_r(),t=Ti(),n=(u,r)=>{let{options:i}=u,s=i.protocolVersion,a=s===5?r.reasonCode:r.returnCode;if(s!==5){let c=new o.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${s}`,a);u.emit("error",c);return}u.handleAuth(r,(c,h)=>{if(c){u.emit("error",c);return}if(a===24)u.reconnecting=!1,u._sendPacket(h);else{let d=new o.ErrorWithReasonCode(`Connection refused: ${t.ReasonCodes[a]}`,a);u.emit("error",d)}})};e.default=n}),ep=M(e=>{var b,w,E,T,R,I,k,W,Q,U,D,V,ae,$,xe,N,le,Le,ge,qe,We,H,ye,G,ie,S,dr,pe,Te,Se,P,Er,oe,Ce,ve,xt,Mt,pr,er,tr,Tt,gr,Ht,K;_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=void 0;var o=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,t=new Set,n=typeof B=="object"&&B?B:{},u=(de,F,te,ue)=>{typeof n.emitWarning=="function"?n.emitWarning(de,F,te,ue):console.error(`[${te}] ${F}: ${de}`)},r=globalThis.AbortController,i=globalThis.AbortSignal;if(typeof r>"u"){i=class{constructor(){It(this,"onabort");It(this,"_onabort",[]);It(this,"reason");It(this,"aborted",!1)}addEventListener(te,ue){this._onabort.push(ue)}},r=class{constructor(){It(this,"signal",new i);F()}abort(te){var ue,Ue;if(!this.signal.aborted){this.signal.reason=te,this.signal.aborted=!0;for(let p of this.signal._onabort)p(te);(Ue=(ue=this.signal).onabort)==null||Ue.call(ue,te)}}};let de=((b=n.env)==null?void 0:b.LRU_CACHE_IGNORE_AC_WARNING)!=="1",F=()=>{de&&(de=!1,u("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",F))}}var s=de=>!t.has(de),a=de=>de&&de===Math.floor(de)&&de>0&&isFinite(de),c=de=>a(de)?de<=Math.pow(2,8)?Uint8Array:de<=Math.pow(2,16)?Uint16Array:de<=Math.pow(2,32)?Uint32Array:de<=Number.MAX_SAFE_INTEGER?h:null:null,h=class extends Array{constructor(de){super(de),this.fill(0)}},d=(w=class{constructor(F,te){It(this,"heap");It(this,"length");if(!q(w,E))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new te(F),this.length=0}static create(F){let te=c(F);if(!te)return[];Ge(w,E,!0);let ue=new w(F,te);return Ge(w,E,!1),ue}push(F){this.heap[this.length++]=F}pop(){return this.heap[--this.length]}},E=new WeakMap,ft(w,E,!1),w),g=(K=class{constructor(F){ft(this,S);ft(this,T);ft(this,R);ft(this,I);ft(this,k);ft(this,W);It(this,"ttl");It(this,"ttlResolution");It(this,"ttlAutopurge");It(this,"updateAgeOnGet");It(this,"updateAgeOnHas");It(this,"allowStale");It(this,"noDisposeOnSet");It(this,"noUpdateTTL");It(this,"maxEntrySize");It(this,"sizeCalculation");It(this,"noDeleteOnFetchRejection");It(this,"noDeleteOnStaleGet");It(this,"allowStaleOnFetchAbort");It(this,"allowStaleOnFetchRejection");It(this,"ignoreFetchAbort");ft(this,Q);ft(this,U);ft(this,D);ft(this,V);ft(this,ae);ft(this,$);ft(this,xe);ft(this,N);ft(this,le);ft(this,Le);ft(this,ge);ft(this,qe);ft(this,We);ft(this,H);ft(this,ye);ft(this,G);ft(this,ie);ft(this,pe,()=>{});ft(this,Te,()=>{});ft(this,Se,()=>{});ft(this,P,()=>!1);ft(this,oe,F=>{});ft(this,Ce,(F,te,ue)=>{});ft(this,ve,(F,te,ue,Ue)=>{if(ue||Ue)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});let{max:te=0,ttl:ue,ttlResolution:Ue=1,ttlAutopurge:p,updateAgeOnGet:f,updateAgeOnHas:y,allowStale:A,dispose:j,disposeAfter:se,noDisposeOnSet:Ne,noUpdateTTL:Ke,maxSize:rt=0,maxEntrySize:st=0,sizeCalculation:Ye,fetchMethod:et,noDeleteOnFetchRejection:Qe,noDeleteOnStaleGet:ct,allowStaleOnFetchRejection:yt,allowStaleOnFetchAbort:mt,ignoreFetchAbort:_t}=F;if(te!==0&&!a(te))throw new TypeError("max option must be a nonnegative integer");let Re=te?c(te):Array;if(!Re)throw new Error("invalid max value: "+te);if(Ge(this,T,te),Ge(this,R,rt),this.maxEntrySize=st||q(this,R),this.sizeCalculation=Ye,this.sizeCalculation){if(!q(this,R)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(et!==void 0&&typeof et!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ge(this,W,et),Ge(this,G,!!et),Ge(this,D,new Map),Ge(this,V,new Array(te).fill(void 0)),Ge(this,ae,new Array(te).fill(void 0)),Ge(this,$,new Re(te)),Ge(this,xe,new Re(te)),Ge(this,N,0),Ge(this,le,0),Ge(this,Le,d.create(te)),Ge(this,Q,0),Ge(this,U,0),typeof j=="function"&&Ge(this,I,j),typeof se=="function"?(Ge(this,k,se),Ge(this,ge,[])):(Ge(this,k,void 0),Ge(this,ge,void 0)),Ge(this,ye,!!q(this,I)),Ge(this,ie,!!q(this,k)),this.noDisposeOnSet=!!Ne,this.noUpdateTTL=!!Ke,this.noDeleteOnFetchRejection=!!Qe,this.allowStaleOnFetchRejection=!!yt,this.allowStaleOnFetchAbort=!!mt,this.ignoreFetchAbort=!!_t,this.maxEntrySize!==0){if(q(this,R)!==0&&!a(q(this,R)))throw new TypeError("maxSize must be a positive integer if specified");if(!a(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ze(this,S,Er).call(this)}if(this.allowStale=!!A,this.noDeleteOnStaleGet=!!ct,this.updateAgeOnGet=!!f,this.updateAgeOnHas=!!y,this.ttlResolution=a(Ue)||Ue===0?Ue:1,this.ttlAutopurge=!!p,this.ttl=ue||0,this.ttl){if(!a(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ze(this,S,dr).call(this)}if(q(this,T)===0&&this.ttl===0&&q(this,R)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!q(this,T)&&!q(this,R)){let He="LRU_CACHE_UNBOUNDED";s(He)&&(t.add(He),u("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",He,K))}}static unsafeExposeInternals(F){return{starts:q(F,We),ttls:q(F,H),sizes:q(F,qe),keyMap:q(F,D),keyList:q(F,V),valList:q(F,ae),next:q(F,$),prev:q(F,xe),get head(){return q(F,N)},get tail(){return q(F,le)},free:q(F,Le),isBackgroundFetch:te=>{var ue;return Ze(ue=F,S,Tt).call(ue,te)},backgroundFetch:(te,ue,Ue,p)=>{var f;return Ze(f=F,S,tr).call(f,te,ue,Ue,p)},moveToTail:te=>{var ue;return Ze(ue=F,S,Ht).call(ue,te)},indexes:te=>{var ue;return Ze(ue=F,S,xt).call(ue,te)},rindexes:te=>{var ue;return Ze(ue=F,S,Mt).call(ue,te)},isStale:te=>{var ue;return q(ue=F,P).call(ue,te)}}}get max(){return q(this,T)}get maxSize(){return q(this,R)}get calculatedSize(){return q(this,U)}get size(){return q(this,Q)}get fetchMethod(){return q(this,W)}get dispose(){return q(this,I)}get disposeAfter(){return q(this,k)}getRemainingTTL(F){return q(this,D).has(F)?1/0:0}*entries(){for(let F of Ze(this,S,xt).call(this))q(this,ae)[F]!==void 0&&q(this,V)[F]!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield[q(this,V)[F],q(this,ae)[F]])}*rentries(){for(let F of Ze(this,S,Mt).call(this))q(this,ae)[F]!==void 0&&q(this,V)[F]!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield[q(this,V)[F],q(this,ae)[F]])}*keys(){for(let F of Ze(this,S,xt).call(this)){let te=q(this,V)[F];te!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield te)}}*rkeys(){for(let F of Ze(this,S,Mt).call(this)){let te=q(this,V)[F];te!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield te)}}*values(){for(let F of Ze(this,S,xt).call(this))q(this,ae)[F]!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield q(this,ae)[F])}*rvalues(){for(let F of Ze(this,S,Mt).call(this))q(this,ae)[F]!==void 0&&!Ze(this,S,Tt).call(this,q(this,ae)[F])&&(yield q(this,ae)[F])}[Symbol.iterator](){return this.entries()}find(F,te={}){for(let ue of Ze(this,S,xt).call(this)){let Ue=q(this,ae)[ue],p=Ze(this,S,Tt).call(this,Ue)?Ue.__staleWhileFetching:Ue;if(p!==void 0&&F(p,q(this,V)[ue],this))return this.get(q(this,V)[ue],te)}}forEach(F,te=this){for(let ue of Ze(this,S,xt).call(this)){let Ue=q(this,ae)[ue],p=Ze(this,S,Tt).call(this,Ue)?Ue.__staleWhileFetching:Ue;p!==void 0&&F.call(te,p,q(this,V)[ue],this)}}rforEach(F,te=this){for(let ue of Ze(this,S,Mt).call(this)){let Ue=q(this,ae)[ue],p=Ze(this,S,Tt).call(this,Ue)?Ue.__staleWhileFetching:Ue;p!==void 0&&F.call(te,p,q(this,V)[ue],this)}}purgeStale(){let F=!1;for(let te of Ze(this,S,Mt).call(this,{allowStale:!0}))q(this,P).call(this,te)&&(this.delete(q(this,V)[te]),F=!0);return F}dump(){let F=[];for(let te of Ze(this,S,xt).call(this,{allowStale:!0})){let ue=q(this,V)[te],Ue=q(this,ae)[te],p=Ze(this,S,Tt).call(this,Ue)?Ue.__staleWhileFetching:Ue;if(p===void 0||ue===void 0)continue;let f={value:p};if(q(this,H)&&q(this,We)){f.ttl=q(this,H)[te];let y=o.now()-q(this,We)[te];f.start=Math.floor(Date.now()-y)}q(this,qe)&&(f.size=q(this,qe)[te]),F.unshift([ue,f])}return F}load(F){this.clear();for(let[te,ue]of F){if(ue.start){let Ue=Date.now()-ue.start;ue.start=o.now()-Ue}this.set(te,ue.value,ue)}}set(F,te,ue={}){var Ke,rt,st,Ye,et;if(te===void 0)return this.delete(F),this;let{ttl:Ue=this.ttl,start:p,noDisposeOnSet:f=this.noDisposeOnSet,sizeCalculation:y=this.sizeCalculation,status:A}=ue,{noUpdateTTL:j=this.noUpdateTTL}=ue,se=q(this,ve).call(this,F,te,ue.size||0,y);if(this.maxEntrySize&&se>this.maxEntrySize)return A&&(A.set="miss",A.maxEntrySizeExceeded=!0),this.delete(F),this;let Ne=q(this,Q)===0?void 0:q(this,D).get(F);if(Ne===void 0)Ne=q(this,Q)===0?q(this,le):q(this,Le).length!==0?q(this,Le).pop():q(this,Q)===q(this,T)?Ze(this,S,er).call(this,!1):q(this,Q),q(this,V)[Ne]=F,q(this,ae)[Ne]=te,q(this,D).set(F,Ne),q(this,$)[q(this,le)]=Ne,q(this,xe)[Ne]=q(this,le),Ge(this,le,Ne),Gt(this,Q)._++,q(this,Ce).call(this,Ne,se,A),A&&(A.set="add"),j=!1;else{Ze(this,S,Ht).call(this,Ne);let Qe=q(this,ae)[Ne];if(te!==Qe){if(q(this,G)&&Ze(this,S,Tt).call(this,Qe)){Qe.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:ct}=Qe;ct!==void 0&&!f&&(q(this,ye)&&((Ke=q(this,I))==null||Ke.call(this,ct,F,"set")),q(this,ie)&&((rt=q(this,ge))==null||rt.push([ct,F,"set"])))}else f||(q(this,ye)&&((st=q(this,I))==null||st.call(this,Qe,F,"set")),q(this,ie)&&((Ye=q(this,ge))==null||Ye.push([Qe,F,"set"])));if(q(this,oe).call(this,Ne),q(this,Ce).call(this,Ne,se,A),q(this,ae)[Ne]=te,A){A.set="replace";let ct=Qe&&Ze(this,S,Tt).call(this,Qe)?Qe.__staleWhileFetching:Qe;ct!==void 0&&(A.oldValue=ct)}}else A&&(A.set="update")}if(Ue!==0&&!q(this,H)&&Ze(this,S,dr).call(this),q(this,H)&&(j||q(this,Se).call(this,Ne,Ue,p),A&&q(this,Te).call(this,A,Ne)),!f&&q(this,ie)&&q(this,ge)){let Qe=q(this,ge),ct;for(;ct=Qe==null?void 0:Qe.shift();)(et=q(this,k))==null||et.call(this,...ct)}return this}pop(){var F;try{for(;q(this,Q);){let te=q(this,ae)[q(this,N)];if(Ze(this,S,er).call(this,!0),Ze(this,S,Tt).call(this,te)){if(te.__staleWhileFetching)return te.__staleWhileFetching}else if(te!==void 0)return te}}finally{if(q(this,ie)&&q(this,ge)){let te=q(this,ge),ue;for(;ue=te==null?void 0:te.shift();)(F=q(this,k))==null||F.call(this,...ue)}}}has(F,te={}){let{updateAgeOnHas:ue=this.updateAgeOnHas,status:Ue}=te,p=q(this,D).get(F);if(p!==void 0){let f=q(this,ae)[p];if(Ze(this,S,Tt).call(this,f)&&f.__staleWhileFetching===void 0)return!1;if(q(this,P).call(this,p))Ue&&(Ue.has="stale",q(this,Te).call(this,Ue,p));else return ue&&q(this,pe).call(this,p),Ue&&(Ue.has="hit",q(this,Te).call(this,Ue,p)),!0}else Ue&&(Ue.has="miss");return!1}peek(F,te={}){let{allowStale:ue=this.allowStale}=te,Ue=q(this,D).get(F);if(Ue!==void 0&&(ue||!q(this,P).call(this,Ue))){let p=q(this,ae)[Ue];return Ze(this,S,Tt).call(this,p)?p.__staleWhileFetching:p}}async fetch(F,te={}){let{allowStale:ue=this.allowStale,updateAgeOnGet:Ue=this.updateAgeOnGet,noDeleteOnStaleGet:p=this.noDeleteOnStaleGet,ttl:f=this.ttl,noDisposeOnSet:y=this.noDisposeOnSet,size:A=0,sizeCalculation:j=this.sizeCalculation,noUpdateTTL:se=this.noUpdateTTL,noDeleteOnFetchRejection:Ne=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:Ke=this.allowStaleOnFetchRejection,ignoreFetchAbort:rt=this.ignoreFetchAbort,allowStaleOnFetchAbort:st=this.allowStaleOnFetchAbort,context:Ye,forceRefresh:et=!1,status:Qe,signal:ct}=te;if(!q(this,G))return Qe&&(Qe.fetch="get"),this.get(F,{allowStale:ue,updateAgeOnGet:Ue,noDeleteOnStaleGet:p,status:Qe});let yt={allowStale:ue,updateAgeOnGet:Ue,noDeleteOnStaleGet:p,ttl:f,noDisposeOnSet:y,size:A,sizeCalculation:j,noUpdateTTL:se,noDeleteOnFetchRejection:Ne,allowStaleOnFetchRejection:Ke,allowStaleOnFetchAbort:st,ignoreFetchAbort:rt,status:Qe,signal:ct},mt=q(this,D).get(F);if(mt===void 0){Qe&&(Qe.fetch="miss");let _t=Ze(this,S,tr).call(this,F,mt,yt,Ye);return _t.__returned=_t}else{let _t=q(this,ae)[mt];if(Ze(this,S,Tt).call(this,_t)){let ze=ue&&_t.__staleWhileFetching!==void 0;return Qe&&(Qe.fetch="inflight",ze&&(Qe.returnedStale=!0)),ze?_t.__staleWhileFetching:_t.__returned=_t}let Re=q(this,P).call(this,mt);if(!et&&!Re)return Qe&&(Qe.fetch="hit"),Ze(this,S,Ht).call(this,mt),Ue&&q(this,pe).call(this,mt),Qe&&q(this,Te).call(this,Qe,mt),_t;let He=Ze(this,S,tr).call(this,F,mt,yt,Ye),Ve=He.__staleWhileFetching!==void 0&&ue;return Qe&&(Qe.fetch=Re?"stale":"refresh",Ve&&Re&&(Qe.returnedStale=!0)),Ve?He.__staleWhileFetching:He.__returned=He}}get(F,te={}){let{allowStale:ue=this.allowStale,updateAgeOnGet:Ue=this.updateAgeOnGet,noDeleteOnStaleGet:p=this.noDeleteOnStaleGet,status:f}=te,y=q(this,D).get(F);if(y!==void 0){let A=q(this,ae)[y],j=Ze(this,S,Tt).call(this,A);return f&&q(this,Te).call(this,f,y),q(this,P).call(this,y)?(f&&(f.get="stale"),j?(f&&ue&&A.__staleWhileFetching!==void 0&&(f.returnedStale=!0),ue?A.__staleWhileFetching:void 0):(p||this.delete(F),f&&ue&&(f.returnedStale=!0),ue?A:void 0)):(f&&(f.get="hit"),j?A.__staleWhileFetching:(Ze(this,S,Ht).call(this,y),Ue&&q(this,pe).call(this,y),A))}else f&&(f.get="miss")}delete(F){var ue,Ue,p,f;let te=!1;if(q(this,Q)!==0){let y=q(this,D).get(F);if(y!==void 0)if(te=!0,q(this,Q)===1)this.clear();else{q(this,oe).call(this,y);let A=q(this,ae)[y];Ze(this,S,Tt).call(this,A)?A.__abortController.abort(new Error("deleted")):(q(this,ye)||q(this,ie))&&(q(this,ye)&&((ue=q(this,I))==null||ue.call(this,A,F,"delete")),q(this,ie)&&((Ue=q(this,ge))==null||Ue.push([A,F,"delete"]))),q(this,D).delete(F),q(this,V)[y]=void 0,q(this,ae)[y]=void 0,y===q(this,le)?Ge(this,le,q(this,xe)[y]):y===q(this,N)?Ge(this,N,q(this,$)[y]):(q(this,$)[q(this,xe)[y]]=q(this,$)[y],q(this,xe)[q(this,$)[y]]=q(this,xe)[y]),Gt(this,Q)._--,q(this,Le).push(y)}}if(q(this,ie)&&((p=q(this,ge))!=null&&p.length)){let y=q(this,ge),A;for(;A=y==null?void 0:y.shift();)(f=q(this,k))==null||f.call(this,...A)}return te}clear(){var F,te,ue;for(let Ue of Ze(this,S,Mt).call(this,{allowStale:!0})){let p=q(this,ae)[Ue];if(Ze(this,S,Tt).call(this,p))p.__abortController.abort(new Error("deleted"));else{let f=q(this,V)[Ue];q(this,ye)&&((F=q(this,I))==null||F.call(this,p,f,"delete")),q(this,ie)&&((te=q(this,ge))==null||te.push([p,f,"delete"]))}}if(q(this,D).clear(),q(this,ae).fill(void 0),q(this,V).fill(void 0),q(this,H)&&q(this,We)&&(q(this,H).fill(0),q(this,We).fill(0)),q(this,qe)&&q(this,qe).fill(0),Ge(this,N,0),Ge(this,le,0),q(this,Le).length=0,Ge(this,U,0),Ge(this,Q,0),q(this,ie)&&q(this,ge)){let Ue=q(this,ge),p;for(;p=Ue==null?void 0:Ue.shift();)(ue=q(this,k))==null||ue.call(this,...p)}}},T=new WeakMap,R=new WeakMap,I=new WeakMap,k=new WeakMap,W=new WeakMap,Q=new WeakMap,U=new WeakMap,D=new WeakMap,V=new WeakMap,ae=new WeakMap,$=new WeakMap,xe=new WeakMap,N=new WeakMap,le=new WeakMap,Le=new WeakMap,ge=new WeakMap,qe=new WeakMap,We=new WeakMap,H=new WeakMap,ye=new WeakMap,G=new WeakMap,ie=new WeakMap,S=new WeakSet,dr=function(){let F=new h(q(this,T)),te=new h(q(this,T));Ge(this,H,F),Ge(this,We,te),Ge(this,Se,(p,f,y=o.now())=>{if(te[p]=f!==0?y:0,F[p]=f,f!==0&&this.ttlAutopurge){let A=setTimeout(()=>{q(this,P).call(this,p)&&this.delete(q(this,V)[p])},f+1);A.unref&&A.unref()}}),Ge(this,pe,p=>{te[p]=F[p]!==0?o.now():0}),Ge(this,Te,(p,f)=>{if(F[f]){let y=F[f],A=te[f];p.ttl=y,p.start=A,p.now=ue||Ue();let j=p.now-A;p.remainingTTL=y-j}});let ue=0,Ue=()=>{let p=o.now();if(this.ttlResolution>0){ue=p;let f=setTimeout(()=>ue=0,this.ttlResolution);f.unref&&f.unref()}return p};this.getRemainingTTL=p=>{let f=q(this,D).get(p);if(f===void 0)return 0;let y=F[f],A=te[f];if(y===0||A===0)return 1/0;let j=(ue||Ue())-A;return y-j},Ge(this,P,p=>F[p]!==0&&te[p]!==0&&(ue||Ue())-te[p]>F[p])},pe=new WeakMap,Te=new WeakMap,Se=new WeakMap,P=new WeakMap,Er=function(){let F=new h(q(this,T));Ge(this,U,0),Ge(this,qe,F),Ge(this,oe,te=>{Ge(this,U,q(this,U)-F[te]),F[te]=0}),Ge(this,ve,(te,ue,Ue,p)=>{if(Ze(this,S,Tt).call(this,ue))return 0;if(!a(Ue))if(p){if(typeof p!="function")throw new TypeError("sizeCalculation must be a function");if(Ue=p(ue,te),!a(Ue))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return Ue}),Ge(this,Ce,(te,ue,Ue)=>{if(F[te]=ue,q(this,R)){let p=q(this,R)-F[te];for(;q(this,U)>p;)Ze(this,S,er).call(this,!0)}Ge(this,U,q(this,U)+F[te]),Ue&&(Ue.entrySize=ue,Ue.totalCalculatedSize=q(this,U))})},oe=new WeakMap,Ce=new WeakMap,ve=new WeakMap,xt=function*({allowStale:F=this.allowStale}={}){if(q(this,Q))for(let te=q(this,le);!(!Ze(this,S,pr).call(this,te)||((F||!q(this,P).call(this,te))&&(yield te),te===q(this,N)));)te=q(this,xe)[te]},Mt=function*({allowStale:F=this.allowStale}={}){if(q(this,Q))for(let te=q(this,N);!(!Ze(this,S,pr).call(this,te)||((F||!q(this,P).call(this,te))&&(yield te),te===q(this,le)));)te=q(this,$)[te]},pr=function(F){return F!==void 0&&q(this,D).get(q(this,V)[F])===F},er=function(F){var p,f;let te=q(this,N),ue=q(this,V)[te],Ue=q(this,ae)[te];return q(this,G)&&Ze(this,S,Tt).call(this,Ue)?Ue.__abortController.abort(new Error("evicted")):(q(this,ye)||q(this,ie))&&(q(this,ye)&&((p=q(this,I))==null||p.call(this,Ue,ue,"evict")),q(this,ie)&&((f=q(this,ge))==null||f.push([Ue,ue,"evict"]))),q(this,oe).call(this,te),F&&(q(this,V)[te]=void 0,q(this,ae)[te]=void 0,q(this,Le).push(te)),q(this,Q)===1?(Ge(this,N,Ge(this,le,0)),q(this,Le).length=0):Ge(this,N,q(this,$)[te]),q(this,D).delete(ue),Gt(this,Q)._--,te},tr=function(F,te,ue,Ue){let p=te===void 0?void 0:q(this,ae)[te];if(Ze(this,S,Tt).call(this,p))return p;let f=new r,{signal:y}=ue;y==null||y.addEventListener("abort",()=>f.abort(y.reason),{signal:f.signal});let A={signal:f.signal,options:ue,context:Ue},j=(Ye,et=!1)=>{let{aborted:Qe}=f.signal,ct=ue.ignoreFetchAbort&&Ye!==void 0;if(ue.status&&(Qe&&!et?(ue.status.fetchAborted=!0,ue.status.fetchError=f.signal.reason,ct&&(ue.status.fetchAbortIgnored=!0)):ue.status.fetchResolved=!0),Qe&&!ct&&!et)return Ne(f.signal.reason);let yt=rt;return q(this,ae)[te]===rt&&(Ye===void 0?yt.__staleWhileFetching?q(this,ae)[te]=yt.__staleWhileFetching:this.delete(F):(ue.status&&(ue.status.fetchUpdated=!0),this.set(F,Ye,A.options))),Ye},se=Ye=>(ue.status&&(ue.status.fetchRejected=!0,ue.status.fetchError=Ye),Ne(Ye)),Ne=Ye=>{let{aborted:et}=f.signal,Qe=et&&ue.allowStaleOnFetchAbort,ct=Qe||ue.allowStaleOnFetchRejection,yt=ct||ue.noDeleteOnFetchRejection,mt=rt;if(q(this,ae)[te]===rt&&(!yt||mt.__staleWhileFetching===void 0?this.delete(F):Qe||(q(this,ae)[te]=mt.__staleWhileFetching)),ct)return ue.status&&mt.__staleWhileFetching!==void 0&&(ue.status.returnedStale=!0),mt.__staleWhileFetching;if(mt.__returned===mt)throw Ye},Ke=(Ye,et)=>{var ct;let Qe=(ct=q(this,W))==null?void 0:ct.call(this,F,p,A);Qe&&Qe instanceof Promise&&Qe.then(yt=>Ye(yt===void 0?void 0:yt),et),f.signal.addEventListener("abort",()=>{(!ue.ignoreFetchAbort||ue.allowStaleOnFetchAbort)&&(Ye(void 0),ue.allowStaleOnFetchAbort&&(Ye=yt=>j(yt,!0)))})};ue.status&&(ue.status.fetchDispatched=!0);let rt=new Promise(Ke).then(j,se),st=Object.assign(rt,{__abortController:f,__staleWhileFetching:p,__returned:void 0});return te===void 0?(this.set(F,st,{...A.options,status:void 0}),te=q(this,D).get(F)):q(this,ae)[te]=st,st},Tt=function(F){if(!q(this,G))return!1;let te=F;return!!te&&te instanceof Promise&&te.hasOwnProperty("__staleWhileFetching")&&te.__abortController instanceof r},gr=function(F,te){q(this,xe)[te]=F,q(this,$)[F]=te},Ht=function(F){F!==q(this,le)&&(F===q(this,N)?Ge(this,N,q(this,$)[F]):Ze(this,S,gr).call(this,q(this,xe)[F],q(this,$)[F]),Ze(this,S,gr).call(this,q(this,le),F),Ge(this,le,F))},K);e.LRUCache=g}),lt=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.ContainerIterator=e.Container=e.Base=void 0;var o=class{constructor(u=0){this.iteratorType=u}equals(u){return this.o===u.o}};e.ContainerIterator=o;var t=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};e.Base=t;var n=class extends t{};e.Container=n}),tp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=lt(),t=class extends o.Base{constructor(u=[]){super(),this.S=[];let r=this;u.forEach(function(i){r.push(i)})}clear(){this.i=0,this.S=[]}push(u){return this.S.push(u),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},n=t;e.default=n}),rp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=lt(),t=class extends o.Base{constructor(u=[]){super(),this.j=0,this.q=[];let r=this;u.forEach(function(i){r.push(i)})}clear(){this.q=[],this.i=this.j=0}push(u){let r=this.q.length;if(this.j/r>.5&&this.j+this.i>=r&&r>4096){let i=this.i;for(let s=0;s<i;++s)this.q[s]=this.q[this.j+s];this.j=0,this.q[this.i]=u}else this.q[this.j+this.i]=u;return++this.i}pop(){if(this.i===0)return;let u=this.q[this.j++];return this.i-=1,u}front(){if(this.i!==0)return this.q[this.j]}},n=t;e.default=n}),ip=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=lt(),t=class extends o.Base{constructor(u=[],r=function(s,a){return s>a?-1:s<a?1:0},i=!0){if(super(),this.v=r,Array.isArray(u))this.C=i?[...u]:u;else{this.C=[];let a=this;u.forEach(function(c){a.C.push(c)})}this.i=this.C.length;let s=this.i>>1;for(let a=this.i-1>>1;a>=0;--a)this.k(a,s)}m(u){let r=this.C[u];for(;u>0;){let i=u-1>>1,s=this.C[i];if(this.v(s,r)<=0)break;this.C[u]=s,u=i}this.C[u]=r}k(u,r){let i=this.C[u];for(;u<r;){let s=u<<1|1,a=s+1,c=this.C[s];if(a<this.i&&this.v(c,this.C[a])>0&&(s=a,c=this.C[a]),this.v(c,i)>=0)break;this.C[u]=c,u=s}this.C[u]=i}clear(){this.i=0,this.C.length=0}push(u){this.C.push(u),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let u=this.C[0],r=this.C.pop();return this.i-=1,this.i&&(this.C[0]=r,this.k(0,this.i>>1)),u}top(){return this.C[0]}find(u){return this.C.indexOf(u)>=0}remove(u){let r=this.C.indexOf(u);return r<0?!1:(r===0?this.pop():r===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(r,1,this.C.pop()),this.i-=1,this.m(r),this.k(r,this.i>>1)),!0)}updateItem(u){let r=this.C.indexOf(u);return r<0?!1:(this.m(r),this.k(r,this.i>>1),!0)}toArray(){return[...this.C]}},n=t;e.default=n}),jn=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=lt(),t=class extends o.Container{},n=t;e.default=n}),ut=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.throwIteratorAccessError=o;function o(){throw new RangeError("Iterator access denied!")}}),ba=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.RandomIterator=void 0;var o=lt(),t=ut(),n=class extends o.ContainerIterator{constructor(u,r){super(r),this.o=u,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,t.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,t.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,t.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,t.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(u){this.container.setElementByPos(this.o,u)}};e.RandomIterator=n}),np=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=n(jn()),t=ba();function n(s){return s&&s.t?s:{default:s}}var u=class Sr extends t.RandomIterator{constructor(a,c,h){super(a,h),this.container=c}copy(){return new Sr(this.o,this.container,this.iteratorType)}},r=class extends o.default{constructor(s=[],a=!0){if(super(),Array.isArray(s))this.J=a?[...s]:s,this.i=s.length;else{this.J=[];let c=this;s.forEach(function(h){c.pushBack(h)})}}clear(){this.i=0,this.J.length=0}begin(){return new u(0,this)}end(){return new u(this.i,this)}rBegin(){return new u(this.i-1,this,1)}rEnd(){return new u(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;return this.J[s]}eraseElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;return this.J.splice(s,1),this.i-=1,this.i}eraseElementByValue(s){let a=0;for(let c=0;c<this.i;++c)this.J[c]!==s&&(this.J[a++]=this.J[c]);return this.i=this.J.length=a,this.i}eraseElementByIterator(s){let a=s.o;return s=s.next(),this.eraseElementByPos(a),s}pushBack(s){return this.J.push(s),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(s,a){if(s<0||s>this.i-1)throw new RangeError;this.J[s]=a}insert(s,a,c=1){if(s<0||s>this.i)throw new RangeError;return this.J.splice(s,0,...new Array(c).fill(a)),this.i+=c,this.i}find(s){for(let a=0;a<this.i;++a)if(this.J[a]===s)return new u(a,this);return this.end()}reverse(){this.J.reverse()}unique(){let s=1;for(let a=1;a<this.i;++a)this.J[a]!==this.J[a-1]&&(this.J[s++]=this.J[a]);return this.i=this.J.length=s,this.i}sort(s){this.J.sort(s)}forEach(s){for(let a=0;a<this.i;++a)s(this.J[a],a,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},i=r;e.default=i}),sp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=u(jn()),t=lt(),n=ut();function u(a){return a&&a.t?a:{default:a}}var r=class Tr extends t.ContainerIterator{constructor(c,h,d,g){super(g),this.o=c,this.h=h,this.container=d,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.l}set pointer(c){this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.l=c}copy(){return new Tr(this.o,this.h,this.container,this.iteratorType)}},i=class extends o.default{constructor(a=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let c=this;a.forEach(function(h){c.pushBack(h)})}V(a){let{L:c,B:h}=a;c.B=h,h.L=c,a===this.p&&(this.p=h),a===this._&&(this._=c),this.i-=1}G(a,c){let h=c.B,d={l:a,L:c,B:h};c.B=d,h.L=d,c===this.h&&(this.p=d),h===this.h&&(this._=d),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;let c=this.p;for(;a--;)c=c.B;return c.l}eraseElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;let c=this.p;for(;a--;)c=c.B;return this.V(c),this.i}eraseElementByValue(a){let c=this.p;for(;c!==this.h;)c.l===a&&this.V(c),c=c.B;return this.i}eraseElementByIterator(a){let c=a.o;return c===this.h&&(0,n.throwIteratorAccessError)(),a=a.next(),this.V(c),a}pushBack(a){return this.G(a,this._),this.i}popBack(){if(this.i===0)return;let a=this._.l;return this.V(this._),a}pushFront(a){return this.G(a,this.h),this.i}popFront(){if(this.i===0)return;let a=this.p.l;return this.V(this.p),a}setElementByPos(a,c){if(a<0||a>this.i-1)throw new RangeError;let h=this.p;for(;a--;)h=h.B;h.l=c}insert(a,c,h=1){if(a<0||a>this.i)throw new RangeError;if(h<=0)return this.i;if(a===0)for(;h--;)this.pushFront(c);else if(a===this.i)for(;h--;)this.pushBack(c);else{let d=this.p;for(let b=1;b<a;++b)d=d.B;let g=d.B;for(this.i+=h;h--;)d.B={l:c,L:d},d.B.L=d,d=d.B;d.B=g,g.L=d}return this.i}find(a){let c=this.p;for(;c!==this.h;){if(c.l===a)return new r(c,this.h,this);c=c.B}return this.end()}reverse(){if(this.i<=1)return;let a=this.p,c=this._,h=0;for(;h<<1<this.i;){let d=a.l;a.l=c.l,c.l=d,a=a.B,c=c.L,h+=1}}unique(){if(this.i<=1)return this.i;let a=this.p;for(;a!==this.h;){let c=a;for(;c.B!==this.h&&c.l===c.B.l;)c=c.B,this.i-=1;a.B=c.B,a.B.L=a,a=a.B}return this.i}sort(a){if(this.i<=1)return;let c=[];this.forEach(function(d){c.push(d)}),c.sort(a);let h=this.p;c.forEach(function(d){h.l=d,h=h.B})}merge(a){let c=this;if(this.i===0)a.forEach(function(h){c.pushBack(h)});else{let h=this.p;a.forEach(function(d){for(;h!==c.h&&h.l<=d;)h=h.B;c.G(d,h.L)})}return this.i}forEach(a){let c=this.p,h=0;for(;c!==this.h;)a(c.l,h++,this),c=c.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let a=this.p;for(;a!==this.h;)yield a.l,a=a.B}).bind(this)()}},s=i;e.default=s}),op=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=n(jn()),t=ba();function n(s){return s&&s.t?s:{default:s}}var u=class kr extends t.RandomIterator{constructor(a,c,h){super(a,h),this.container=c}copy(){return new kr(this.o,this.container,this.iteratorType)}},r=class extends o.default{constructor(s=[],a=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let c=(()=>{if(typeof s.length=="number")return s.length;if(typeof s.size=="number")return s.size;if(typeof s.size=="function")return s.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=a,this.P=Math.max(Math.ceil(c/this.F),1);for(let g=0;g<this.P;++g)this.A.push(new Array(this.F));let h=Math.ceil(c/this.F);this.j=this.R=(this.P>>1)-(h>>1),this.D=this.N=this.F-c%this.F>>1;let d=this;s.forEach(function(g){d.pushBack(g)})}T(){let s=[],a=Math.max(this.P>>1,1);for(let c=0;c<a;++c)s[c]=new Array(this.F);for(let c=this.j;c<this.P;++c)s[s.length]=this.A[c];for(let c=0;c<this.R;++c)s[s.length]=this.A[c];s[s.length]=[...this.A[this.R]],this.j=a,this.R=s.length-1;for(let c=0;c<a;++c)s[s.length]=new Array(this.F);this.A=s,this.P=s.length}O(s){let a=this.D+s+1,c=a%this.F,h=c-1,d=this.j+(a-c)/this.F;return c===0&&(d-=1),d%=this.P,h<0&&(h+=this.F),{curNodeBucketIndex:d,curNodePointerIndex:h}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new u(0,this)}end(){return new u(this.i,this)}rBegin(){return new u(this.i-1,this,1)}rEnd(){return new u(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(s){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=s,this.i}popBack(){if(this.i===0)return;let s=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,s}pushFront(s){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=s,this.i}popFront(){if(this.i===0)return;let s=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,s}getElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;let{curNodeBucketIndex:a,curNodePointerIndex:c}=this.O(s);return this.A[a][c]}setElementByPos(s,a){if(s<0||s>this.i-1)throw new RangeError;let{curNodeBucketIndex:c,curNodePointerIndex:h}=this.O(s);this.A[c][h]=a}insert(s,a,c=1){if(s<0||s>this.i)throw new RangeError;if(s===0)for(;c--;)this.pushFront(a);else if(s===this.i)for(;c--;)this.pushBack(a);else{let h=[];for(let d=s;d<this.i;++d)h.push(this.getElementByPos(d));this.cut(s-1);for(let d=0;d<c;++d)this.pushBack(a);for(let d=0;d<h.length;++d)this.pushBack(h[d])}return this.i}cut(s){if(s<0)return this.clear(),0;let{curNodeBucketIndex:a,curNodePointerIndex:c}=this.O(s);return this.R=a,this.N=c,this.i=s+1,this.i}eraseElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;if(s===0)this.popFront();else if(s===this.i-1)this.popBack();else{let a=[];for(let h=s+1;h<this.i;++h)a.push(this.getElementByPos(h));this.cut(s),this.popBack();let c=this;a.forEach(function(h){c.pushBack(h)})}return this.i}eraseElementByValue(s){if(this.i===0)return 0;let a=[];for(let h=0;h<this.i;++h){let d=this.getElementByPos(h);d!==s&&a.push(d)}let c=a.length;for(let h=0;h<c;++h)this.setElementByPos(h,a[h]);return this.cut(c-1)}eraseElementByIterator(s){let a=s.o;return this.eraseElementByPos(a),s=s.next(),s}find(s){for(let a=0;a<this.i;++a)if(this.getElementByPos(a)===s)return new u(a,this);return this.end()}reverse(){let s=0,a=this.i-1;for(;s<a;){let c=this.getElementByPos(s);this.setElementByPos(s,this.getElementByPos(a)),this.setElementByPos(a,c),s+=1,a-=1}}unique(){if(this.i<=1)return this.i;let s=1,a=this.getElementByPos(0);for(let c=1;c<this.i;++c){let h=this.getElementByPos(c);h!==a&&(a=h,this.setElementByPos(s++,h))}for(;this.i>s;)this.popBack();return this.i}sort(s){let a=[];for(let c=0;c<this.i;++c)a.push(this.getElementByPos(c));a.sort(s);for(let c=0;c<this.i;++c)this.setElementByPos(c,a[c])}shrinkToFit(){if(this.i===0)return;let s=[];this.forEach(function(a){s.push(a)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let a=0;a<this.P;++a)this.A.push(new Array(this.F));for(let a=0;a<s.length;++a)this.pushBack(s[a])}forEach(s){for(let a=0;a<this.i;++a)s(this.getElementByPos(a),a,this)}[Symbol.iterator](){return(function*(){for(let s=0;s<this.i;++s)yield this.getElementByPos(s)}).bind(this)()}},i=r;e.default=i}),ap=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.TreeNodeEnableIndex=e.TreeNode=void 0;var o=class{constructor(n,u){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=n,this.l=u}L(){let n=this;if(n.ee===1&&n.tt.tt===n)n=n.W;else if(n.U)for(n=n.U;n.W;)n=n.W;else{let u=n.tt;for(;u.U===n;)n=u,u=n.tt;n=u}return n}B(){let n=this;if(n.W){for(n=n.W;n.U;)n=n.U;return n}else{let u=n.tt;for(;u.W===n;)n=u,u=n.tt;return n.W!==u?u:n}}te(){let n=this.tt,u=this.W,r=u.U;return n.tt===this?n.tt=u:n.U===this?n.U=u:n.W=u,u.tt=n,u.U=this,this.tt=u,this.W=r,r&&(r.tt=this),u}se(){let n=this.tt,u=this.U,r=u.W;return n.tt===this?n.tt=u:n.U===this?n.U=u:n.W=u,u.tt=n,u.W=this,this.tt=u,this.U=r,r&&(r.tt=this),u}};e.TreeNode=o;var t=class extends o{constructor(){super(...arguments),this.rt=1}te(){let n=super.te();return this.ie(),n.ie(),n}se(){let n=super.se();return this.ie(),n.ie(),n}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};e.TreeNodeEnableIndex=t}),Sa=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=ap(),t=lt(),n=ut(),u=class extends t.Container{constructor(i=function(a,c){return a<c?-1:a>c?1:0},s=!1){super(),this.Y=void 0,this.v=i,s?(this.re=o.TreeNodeEnableIndex,this.M=function(a,c,h){let d=this.ne(a,c,h);if(d){let g=d.tt;for(;g!==this.h;)g.rt+=1,g=g.tt;let b=this.he(d);if(b){let{parentNode:w,grandParent:E,curNode:T}=b;w.ie(),E.ie(),T.ie()}}return this.i},this.V=function(a){let c=this.fe(a);for(;c!==this.h;)c.rt-=1,c=c.tt}):(this.re=o.TreeNode,this.M=function(a,c,h){let d=this.ne(a,c,h);return d&&this.he(d),this.i},this.V=this.fe),this.h=new this.re}X(i,s){let a=this.h;for(;i;){let c=this.v(i.u,s);if(c<0)i=i.W;else if(c>0)a=i,i=i.U;else return i}return a}Z(i,s){let a=this.h;for(;i;)this.v(i.u,s)<=0?i=i.W:(a=i,i=i.U);return a}$(i,s){let a=this.h;for(;i;){let c=this.v(i.u,s);if(c<0)a=i,i=i.W;else if(c>0)i=i.U;else return i}return a}rr(i,s){let a=this.h;for(;i;)this.v(i.u,s)<0?(a=i,i=i.W):i=i.U;return a}ue(i){for(;;){let s=i.tt;if(s===this.h)return;if(i.ee===1){i.ee=0;return}if(i===s.U){let a=s.W;if(a.ee===1)a.ee=0,s.ee=1,s===this.Y?this.Y=s.te():s.te();else if(a.W&&a.W.ee===1){a.ee=s.ee,s.ee=0,a.W.ee=0,s===this.Y?this.Y=s.te():s.te();return}else a.U&&a.U.ee===1?(a.ee=1,a.U.ee=0,a.se()):(a.ee=1,i=s)}else{let a=s.U;if(a.ee===1)a.ee=0,s.ee=1,s===this.Y?this.Y=s.se():s.se();else if(a.U&&a.U.ee===1){a.ee=s.ee,s.ee=0,a.U.ee=0,s===this.Y?this.Y=s.se():s.se();return}else a.W&&a.W.ee===1?(a.ee=1,a.W.ee=0,a.te()):(a.ee=1,i=s)}}}fe(i){if(this.i===1)return this.clear(),this.h;let s=i;for(;s.U||s.W;){if(s.W)for(s=s.W;s.U;)s=s.U;else s=s.U;[i.u,s.u]=[s.u,i.u],[i.l,s.l]=[s.l,i.l],i=s}this.h.U===s?this.h.U=s.tt:this.h.W===s&&(this.h.W=s.tt),this.ue(s);let a=s.tt;return s===a.U?a.U=void 0:a.W=void 0,this.i-=1,this.Y.ee=0,a}oe(i,s){return i===void 0?!1:this.oe(i.U,s)||s(i)?!0:this.oe(i.W,s)}he(i){for(;;){let s=i.tt;if(s.ee===0)return;let a=s.tt;if(s===a.U){let c=a.W;if(c&&c.ee===1){if(c.ee=s.ee=0,a===this.Y)return;a.ee=1,i=a;continue}else if(i===s.W){if(i.ee=0,i.U&&(i.U.tt=s),i.W&&(i.W.tt=a),s.W=i.U,a.U=i.W,i.U=s,i.W=a,a===this.Y)this.Y=i,this.h.tt=i;else{let h=a.tt;h.U===a?h.U=i:h.W=i}return i.tt=a.tt,s.tt=i,a.tt=i,a.ee=1,{parentNode:s,grandParent:a,curNode:i}}else s.ee=0,a===this.Y?this.Y=a.se():a.se(),a.ee=1}else{let c=a.U;if(c&&c.ee===1){if(c.ee=s.ee=0,a===this.Y)return;a.ee=1,i=a;continue}else if(i===s.U){if(i.ee=0,i.U&&(i.U.tt=a),i.W&&(i.W.tt=s),a.W=i.U,s.U=i.W,i.U=a,i.W=s,a===this.Y)this.Y=i,this.h.tt=i;else{let h=a.tt;h.U===a?h.U=i:h.W=i}return i.tt=a.tt,s.tt=i,a.tt=i,a.ee=1,{parentNode:s,grandParent:a,curNode:i}}else s.ee=0,a===this.Y?this.Y=a.te():a.te(),a.ee=1}return}}ne(i,s,a){if(this.Y===void 0){this.i+=1,this.Y=new this.re(i,s),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let c,h=this.h.U,d=this.v(h.u,i);if(d===0){h.l=s;return}else if(d>0)h.U=new this.re(i,s),h.U.tt=h,c=h.U,this.h.U=c;else{let g=this.h.W,b=this.v(g.u,i);if(b===0){g.l=s;return}else if(b<0)g.W=new this.re(i,s),g.W.tt=g,c=g.W,this.h.W=c;else{if(a!==void 0){let w=a.o;if(w!==this.h){let E=this.v(w.u,i);if(E===0){w.l=s;return}else if(E>0){let T=w.L(),R=this.v(T.u,i);if(R===0){T.l=s;return}else R<0&&(c=new this.re(i,s),T.W===void 0?(T.W=c,c.tt=T):(w.U=c,c.tt=w))}}}if(c===void 0)for(c=this.Y;;){let w=this.v(c.u,i);if(w>0){if(c.U===void 0){c.U=new this.re(i,s),c.U.tt=c,c=c.U;break}c=c.U}else if(w<0){if(c.W===void 0){c.W=new this.re(i,s),c.W.tt=c,c=c.W;break}c=c.W}else{c.l=s;return}}}}return this.i+=1,c}I(i,s){for(;i;){let a=this.v(i.u,s);if(a<0)i=i.W;else if(a>0)i=i.U;else return i}return i||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(i,s){let a=i.o;if(a===this.h&&(0,n.throwIteratorAccessError)(),this.i===1)return a.u=s,!0;if(a===this.h.U)return this.v(a.B().u,s)>0?(a.u=s,!0):!1;if(a===this.h.W)return this.v(a.L().u,s)<0?(a.u=s,!0):!1;let c=a.L().u;if(this.v(c,s)>=0)return!1;let h=a.B().u;return this.v(h,s)<=0?!1:(a.u=s,!0)}eraseElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let s=0,a=this;return this.oe(this.Y,function(c){return i===s?(a.V(c),!0):(s+=1,!1)}),this.i}eraseElementByKey(i){if(this.i===0)return!1;let s=this.I(this.Y,i);return s===this.h?!1:(this.V(s),!0)}eraseElementByIterator(i){let s=i.o;s===this.h&&(0,n.throwIteratorAccessError)();let a=s.W===void 0;return i.iteratorType===0?a&&i.next():(!a||s.U===void 0)&&i.next(),this.V(s),i}forEach(i){let s=0;for(let a of this)i(a,s++,this)}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let s,a=0;for(let c of this){if(a===i){s=c;break}a+=1}return s}getHeight(){if(this.i===0)return 0;let i=function(s){return s?Math.max(i(s.U),i(s.W))+1:0};return i(this.Y)}},r=u;e.default=r}),Ia=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=lt(),t=ut(),n=class extends o.ContainerIterator{constructor(r,i,s){super(s),this.o=r,this.h=i,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,t.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,t.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let r=this.o,i=this.h.tt;if(r===this.h)return i?i.rt-1:0;let s=0;for(r.U&&(s+=r.U.rt);r!==i;){let a=r.tt;r===a.W&&(s+=1,a.U&&(s+=a.U.rt)),r=a}return s}},u=n;e.default=u}),cp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=u(Sa()),t=u(Ia()),n=ut();function u(a){return a&&a.t?a:{default:a}}var r=class Ar extends t.default{constructor(c,h,d,g){super(c,h,g),this.container=d}get pointer(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.u}copy(){return new Ar(this.o,this.h,this.container,this.iteratorType)}},i=class extends o.default{constructor(a=[],c,h){super(c,h);let d=this;a.forEach(function(g){d.insert(g)})}*K(a){a!==void 0&&(yield*this.K(a.U),yield a.u,yield*this.K(a.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(a,c){return this.M(a,void 0,c)}find(a){let c=this.I(this.Y,a);return new r(c,this.h,this)}lowerBound(a){let c=this.X(this.Y,a);return new r(c,this.h,this)}upperBound(a){let c=this.Z(this.Y,a);return new r(c,this.h,this)}reverseLowerBound(a){let c=this.$(this.Y,a);return new r(c,this.h,this)}reverseUpperBound(a){let c=this.rr(this.Y,a);return new r(c,this.h,this)}union(a){let c=this;return a.forEach(function(h){c.insert(h)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},s=i;e.default=s}),dp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=u(Sa()),t=u(Ia()),n=ut();function u(a){return a&&a.t?a:{default:a}}var r=class Or extends t.default{constructor(c,h,d,g){super(c,h,g),this.container=d}get pointer(){this.o===this.h&&(0,n.throwIteratorAccessError)();let c=this;return new Proxy([],{get(h,d){if(d==="0")return c.o.u;if(d==="1")return c.o.l},set(h,d,g){if(d!=="1")throw new TypeError("props must be 1");return c.o.l=g,!0}})}copy(){return new Or(this.o,this.h,this.container,this.iteratorType)}},i=class extends o.default{constructor(a=[],c,h){super(c,h);let d=this;a.forEach(function(g){d.setElement(g[0],g[1])})}*K(a){a!==void 0&&(yield*this.K(a.U),yield[a.u,a.l],yield*this.K(a.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i===0)return;let a=this.h.U;return[a.u,a.l]}back(){if(this.i===0)return;let a=this.h.W;return[a.u,a.l]}lowerBound(a){let c=this.X(this.Y,a);return new r(c,this.h,this)}upperBound(a){let c=this.Z(this.Y,a);return new r(c,this.h,this)}reverseLowerBound(a){let c=this.$(this.Y,a);return new r(c,this.h,this)}reverseUpperBound(a){let c=this.rr(this.Y,a);return new r(c,this.h,this)}setElement(a,c,h){return this.M(a,c,h)}find(a){let c=this.I(this.Y,a);return new r(c,this.h,this)}getElementByKey(a){return this.I(this.Y,a).l}union(a){let c=this;return a.forEach(function(h){c.setElement(h[0],h[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},s=i;e.default=s}),Ba=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=o;function o(t){let n=typeof t;return n==="object"&&t!==null||n==="function"}}),xa=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.HashContainerIterator=e.HashContainer=void 0;var o=lt(),t=u(Ba()),n=ut();function u(s){return s&&s.t?s:{default:s}}var r=class extends o.ContainerIterator{constructor(s,a,c){super(c),this.o=s,this.h=a,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L,this})}};e.HashContainerIterator=r;var i=class extends o.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(s){let{L:a,B:c}=s;a.B=c,c.L=a,s===this.p&&(this.p=c),s===this._&&(this._=a),this.i-=1}M(s,a,c){c===void 0&&(c=(0,t.default)(s));let h;if(c){let d=s[this.HASH_TAG];if(d!==void 0)return this.H[d].l=a,this.i;Object.defineProperty(s,this.HASH_TAG,{value:this.H.length,configurable:!0}),h={u:s,l:a,L:this._,B:this.h},this.H.push(h)}else{let d=this.g[s];if(d)return d.l=a,this.i;h={u:s,l:a,L:this._,B:this.h},this.g[s]=h}return this.i===0?(this.p=h,this.h.B=h):this._.B=h,this._=h,this.h.L=h,++this.i}I(s,a){if(a===void 0&&(a=(0,t.default)(s)),a){let c=s[this.HASH_TAG];return c===void 0?this.h:this.H[c]}else return this.g[s]||this.h}clear(){let s=this.HASH_TAG;this.H.forEach(function(a){delete a.u[s]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(s,a){let c;if(a===void 0&&(a=(0,t.default)(s)),a){let h=s[this.HASH_TAG];if(h===void 0)return!1;delete s[this.HASH_TAG],c=this.H[h],delete this.H[h]}else{if(c=this.g[s],c===void 0)return!1;delete this.g[s]}return this.V(c),!0}eraseElementByIterator(s){let a=s.o;return a===this.h&&(0,n.throwIteratorAccessError)(),this.V(a),s.next()}eraseElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;let a=this.p;for(;s--;)a=a.B;return this.V(a),this.i}};e.HashContainer=i}),yp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=xa(),t=ut(),n=class Ir extends o.HashContainerIterator{constructor(s,a,c,h){super(s,a,h),this.container=c}get pointer(){return this.o===this.h&&(0,t.throwIteratorAccessError)(),this.o.u}copy(){return new Ir(this.o,this.h,this.container,this.iteratorType)}},u=class extends o.HashContainer{constructor(i=[]){super();let s=this;i.forEach(function(a){s.insert(a)})}begin(){return new n(this.p,this.h,this)}end(){return new n(this.h,this.h,this)}rBegin(){return new n(this._,this.h,this,1)}rEnd(){return new n(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(i,s){return this.M(i,void 0,s)}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let s=this.p;for(;i--;)s=s.B;return s.u}find(i,s){let a=this.I(i,s);return new n(a,this.h,this)}forEach(i){let s=0,a=this.p;for(;a!==this.h;)i(a.u,s++,this),a=a.B}[Symbol.iterator](){return(function*(){let i=this.p;for(;i!==this.h;)yield i.u,i=i.B}).bind(this)()}},r=u;e.default=r}),wp=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var o=xa(),t=u(Ba()),n=ut();function u(a){return a&&a.t?a:{default:a}}var r=class Pr extends o.HashContainerIterator{constructor(c,h,d,g){super(c,h,g),this.container=d}get pointer(){this.o===this.h&&(0,n.throwIteratorAccessError)();let c=this;return new Proxy([],{get(h,d){if(d==="0")return c.o.u;if(d==="1")return c.o.l},set(h,d,g){if(d!=="1")throw new TypeError("props must be 1");return c.o.l=g,!0}})}copy(){return new Pr(this.o,this.h,this.container,this.iteratorType)}},i=class extends o.HashContainer{constructor(a=[]){super();let c=this;a.forEach(function(h){c.setElement(h[0],h[1])})}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(a,c,h){return this.M(a,c,h)}getElementByKey(a,c){if(c===void 0&&(c=(0,t.default)(a)),c){let d=a[this.HASH_TAG];return d!==void 0?this.H[d].l:void 0}let h=this.g[a];return h?h.l:void 0}getElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;let c=this.p;for(;a--;)c=c.B;return[c.u,c.l]}find(a,c){let h=this.I(a,c);return new r(h,this.h,this)}forEach(a){let c=0,h=this.p;for(;h!==this.h;)a([h.u,h.l],c++,this),h=h.B}[Symbol.iterator](){return(function*(){let a=this.p;for(;a!==this.h;)yield[a.u,a.l],a=a.B}).bind(this)()}},s=i;e.default=s}),_p=M(e=>{_(),v(),m(),Object.defineProperty(e,"t",{value:!0}),Object.defineProperty(e,"Deque",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"HashMap",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"HashSet",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"LinkList",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"OrderedMap",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"OrderedSet",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"PriorityQueue",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"Queue",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"Stack",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"Vector",{enumerable:!0,get:function(){return u.default}});var o=d(tp()),t=d(rp()),n=d(ip()),u=d(np()),r=d(sp()),i=d(op()),s=d(cp()),a=d(dp()),c=d(yp()),h=d(wp());function d(g){return g&&g.t?g:{default:g}}}),vp=M((e,o)=>{_(),v(),m();var t=_p().OrderedSet,n=ot()("number-allocator:trace"),u=ot()("number-allocator:error");function r(s,a){this.low=s,this.high=a}r.prototype.equals=function(s){return this.low===s.low&&this.high===s.high},r.prototype.compare=function(s){return this.low<s.low&&this.high<s.low?-1:s.low<this.low&&s.high<this.low?1:0};function i(s,a){if(!(this instanceof i))return new i(s,a);this.min=s,this.max=a,this.ss=new t([],(c,h)=>c.compare(h)),n("Create"),this.clear()}i.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},i.prototype.alloc=function(){if(this.ss.size()===0)return n("alloc():empty"),null;let s=this.ss.begin(),a=s.pointer.low,c=s.pointer.high,h=a;return h+1<=c?this.ss.updateKeyByIterator(s,new r(a+1,c)):this.ss.eraseElementByPos(0),n("alloc():"+h),h},i.prototype.use=function(s){let a=new r(s,s),c=this.ss.lowerBound(a);if(!c.equals(this.ss.end())){let h=c.pointer.low,d=c.pointer.high;return c.pointer.equals(a)?(this.ss.eraseElementByIterator(c),n("use():"+s),!0):h>s?!1:h===s?(this.ss.updateKeyByIterator(c,new r(h+1,d)),n("use():"+s),!0):d===s?(this.ss.updateKeyByIterator(c,new r(h,d-1)),n("use():"+s),!0):(this.ss.updateKeyByIterator(c,new r(s+1,d)),this.ss.insert(new r(h,s-1)),n("use():"+s),!0)}return n("use():failed"),!1},i.prototype.free=function(s){if(s<this.min||s>this.max){u("free():"+s+" is out of range");return}let a=new r(s,s),c=this.ss.upperBound(a);if(c.equals(this.ss.end())){if(c.equals(this.ss.begin())){this.ss.insert(a);return}c.pre();let h=c.pointer.high;c.pointer.high+1===s?this.ss.updateKeyByIterator(c,new r(h,s)):this.ss.insert(a)}else if(c.equals(this.ss.begin()))if(s+1===c.pointer.low){let h=c.pointer.high;this.ss.updateKeyByIterator(c,new r(s,h))}else this.ss.insert(a);else{let h=c.pointer.low,d=c.pointer.high;c.pre();let g=c.pointer.low;c.pointer.high+1===s?s+1===h?(this.ss.eraseElementByIterator(c),this.ss.updateKeyByIterator(c,new r(g,d))):this.ss.updateKeyByIterator(c,new r(g,s)):s+1===h?(this.ss.eraseElementByIterator(c.next()),this.ss.insert(new r(s,d))):this.ss.insert(a)}n("free():"+s)},i.prototype.clear=function(){n("clear()"),this.ss.clear(),this.ss.insert(new r(this.min,this.max))},i.prototype.intervalCount=function(){return this.ss.size()},i.prototype.dump=function(){console.log("length:"+this.ss.size());for(let s of this.ss)console.log(s)},o.exports=i}),Ua=M((e,o)=>{_(),v(),m();var t=vp();o.exports.NumberAllocator=t}),Sp=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=ep(),t=Ua(),n=class{constructor(u){u>0&&(this.aliasToTopic=new o.LRUCache({max:u}),this.topicToAlias={},this.numberAllocator=new t.NumberAllocator(1,u),this.max=u,this.length=0)}put(u,r){if(r===0||r>this.max)return!1;let i=this.aliasToTopic.get(r);return i&&delete this.topicToAlias[i],this.aliasToTopic.set(r,u),this.topicToAlias[u]=r,this.numberAllocator.use(r),this.length=this.aliasToTopic.size,!0}getTopicByAlias(u){return this.aliasToTopic.get(u)}getAliasByTopic(u){let r=this.topicToAlias[u];return typeof r<"u"&&this.aliasToTopic.get(r),r}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};e.default=n}),Ap=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0});var t=Ti(),n=o(Sp()),u=_r(),r=(i,s)=>{i.log("_handleConnack");let{options:a}=i,c=a.protocolVersion===5?s.reasonCode:s.returnCode;if(clearTimeout(i.connackTimer),delete i.topicAliasSend,s.properties){if(s.properties.topicAliasMaximum){if(s.properties.topicAliasMaximum>65535){i.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}s.properties.topicAliasMaximum>0&&(i.topicAliasSend=new n.default(s.properties.topicAliasMaximum))}s.properties.serverKeepAlive&&a.keepalive&&(a.keepalive=s.properties.serverKeepAlive),s.properties.maximumPacketSize&&(a.properties||(a.properties={}),a.properties.maximumPacketSize=s.properties.maximumPacketSize)}if(c===0)i.reconnecting=!1,i._onConnect(s);else if(c>0){let h=new u.ErrorWithReasonCode(`Connection refused: ${t.ReasonCodes[c]}`,c);i.emit("error",h),i.options.reconnectOnConnackError&&i._cleanUp(!0)}};e.default=r}),Ip=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=(t,n,u)=>{t.log("handling pubrel packet");let r=typeof u<"u"?u:t.noop,{messageId:i}=n,s={cmd:"pubcomp",messageId:i};t.incomingStore.get(n,(a,c)=>{a?t._sendPacket(s,r):(t.emit("message",c.topic,c.payload,c),t.handleMessage(c,h=>{if(h)return r(h);t.incomingStore.del(c,t.noop),t._sendPacket(s,r)}))})};e.default=o}),Tp=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0});var t=o(Vd()),n=o(Qd()),u=o(Ap()),r=o(Ti()),i=o(Ip()),s=(a,c,h)=>{let{options:d}=a;if(d.protocolVersion===5&&d.properties&&d.properties.maximumPacketSize&&d.properties.maximumPacketSize<c.length)return a.emit("error",new Error(`exceeding packets size ${c.cmd}`)),a.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),a;switch(a.log("_handlePacket :: emitting packetreceive"),a.emit("packetreceive",c),c.cmd){case"publish":(0,t.default)(a,c,h);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":a.reschedulePing(),(0,r.default)(a,c),h();break;case"pubrel":a.reschedulePing(),(0,i.default)(a,c,h);break;case"connack":(0,u.default)(a,c),h();break;case"auth":a.reschedulePing(),(0,n.default)(a,c),h();break;case"pingresp":a.log("_handlePacket :: received pingresp"),a.reschedulePing(!0),h();break;case"disconnect":a.emit("disconnect",c),h();break;default:a.log("_handlePacket :: unknown command"),h();break}};e.default=s}),Rp=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0}),e.TypedEventEmitter=void 0;var t=o((sr(),X(nr))),n=_r(),u=class{};e.TypedEventEmitter=u,(0,n.applyMixin)(u,t.default)}),Oi=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.isReactNativeBrowser=e.isWebWorker=void 0;var o=()=>{var r;return typeof window<"u"?typeof navigator<"u"&&((r=navigator.userAgent)===null||r===void 0?void 0:r.toLowerCase().indexOf(" electron/"))>-1&&B!=null&&B.versions?!Object.prototype.hasOwnProperty.call(B.versions,"electron"):typeof window.document<"u":!1},t=()=>{var r,i;return!!(typeof self=="object"&&!((i=(r=self==null?void 0:self.constructor)===null||r===void 0?void 0:r.name)===null||i===void 0)&&i.includes("WorkerGlobalScope"))},n=()=>typeof navigator<"u"&&navigator.product==="ReactNative",u=o()||t()||n();e.isWebWorker=t(),e.isReactNativeBrowser=n(),e.default=u}),kp=M((e,o)=>{_(),v(),m(),function(t,n){typeof e=="object"&&typeof o<"u"?n(e):typeof define=="function"&&define.amd?define(["exports"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.fastUniqueNumbers={}))}(e,function(t){var n=function(b){return function(w){var E=b(w);return w.add(E),E}},u=function(b){return function(w,E){return b.set(w,E),E}},r=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,i=536870912,s=i*2,a=function(b,w){return function(E){var T=w.get(E),R=T===void 0?E.size:T<s?T+1:0;if(!E.has(R))return b(E,R);if(E.size<i){for(;E.has(R);)R=Math.floor(Math.random()*s);return b(E,R)}if(E.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;E.has(R);)R=Math.floor(Math.random()*r);return b(E,R)}},c=new WeakMap,h=u(c),d=a(h,c),g=n(d);t.addUniqueNumber=g,t.generateUniqueNumber=d})}),xp=M((e,o)=>{_(),v(),m(),function(t,n){typeof e=="object"&&typeof o<"u"?n(e,kp()):typeof define=="function"&&define.amd?define(["exports","fast-unique-numbers"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.workerTimersBroker={},t.fastUniqueNumbers))}(e,function(t,n){var u=function(s){return s.method!==void 0&&s.method==="call"},r=function(s){return s.error===null&&typeof s.id=="number"},i=function(s){var a=new Map([[0,function(){}]]),c=new Map([[0,function(){}]]),h=new Map,d=new Worker(s);d.addEventListener("message",function(T){var R=T.data;if(u(R)){var I=R.params,k=I.timerId,W=I.timerType;if(W==="interval"){var Q=a.get(k);if(typeof Q=="number"){var U=h.get(Q);if(U===void 0||U.timerId!==k||U.timerType!==W)throw new Error("The timer is in an undefined state.")}else if(typeof Q<"u")Q();else throw new Error("The timer is in an undefined state.")}else if(W==="timeout"){var D=c.get(k);if(typeof D=="number"){var V=h.get(D);if(V===void 0||V.timerId!==k||V.timerType!==W)throw new Error("The timer is in an undefined state.")}else if(typeof D<"u")D(),c.delete(k);else throw new Error("The timer is in an undefined state.")}}else if(r(R)){var ae=R.id,$=h.get(ae);if($===void 0)throw new Error("The timer is in an undefined state.");var xe=$.timerId,N=$.timerType;h.delete(ae),N==="interval"?a.delete(xe):c.delete(xe)}else{var le=R.error.message;throw new Error(le)}});var g=function(T){var R=n.generateUniqueNumber(h);h.set(R,{timerId:T,timerType:"interval"}),a.set(T,R),d.postMessage({id:R,method:"clear",params:{timerId:T,timerType:"interval"}})},b=function(T){var R=n.generateUniqueNumber(h);h.set(R,{timerId:T,timerType:"timeout"}),c.set(T,R),d.postMessage({id:R,method:"clear",params:{timerId:T,timerType:"timeout"}})},w=function(T){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=n.generateUniqueNumber(a);return a.set(I,function(){T(),typeof a.get(I)=="function"&&d.postMessage({id:null,method:"set",params:{delay:R,now:performance.now(),timerId:I,timerType:"interval"}})}),d.postMessage({id:null,method:"set",params:{delay:R,now:performance.now(),timerId:I,timerType:"interval"}}),I},E=function(T){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=n.generateUniqueNumber(c);return c.set(I,T),d.postMessage({id:null,method:"set",params:{delay:R,now:performance.now(),timerId:I,timerType:"timeout"}}),I};return{clearInterval:g,clearTimeout:b,setInterval:w,setTimeout:E}};t.load=i})}),Lp=M((e,o)=>{_(),v(),m(),function(t,n){typeof e=="object"&&typeof o<"u"?n(e,xp()):typeof define=="function"&&define.amd?define(["exports","worker-timers-broker"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.workerTimers={},t.workerTimersBroker))}(e,function(t,n){var u=function(d,g){var b=null;return function(){if(b!==null)return b;var w=new Blob([g],{type:"application/javascript; charset=utf-8"}),E=URL.createObjectURL(w);return b=d(E),setTimeout(function(){return URL.revokeObjectURL(E)}),b}},r=`(()=>{var e={472:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error('The given type "'.concat(c,'" is not supported'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error('The given method "'.concat(t.method,'" is not supported'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error('The given type "'.concat(v,'" is not supported'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(472)})()})();`,i=u(n.load,r),s=function(d){return i().clearInterval(d)},a=function(d){return i().clearTimeout(d)},c=function(){var d;return(d=i()).setInterval.apply(d,arguments)},h=function(){var d;return(d=i()).setTimeout.apply(d,arguments)};t.clearInterval=s,t.clearTimeout=a,t.setInterval=c,t.setTimeout=h})}),Dp=M(e=>{_(),v(),m();var o=e&&e.__createBinding||(Object.create?function(c,h,d,g){g===void 0&&(g=d);var b=Object.getOwnPropertyDescriptor(h,d);(!b||("get"in b?!h.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(c,g,b)}:function(c,h,d,g){g===void 0&&(g=d),c[g]=h[d]}),t=e&&e.__setModuleDefault||(Object.create?function(c,h){Object.defineProperty(c,"default",{enumerable:!0,value:h})}:function(c,h){c.default=h}),n=e&&e.__importStar||function(c){if(c&&c.__esModule)return c;var h={};if(c!=null)for(var d in c)d!=="default"&&Object.prototype.hasOwnProperty.call(c,d)&&o(h,c,d);return t(h,c),h};Object.defineProperty(e,"__esModule",{value:!0});var u=n(Oi()),r=Lp(),i={set:r.setInterval,clear:r.clearInterval},s={set:(c,h)=>setInterval(c,h),clear:c=>clearInterval(c)},a=c=>{switch(c){case"native":return s;case"worker":return i;case"auto":default:return u.default&&!u.isWebWorker&&!u.isReactNativeBrowser?i:s}};e.default=a}),Wa=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(e,"__esModule",{value:!0});var t=o(Dp()),n=class{get keepaliveTimeoutTimestamp(){return this._keepaliveTimeoutTimestamp}get intervalEvery(){return this._intervalEvery}get keepalive(){return this._keepalive}constructor(u,r){this.destroyed=!1,this.client=u,this.timer=typeof r=="object"&&"set"in r&&"clear"in r?r:(0,t.default)(r),this.setKeepalive(u.options.keepalive)}clear(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}setKeepalive(u){if(u*=1e3,isNaN(u)||u<=0||u>2147483647)throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${u}`);this._keepalive=u,this.reschedule(),this.client.log(`KeepaliveManager: set keepalive to ${u}ms`)}destroy(){this.clear(),this.destroyed=!0}reschedule(){if(this.destroyed)return;this.clear(),this.counter=0;let u=Math.ceil(this._keepalive*1.5);this._keepaliveTimeoutTimestamp=Date.now()+u,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set(()=>{this.destroyed||(this.counter+=1,this.counter===2?this.client.sendPing():this.counter>2&&this.client.onKeepaliveTimeout())},this._intervalEvery)}};e.default=n}),os=M(e=>{_(),v(),m();var o=e&&e.__createBinding||(Object.create?function(Q,U,D,V){V===void 0&&(V=D);var ae=Object.getOwnPropertyDescriptor(U,D);(!ae||("get"in ae?!U.__esModule:ae.writable||ae.configurable))&&(ae={enumerable:!0,get:function(){return U[D]}}),Object.defineProperty(Q,V,ae)}:function(Q,U,D,V){V===void 0&&(V=D),Q[V]=U[D]}),t=e&&e.__setModuleDefault||(Object.create?function(Q,U){Object.defineProperty(Q,"default",{enumerable:!0,value:U})}:function(Q,U){Q.default=U}),n=e&&e.__importStar||function(Q){if(Q&&Q.__esModule)return Q;var U={};if(Q!=null)for(var D in Q)D!=="default"&&Object.prototype.hasOwnProperty.call(Q,D)&&o(U,Q,D);return t(U,Q),U},u=e&&e.__importDefault||function(Q){return Q&&Q.__esModule?Q:{default:Q}};Object.defineProperty(e,"__esModule",{value:!0});var r=u(Gu()),i=u(Nd()),s=u(Zo()),a=jt(),c=u(Fd()),h=n($d()),d=u(ot()),g=u(ra()),b=u(Tp()),w=_r(),E=Rp(),T=u(Wa()),R=n(Oi()),I=globalThis.setImmediate||((...Q)=>{let U=Q.shift();(0,w.nextTick)(()=>{U(...Q)})}),k={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,writeCache:!0,timerVariant:"auto"},W=class mr extends E.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(U,D){super(),this.options=D||{};for(let V in k)typeof this.options[V]>"u"?this.options[V]=k[V]:this.options[V]=D[V];this.log=this.options.log||(0,d.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: version:",mr.VERSION),R.isWebWorker?this.log("MqttClient :: environment","webworker"):this.log("MqttClient :: environment",R.default?"browser":"node"),this.log("MqttClient :: options.protocol",D.protocol),this.log("MqttClient :: options.protocolVersion",D.protocolVersion),this.log("MqttClient :: options.username",D.username),this.log("MqttClient :: options.keepalive",D.keepalive),this.log("MqttClient :: options.reconnectPeriod",D.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",D.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",D.properties?D.properties.topicAliasMaximum:void 0),this.options.clientId=typeof D.clientId=="string"?D.clientId:mr.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=D.protocolVersion===5&&D.customHandleAcks?D.customHandleAcks:(...V)=>{V[3](null,0)},this.options.writeCache||(i.default.writeToStream.cacheNumbers=!1),this.streamBuilder=U,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new s.default:this.options.messageIdProvider,this.outgoingStore=D.outgoingStore||new g.default,this.incomingStore=D.incomingStore||new g.default,this.queueQoSZero=D.queueQoSZero===void 0?!0:D.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.keepaliveManager=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,D.properties&&D.properties.topicAliasMaximum>0&&(D.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new r.default(D.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:V}=this,ae=()=>{let $=V.shift();this.log("deliver :: entry %o",$);let xe=null;if(!$){this._resubscribe();return}xe=$.packet,this.log("deliver :: call _sendPacket for %o",xe);let N=!0;xe.messageId&&xe.messageId!==0&&(this.messageIdProvider.register(xe.messageId)||(N=!1)),N?this._sendPacket(xe,le=>{$.cb&&$.cb(le),ae()}):(this.log("messageId: %d has already used. The message is skipped and removed.",xe.messageId),ae())};this.log("connect :: sending queued packets"),ae()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this._destroyKeepaliveManager(),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(U,D){D()}handleMessage(U,D){D()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var U;let D=new a.Writable,V=i.default.parser(this.options),ae=null,$=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.disconnected&&!this.reconnecting&&(this.incomingStore=this.options.incomingStore||new g.default,this.outgoingStore=this.options.outgoingStore||new g.default,this.disconnecting=!1,this.disconnected=!1),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),V.on("packet",ge=>{this.log("parser :: on packet push to packets array."),$.push(ge)});let xe=()=>{this.log("work :: getting next packet in queue");let ge=$.shift();if(ge)this.log("work :: packet pulled from queue"),(0,b.default)(this,ge,N);else{this.log("work :: no packets in queue");let qe=ae;ae=null,this.log("work :: done flag is %s",!!qe),qe&&qe()}},N=()=>{if($.length)(0,w.nextTick)(xe);else{let ge=ae;ae=null,ge()}};D._write=(ge,qe,We)=>{ae=We,this.log("writable stream :: parsing buffer"),V.parse(ge),xe()};let le=ge=>{this.log("streamErrorHandler :: error",ge.message),ge.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",ge)):this.noop(ge)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(D),this.stream.on("error",le),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let Le={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(Le.will=Object.assign(Object.assign({},this.options.will),{payload:(U=this.options.will)===null||U===void 0?void 0:U.payload})),this.topicAliasRecv&&(Le.properties||(Le.properties={}),this.topicAliasRecv&&(Le.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(Le),V.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let ge=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(ge)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this.emit("error",new Error("connack timeout")),this._cleanUp(!0)},this.options.connectTimeout),this}publish(U,D,V,ae){this.log("publish :: message `%s` to topic `%s`",D,U);let{options:$}=this;typeof V=="function"&&(ae=V,V=null),V=V||{},V=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),V);let{qos:xe,retain:N,dup:le,properties:Le,cbStorePut:ge}=V;if(this._checkDisconnecting(ae))return this;let qe=()=>{let We=0;if((xe===1||xe===2)&&(We=this._nextId(),We===null))return this.log("No messageId left"),!1;let H={cmd:"publish",topic:U,payload:D,qos:xe,retain:N,messageId:We,dup:le};switch($.protocolVersion===5&&(H.properties=Le),this.log("publish :: qos",xe),xe){case 1:case 2:this.outgoing[H.messageId]={volatile:!1,cb:ae||this.noop},this.log("MqttClient:publish: packet cmd: %s",H.cmd),this._sendPacket(H,void 0,ge);break;default:this.log("MqttClient:publish: packet cmd: %s",H.cmd),this._sendPacket(H,ae,ge);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!qe())&&this._storeProcessingQueue.push({invoke:qe,cbStorePut:V.cbStorePut,callback:ae}),this}publishAsync(U,D,V){return new Promise((ae,$)=>{this.publish(U,D,V,(xe,N)=>{xe?$(xe):ae(N)})})}subscribe(U,D,V){let ae=this.options.protocolVersion;typeof D=="function"&&(V=D),V=V||this.noop;let $=!1,xe=[];typeof U=="string"?(U=[U],xe=U):Array.isArray(U)?xe=U:typeof U=="object"&&($=U.resubscribe,delete U.resubscribe,xe=Object.keys(U));let N=h.validateTopics(xe);if(N!==null)return I(V,new Error(`Invalid topic ${N}`)),this;if(this._checkDisconnecting(V))return this.log("subscribe: discconecting true"),this;let le={qos:0};ae===5&&(le.nl=!1,le.rap=!1,le.rh=0),D=Object.assign(Object.assign({},le),D);let Le=D.properties,ge=[],qe=(H,ye)=>{if(ye=ye||D,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,H)||this._resubscribeTopics[H].qos<ye.qos||$){let G={topic:H,qos:ye.qos};ae===5&&(G.nl=ye.nl,G.rap=ye.rap,G.rh=ye.rh,G.properties=Le),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",G.topic,G.qos),ge.push(G)}};if(Array.isArray(U)?U.forEach(H=>{this.log("subscribe: array topic %s",H),qe(H)}):Object.keys(U).forEach(H=>{this.log("subscribe: object topic %s, %o",H,U[H]),qe(H,U[H])}),!ge.length)return V(null,[]),this;let We=()=>{let H=this._nextId();if(H===null)return this.log("No messageId left"),!1;let ye={cmd:"subscribe",subscriptions:ge,messageId:H};if(Le&&(ye.properties=Le),this.options.resubscribe){this.log("subscribe :: resubscribe true");let G=[];ge.forEach(ie=>{if(this.options.reconnectPeriod>0){let S={qos:ie.qos};ae===5&&(S.nl=ie.nl||!1,S.rap=ie.rap||!1,S.rh=ie.rh||0,S.properties=ie.properties),this._resubscribeTopics[ie.topic]=S,G.push(ie.topic)}}),this.messageIdToTopic[ye.messageId]=G}return this.outgoing[ye.messageId]={volatile:!0,cb(G,ie){if(!G){let{granted:S}=ie;for(let J=0;J<S.length;J+=1)ge[J].qos=S[J]}V(G,ge,ie)}},this.log("subscribe :: call _sendPacket"),this._sendPacket(ye),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!We())&&this._storeProcessingQueue.push({invoke:We,callback:V}),this}subscribeAsync(U,D){return new Promise((V,ae)=>{this.subscribe(U,D,($,xe)=>{$?ae($):V(xe)})})}unsubscribe(U,D,V){typeof U=="string"&&(U=[U]),typeof D=="function"&&(V=D),V=V||this.noop;let ae=h.validateTopics(U);if(ae!==null)return I(V,new Error(`Invalid topic ${ae}`)),this;if(this._checkDisconnecting(V))return this;let $=()=>{let xe=this._nextId();if(xe===null)return this.log("No messageId left"),!1;let N={cmd:"unsubscribe",messageId:xe,unsubscriptions:[]};return typeof U=="string"?N.unsubscriptions=[U]:Array.isArray(U)&&(N.unsubscriptions=U),this.options.resubscribe&&N.unsubscriptions.forEach(le=>{delete this._resubscribeTopics[le]}),typeof D=="object"&&D.properties&&(N.properties=D.properties),this.outgoing[N.messageId]={volatile:!0,cb:V},this.log("unsubscribe: call _sendPacket"),this._sendPacket(N),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!$())&&this._storeProcessingQueue.push({invoke:$,callback:V}),this}unsubscribeAsync(U,D){return new Promise((V,ae)=>{this.unsubscribe(U,D,($,xe)=>{$?ae($):V(xe)})})}end(U,D,V){this.log("end :: (%s)",this.options.clientId),(U==null||typeof U!="boolean")&&(V=V||D,D=U,U=!1),typeof D!="object"&&(V=V||D,D=null),this.log("end :: cb? %s",!!V),(!V||typeof V!="function")&&(V=this.noop);let ae=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(xe=>{this.outgoingStore.close(N=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),V){let le=xe||N;this.log("end :: closeStores: invoking callback with args"),V(le)}})}),this._deferredReconnect?this._deferredReconnect():(this.options.reconnectPeriod===0||this.options.manualConnect)&&(this.disconnecting=!1)},$=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,U),this._cleanUp(U,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,w.nextTick)(ae)},D)};return this.disconnecting?(V(),this):(this._clearReconnect(),this.disconnecting=!0,!U&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,$,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),$()),this)}endAsync(U,D){return new Promise((V,ae)=>{this.end(U,D,$=>{$?ae($):V()})})}removeOutgoingMessage(U){if(this.outgoing[U]){let{cb:D}=this.outgoing[U];this._removeOutgoingAndStoreMessage(U,()=>{D(new Error("Message removed"))})}return this}reconnect(U){this.log("client reconnect");let D=()=>{U?(this.options.incomingStore=U.incomingStore,this.options.outgoingStore=U.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new g.default,this.outgoingStore=this.options.outgoingStore||new g.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=D:D(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(U=>{this.outgoing[U].volatile&&typeof this.outgoing[U].cb=="function"&&(this.outgoing[U].cb(new Error("Connection closed")),delete this.outgoing[U])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(U=>{typeof this.outgoing[U].cb=="function"&&(this.outgoing[U].cb(new Error("Connection closed")),delete this.outgoing[U])}))}_removeTopicAliasAndRecoverTopicName(U){let D;U.properties&&(D=U.properties.topicAlias);let V=U.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",D,V),V.length===0){if(typeof D>"u")return new Error("Unregistered Topic Alias");if(V=this.topicAliasSend.getTopicByAlias(D),typeof V>"u")return new Error("Unregistered Topic Alias");U.topic=V}D&&delete U.properties.topicAlias}_checkDisconnecting(U){return this.disconnecting&&(U&&U!==this.noop?U(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(U,D,V={}){if(D&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",D)),this.log("_cleanUp :: forced? %s",U),U)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let ae=Object.assign({cmd:"disconnect"},V);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(ae,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),I(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}!this.disconnecting&&!this.reconnecting&&(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),D&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",D),D())}_storeAndSend(U,D,V){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",U.cmd);let ae=U,$;if(ae.cmd==="publish"&&(ae=(0,c.default)(U),$=this._removeTopicAliasAndRecoverTopicName(ae),$))return D&&D($);this.outgoingStore.put(ae,xe=>{if(xe)return D&&D(xe);V(),this._writePacket(U,D)})}_applyTopicAlias(U){if(this.options.protocolVersion===5&&U.cmd==="publish"){let D;U.properties&&(D=U.properties.topicAlias);let V=U.topic.toString();if(this.topicAliasSend)if(D){if(V.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",V,D),!this.topicAliasSend.put(V,D)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",V,D),new Error("Sending Topic Alias out of range")}else V.length!==0&&(this.options.autoAssignTopicAlias?(D=this.topicAliasSend.getAliasByTopic(V),D?(U.topic="",U.properties=Object.assign(Object.assign({},U.properties),{topicAlias:D}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",V,D)):(D=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(V,D),U.properties=Object.assign(Object.assign({},U.properties),{topicAlias:D}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",V,D))):this.options.autoUseTopicAlias&&(D=this.topicAliasSend.getAliasByTopic(V),D&&(U.topic="",U.properties=Object.assign(Object.assign({},U.properties),{topicAlias:D}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",V,D))));else if(D)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",V,D),new Error("Sending Topic Alias out of range")}}_noop(U){this.log("noop ::",U)}_writePacket(U,D){this.log("_writePacket :: packet: %O",U),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",U),this.log("_writePacket :: writing to stream");let V=i.default.writeToStream(U,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",V),!V&&D&&D!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",D)):D&&(this.log("_writePacket :: invoking cb"),D())}_sendPacket(U,D,V,ae){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),V=V||this.noop,D=D||this.noop;let $=this._applyTopicAlias(U);if($){D($);return}if(!this.connected){if(U.cmd==="auth"){this._writePacket(U,D);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(U,D,V);return}if(ae){this._writePacket(U,D);return}switch(U.cmd){case"publish":break;case"pubrel":this._storeAndSend(U,D,V);return;default:this._writePacket(U,D);return}switch(U.qos){case 2:case 1:this._storeAndSend(U,D,V);break;case 0:default:this._writePacket(U,D);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(U,D,V){this.log("_storePacket :: packet: %o",U),this.log("_storePacket :: cb? %s",!!D),V=V||this.noop;let ae=U;if(ae.cmd==="publish"){ae=(0,c.default)(U);let xe=this._removeTopicAliasAndRecoverTopicName(ae);if(xe)return D&&D(xe)}let $=ae.qos||0;$===0&&this.queueQoSZero||ae.cmd!=="publish"?this.queue.push({packet:ae,cb:D}):$>0?(D=this.outgoing[ae.messageId]?this.outgoing[ae.messageId].cb:null,this.outgoingStore.put(ae,xe=>{if(xe)return D&&D(xe);V()})):D&&D(new Error("No connection to broker"))}_setupKeepaliveManager(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new T.default(this,this.options.timerVariant))}_destroyKeepaliveManager(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}reschedulePing(U=!1){this.keepaliveManager&&this.options.keepalive&&(U||this.options.reschedulePings)&&this._reschedulePing()}_reschedulePing(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}sendPing(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}onKeepaliveTimeout(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}_resubscribe(){this.log("_resubscribe");let U=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&U.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let D=0;D<U.length;D++){let V={};V[U[D]]=this._resubscribeTopics[U[D]],V.resubscribe=!0,this.subscribe(V,{properties:V[U[D]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(U){if(this.disconnected){this.emit("connect",U);return}this.connackPacket=U,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;let D=()=>{let V=this.outgoingStore.createStream(),ae=()=>{V.destroy(),V=null,this._flushStoreProcessingQueue(),$()},$=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",ae),V.on("error",N=>{$(),this._flushStoreProcessingQueue(),this.removeListener("close",ae),this.emit("error",N)});let xe=()=>{if(!V)return;let N=V.read(1),le;if(!N){V.once("readable",xe);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[N.messageId]){xe();return}!this.disconnecting&&!this.reconnectTimer?(le=this.outgoing[N.messageId]?this.outgoing[N.messageId].cb:null,this.outgoing[N.messageId]={volatile:!1,cb(Le,ge){le&&le(Le,ge),xe()}},this._packetIdsDuringStoreProcessing[N.messageId]=!0,this.messageIdProvider.register(N.messageId)?this._sendPacket(N,void 0,void 0,!0):this.log("messageId: %d has already used.",N.messageId)):V.destroy&&V.destroy()};V.on("end",()=>{let N=!0;for(let le in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[le]){N=!1;break}this.removeListener("close",ae),N?($(),this._invokeAllStoreProcessingQueue(),this.emit("connect",U)):D()}),xe()};D()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let U=this._storeProcessingQueue[0];if(U&&U.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let U of this._storeProcessingQueue)U.cbStorePut&&U.cbStorePut(new Error("Connection closed")),U.callback&&U.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(U,D){delete this.outgoing[U],this.outgoingStore.del({messageId:U},(V,ae)=>{D(V,ae),this.messageIdProvider.deallocate(U),this._invokeStoreProcessingQueue()})}};W.VERSION=w.MQTTJS_VERSION,e.default=W}),Vp=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=Ua(),t=class{constructor(){this.numberAllocator=new o.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(n){return this.numberAllocator.use(n)}deallocate(n){this.numberAllocator.free(n)}clear(){this.numberAllocator.clear()}};e.default=t});function Rr(e){throw new RangeError(sE[e])}function zp(e,o){let t=e.split("@"),n="";t.length>1&&(n=t[0]+"@",e=t[1]);let u=function(r,i){let s=[],a=r.length;for(;a--;)s[a]=i(r[a]);return s}((e=e.replace(nE,".")).split("."),o).join(".");return n+u}function Yp(e){let o=[],t=0,n=e.length;for(;t<n;){let u=e.charCodeAt(t++);if(u>=55296&&u<=56319&&t<n){let r=e.charCodeAt(t++);(64512&r)==56320?o.push(((1023&u)<<10)+(1023&r)+65536):(o.push(u),t--)}else o.push(u)}return o}var rE,iE,nE,sE,dt,Ka,Kp,Jp,Gp,Qp,Kt,Xp=_e(()=>{_(),v(),m(),rE=/^xn--/,iE=/[^\0-\x7E]/,nE=/[\x2E\u3002\uFF0E\uFF61]/g,sE={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},dt=Math.floor,Ka=String.fromCharCode,Kp=function(e,o){return e+22+75*(e<26)-((o!=0)<<5)},Jp=function(e,o,t){let n=0;for(e=t?dt(e/700):e>>1,e+=dt(e/o);e>455;n+=36)e=dt(e/35);return dt(n+36*e/(e+38))},Gp=function(e){let o=[],t=e.length,n=0,u=128,r=72,i=e.lastIndexOf("-");i<0&&(i=0);for(let a=0;a<i;++a)e.charCodeAt(a)>=128&&Rr("not-basic"),o.push(e.charCodeAt(a));for(let a=i>0?i+1:0;a<t;){let c=n;for(let d=1,g=36;;g+=36){a>=t&&Rr("invalid-input");let b=(s=e.charCodeAt(a++))-48<10?s-22:s-65<26?s-65:s-97<26?s-97:36;(b>=36||b>dt((2147483647-n)/d))&&Rr("overflow"),n+=b*d;let w=g<=r?1:g>=r+26?26:g-r;if(b<w)break;let E=36-w;d>dt(2147483647/E)&&Rr("overflow"),d*=E}let h=o.length+1;r=Jp(n-c,h,c==0),dt(n/h)>2147483647-u&&Rr("overflow"),u+=dt(n/h),n%=h,o.splice(n++,0,u)}var s;return String.fromCodePoint(...o)},Qp=function(e){let o=[],t=(e=Yp(e)).length,n=128,u=0,r=72;for(let a of e)a<128&&o.push(Ka(a));let i=o.length,s=i;for(i&&o.push("-");s<t;){let a=2147483647;for(let h of e)h>=n&&h<a&&(a=h);let c=s+1;a-n>dt((2147483647-u)/c)&&Rr("overflow"),u+=(a-n)*c,n=a;for(let h of e)if(h<n&&++u>2147483647&&Rr("overflow"),h==n){let d=u;for(let g=36;;g+=36){let b=g<=r?1:g>=r+26?26:g-r;if(d<b)break;let w=d-b,E=36-b;o.push(Ka(Kp(b+w%E,0))),d=dt(w/E)}o.push(Ka(Kp(d,0))),r=Jp(u,c,s==i),u=0,++s}++u,++n}return o.join("")},Kt={version:"2.1.0",ucs2:{decode:Yp,encode:e=>String.fromCodePoint(...e)},decode:Gp,encode:Qp,toASCII:function(e){return zp(e,function(o){return iE.test(o)?"xn--"+Qp(o):o})},toUnicode:function(e){return zp(e,function(o){return rE.test(o)?Gp(o.slice(4).toLowerCase()):o})}},Kt.decode,Kt.encode,Kt.toASCII,Kt.toUnicode,Kt.ucs2,Kt.version});function oE(e,o){return Object.prototype.hasOwnProperty.call(e,o)}var aE,Mi,lE,pt,Zp=_e(()=>{_(),v(),m(),aE=function(e,o,t,n){o=o||"&",t=t||"=";var u={};if(typeof e!="string"||e.length===0)return u;var r=/\+/g;e=e.split(o);var i=1e3;n&&typeof n.maxKeys=="number"&&(i=n.maxKeys);var s=e.length;i>0&&s>i&&(s=i);for(var a=0;a<s;++a){var c,h,d,g,b=e[a].replace(r,"%20"),w=b.indexOf(t);w>=0?(c=b.substr(0,w),h=b.substr(w+1)):(c=b,h=""),d=decodeURIComponent(c),g=decodeURIComponent(h),oE(u,d)?Array.isArray(u[d])?u[d].push(g):u[d]=[u[d],g]:u[d]=g}return u},Mi=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},lE=function(e,o,t,n){return o=o||"&",t=t||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(u){var r=encodeURIComponent(Mi(u))+t;return Array.isArray(e[u])?e[u].map(function(i){return r+encodeURIComponent(Mi(i))}).join(o):r+encodeURIComponent(Mi(e[u]))}).join(o):n?encodeURIComponent(Mi(n))+t+encodeURIComponent(Mi(e)):""},pt={},pt.decode=pt.parse=aE,pt.encode=pt.stringify=lE,pt.decode,pt.encode,pt.parse,pt.stringify});function Ga(){throw new Error("setTimeout has not been defined")}function Qa(){throw new Error("clearTimeout has not been defined")}function rg(e){if(Pt===setTimeout)return setTimeout(e,0);if((Pt===Ga||!Pt)&&setTimeout)return Pt=setTimeout,setTimeout(e,0);try{return Pt(e,0)}catch{try{return Pt.call(null,e,0)}catch{return Pt.call(this||si,e,0)}}}function uE(){ni&&Cr&&(ni=!1,Cr.length?Ot=Cr.concat(Ot):as=-1,Ot.length&&ig())}function ig(){if(!ni){var e=rg(uE);ni=!0;for(var o=Ot.length;o;){for(Cr=Ot,Ot=[];++as<o;)Cr&&Cr[as].run();as=-1,o=Ot.length}Cr=null,ni=!1,function(t){if(kt===clearTimeout)return clearTimeout(t);if((kt===Qa||!kt)&&clearTimeout)return kt=clearTimeout,clearTimeout(t);try{kt(t)}catch{try{return kt.call(null,t)}catch{return kt.call(this||si,t)}}}(e)}}function eg(e,o){(this||si).fun=e,(this||si).array=o}function Bt(){}var tg,Pt,kt,si,fe,Cr,Ot,ni,as,ne,ng=_e(()=>{_(),v(),m(),si=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,fe=tg={},function(){try{Pt=typeof setTimeout=="function"?setTimeout:Ga}catch{Pt=Ga}try{kt=typeof clearTimeout=="function"?clearTimeout:Qa}catch{kt=Qa}}(),Ot=[],ni=!1,as=-1,fe.nextTick=function(e){var o=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)o[t-1]=arguments[t];Ot.push(new eg(e,o)),Ot.length!==1||ni||rg(ig)},eg.prototype.run=function(){(this||si).fun.apply(null,(this||si).array)},fe.title="browser",fe.browser=!0,fe.env={},fe.argv=[],fe.version="",fe.versions={},fe.on=Bt,fe.addListener=Bt,fe.once=Bt,fe.off=Bt,fe.removeListener=Bt,fe.removeAllListeners=Bt,fe.emit=Bt,fe.prependListener=Bt,fe.prependOnceListener=Bt,fe.listeners=function(e){return[]},fe.binding=function(e){throw new Error("process.binding is not supported")},fe.cwd=function(){return"/"},fe.chdir=function(e){throw new Error("process.chdir is not supported")},fe.umask=function(){return 0},ne=tg,ne.addListener,ne.argv,ne.binding,ne.browser,ne.chdir,ne.cwd,ne.emit,ne.env,ne.listeners,ne.nextTick,ne.off,ne.on,ne.once,ne.prependListener,ne.prependOnceListener,ne.removeAllListeners,ne.removeListener,ne.title,ne.umask,ne.version,ne.versions});function fE(){if(sg)return Ya;sg=!0;var e=Ya={},o,t;function n(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?o=setTimeout:o=n}catch{o=n}try{typeof clearTimeout=="function"?t=clearTimeout:t=u}catch{t=u}})();function r(E){if(o===setTimeout)return setTimeout(E,0);if((o===n||!o)&&setTimeout)return o=setTimeout,setTimeout(E,0);try{return o(E,0)}catch{try{return o.call(null,E,0)}catch{return o.call(this||oi,E,0)}}}function i(E){if(t===clearTimeout)return clearTimeout(E);if((t===u||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(E);try{return t(E)}catch{try{return t.call(null,E)}catch{return t.call(this||oi,E)}}}var s=[],a=!1,c,h=-1;function d(){!a||!c||(a=!1,c.length?s=c.concat(s):h=-1,s.length&&g())}function g(){if(!a){var E=r(d);a=!0;for(var T=s.length;T;){for(c=s,s=[];++h<T;)c&&c[h].run();h=-1,T=s.length}c=null,a=!1,i(E)}}e.nextTick=function(E){var T=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)T[R-1]=arguments[R];s.push(new b(E,T)),s.length===1&&!a&&r(g)};function b(E,T){(this||oi).fun=E,(this||oi).array=T}b.prototype.run=function(){(this||oi).fun.apply(null,(this||oi).array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function w(){}return e.on=w,e.addListener=w,e.once=w,e.off=w,e.removeListener=w,e.removeAllListeners=w,e.emit=w,e.prependListener=w,e.prependOnceListener=w,e.listeners=function(E){return[]},e.binding=function(E){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(E){throw new Error("process.chdir is not supported")},e.umask=function(){return 0},Ya}var Ya,sg,oi,re,Ja=_e(()=>{_(),v(),m(),Ya={},sg=!1,oi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,re=fE(),re.platform="browser",re.addListener,re.argv,re.binding,re.browser,re.chdir,re.cwd,re.emit,re.env,re.listeners,re.nextTick,re.off,re.on,re.once,re.prependListener,re.prependOnceListener,re.removeAllListeners,re.removeListener,re.title,re.umask,re.version,re.versions});function cE(){if(og)return Xa;og=!0;var e=re;function o(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function t(r,i){for(var s="",a=0,c=-1,h=0,d,g=0;g<=r.length;++g){if(g<r.length)d=r.charCodeAt(g);else{if(d===47)break;d=47}if(d===47){if(!(c===g-1||h===1))if(c!==g-1&&h===2){if(s.length<2||a!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var b=s.lastIndexOf("/");if(b!==s.length-1){b===-1?(s="",a=0):(s=s.slice(0,b),a=s.length-1-s.lastIndexOf("/")),c=g,h=0;continue}}else if(s.length===2||s.length===1){s="",a=0,c=g,h=0;continue}}i&&(s.length>0?s+="/..":s="..",a=2)}else s.length>0?s+="/"+r.slice(c+1,g):s=r.slice(c+1,g),a=g-c-1;c=g,h=0}else d===46&&h!==-1?++h:h=-1}return s}function n(r,i){var s=i.dir||i.root,a=i.base||(i.name||"")+(i.ext||"");return s?s===i.root?s+a:s+r+a:a}var u={resolve:function(){for(var r="",i=!1,s,a=arguments.length-1;a>=-1&&!i;a--){var c;a>=0?c=arguments[a]:(s===void 0&&(s=e.cwd()),c=s),o(c),c.length!==0&&(r=c+"/"+r,i=c.charCodeAt(0)===47)}return r=t(r,!i),i?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(o(r),r.length===0)return".";var i=r.charCodeAt(0)===47,s=r.charCodeAt(r.length-1)===47;return r=t(r,!i),r.length===0&&!i&&(r="."),r.length>0&&s&&(r+="/"),i?"/"+r:r},isAbsolute:function(r){return o(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,i=0;i<arguments.length;++i){var s=arguments[i];o(s),s.length>0&&(r===void 0?r=s:r+="/"+s)}return r===void 0?".":u.normalize(r)},relative:function(r,i){if(o(r),o(i),r===i||(r=u.resolve(r),i=u.resolve(i),r===i))return"";for(var s=1;s<r.length&&r.charCodeAt(s)===47;++s);for(var a=r.length,c=a-s,h=1;h<i.length&&i.charCodeAt(h)===47;++h);for(var d=i.length,g=d-h,b=c<g?c:g,w=-1,E=0;E<=b;++E){if(E===b){if(g>b){if(i.charCodeAt(h+E)===47)return i.slice(h+E+1);if(E===0)return i.slice(h+E)}else c>b&&(r.charCodeAt(s+E)===47?w=E:E===0&&(w=0));break}var T=r.charCodeAt(s+E),R=i.charCodeAt(h+E);if(T!==R)break;T===47&&(w=E)}var I="";for(E=s+w+1;E<=a;++E)(E===a||r.charCodeAt(E)===47)&&(I.length===0?I+="..":I+="/..");return I.length>0?I+i.slice(h+w):(h+=w,i.charCodeAt(h)===47&&++h,i.slice(h))},_makeLong:function(r){return r},dirname:function(r){if(o(r),r.length===0)return".";for(var i=r.charCodeAt(0),s=i===47,a=-1,c=!0,h=r.length-1;h>=1;--h)if(i=r.charCodeAt(h),i===47){if(!c){a=h;break}}else c=!1;return a===-1?s?"/":".":s&&a===1?"//":r.slice(0,a)},basename:function(r,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');o(r);var s=0,a=-1,c=!0,h;if(i!==void 0&&i.length>0&&i.length<=r.length){if(i.length===r.length&&i===r)return"";var d=i.length-1,g=-1;for(h=r.length-1;h>=0;--h){var b=r.charCodeAt(h);if(b===47){if(!c){s=h+1;break}}else g===-1&&(c=!1,g=h+1),d>=0&&(b===i.charCodeAt(d)?--d===-1&&(a=h):(d=-1,a=g))}return s===a?a=g:a===-1&&(a=r.length),r.slice(s,a)}else{for(h=r.length-1;h>=0;--h)if(r.charCodeAt(h)===47){if(!c){s=h+1;break}}else a===-1&&(c=!1,a=h+1);return a===-1?"":r.slice(s,a)}},extname:function(r){o(r);for(var i=-1,s=0,a=-1,c=!0,h=0,d=r.length-1;d>=0;--d){var g=r.charCodeAt(d);if(g===47){if(!c){s=d+1;break}continue}a===-1&&(c=!1,a=d+1),g===46?i===-1?i=d:h!==1&&(h=1):i!==-1&&(h=-1)}return i===-1||a===-1||h===0||h===1&&i===a-1&&i===s+1?"":r.slice(i,a)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return n("/",r)},parse:function(r){o(r);var i={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return i;var s=r.charCodeAt(0),a=s===47,c;a?(i.root="/",c=1):c=0;for(var h=-1,d=0,g=-1,b=!0,w=r.length-1,E=0;w>=c;--w){if(s=r.charCodeAt(w),s===47){if(!b){d=w+1;break}continue}g===-1&&(b=!1,g=w+1),s===46?h===-1?h=w:E!==1&&(E=1):h!==-1&&(E=-1)}return h===-1||g===-1||E===0||E===1&&h===g-1&&h===d+1?g!==-1&&(d===0&&a?i.base=i.name=r.slice(1,g):i.base=i.name=r.slice(d,g)):(d===0&&a?(i.name=r.slice(1,h),i.base=r.slice(1,g)):(i.name=r.slice(d,h),i.base=r.slice(d,g)),i.ext=r.slice(h,g)),d>0?i.dir=r.slice(0,d-1):a&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};return u.posix=u,Xa=u,Xa}var Xa,og,Za,ag=_e(()=>{_(),v(),m(),Ja(),Xa={},og=!1,Za=cE()}),gg={};Jt(gg,{URL:()=>FE,Url:()=>UE,default:()=>Z,fileURLToPath:()=>dg,format:()=>NE,parse:()=>jE,pathToFileURL:()=>pg,resolve:()=>qE,resolveObject:()=>DE});function Fe(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function Li(e,o,t){if(e&&gt.isObject(e)&&e instanceof Fe)return e;var n=new Fe;return n.parse(e,o,t),n}function _E(){if(cg)return rl;cg=!0;var e=ne;function o(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function t(r,i){for(var s="",a=0,c=-1,h=0,d,g=0;g<=r.length;++g){if(g<r.length)d=r.charCodeAt(g);else{if(d===47)break;d=47}if(d===47){if(!(c===g-1||h===1))if(c!==g-1&&h===2){if(s.length<2||a!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var b=s.lastIndexOf("/");if(b!==s.length-1){b===-1?(s="",a=0):(s=s.slice(0,b),a=s.length-1-s.lastIndexOf("/")),c=g,h=0;continue}}else if(s.length===2||s.length===1){s="",a=0,c=g,h=0;continue}}i&&(s.length>0?s+="/..":s="..",a=2)}else s.length>0?s+="/"+r.slice(c+1,g):s=r.slice(c+1,g),a=g-c-1;c=g,h=0}else d===46&&h!==-1?++h:h=-1}return s}function n(r,i){var s=i.dir||i.root,a=i.base||(i.name||"")+(i.ext||"");return s?s===i.root?s+a:s+r+a:a}var u={resolve:function(){for(var r="",i=!1,s,a=arguments.length-1;a>=-1&&!i;a--){var c;a>=0?c=arguments[a]:(s===void 0&&(s=e.cwd()),c=s),o(c),c.length!==0&&(r=c+"/"+r,i=c.charCodeAt(0)===47)}return r=t(r,!i),i?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(o(r),r.length===0)return".";var i=r.charCodeAt(0)===47,s=r.charCodeAt(r.length-1)===47;return r=t(r,!i),r.length===0&&!i&&(r="."),r.length>0&&s&&(r+="/"),i?"/"+r:r},isAbsolute:function(r){return o(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,i=0;i<arguments.length;++i){var s=arguments[i];o(s),s.length>0&&(r===void 0?r=s:r+="/"+s)}return r===void 0?".":u.normalize(r)},relative:function(r,i){if(o(r),o(i),r===i||(r=u.resolve(r),i=u.resolve(i),r===i))return"";for(var s=1;s<r.length&&r.charCodeAt(s)===47;++s);for(var a=r.length,c=a-s,h=1;h<i.length&&i.charCodeAt(h)===47;++h);for(var d=i.length,g=d-h,b=c<g?c:g,w=-1,E=0;E<=b;++E){if(E===b){if(g>b){if(i.charCodeAt(h+E)===47)return i.slice(h+E+1);if(E===0)return i.slice(h+E)}else c>b&&(r.charCodeAt(s+E)===47?w=E:E===0&&(w=0));break}var T=r.charCodeAt(s+E),R=i.charCodeAt(h+E);if(T!==R)break;T===47&&(w=E)}var I="";for(E=s+w+1;E<=a;++E)(E===a||r.charCodeAt(E)===47)&&(I.length===0?I+="..":I+="/..");return I.length>0?I+i.slice(h+w):(h+=w,i.charCodeAt(h)===47&&++h,i.slice(h))},_makeLong:function(r){return r},dirname:function(r){if(o(r),r.length===0)return".";for(var i=r.charCodeAt(0),s=i===47,a=-1,c=!0,h=r.length-1;h>=1;--h)if(i=r.charCodeAt(h),i===47){if(!c){a=h;break}}else c=!1;return a===-1?s?"/":".":s&&a===1?"//":r.slice(0,a)},basename:function(r,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');o(r);var s=0,a=-1,c=!0,h;if(i!==void 0&&i.length>0&&i.length<=r.length){if(i.length===r.length&&i===r)return"";var d=i.length-1,g=-1;for(h=r.length-1;h>=0;--h){var b=r.charCodeAt(h);if(b===47){if(!c){s=h+1;break}}else g===-1&&(c=!1,g=h+1),d>=0&&(b===i.charCodeAt(d)?--d===-1&&(a=h):(d=-1,a=g))}return s===a?a=g:a===-1&&(a=r.length),r.slice(s,a)}else{for(h=r.length-1;h>=0;--h)if(r.charCodeAt(h)===47){if(!c){s=h+1;break}}else a===-1&&(c=!1,a=h+1);return a===-1?"":r.slice(s,a)}},extname:function(r){o(r);for(var i=-1,s=0,a=-1,c=!0,h=0,d=r.length-1;d>=0;--d){var g=r.charCodeAt(d);if(g===47){if(!c){s=d+1;break}continue}a===-1&&(c=!1,a=d+1),g===46?i===-1?i=d:h!==1&&(h=1):i!==-1&&(h=-1)}return i===-1||a===-1||h===0||h===1&&i===a-1&&i===s+1?"":r.slice(i,a)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return n("/",r)},parse:function(r){o(r);var i={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return i;var s=r.charCodeAt(0),a=s===47,c;a?(i.root="/",c=1):c=0;for(var h=-1,d=0,g=-1,b=!0,w=r.length-1,E=0;w>=c;--w){if(s=r.charCodeAt(w),s===47){if(!b){d=w+1;break}continue}g===-1&&(b=!1,g=w+1),s===46?h===-1?h=w:E!==1&&(E=1):h!==-1&&(E=-1)}return h===-1||g===-1||E===0||E===1&&h===g-1&&h===d+1?g!==-1&&(d===0&&a?i.base=i.name=r.slice(1,g):i.base=i.name=r.slice(d,g)):(d===0&&a?(i.name=r.slice(1,h),i.base=r.slice(1,g)):(i.name=r.slice(d,h),i.base=r.slice(d,g)),i.ext=r.slice(h,g)),d>0?i.dir=r.slice(0,d-1):a&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};return u.posix=u,rl=u,rl}function kE(e){if(typeof e=="string")e=new URL(e);else if(!(e instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(e.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return nl?OE(e):xE(e)}function OE(e){let o=e.hostname,t=e.pathname;for(let n=0;n<t.length;n++)if(t[n]==="%"){let u=t.codePointAt(n+2)||32;if(t[n+1]==="2"&&u===102||t[n+1]==="5"&&u===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(t=t.replace(IE,"\\"),t=decodeURIComponent(t),o!=="")return`\\\\${o}${t}`;{let n=t.codePointAt(1)|32,u=t[2];if(n<SE||n>AE||u!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return t.slice(1)}}function xE(e){if(e.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let o=e.pathname;for(let t=0;t<o.length;t++)if(o[t]==="%"){let n=o.codePointAt(t+2)||32;if(o[t+1]==="2"&&n===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(o)}function ME(e){let o=hg.resolve(e),t=e.charCodeAt(e.length-1);(t===EE||nl&&t===vE)&&o[o.length-1]!==hg.sep&&(o+="/");let n=new URL("file://");return o.includes("%")&&(o=o.replace(TE,"%25")),!nl&&o.includes("\\")&&(o=o.replace(RE,"%5C")),o.includes(`
`)&&(o=o.replace(CE,"%0A")),o.includes("\r")&&(o=o.replace(BE,"%0D")),o.includes("	")&&(o=o.replace(PE,"%09")),n.pathname=o,n}function dg(e){if(typeof e=="string")e=new URL(e);else if(!(e instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(e.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return sl?XE(e):ZE(e)}function XE(e){let o=e.hostname,t=e.pathname;for(let n=0;n<t.length;n++)if(t[n]==="%"){let u=t.codePointAt(n+2)||32;if(t[n+1]==="2"&&u===102||t[n+1]==="5"&&u===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(t=t.replace(zE,"\\"),t=decodeURIComponent(t),o!=="")return`\\\\${o}${t}`;{let n=t.codePointAt(1)|32,u=t[2];if(n<HE||n>VE||u!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return t.slice(1)}}function ZE(e){if(e.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let o=e.pathname;for(let t=0;t<o.length;t++)if(o[t]==="%"){let n=o.codePointAt(t+2)||32;if(o[t+1]==="2"&&n===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(o)}function pg(e){let o=Za.resolve(e),t=e.charCodeAt(e.length-1);(t===$E||sl&&t===WE)&&o[o.length-1]!==Za.sep&&(o+="/");let n=new URL("file://");return o.includes("%")&&(o=o.replace(KE,"%25")),!sl&&o.includes("\\")&&(o=o.replace(GE,"%5C")),o.includes(`
`)&&(o=o.replace(QE,"%0A")),o.includes("\r")&&(o=o.replace(YE,"%0D")),o.includes("	")&&(o=o.replace(JE,"%09")),n.pathname=o,n}var Z,hE,gt,dE,pE,gE,yE,il,lg,ug,fg,bE,wE,el,ai,tl,rl,cg,hg,mE,vE,EE,SE,AE,nl,IE,TE,RE,CE,BE,PE,LE,UE,NE,qE,DE,jE,FE,WE,$E,HE,VE,sl,zE,KE,GE,QE,YE,JE,yg=_e(()=>{_(),v(),m(),Xp(),Zp(),ng(),ag(),Ja(),Z={},hE=Kt,gt={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},Z.parse=Li,Z.resolve=function(e,o){return Li(e,!1,!0).resolve(o)},Z.resolveObject=function(e,o){return e?Li(e,!1,!0).resolveObject(o):o},Z.format=function(e){return gt.isString(e)&&(e=Li(e)),e instanceof Fe?e.format():Fe.prototype.format.call(e)},Z.Url=Fe,dE=/^([a-z0-9.+-]+:)/i,pE=/:[0-9]*$/,gE=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,yE=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),il=["'"].concat(yE),lg=["%","/","?",";","#"].concat(il),ug=["/","?","#"],fg=/^[+a-z0-9A-Z_-]{0,63}$/,bE=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,wE={javascript:!0,"javascript:":!0},el={javascript:!0,"javascript:":!0},ai={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},tl=pt,Fe.prototype.parse=function(e,o,t){if(!gt.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),u=n!==-1&&n<e.indexOf("#")?"?":"#",r=e.split(u);r[0]=r[0].replace(/\\/g,"/");var i=e=r.join(u);if(i=i.trim(),!t&&e.split("#").length===1){var s=gE.exec(i);if(s)return this.path=i,this.href=i,this.pathname=s[1],s[2]?(this.search=s[2],this.query=o?tl.parse(this.search.substr(1)):this.search.substr(1)):o&&(this.search="",this.query={}),this}var a=dE.exec(i);if(a){var c=(a=a[0]).toLowerCase();this.protocol=c,i=i.substr(a.length)}if(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var h=i.substr(0,2)==="//";!h||a&&el[a]||(i=i.substr(2),this.slashes=!0)}if(!el[a]&&(h||a&&!ai[a])){for(var d,g,b=-1,w=0;w<ug.length;w++)(E=i.indexOf(ug[w]))!==-1&&(b===-1||E<b)&&(b=E);for((g=b===-1?i.lastIndexOf("@"):i.lastIndexOf("@",b))!==-1&&(d=i.slice(0,g),i=i.slice(g+1),this.auth=decodeURIComponent(d)),b=-1,w=0;w<lg.length;w++){var E;(E=i.indexOf(lg[w]))!==-1&&(b===-1||E<b)&&(b=E)}b===-1&&(b=i.length),this.host=i.slice(0,b),i=i.slice(b),this.parseHost(),this.hostname=this.hostname||"";var T=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!T)for(var R=this.hostname.split(/\./),I=(w=0,R.length);w<I;w++){var k=R[w];if(k&&!k.match(fg)){for(var W="",Q=0,U=k.length;Q<U;Q++)k.charCodeAt(Q)>127?W+="x":W+=k[Q];if(!W.match(fg)){var D=R.slice(0,w),V=R.slice(w+1),ae=k.match(bE);ae&&(D.push(ae[1]),V.unshift(ae[2])),V.length&&(i="/"+V.join(".")+i),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=hE.toASCII(this.hostname));var $=this.port?":"+this.port:"",xe=this.hostname||"";this.host=xe+$,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),i[0]!=="/"&&(i="/"+i))}if(!wE[c])for(w=0,I=il.length;w<I;w++){var N=il[w];if(i.indexOf(N)!==-1){var le=encodeURIComponent(N);le===N&&(le=escape(N)),i=i.split(N).join(le)}}var Le=i.indexOf("#");Le!==-1&&(this.hash=i.substr(Le),i=i.slice(0,Le));var ge=i.indexOf("?");if(ge!==-1?(this.search=i.substr(ge),this.query=i.substr(ge+1),o&&(this.query=tl.parse(this.query)),i=i.slice(0,ge)):o&&(this.search="",this.query={}),i&&(this.pathname=i),ai[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){$=this.pathname||"";var qe=this.search||"";this.path=$+qe}return this.href=this.format(),this},Fe.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var o=this.protocol||"",t=this.pathname||"",n=this.hash||"",u=!1,r="";this.host?u=e+this.host:this.hostname&&(u=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(u+=":"+this.port)),this.query&&gt.isObject(this.query)&&Object.keys(this.query).length&&(r=tl.stringify(this.query));var i=this.search||r&&"?"+r||"";return o&&o.substr(-1)!==":"&&(o+=":"),this.slashes||(!o||ai[o])&&u!==!1?(u="//"+(u||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):u||(u=""),n&&n.charAt(0)!=="#"&&(n="#"+n),i&&i.charAt(0)!=="?"&&(i="?"+i),o+u+(t=t.replace(/[?#]/g,function(s){return encodeURIComponent(s)}))+(i=i.replace("#","%23"))+n},Fe.prototype.resolve=function(e){return this.resolveObject(Li(e,!1,!0)).format()},Fe.prototype.resolveObject=function(e){if(gt.isString(e)){var o=new Fe;o.parse(e,!1,!0),e=o}for(var t=new Fe,n=Object.keys(this),u=0;u<n.length;u++){var r=n[u];t[r]=this[r]}if(t.hash=e.hash,e.href==="")return t.href=t.format(),t;if(e.slashes&&!e.protocol){for(var i=Object.keys(e),s=0;s<i.length;s++){var a=i[s];a!=="protocol"&&(t[a]=e[a])}return ai[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(e.protocol&&e.protocol!==t.protocol){if(!ai[e.protocol]){for(var c=Object.keys(e),h=0;h<c.length;h++){var d=c[h];t[d]=e[d]}return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||el[e.protocol])t.pathname=e.pathname;else{for(var g=(e.pathname||"").split("/");g.length&&!(e.host=g.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),t.pathname=g.join("/")}if(t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,t.pathname||t.search){var b=t.pathname||"",w=t.search||"";t.path=b+w}return t.slashes=t.slashes||e.slashes,t.href=t.format(),t}var E=t.pathname&&t.pathname.charAt(0)==="/",T=e.host||e.pathname&&e.pathname.charAt(0)==="/",R=T||E||t.host&&e.pathname,I=R,k=t.pathname&&t.pathname.split("/")||[],W=(g=e.pathname&&e.pathname.split("/")||[],t.protocol&&!ai[t.protocol]);if(W&&(t.hostname="",t.port=null,t.host&&(k[0]===""?k[0]=t.host:k.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(g[0]===""?g[0]=e.host:g.unshift(e.host)),e.host=null),R=R&&(g[0]===""||k[0]==="")),T)t.host=e.host||e.host===""?e.host:t.host,t.hostname=e.hostname||e.hostname===""?e.hostname:t.hostname,t.search=e.search,t.query=e.query,k=g;else if(g.length)k||(k=[]),k.pop(),k=k.concat(g),t.search=e.search,t.query=e.query;else if(!gt.isNullOrUndefined(e.search))return W&&(t.hostname=t.host=k.shift(),(ae=!!(t.host&&t.host.indexOf("@")>0)&&t.host.split("@"))&&(t.auth=ae.shift(),t.host=t.hostname=ae.shift())),t.search=e.search,t.query=e.query,gt.isNull(t.pathname)&&gt.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!k.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var Q=k.slice(-1)[0],U=(t.host||e.host||k.length>1)&&(Q==="."||Q==="..")||Q==="",D=0,V=k.length;V>=0;V--)(Q=k[V])==="."?k.splice(V,1):Q===".."?(k.splice(V,1),D++):D&&(k.splice(V,1),D--);if(!R&&!I)for(;D--;D)k.unshift("..");!R||k[0]===""||k[0]&&k[0].charAt(0)==="/"||k.unshift(""),U&&k.join("/").substr(-1)!=="/"&&k.push("");var ae,$=k[0]===""||k[0]&&k[0].charAt(0)==="/";return W&&(t.hostname=t.host=$?"":k.length?k.shift():"",(ae=!!(t.host&&t.host.indexOf("@")>0)&&t.host.split("@"))&&(t.auth=ae.shift(),t.host=t.hostname=ae.shift())),(R=R||t.host&&k.length)&&!$&&k.unshift(""),k.length?t.pathname=k.join("/"):(t.pathname=null,t.path=null),gt.isNull(t.pathname)&&gt.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},Fe.prototype.parseHost=function(){var e=this.host,o=pE.exec(e);o&&((o=o[0])!==":"&&(this.port=o.substr(1)),e=e.substr(0,e.length-o.length)),e&&(this.hostname=e)},Z.Url,Z.format,Z.resolve,Z.resolveObject,rl={},cg=!1,hg=_E(),mE=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Z.URL=typeof URL<"u"?URL:null,Z.pathToFileURL=ME,Z.fileURLToPath=kE,Z.Url,Z.format,Z.resolve,Z.resolveObject,Z.URL,vE=92,EE=47,SE=97,AE=122,nl=mE==="win32",IE=/\//g,TE=/%/g,RE=/\\/g,CE=/\n/g,BE=/\r/g,PE=/\t/g,LE=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Z.URL=typeof URL<"u"?URL:null,Z.pathToFileURL=pg,Z.fileURLToPath=dg,UE=Z.Url,NE=Z.format,qE=Z.resolve,DE=Z.resolveObject,jE=Z.parse,FE=Z.URL,WE=92,$E=47,HE=97,VE=122,sl=LE==="win32",zE=/\//g,KE=/%/g,GE=/\\/g,QE=/\n/g,YE=/\r/g,JE=/\t/g}),wg=M((e,o)=>{_(),v(),m(),o.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),ls=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferedDuplex=e.writev=void 0;var o=jt(),t=(be(),X(me));function n(r,i){let s=new Array(r.length);for(let a=0;a<r.length;a++)typeof r[a].chunk=="string"?s[a]=t.Buffer.from(r[a].chunk,"utf8"):s[a]=r[a].chunk;this._write(t.Buffer.concat(s),"binary",i)}e.writev=n;var u=class extends o.Duplex{constructor(r,i,s){super({objectMode:!0}),this.proxy=i,this.socket=s,this.writeQueue=[],r.objectMode||(this._writev=n.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",a=>{this.destroyed||this.push(a)})}_read(r){this.proxy.read(r)}_write(r,i,s){this.isSocketOpen?this.writeToProxy(r,i,s):this.writeQueue.push({chunk:r,encoding:i,cb:s})}_final(r){this.writeQueue=[],this.proxy.end(r)}_destroy(r,i){this.writeQueue=[],this.proxy.destroy(),i(r)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(r,i,s){this.proxy.write(r,i)===!1?this.proxy.once("drain",s):s()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:r,encoding:i,cb:s}=this.writeQueue.shift();this.writeToProxy(r,i,s)}}};e.BufferedDuplex=u}),Ui=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(e,"__esModule",{value:!0}),e.streamBuilder=e.browserStreamBuilder=void 0;var t=(be(),X(me)),n=o(wg()),u=o(ot()),r=jt(),i=o(Oi()),s=ls(),a=(0,u.default)("mqttjs:ws"),c=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function h(R,I){let k=`${R.protocol}://${R.hostname}:${R.port}${R.path}`;return typeof R.transformWsUrl=="function"&&(k=R.transformWsUrl(k,R,I)),k}function d(R){let I=R;return R.port||(R.protocol==="wss"?I.port=443:I.port=80),R.path||(I.path="/"),R.wsOptions||(I.wsOptions={}),!i.default&&!R.forceNativeWebSocket&&R.protocol==="wss"&&c.forEach(k=>{Object.prototype.hasOwnProperty.call(R,k)&&!Object.prototype.hasOwnProperty.call(R.wsOptions,k)&&(I.wsOptions[k]=R[k])}),I}function g(R){let I=d(R);if(I.hostname||(I.hostname=I.host),!I.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let k=new URL(document.URL);I.hostname=k.hostname,I.port||(I.port=Number(k.port))}return I.objectMode===void 0&&(I.objectMode=!(I.binary===!0||I.binary===void 0)),I}function b(R,I,k){a("createWebSocket"),a(`protocol: ${k.protocolId} ${k.protocolVersion}`);let W=k.protocolId==="MQIsdp"&&k.protocolVersion===3?"mqttv3.1":"mqtt";a(`creating new Websocket for url: ${I} and protocol: ${W}`);let Q;return k.createWebsocket?Q=k.createWebsocket(I,[W],k):Q=new n.default(I,[W],k.wsOptions),Q}function w(R,I){let k=I.protocolId==="MQIsdp"&&I.protocolVersion===3?"mqttv3.1":"mqtt",W=h(I,R),Q;return I.createWebsocket?Q=I.createWebsocket(W,[k],I):Q=new WebSocket(W,[k]),Q.binaryType="arraybuffer",Q}var E=(R,I)=>{a("streamBuilder");let k=d(I);k.hostname=k.hostname||k.host||"localhost";let W=h(k,R),Q=b(R,W,k),U=n.default.createWebSocketStream(Q,k.wsOptions);return U.url=W,Q.on("close",()=>{U.destroy()}),U};e.streamBuilder=E;var T=(R,I)=>{a("browserStreamBuilder");let k,W=g(I).browserBufferSize||1024*512,Q=I.browserBufferTimeout||1e3,U=!I.objectMode,D=w(R,I),V=$(I,ge,qe);I.objectMode||(V._writev=s.writev.bind(V)),V.on("close",()=>{D.close()});let ae=typeof D.addEventListener<"u";D.readyState===D.OPEN?(k=V,k.socket=D):(k=new s.BufferedDuplex(I,V,D),ae?D.addEventListener("open",xe):D.onopen=xe),ae?(D.addEventListener("close",N),D.addEventListener("error",le),D.addEventListener("message",Le)):(D.onclose=N,D.onerror=le,D.onmessage=Le);function $(We,H,ye){let G=new r.Transform({objectMode:We.objectMode});return G._write=H,G._flush=ye,G}function xe(){a("WebSocket onOpen"),k instanceof s.BufferedDuplex&&k.socketReady()}function N(We){a("WebSocket onClose",We),k.end(),k.destroy()}function le(We){a("WebSocket onError",We);let H=new Error("WebSocket error");H.event=We,k.destroy(H)}async function Le(We){let{data:H}=We;H instanceof ArrayBuffer?H=t.Buffer.from(H):H instanceof Blob?H=t.Buffer.from(await new Response(H).arrayBuffer()):H=t.Buffer.from(H,"utf8"),V&&!V.destroyed&&V.push(H)}function ge(We,H,ye){if(D.bufferedAmount>W){setTimeout(ge,Q,We,H,ye);return}U&&typeof We=="string"&&(We=t.Buffer.from(We,"utf8"));try{D.send(We)}catch(G){return ye(G)}ye()}function qe(We){D.close(),We()}return k};e.browserStreamBuilder=T}),ul={};Jt(ul,{Server:()=>Me,Socket:()=>Me,Stream:()=>Me,_createServerHandle:()=>Me,_normalizeArgs:()=>Me,_setSimultaneousAccepts:()=>Me,connect:()=>Me,createConnection:()=>Me,createServer:()=>Me,default:()=>fS,isIP:()=>Me,isIPv4:()=>Me,isIPv6:()=>Me});function Me(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var fS,fl=_e(()=>{_(),v(),m(),fS={_createServerHandle:Me,_normalizeArgs:Me,_setSimultaneousAccepts:Me,connect:Me,createConnection:Me,createServer:Me,isIP:Me,isIPv4:Me,isIPv6:Me,Server:Me,Socket:Me,Stream:Me}}),cl=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0});var t=o((fl(),X(ul))),n=o(ot()),u=(0,n.default)("mqttjs:tcp"),r=(i,s)=>{s.port=s.port||1883,s.hostname=s.hostname||s.host||"localhost";let{port:a,path:c}=s,h=s.hostname;return u("port %d and host %s",a,h),t.default.createConnection({port:a,host:h,path:c})};e.default=r}),Ig={};Jt(Ig,{default:()=>gS});var gS,Tg=_e(()=>{_(),v(),m(),gS={}}),dl=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0});var t=o((Tg(),X(Ig))),n=o((fl(),X(ul))),u=o(ot()),r=(0,u.default)("mqttjs:tls"),i=(s,a)=>{a.port=a.port||8883,a.host=a.hostname||a.host||"localhost",n.default.isIP(a.host)===0&&(a.servername=a.host),a.rejectUnauthorized=a.rejectUnauthorized!==!1,delete a.path,r("port %d host %s rejectUnauthorized %b",a.port,a.host,a.rejectUnauthorized);let c=t.default.connect(a);c.on("secureConnect",()=>{a.rejectUnauthorized&&!c.authorized?c.emit("error",new Error("TLS not authorized")):c.removeListener("error",h)});function h(d){a.rejectUnauthorized&&s.emit("error",d),c.end()}return c.on("error",h),c};e.default=i}),yl=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=(be(),X(me)),t=jt(),n=ls(),u,r,i;function s(){let g=new t.Transform;return g._write=(b,w,E)=>{u.send({data:b.buffer,success(){E()},fail(T){E(new Error(T))}})},g._flush=b=>{u.close({success(){b()}})},g}function a(g){g.hostname||(g.hostname="localhost"),g.path||(g.path="/"),g.wsOptions||(g.wsOptions={})}function c(g,b){let w=g.protocol==="wxs"?"wss":"ws",E=`${w}://${g.hostname}${g.path}`;return g.port&&g.port!==80&&g.port!==443&&(E=`${w}://${g.hostname}:${g.port}${g.path}`),typeof g.transformWsUrl=="function"&&(E=g.transformWsUrl(E,g,b)),E}function h(){u.onOpen(()=>{i.socketReady()}),u.onMessage(g=>{let{data:b}=g;b instanceof ArrayBuffer?b=o.Buffer.from(b):b=o.Buffer.from(b,"utf8"),r.push(b)}),u.onClose(()=>{i.emit("close"),i.end(),i.destroy()}),u.onError(g=>{let b=new Error(g.errMsg);i.destroy(b)})}var d=(g,b)=>{if(b.hostname=b.hostname||b.host,!b.hostname)throw new Error("Could not determine host. Specify host manually.");let w=b.protocolId==="MQIsdp"&&b.protocolVersion===3?"mqttv3.1":"mqtt";a(b);let E=c(b,g);u=wx.connectSocket({url:E,protocols:[w]}),r=s(),i=new n.BufferedDuplex(b,r,u),i._destroy=(R,I)=>{u.close({success(){I&&I(R)}})};let T=i.destroy;return i.destroy=(R,I)=>(i.destroy=T,setTimeout(()=>{u.close({fail(){i._destroy(R,I)}})},0),i),h(),i};e.default=d}),_l=M(e=>{_(),v(),m(),Object.defineProperty(e,"__esModule",{value:!0});var o=(be(),X(me)),t=jt(),n=ls(),u,r,i,s=!1;function a(){let b=new t.Transform;return b._write=(w,E,T)=>{u.sendSocketMessage({data:w.buffer,success(){T()},fail(){T(new Error)}})},b._flush=w=>{u.closeSocket({success(){w()}})},b}function c(b){b.hostname||(b.hostname="localhost"),b.path||(b.path="/"),b.wsOptions||(b.wsOptions={})}function h(b,w){let E=b.protocol==="alis"?"wss":"ws",T=`${E}://${b.hostname}${b.path}`;return b.port&&b.port!==80&&b.port!==443&&(T=`${E}://${b.hostname}:${b.port}${b.path}`),typeof b.transformWsUrl=="function"&&(T=b.transformWsUrl(T,b,w)),T}function d(){s||(s=!0,u.onSocketOpen(()=>{i.socketReady()}),u.onSocketMessage(b=>{if(typeof b.data=="string"){let w=o.Buffer.from(b.data,"base64");r.push(w)}else{let w=new FileReader;w.addEventListener("load",()=>{let E=w.result;E instanceof ArrayBuffer?E=o.Buffer.from(E):E=o.Buffer.from(E,"utf8"),r.push(E)}),w.readAsArrayBuffer(b.data)}}),u.onSocketClose(()=>{i.end(),i.destroy()}),u.onSocketError(b=>{i.destroy(b)}))}var g=(b,w)=>{if(w.hostname=w.hostname||w.host,!w.hostname)throw new Error("Could not determine host. Specify host manually.");let E=w.protocolId==="MQIsdp"&&w.protocolVersion===3?"mqttv3.1":"mqtt";c(w);let T=h(w,b);return u=w.my,u.connectSocket({url:T,protocols:E}),r=a(),i=new n.BufferedDuplex(w,r,u),d(),i};e.default=g}),kg=M(e=>{_(),v(),m();var o=e&&e.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(e,"__esModule",{value:!0}),e.connectAsync=void 0;var t=o(ot()),n=o((yg(),X(gg))),u=o(os()),r=o(Oi());typeof(B==null?void 0:B.nextTick)!="function"&&(B.nextTick=setImmediate);var i=(0,t.default)("mqttjs"),s=null;function a(d){let g;d.auth&&(g=d.auth.match(/^(.+):(.+)$/),g?(d.username=g[1],d.password=g[2]):d.username=d.auth)}function c(d,g){var b,w,E,T;if(i("connecting to an MQTT broker..."),typeof d=="object"&&!g&&(g=d,d=""),g=g||{},d&&typeof d=="string"){let k=n.default.parse(d,!0),W={};if(k.port!=null&&(W.port=Number(k.port)),W.host=k.hostname,W.query=k.query,W.auth=k.auth,W.protocol=k.protocol,W.path=k.path,W.protocol=(b=W.protocol)===null||b===void 0?void 0:b.replace(/:$/,""),g=Object.assign(Object.assign({},W),g),!g.protocol)throw new Error("Missing protocol")}if(g.unixSocket=g.unixSocket||((w=g.protocol)===null||w===void 0?void 0:w.includes("+unix")),g.unixSocket?g.protocol=g.protocol.replace("+unix",""):!(!((E=g.protocol)===null||E===void 0)&&E.startsWith("ws"))&&!(!((T=g.protocol)===null||T===void 0)&&T.startsWith("wx"))&&delete g.path,a(g),g.query&&typeof g.query.clientId=="string"&&(g.clientId=g.query.clientId),g.cert&&g.key)if(g.protocol){if(["mqtts","wss","wxs","alis"].indexOf(g.protocol)===-1)switch(g.protocol){case"mqtt":g.protocol="mqtts";break;case"ws":g.protocol="wss";break;case"wx":g.protocol="wxs";break;case"ali":g.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${g.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(s||(s={},!r.default&&!g.forceNativeWebSocket?(s.ws=Ui().streamBuilder,s.wss=Ui().streamBuilder,s.mqtt=cl().default,s.tcp=cl().default,s.ssl=dl().default,s.tls=s.ssl,s.mqtts=dl().default):(s.ws=Ui().browserStreamBuilder,s.wss=Ui().browserStreamBuilder,s.wx=yl().default,s.wxs=yl().default,s.ali=_l().default,s.alis=_l().default)),!s[g.protocol]){let k=["mqtts","wss"].indexOf(g.protocol)!==-1;g.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((W,Q)=>k&&Q%2===0?!1:typeof s[W]=="function")[0]}if(g.clean===!1&&!g.clientId)throw new Error("Missing clientId for unclean clients");g.protocol&&(g.defaultProtocol=g.protocol);function R(k){return g.servers&&((!k._reconnectCount||k._reconnectCount===g.servers.length)&&(k._reconnectCount=0),g.host=g.servers[k._reconnectCount].host,g.port=g.servers[k._reconnectCount].port,g.protocol=g.servers[k._reconnectCount].protocol?g.servers[k._reconnectCount].protocol:g.defaultProtocol,g.hostname=g.host,k._reconnectCount++),i("calling streambuilder for",g.protocol),s[g.protocol](k,g)}let I=new u.default(R,g);return I.on("error",()=>{}),I}function h(d,g,b=!0){return new Promise((w,E)=>{let T=c(d,g),R={connect:k=>{I(),w(T)},end:()=>{I(),w(T)},error:k=>{I(),T.end(),E(k)}};b===!1&&(R.close=()=>{R.error(new Error("Couldn't connect to server"))});function I(){Object.keys(R).forEach(k=>{T.off(k,R[k])})}Object.keys(R).forEach(k=>{T.on(k,R[k])})})}e.connectAsync=h,e.default=c}),ml=M(e=>{_(),v(),m();var o=e&&e.__createBinding||(Object.create?function(b,w,E,T){T===void 0&&(T=E);var R=Object.getOwnPropertyDescriptor(w,E);(!R||("get"in R?!w.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return w[E]}}),Object.defineProperty(b,T,R)}:function(b,w,E,T){T===void 0&&(T=E),b[T]=w[E]}),t=e&&e.__setModuleDefault||(Object.create?function(b,w){Object.defineProperty(b,"default",{enumerable:!0,value:w})}:function(b,w){b.default=w}),n=e&&e.__importStar||function(b){if(b&&b.__esModule)return b;var w={};if(b!=null)for(var E in b)E!=="default"&&Object.prototype.hasOwnProperty.call(b,E)&&o(w,b,E);return t(w,b),w},u=e&&e.__exportStar||function(b,w){for(var E in b)E!=="default"&&!Object.prototype.hasOwnProperty.call(w,E)&&o(w,b,E)},r=e&&e.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=e.KeepaliveManager=e.UniqueMessageIdProvider=e.DefaultMessageIdProvider=e.Store=e.MqttClient=e.connectAsync=e.connect=e.Client=void 0;var i=r(os());e.MqttClient=i.default;var s=r(Zo());e.DefaultMessageIdProvider=s.default;var a=r(Vp());e.UniqueMessageIdProvider=a.default;var c=r(ra());e.Store=c.default;var h=n(kg());e.connect=h.default,Object.defineProperty(e,"connectAsync",{enumerable:!0,get:function(){return h.connectAsync}});var d=r(Wa());e.KeepaliveManager=d.default,e.Client=i.default,u(os(),e),u(_r(),e);var g=Ti();Object.defineProperty(e,"ReasonCodes",{enumerable:!0,get:function(){return g.ReasonCodes}})}),XS=M(e=>{_(),v(),m();var o=e&&e.__createBinding||(Object.create?function(i,s,a,c){c===void 0&&(c=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(i,c,h)}:function(i,s,a,c){c===void 0&&(c=a),i[c]=s[a]}),t=e&&e.__setModuleDefault||(Object.create?function(i,s){Object.defineProperty(i,"default",{enumerable:!0,value:s})}:function(i,s){i.default=s}),n=e&&e.__importStar||function(i){if(i&&i.__esModule)return i;var s={};if(i!=null)for(var a in i)a!=="default"&&Object.prototype.hasOwnProperty.call(i,a)&&o(s,i,a);return t(s,i),s},u=e&&e.__exportStar||function(i,s){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&o(s,i,a)};Object.defineProperty(e,"__esModule",{value:!0});var r=n(ml());e.default=r,u(ml(),e)});const mqtt=XS();/*! Bundled license information:

@jspm/core/nodelibs/browser/buffer.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=e;function e(o,t){for(var n=new Array(arguments.length-1),u=0,r=2,i=!0;r<arguments.length;)n[u++]=arguments[r++];return new Promise(function(a,c){n[u]=function(d){if(i)if(i=!1,d)c(d);else{for(var g=new Array(arguments.length-1),b=0;b<g.length;)g[b++]=arguments[b];a.apply(null,g)}};try{o.apply(t||null,n)}catch(h){i&&(i=!1,c(h))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(e){var o=e;o.length=function(s){var a=s.length;if(!a)return 0;for(var c=0;--a%4>1&&s.charAt(a)==="=";)++c;return Math.ceil(s.length*3)/4-c};for(var t=new Array(64),n=new Array(123),u=0;u<64;)n[t[u]=u<26?u+65:u<52?u+71:u<62?u-4:u-59|43]=u++;o.encode=function(s,a,c){for(var h=null,d=[],g=0,b=0,w;a<c;){var E=s[a++];switch(b){case 0:d[g++]=t[E>>2],w=(E&3)<<4,b=1;break;case 1:d[g++]=t[w|E>>4],w=(E&15)<<2,b=2;break;case 2:d[g++]=t[w|E>>6],d[g++]=t[E&63],b=0;break}g>8191&&((h||(h=[])).push(String.fromCharCode.apply(String,d)),g=0)}return b&&(d[g++]=t[w],d[g++]=61,b===1&&(d[g++]=61)),h?(g&&h.push(String.fromCharCode.apply(String,d.slice(0,g))),h.join("")):String.fromCharCode.apply(String,d.slice(0,g))};var r="invalid encoding";o.decode=function(s,a,c){for(var h=c,d=0,g,b=0;b<s.length;){var w=s.charCodeAt(b++);if(w===61&&d>1)break;if((w=n[w])===void 0)throw Error(r);switch(d){case 0:g=w,d=1;break;case 1:a[c++]=g<<2|(w&48)>>4,g=w,d=2;break;case 2:a[c++]=(g&15)<<4|(w&60)>>2,g=w,d=3;break;case 3:a[c++]=(g&3)<<6|w,d=0;break}}if(d===1)throw Error(r);return c-h},o.test=function(s){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(s)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=e;function e(){this._listeners={}}return e.prototype.on=function(t,n,u){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:n,ctx:u||this}),this},e.prototype.off=function(t,n){if(t===void 0)this._listeners={};else if(n===void 0)this._listeners[t]=[];else for(var u=this._listeners[t],r=0;r<u.length;)u[r].fn===n?u.splice(r,1):++r;return this},e.prototype.emit=function(t){var n=this._listeners[t];if(n){for(var u=[],r=1;r<arguments.length;)u.push(arguments[r++]);for(r=0;r<n.length;)n[r].fn.apply(n[r++].ctx,u)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=e(e);function e(r){return typeof Float32Array<"u"?function(){var i=new Float32Array([-0]),s=new Uint8Array(i.buffer),a=s[3]===128;function c(b,w,E){i[0]=b,w[E]=s[0],w[E+1]=s[1],w[E+2]=s[2],w[E+3]=s[3]}function h(b,w,E){i[0]=b,w[E]=s[3],w[E+1]=s[2],w[E+2]=s[1],w[E+3]=s[0]}r.writeFloatLE=a?c:h,r.writeFloatBE=a?h:c;function d(b,w){return s[0]=b[w],s[1]=b[w+1],s[2]=b[w+2],s[3]=b[w+3],i[0]}function g(b,w){return s[3]=b[w],s[2]=b[w+1],s[1]=b[w+2],s[0]=b[w+3],i[0]}r.readFloatLE=a?d:g,r.readFloatBE=a?g:d}():function(){function i(a,c,h,d){var g=c<0?1:0;if(g&&(c=-c),c===0)a(1/c>0?0:2147483648,h,d);else if(isNaN(c))a(2143289344,h,d);else if(c>34028234663852886e22)a((g<<31|2139095040)>>>0,h,d);else if(c<11754943508222875e-54)a((g<<31|Math.round(c/1401298464324817e-60))>>>0,h,d);else{var b=Math.floor(Math.log(c)/Math.LN2),w=Math.round(c*Math.pow(2,-b)*8388608)&8388607;a((g<<31|b+127<<23|w)>>>0,h,d)}}r.writeFloatLE=i.bind(null,o),r.writeFloatBE=i.bind(null,t);function s(a,c,h){var d=a(c,h),g=(d>>31)*2+1,b=d>>>23&255,w=d&8388607;return b===255?w?NaN:g*(1/0):b===0?g*1401298464324817e-60*w:g*Math.pow(2,b-150)*(w+8388608)}r.readFloatLE=s.bind(null,n),r.readFloatBE=s.bind(null,u)}(),typeof Float64Array<"u"?function(){var i=new Float64Array([-0]),s=new Uint8Array(i.buffer),a=s[7]===128;function c(b,w,E){i[0]=b,w[E]=s[0],w[E+1]=s[1],w[E+2]=s[2],w[E+3]=s[3],w[E+4]=s[4],w[E+5]=s[5],w[E+6]=s[6],w[E+7]=s[7]}function h(b,w,E){i[0]=b,w[E]=s[7],w[E+1]=s[6],w[E+2]=s[5],w[E+3]=s[4],w[E+4]=s[3],w[E+5]=s[2],w[E+6]=s[1],w[E+7]=s[0]}r.writeDoubleLE=a?c:h,r.writeDoubleBE=a?h:c;function d(b,w){return s[0]=b[w],s[1]=b[w+1],s[2]=b[w+2],s[3]=b[w+3],s[4]=b[w+4],s[5]=b[w+5],s[6]=b[w+6],s[7]=b[w+7],i[0]}function g(b,w){return s[7]=b[w],s[6]=b[w+1],s[5]=b[w+2],s[4]=b[w+3],s[3]=b[w+4],s[2]=b[w+5],s[1]=b[w+6],s[0]=b[w+7],i[0]}r.readDoubleLE=a?d:g,r.readDoubleBE=a?g:d}():function(){function i(a,c,h,d,g,b){var w=d<0?1:0;if(w&&(d=-d),d===0)a(0,g,b+c),a(1/d>0?0:2147483648,g,b+h);else if(isNaN(d))a(0,g,b+c),a(2146959360,g,b+h);else if(d>17976931348623157e292)a(0,g,b+c),a((w<<31|2146435072)>>>0,g,b+h);else{var E;if(d<22250738585072014e-324)E=d/5e-324,a(E>>>0,g,b+c),a((w<<31|E/4294967296)>>>0,g,b+h);else{var T=Math.floor(Math.log(d)/Math.LN2);T===1024&&(T=1023),E=d*Math.pow(2,-T),a(E*4503599627370496>>>0,g,b+c),a((w<<31|T+1023<<20|E*1048576&1048575)>>>0,g,b+h)}}}r.writeDoubleLE=i.bind(null,o,0,4),r.writeDoubleBE=i.bind(null,t,4,0);function s(a,c,h,d,g){var b=a(d,g+c),w=a(d,g+h),E=(w>>31)*2+1,T=w>>>20&2047,R=4294967296*(w&1048575)+b;return T===2047?R?NaN:E*(1/0):T===0?E*5e-324*R:E*Math.pow(2,T-1075)*(R+4503599627370496)}r.readDoubleLE=s.bind(null,n,0,4),r.readDoubleBE=s.bind(null,u,4,0)}(),r}function o(r,i,s){i[s]=r&255,i[s+1]=r>>>8&255,i[s+2]=r>>>16&255,i[s+3]=r>>>24}function t(r,i,s){i[s]=r>>>24,i[s+1]=r>>>16&255,i[s+2]=r>>>8&255,i[s+3]=r&255}function n(r,i){return(r[i]|r[i+1]<<8|r[i+2]<<16|r[i+3]<<24)>>>0}function u(r,i){return(r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(e){var o=e;o.length=function(n){for(var u=0,r=0,i=0;i<n.length;++i)r=n.charCodeAt(i),r<128?u+=1:r<2048?u+=2:(r&64512)===55296&&(n.charCodeAt(i+1)&64512)===56320?(++i,u+=4):u+=3;return u},o.read=function(n,u,r){var i=r-u;if(i<1)return"";for(var s=null,a=[],c=0,h;u<r;)h=n[u++],h<128?a[c++]=h:h>191&&h<224?a[c++]=(h&31)<<6|n[u++]&63:h>239&&h<365?(h=((h&7)<<18|(n[u++]&63)<<12|(n[u++]&63)<<6|n[u++]&63)-65536,a[c++]=55296+(h>>10),a[c++]=56320+(h&1023)):a[c++]=(h&15)<<12|(n[u++]&63)<<6|n[u++]&63,c>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),c=0);return s?(c&&s.push(String.fromCharCode.apply(String,a.slice(0,c))),s.join("")):String.fromCharCode.apply(String,a.slice(0,c))},o.write=function(n,u,r){for(var i=r,s,a,c=0;c<n.length;++c)s=n.charCodeAt(c),s<128?u[r++]=s:s<2048?(u[r++]=s>>6|192,u[r++]=s&63|128):(s&64512)===55296&&((a=n.charCodeAt(c+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++c,u[r++]=s>>18|240,u[r++]=s>>12&63|128,u[r++]=s>>6&63|128,u[r++]=s&63|128):(u[r++]=s>>12|224,u[r++]=s>>6&63|128,u[r++]=s&63|128);return r-i}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=e;function e(o,t,n){var u=n||8192,r=u>>>1,i=null,s=u;return function(c){if(c<1||c>r)return o(c);s+c>u&&(i=o(u),s=0);var h=t.call(i,s,s+=c);return s&7&&(s=(s|7)+1),h}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=o;var e=requireMinimal$1();function o(r,i){this.lo=r>>>0,this.hi=i>>>0}var t=o.zero=new o(0,0);t.toNumber=function(){return 0},t.zzEncode=t.zzDecode=function(){return this},t.length=function(){return 1};var n=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(i){if(i===0)return t;var s=i<0;s&&(i=-i);var a=i>>>0,c=(i-a)/4294967296>>>0;return s&&(c=~c>>>0,a=~a>>>0,++a>4294967295&&(a=0,++c>4294967295&&(c=0))),new o(a,c)},o.from=function(i){if(typeof i=="number")return o.fromNumber(i);if(e.isString(i))if(e.Long)i=e.Long.fromString(i);else return o.fromNumber(parseInt(i,10));return i.low||i.high?new o(i.low>>>0,i.high>>>0):t},o.prototype.toNumber=function(i){if(!i&&this.hi>>>31){var s=~this.lo+1>>>0,a=~this.hi>>>0;return s||(a=a+1>>>0),-(s+a*4294967296)}return this.lo+this.hi*4294967296},o.prototype.toLong=function(i){return e.Long?new e.Long(this.lo|0,this.hi|0,!!i):{low:this.lo|0,high:this.hi|0,unsigned:!!i}};var u=String.prototype.charCodeAt;return o.fromHash=function(i){return i===n?t:new o((u.call(i,0)|u.call(i,1)<<8|u.call(i,2)<<16|u.call(i,3)<<24)>>>0,(u.call(i,4)|u.call(i,5)<<8|u.call(i,6)<<16|u.call(i,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var i=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^i)>>>0,this.lo=(this.lo<<1^i)>>>0,this},o.prototype.zzDecode=function(){var i=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^i)>>>0,this.hi=(this.hi>>>1^i)>>>0,this},o.prototype.length=function(){var i=this.lo,s=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return a===0?s===0?i<16384?i<128?1:2:i<2097152?3:4:s<16384?s<128?5:6:s<2097152?7:8:a<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(e){var o=e;o.asPromise=requireAspromise(),o.base64=requireBase64(),o.EventEmitter=requireEventemitter(),o.float=requireFloat(),o.inquire=requireInquire(),o.utf8=requireUtf8(),o.pool=requirePool(),o.LongBits=requireLongbits(),o.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),o.global=o.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r},o.isString=function(r){return typeof r=="string"||r instanceof String},o.isObject=function(r){return r&&typeof r=="object"},o.isset=o.isSet=function(r,i){var s=r[i];return s!=null&&r.hasOwnProperty(i)?typeof s!="object"||(Array.isArray(s)?s.length:Object.keys(s).length)>0:!1},o.Buffer=function(){try{var u=o.inquire("buffer").Buffer;return u.prototype.utf8Write?u:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(r){return typeof r=="number"?o.Buffer?o._Buffer_allocUnsafe(r):new o.Array(r):o.Buffer?o._Buffer_from(r):typeof Uint8Array>"u"?r:new Uint8Array(r)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(r){return r?o.LongBits.from(r).toHash():o.LongBits.zeroHash},o.longFromHash=function(r,i){var s=o.LongBits.fromHash(r);return o.Long?o.Long.fromBits(s.lo,s.hi,i):s.toNumber(!!i)};function t(u,r,i){for(var s=Object.keys(r),a=0;a<s.length;++a)(u[s[a]]===void 0||!i)&&(u[s[a]]=r[s[a]]);return u}o.merge=t,o.lcFirst=function(r){return r.charAt(0).toLowerCase()+r.substring(1)};function n(u){function r(i,s){if(!(this instanceof r))return new r(i,s);Object.defineProperty(this,"message",{get:function(){return i}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:new Error().stack||""}),s&&t(this,s)}return r.prototype=Object.create(Error.prototype,{constructor:{value:r,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return u},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),r}o.newError=n,o.ProtocolError=n("ProtocolError"),o.oneOfGetter=function(r){for(var i={},s=0;s<r.length;++s)i[r[s]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(i[a[c]]===1&&this[a[c]]!==void 0&&this[a[c]]!==null)return a[c]}},o.oneOfSetter=function(r){return function(i){for(var s=0;s<r.length;++s)r[s]!==i&&delete this[r[s]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var u=o.Buffer;if(!u){o._Buffer_from=o._Buffer_allocUnsafe=null;return}o._Buffer_from=u.from!==Uint8Array.from&&u.from||function(i,s){return new u(i,s)},o._Buffer_allocUnsafe=u.allocUnsafe||function(i){return new u(i)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=a;var e=requireMinimal$1(),o,t=e.LongBits,n=e.base64,u=e.utf8;function r(T,R,I){this.fn=T,this.len=R,this.next=void 0,this.val=I}function i(){}function s(T){this.head=T.head,this.tail=T.tail,this.len=T.len,this.next=T.states}function a(){this.len=0,this.head=new r(i,0,0),this.tail=this.head,this.states=null}var c=function(){return e.Buffer?function(){return(a.create=function(){return new o})()}:function(){return new a}};a.create=c(),a.alloc=function(R){return new e.Array(R)},e.Array!==Array&&(a.alloc=e.pool(a.alloc,e.Array.prototype.subarray)),a.prototype._push=function(R,I,k){return this.tail=this.tail.next=new r(R,I,k),this.len+=I,this};function h(T,R,I){R[I]=T&255}function d(T,R,I){for(;T>127;)R[I++]=T&127|128,T>>>=7;R[I]=T}function g(T,R){this.len=T,this.next=void 0,this.val=R}g.prototype=Object.create(r.prototype),g.prototype.fn=d,a.prototype.uint32=function(R){return this.len+=(this.tail=this.tail.next=new g((R=R>>>0)<128?1:R<16384?2:R<2097152?3:R<268435456?4:5,R)).len,this},a.prototype.int32=function(R){return R<0?this._push(b,10,t.fromNumber(R)):this.uint32(R)},a.prototype.sint32=function(R){return this.uint32((R<<1^R>>31)>>>0)};function b(T,R,I){for(;T.hi;)R[I++]=T.lo&127|128,T.lo=(T.lo>>>7|T.hi<<25)>>>0,T.hi>>>=7;for(;T.lo>127;)R[I++]=T.lo&127|128,T.lo=T.lo>>>7;R[I++]=T.lo}a.prototype.uint64=function(R){var I=t.from(R);return this._push(b,I.length(),I)},a.prototype.int64=a.prototype.uint64,a.prototype.sint64=function(R){var I=t.from(R).zzEncode();return this._push(b,I.length(),I)},a.prototype.bool=function(R){return this._push(h,1,R?1:0)};function w(T,R,I){R[I]=T&255,R[I+1]=T>>>8&255,R[I+2]=T>>>16&255,R[I+3]=T>>>24}a.prototype.fixed32=function(R){return this._push(w,4,R>>>0)},a.prototype.sfixed32=a.prototype.fixed32,a.prototype.fixed64=function(R){var I=t.from(R);return this._push(w,4,I.lo)._push(w,4,I.hi)},a.prototype.sfixed64=a.prototype.fixed64,a.prototype.float=function(R){return this._push(e.float.writeFloatLE,4,R)},a.prototype.double=function(R){return this._push(e.float.writeDoubleLE,8,R)};var E=e.Array.prototype.set?function(R,I,k){I.set(R,k)}:function(R,I,k){for(var W=0;W<R.length;++W)I[k+W]=R[W]};return a.prototype.bytes=function(R){var I=R.length>>>0;if(!I)return this._push(h,1,0);if(e.isString(R)){var k=a.alloc(I=n.length(R));n.decode(R,k,0),R=k}return this.uint32(I)._push(E,I,R)},a.prototype.string=function(R){var I=u.length(R);return I?this.uint32(I)._push(u.write,I,R):this._push(h,1,0)},a.prototype.fork=function(){return this.states=new s(this),this.head=this.tail=new r(i,0,0),this.len=0,this},a.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new r(i,0,0),this.len=0),this},a.prototype.ldelim=function(){var R=this.head,I=this.tail,k=this.len;return this.reset().uint32(k),k&&(this.tail.next=R.next,this.tail=I,this.len+=k),this},a.prototype.finish=function(){for(var R=this.head.next,I=this.constructor.alloc(this.len),k=0;R;)R.fn(R.val,I,k),k+=R.len,R=R.next;return I},a._configure=function(T){o=T,a.create=c(),o._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=t;var e=requireWriter();(t.prototype=Object.create(e.prototype)).constructor=t;var o=requireMinimal$1();function t(){e.call(this)}t._configure=function(){t.alloc=o._Buffer_allocUnsafe,t.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&o.Buffer.prototype.set.name==="set"?function(r,i,s){i.set(r,s)}:function(r,i,s){if(r.copy)r.copy(i,s,0,r.length);else for(var a=0;a<r.length;)i[s++]=r[a++]}},t.prototype.bytes=function(r){o.isString(r)&&(r=o._Buffer_from(r,"base64"));var i=r.length>>>0;return this.uint32(i),i&&this._push(t.writeBytesBuffer,i,r),this};function n(u,r,i){u.length<40?o.utf8.write(u,r,i):r.utf8Write?r.utf8Write(u,i):r.write(u,i)}return t.prototype.string=function(r){var i=o.Buffer.byteLength(r);return this.uint32(i),i&&this._push(n,i,r),this},t._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=r;var e=requireMinimal$1(),o,t=e.LongBits,n=e.utf8;function u(d,g){return RangeError("index out of range: "+d.pos+" + "+(g||1)+" > "+d.len)}function r(d){this.buf=d,this.pos=0,this.len=d.length}var i=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new r(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new r(g);throw Error("illegal buffer")},s=function(){return e.Buffer?function(b){return(r.create=function(E){return e.Buffer.isBuffer(E)?new o(E):i(E)})(b)}:i};r.create=s(),r.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,r.prototype.uint32=function(){var g=4294967295;return function(){if(g=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(g=(g|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return g}}(),r.prototype.int32=function(){return this.uint32()|0},r.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(g&1)|0};function a(){var d=new t(0,0),g=0;if(this.len-this.pos>4){for(;g<4;++g)if(d.lo=(d.lo|(this.buf[this.pos]&127)<<g*7)>>>0,this.buf[this.pos++]<128)return d;if(d.lo=(d.lo|(this.buf[this.pos]&127)<<28)>>>0,d.hi=(d.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return d;g=0}else{for(;g<3;++g){if(this.pos>=this.len)throw u(this);if(d.lo=(d.lo|(this.buf[this.pos]&127)<<g*7)>>>0,this.buf[this.pos++]<128)return d}return d.lo=(d.lo|(this.buf[this.pos++]&127)<<g*7)>>>0,d}if(this.len-this.pos>4){for(;g<5;++g)if(d.hi=(d.hi|(this.buf[this.pos]&127)<<g*7+3)>>>0,this.buf[this.pos++]<128)return d}else for(;g<5;++g){if(this.pos>=this.len)throw u(this);if(d.hi=(d.hi|(this.buf[this.pos]&127)<<g*7+3)>>>0,this.buf[this.pos++]<128)return d}throw Error("invalid varint encoding")}r.prototype.bool=function(){return this.uint32()!==0};function c(d,g){return(d[g-4]|d[g-3]<<8|d[g-2]<<16|d[g-1]<<24)>>>0}r.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return c(this.buf,this.pos+=4)},r.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return c(this.buf,this.pos+=4)|0};function h(){if(this.pos+8>this.len)throw u(this,8);return new t(c(this.buf,this.pos+=4),c(this.buf,this.pos+=4))}return r.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var g=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},r.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var g=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},r.prototype.bytes=function(){var g=this.uint32(),b=this.pos,w=this.pos+g;if(w>this.len)throw u(this,g);if(this.pos+=g,Array.isArray(this.buf))return this.buf.slice(b,w);if(b===w){var E=e.Buffer;return E?E.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,b,w)},r.prototype.string=function(){var g=this.bytes();return n.read(g,0,g.length)},r.prototype.skip=function(g){if(typeof g=="number"){if(this.pos+g>this.len)throw u(this,g);this.pos+=g}else do if(this.pos>=this.len)throw u(this);while(this.buf[this.pos++]&128);return this},r.prototype.skipType=function(d){switch(d){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(d=this.uint32()&7)!==4;)this.skipType(d);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+d+" at offset "+this.pos)}return this},r._configure=function(d){o=d,r.create=s(),o._configure();var g=e.Long?"toLong":"toNumber";e.merge(r.prototype,{int64:function(){return a.call(this)[g](!1)},uint64:function(){return a.call(this)[g](!0)},sint64:function(){return a.call(this).zzDecode()[g](!1)},fixed64:function(){return h.call(this)[g](!0)},sfixed64:function(){return h.call(this)[g](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=t;var e=requireReader();(t.prototype=Object.create(e.prototype)).constructor=t;var o=requireMinimal$1();function t(n){e.call(this,n)}return t._configure=function(){o.Buffer&&(t.prototype._slice=o.Buffer.prototype.slice)},t.prototype.string=function(){var u=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+u,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+u,this.len))},t._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=o;var e=requireMinimal$1();(o.prototype=Object.create(e.EventEmitter.prototype)).constructor=o;function o(t,n,u){if(typeof t!="function")throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!n,this.responseDelimited=!!u}return o.prototype.rpcCall=function t(n,u,r,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return e.asPromise(t,a,n,u,r,i);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(n,u[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(h,d){if(h)return a.emit("error",h,n),s(h);if(d===null){a.end(!0);return}if(!(d instanceof r))try{d=r[a.responseDelimited?"decodeDelimited":"decode"](d)}catch(g){return a.emit("error",g,n),s(g)}return a.emit("data",d,n),s(null,d)})}catch(c){a.emit("error",c,n),setTimeout(function(){s(c)},0);return}},o.prototype.end=function(n){return this.rpcImpl&&(n||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(e){var o=e;o.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(e){var o=e;o.build="minimal",o.Writer=requireWriter(),o.BufferWriter=requireWriter_buffer(),o.Reader=requireReader(),o.BufferReader=requireReader_buffer(),o.util=requireMinimal$1(),o.rpc=requireRpc(),o.roots=requireRoots(),o.configure=t;function t(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}t()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const $Reader=minimalExports.Reader,$Writer=minimalExports.Writer,$util=minimalExports.util,$root=minimalExports.roots.default||(minimalExports.roots.default={}),models=$root.models=(()=>{const e={};return e.EncapMessage=function(){function o(t){if(t)for(let n=Object.keys(t),u=0;u<n.length;++u)t[n[u]]!=null&&(this[n[u]]=t[n[u]])}return o.prototype.type=0,o.prototype.payload=$util.newBuffer([]),o.prototype.context=null,o.create=function(n){return new o(n)},o.encode=function(n,u){return u||(u=$Writer.create()),n.type!=null&&Object.hasOwnProperty.call(n,"type")&&u.uint32(8).int32(n.type),n.payload!=null&&Object.hasOwnProperty.call(n,"payload")&&u.uint32(18).bytes(n.payload),n.context!=null&&Object.hasOwnProperty.call(n,"context")&&$root.models.EventContext.encode(n.context,u.uint32(26).fork()).ldelim(),u},o.encodeDelimited=function(n,u){return this.encode(n,u).ldelim()},o.decode=function(n,u,r){n instanceof $Reader||(n=$Reader.create(n));let i=u===void 0?n.len:n.pos+u,s=new $root.models.EncapMessage;for(;n.pos<i;){let a=n.uint32();if(a===r)break;switch(a>>>3){case 1:{s.type=n.int32();break}case 2:{s.payload=n.bytes();break}case 3:{s.context=$root.models.EventContext.decode(n,n.uint32());break}default:n.skipType(a&7);break}}return s},o.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},o.verify=function(n){if(typeof n!="object"||n===null)return"object expected";if(n.type!=null&&n.hasOwnProperty("type")&&!$util.isInteger(n.type))return"type: integer expected";if(n.payload!=null&&n.hasOwnProperty("payload")&&!(n.payload&&typeof n.payload.length=="number"||$util.isString(n.payload)))return"payload: buffer expected";if(n.context!=null&&n.hasOwnProperty("context")){let u=$root.models.EventContext.verify(n.context);if(u)return"context."+u}return null},o.fromObject=function(n){if(n instanceof $root.models.EncapMessage)return n;let u=new $root.models.EncapMessage;if(n.type!=null&&(u.type=n.type|0),n.payload!=null&&(typeof n.payload=="string"?$util.base64.decode(n.payload,u.payload=$util.newBuffer($util.base64.length(n.payload)),0):n.payload.length>=0&&(u.payload=n.payload)),n.context!=null){if(typeof n.context!="object")throw TypeError(".models.EncapMessage.context: object expected");u.context=$root.models.EventContext.fromObject(n.context)}return u},o.toObject=function(n,u){u||(u={});let r={};return u.defaults&&(r.type=0,u.bytes===String?r.payload="":(r.payload=[],u.bytes!==Array&&(r.payload=$util.newBuffer(r.payload))),r.context=null),n.type!=null&&n.hasOwnProperty("type")&&(r.type=n.type),n.payload!=null&&n.hasOwnProperty("payload")&&(r.payload=u.bytes===String?$util.base64.encode(n.payload,0,n.payload.length):u.bytes===Array?Array.prototype.slice.call(n.payload):n.payload),n.context!=null&&n.hasOwnProperty("context")&&(r.context=$root.models.EventContext.toObject(n.context,u)),r},o.prototype.toJSON=function(){return this.constructor.toObject(this,minimalExports.util.toJSONOptions)},o.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/models.EncapMessage"},o}(),e.EventContext=function(){function o(t){if(t)for(let n=Object.keys(t),u=0;u<n.length;++u)t[n[u]]!=null&&(this[n[u]]=t[n[u]])}return o.prototype.action=0,o.prototype.source="",o.create=function(n){return new o(n)},o.encode=function(n,u){return u||(u=$Writer.create()),n.action!=null&&Object.hasOwnProperty.call(n,"action")&&u.uint32(8).int32(n.action),n.source!=null&&Object.hasOwnProperty.call(n,"source")&&u.uint32(18).string(n.source),u},o.encodeDelimited=function(n,u){return this.encode(n,u).ldelim()},o.decode=function(n,u,r){n instanceof $Reader||(n=$Reader.create(n));let i=u===void 0?n.len:n.pos+u,s=new $root.models.EventContext;for(;n.pos<i;){let a=n.uint32();if(a===r)break;switch(a>>>3){case 1:{s.action=n.int32();break}case 2:{s.source=n.string();break}default:n.skipType(a&7);break}}return s},o.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},o.verify=function(n){return typeof n!="object"||n===null?"object expected":n.action!=null&&n.hasOwnProperty("action")&&!$util.isInteger(n.action)?"action: integer expected":n.source!=null&&n.hasOwnProperty("source")&&!$util.isString(n.source)?"source: string expected":null},o.fromObject=function(n){if(n instanceof $root.models.EventContext)return n;let u=new $root.models.EventContext;return n.action!=null&&(u.action=n.action|0),n.source!=null&&(u.source=String(n.source)),u},o.toObject=function(n,u){u||(u={});let r={};return u.defaults&&(r.action=0,r.source=""),n.action!=null&&n.hasOwnProperty("action")&&(r.action=n.action),n.source!=null&&n.hasOwnProperty("source")&&(r.source=n.source),r},o.prototype.toJSON=function(){return this.constructor.toObject(this,minimalExports.util.toJSONOptions)},o.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/models.EventContext"},o}(),e.Tick=function(){function o(t){if(t)for(let n=Object.keys(t),u=0;u<n.length;++u)t[n[u]]!=null&&(this[n[u]]=t[n[u]])}return o.prototype.symbol="",o.prototype.matchPrice=0,o.prototype.matchQtty=0,o.prototype.time=null,o.prototype.side=0,o.prototype.session=0,o.create=function(n){return new o(n)},o.encode=function(n,u){return u||(u=$Writer.create()),n.symbol!=null&&Object.hasOwnProperty.call(n,"symbol")&&u.uint32(10).string(n.symbol),n.matchPrice!=null&&Object.hasOwnProperty.call(n,"matchPrice")&&u.uint32(17).double(n.matchPrice),n.matchQtty!=null&&Object.hasOwnProperty.call(n,"matchQtty")&&u.uint32(25).double(n.matchQtty),n.time!=null&&Object.hasOwnProperty.call(n,"time")&&$root.models.Timestamp.encode(n.time,u.uint32(34).fork()).ldelim(),n.side!=null&&Object.hasOwnProperty.call(n,"side")&&u.uint32(40).int32(n.side),n.session!=null&&Object.hasOwnProperty.call(n,"session")&&u.uint32(48).int32(n.session),u},o.encodeDelimited=function(n,u){return this.encode(n,u).ldelim()},o.decode=function(n,u,r){n instanceof $Reader||(n=$Reader.create(n));let i=u===void 0?n.len:n.pos+u,s=new $root.models.Tick;for(;n.pos<i;){let a=n.uint32();if(a===r)break;switch(a>>>3){case 1:{s.symbol=n.string();break}case 2:{s.matchPrice=n.double();break}case 3:{s.matchQtty=n.double();break}case 4:{s.time=$root.models.Timestamp.decode(n,n.uint32());break}case 5:{s.side=n.int32();break}case 6:{s.session=n.int32();break}default:n.skipType(a&7);break}}return s},o.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},o.verify=function(n){if(typeof n!="object"||n===null)return"object expected";if(n.symbol!=null&&n.hasOwnProperty("symbol")&&!$util.isString(n.symbol))return"symbol: string expected";if(n.matchPrice!=null&&n.hasOwnProperty("matchPrice")&&typeof n.matchPrice!="number")return"matchPrice: number expected";if(n.matchQtty!=null&&n.hasOwnProperty("matchQtty")&&typeof n.matchQtty!="number")return"matchQtty: number expected";if(n.time!=null&&n.hasOwnProperty("time")){let u=$root.models.Timestamp.verify(n.time);if(u)return"time."+u}return n.side!=null&&n.hasOwnProperty("side")&&!$util.isInteger(n.side)?"side: integer expected":n.session!=null&&n.hasOwnProperty("session")&&!$util.isInteger(n.session)?"session: integer expected":null},o.fromObject=function(n){if(n instanceof $root.models.Tick)return n;let u=new $root.models.Tick;if(n.symbol!=null&&(u.symbol=String(n.symbol)),n.matchPrice!=null&&(u.matchPrice=Number(n.matchPrice)),n.matchQtty!=null&&(u.matchQtty=Number(n.matchQtty)),n.time!=null){if(typeof n.time!="object")throw TypeError(".models.Tick.time: object expected");u.time=$root.models.Timestamp.fromObject(n.time)}return n.side!=null&&(u.side=n.side|0),n.session!=null&&(u.session=n.session|0),u},o.toObject=function(n,u){u||(u={});let r={};return u.defaults&&(r.symbol="",r.matchPrice=0,r.matchQtty=0,r.time=null,r.side=0,r.session=0),n.symbol!=null&&n.hasOwnProperty("symbol")&&(r.symbol=n.symbol),n.matchPrice!=null&&n.hasOwnProperty("matchPrice")&&(r.matchPrice=u.json&&!isFinite(n.matchPrice)?String(n.matchPrice):n.matchPrice),n.matchQtty!=null&&n.hasOwnProperty("matchQtty")&&(r.matchQtty=u.json&&!isFinite(n.matchQtty)?String(n.matchQtty):n.matchQtty),n.time!=null&&n.hasOwnProperty("time")&&(r.time=$root.models.Timestamp.toObject(n.time,u)),n.side!=null&&n.hasOwnProperty("side")&&(r.side=n.side),n.session!=null&&n.hasOwnProperty("session")&&(r.session=n.session),r},o.prototype.toJSON=function(){return this.constructor.toObject(this,minimalExports.util.toJSONOptions)},o.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/models.Tick"},o}(),e.Timestamp=function(){function o(t){if(t)for(let n=Object.keys(t),u=0;u<n.length;++u)t[n[u]]!=null&&(this[n[u]]=t[n[u]])}return o.prototype.seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,o.prototype.nanos=0,o.create=function(n){return new o(n)},o.encode=function(n,u){return u||(u=$Writer.create()),n.seconds!=null&&Object.hasOwnProperty.call(n,"seconds")&&u.uint32(8).int64(n.seconds),n.nanos!=null&&Object.hasOwnProperty.call(n,"nanos")&&u.uint32(16).int32(n.nanos),u},o.encodeDelimited=function(n,u){return this.encode(n,u).ldelim()},o.decode=function(n,u,r){n instanceof $Reader||(n=$Reader.create(n));let i=u===void 0?n.len:n.pos+u,s=new $root.models.Timestamp;for(;n.pos<i;){let a=n.uint32();if(a===r)break;switch(a>>>3){case 1:{s.seconds=n.int64();break}case 2:{s.nanos=n.int32();break}default:n.skipType(a&7);break}}return s},o.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},o.verify=function(n){return typeof n!="object"||n===null?"object expected":n.seconds!=null&&n.hasOwnProperty("seconds")&&!$util.isInteger(n.seconds)&&!(n.seconds&&$util.isInteger(n.seconds.low)&&$util.isInteger(n.seconds.high))?"seconds: integer|Long expected":n.nanos!=null&&n.hasOwnProperty("nanos")&&!$util.isInteger(n.nanos)?"nanos: integer expected":null},o.fromObject=function(n){if(n instanceof $root.models.Timestamp)return n;let u=new $root.models.Timestamp;return n.seconds!=null&&($util.Long?(u.seconds=$util.Long.fromValue(n.seconds)).unsigned=!1:typeof n.seconds=="string"?u.seconds=parseInt(n.seconds,10):typeof n.seconds=="number"?u.seconds=n.seconds:typeof n.seconds=="object"&&(u.seconds=new $util.LongBits(n.seconds.low>>>0,n.seconds.high>>>0).toNumber())),n.nanos!=null&&(u.nanos=n.nanos|0),u},o.toObject=function(n,u){u||(u={});let r={};if(u.defaults){if($util.Long){let i=new $util.Long(0,0,!1);r.seconds=u.longs===String?i.toString():u.longs===Number?i.toNumber():i}else r.seconds=u.longs===String?"0":0;r.nanos=0}return n.seconds!=null&&n.hasOwnProperty("seconds")&&(typeof n.seconds=="number"?r.seconds=u.longs===String?String(n.seconds):n.seconds:r.seconds=u.longs===String?$util.Long.prototype.toString.call(n.seconds):u.longs===Number?new $util.LongBits(n.seconds.low>>>0,n.seconds.high>>>0).toNumber():n.seconds),n.nanos!=null&&n.hasOwnProperty("nanos")&&(r.nanos=n.nanos),r},o.prototype.toJSON=function(){return this.constructor.toObject(this,minimalExports.util.toJSONOptions)},o.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/models.Timestamp"},o}(),e})(),_hoisted_1=["title"],_hoisted_2=["title"],_hoisted_3=["title"],_hoisted_4=["title"],_hoisted_5=createBaseVNode("i",{class:"far fa-angle-double-right"},null,-1),_hoisted_6=[_hoisted_5],_sfc_main={__name:"Chart",emits:["showPendingOrders","showMatchedOrders","showVpsOtpPopup"],setup(e,{expose:o,emit:t}){const n=useStore(),u=useRoute(),{t:r}=useI18n(),i=inject("mf"),s=inject("devices"),a=inject("filters"),c=t,h=ref(null),d=ref(null),g=ref(null),b=ref(null),w=ref(null),E=ref(null),T=ref(null),R=ref(null),I=ref(null),k=ref(null),W=ref(null),Q=ref(null),U=ref(null),D=format(new Date,"yyyy-MM-dd"),V={START:getUnixTime(new Date(`${D}T08:45:00Z`)),ATO:getUnixTime(new Date(`${D}T09:00:00Z`)),ATC:getUnixTime(new Date(`${D}T14:30:00Z`)),END:getUnixTime(new Date(`${D}T14:45:00Z`))},ae={FIREANT:"wss://tradestation.fireant.vn/quote-lite?access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSIsImtpZCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSJ9.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4iLCJhdWQiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4vcmVzb3VyY2VzIiwiZXhwIjoxODg5NjIyNTMwLCJuYmYiOjE1ODk2MjI1MzAsImNsaWVudF9pZCI6ImZpcmVhbnQudHJhZGVzdGF0aW9uIiwic2NvcGUiOlsiYWNhZGVteS1yZWFkIiwiYWNhZGVteS13cml0ZSIsImFjY291bnRzLXJlYWQiLCJhY2NvdW50cy13cml0ZSIsImJsb2ctcmVhZCIsImNvbXBhbmllcy1yZWFkIiwiZmluYW5jZS1yZWFkIiwiaW5kaXZpZHVhbHMtcmVhZCIsImludmVzdG9wZWRpYS1yZWFkIiwib3JkZXJzLXJlYWQiLCJvcmRlcnMtd3JpdGUiLCJwb3N0cy1yZWFkIiwicG9zdHMtd3JpdGUiLCJzZWFyY2giLCJzeW1ib2xzLXJlYWQiLCJ1c2VyLWRhdGEtcmVhZCIsInVzZXItZGF0YS13cml0ZSIsInVzZXJzLXJlYWQiXSwianRpIjoiMjYxYTZhYWQ2MTQ5Njk1ZmJiYzcwODM5MjM0Njc1NWQifQ.dA5-HVzWv-BRfEiAd24uNBiBxASO-PAyWeWESovZm_hj4aXMAZA1-bWNZeXt88dqogo18AwpDQ-h6gefLPdZSFrG5umC1dVWaeYvUnGm62g4XS29fj6p01dhKNNqrsu5KrhnhdnKYVv9VdmbmqDfWR8wDgglk5cJFqalzq6dJWJInFQEPmUs9BW_Zs8tQDn-i5r4tYq2U8vCdqptXoM7YgPllXaPVDeccC9QNu2Xlp9WUvoROzoQXg25lFub1IYkTrM66gJ6t9fJRZToewCt495WNEOQFa_rwLCZ1QwzvL0iYkONHS_jZ0BOhBCdW9dWSawD6iF1SIQaFROvMDH1rg",VPS:"wss://datafeed.vps.com.vn/socket.io/?EIO=3&transport=websocket",DNSE:"wss://datafeed-krx.dnse.com.vn/wss"};let $={ohlcMap:new Map,chart:{},series:{},whitespaces:[],crosshair:{},interval:null,refreshAt:subSeconds(new Date,11),statusAt:subSeconds(new Date,21),websocket:null,socketStop:!1,socketUpdatedAt:subSeconds(new Date,61),hasProgress:!1};const xe=reactive({prices:[],chartDate:u.query.date??D,clock:format(new Date,"HH:mm:ss"),chartHeightEnough:!1,isSocketWarning:!1,TIME:V}),N=computed(()=>n.state.tradingDerivative.status),le=computed(()=>n.state.tradingDerivative.config),Le=computed(()=>n.state.tradingDerivative.isLoading);$.interval=setInterval(()=>{xe.clock=format(new Date,"HH:mm:ss"),te()&&(U.value&&U.value.cancelWithoutClose(),differenceInSeconds(new Date,new Date($.refreshAt))>10&&(le.value.autoRefresh&&R.value.refresh(),$.refreshAt=new Date),differenceInSeconds(new Date,new Date($.statusAt))>20&&(Ne(),$.statusAt=new Date))},1e3),y(),onMounted(()=>{S(),ge(),R.value.createSeries($.chart),W.value.createSeries($.chart),I.value.createSeries($.chart),new ResizeObserver(ie).observe(h.value),document.addEventListener("keydown",Te)}),onUnmounted(()=>{qe(),document.removeEventListener("keydown",Te),clearInterval($.interval),ve(),$.socketStop=!0}),watch(()=>n.state.tradingDerivative.chartData,Se),o({connectSocket:Ce,closeAllOrders:st});function ge(){const Re={localization:{dateFormat:"dd/MM/yyyy",locale:"vi-VN"},rightPriceScale:{visible:!0,scaleMargins:{top:.25,bottom:.25}},leftPriceScale:{visible:!1},layout:{backgroundColor:"#000000",textColor:"#CCCCCC"},grid:{vertLines:{color:"#1B1E27",style:2},horzLines:{color:"#1B1E27",style:2}},crosshair:{mode:1},timeScale:{timeVisible:!0,rightOffset:1e3,minBarSpacing:.01,barSpacing:.05}};$.chart=createChart(d.value,Re),$.chart.subscribeCrosshairMove(J),$.chart.subscribeCustomPriceLineDragged(pe),$.series.whitespace=$.chart.addHistogramSeries({priceScaleId:"whitespace",scaleMargins:{top:0,bottom:0},color:"#808080",lastValueVisible:!1,priceLineVisible:!1}),$.series.price=$.chart.addCandlestickSeries({upColor:"#F5F5F5",downColor:"#F5F5F5",borderVisible:!1,wickUpColor:"#F5F5F5",wickDownColor:"#F5F5F5",priceFormat:{minMove:.1}})}function qe(){$.chart&&($.chart.remove(),$.chart=null)}function We(Re){ke($.hasProgress),R.value.isSelected()?R.value.draw($.crosshair):I.value.isSelected()?I.value.draw($.crosshair):k.value.isSelected()?k.value.draw($.crosshair):W.value.isSelected()?W.value.draw($.crosshair):Q.value.isSelected()&&Q.value.draw($.crosshair)}function H(Re){Re.preventDefault()}function ye(Re){Re.stopPropagation()}function G(Re){Re.preventDefault(),Re.stopPropagation()}function ie(){h.value&&(S(),$.chart.resize(h.value.offsetWidth,h.value.offsetHeight),w.value.checkFullscreen())}function S(){xe.chartHeightEnough=h.value.offsetHeight>700}function J(Re){if(Re.time){let He=Re.seriesPrices.get($.series.price);He||(He=Ye(Re.point.y)),$.crosshair.time=Re.time,$.crosshair.price=He}else s.phone||($.crosshair.time=null,$.crosshair.price=null);Re.point!==void 0&&($.crosshair.x=Re.point.x,$.crosshair.y=Re.point.y)}function pe(Re){let He=Re.customPriceLine,Ve=He.options();Ve.price=i.fmtNum(Ve.price);const ze=+Re.fromPriceString,at=Ve.price;switch(Ve.lineType){case"order":U.value.drag({line:He,lineOptions:Ve,oldPrice:ze,newPrice:at});break;case"line":k.value.drag({lineOptions:Ve,oldPrice:ze,newPrice:at});break;case"target":Q.value.drag({lineOptions:Ve,newPrice:at});break;case"pattern":R.value.drag({lineOptions:Ve});break}}function Te(Re){const He=$.chart.timeScale(),Ve=$.chart.options().timeScale.barSpacing;switch(Re.key){case"[":Re.ctrlKey?He.applyOptions({barSpacing:Ve-.01}):Re.altKey&&He.scrollToPosition(He.scrollPosition()-50);break;case"]":Re.ctrlKey?He.applyOptions({barSpacing:Ve+.01}):Re.altKey&&He.scrollToPosition(He.scrollPosition()+50);break}}function Se(Re){xe.chartDate===D&&te()||(Re.length>0&&($.whitespaces=oe($.whitespaces,C(xe.chartDate))),$.series.whitespace.setData($.whitespaces),yt(Re))}function P(Re,He){He?(Ke(),$.whitespaces=oe($.whitespaces,C(D)),$.series.whitespace.setData($.whitespaces),yt(Re)):mt(Re)}function C(Re){const He=getUnixTime(new Date(`${Re}T09:00:00Z`)),Ve=getUnixTime(new Date(`${Re}T11:30:00Z`)),ze=getUnixTime(new Date(`${Re}T13:00:00Z`)),at=getUnixTime(new Date(`${Re}T14:30:00Z`)),Xe=getUnixTime(new Date(`${Re}T13:00:00Z`)),ht=getUnixTime(new Date(`${Re}T14:00:00Z`));let Dt=[];for(let Rt=He;Rt<=at;Rt++){if(Rt>Ve&&Rt<ze)continue;let Ct={time:Rt};(Rt===Xe||Rt===ht||Rt===at)&&(Ct.value=1),Dt.push(Ct)}if(xe.chartDate===D){const Rt=getUnixTime(new Date(`${Re}T17:00:00Z`));for(let Ct=at+1;Ct<=Rt;Ct++){let Ft={time:Ct};Dt.push(Ft)}}return Dt}function oe(Re,He){return Array.from(new Map([...Re,...He].sort((Ve,ze)=>Ve.time-ze.time).map(Ve=>[Ve.time,Ve])).values())}async function Ce(){if(te()){await ve();const Re=le.value.source,He=ae[Re],Ve=()=>{$.socketStop||(xe.isSocketWarning=!0,Ce())};Re==="DNSE"?($.websocket=mqtt.connect(He,{username:"entrade",password:"entrade"}),$.websocket.on("close",Ve),z(),ee()):($.websocket=new WebSocket(He),$.websocket.onclose=Ve,Re==="FIREANT"?he():(Ie(),L()))}}async function ve(){const Re=le.value.source;$.websocket&&(Re==="DNSE"?$.websocket.connected:$.websocket.readyState===WebSocket.OPEN)?(Re==="DNSE"?$.websocket.end():$.websocket.close(),await new Promise(Ve=>{const ze=setInterval(()=>{(!$.websocket||(Re==="DNSE"?$.websocket.disconnected:$.websocket.readyState===WebSocket.CLOSED))&&($.websocket=null,clearInterval(ze),Ve())},100)})):$.websocket=null}function he(){n.dispatch("tradingDerivative/setLoading",!0),$.websocket.onopen=Re=>{if($.websocket.readyState===WebSocket.OPEN){let He='{"protocol":"json","version":1}';$.websocket.send(He),He='{"arguments":["VN30F1M"],"invocationId":"0","target":"SubscribeTrades","type":1}',$.websocket.send(He)}},$.websocket.onmessage=Re=>{xe.isSocketWarning=!1,je(Re.data).forEach(Ve=>{if(!Ve)return!1;if(Ve.type===3)Ve.result[0].date.slice(0,10)===D&&(console.log("FIREANT-first",Ve.result),P(Ve.result,!0)),n.dispatch("tradingDerivative/setLoading",!1);else if(Ve.type===1&&Ve.target==="UpdateTrades"&&Ve.arguments[0]==="VN30F1M"){console.log("FIREANT",Ve.arguments[1]),U.value.scan(Ve.arguments[1].at(-1).price);let ze=Ve.arguments[1];ze.sort((at,Xe)=>at.date===Xe.date?at.id-Xe.id:new Date(at.date)-new Date(Xe.date)),P(ze)}})}}function je(Re){let He=[];return Re.split("").forEach(Ve=>{const ze=Ve.indexOf("{"),at=Ve.lastIndexOf("}");let Xe=null;if(ze!==-1&&at!==-1&&at>ze){const ht=Ve.substring(ze,at+1);ht!=="{}"&&(Xe=JSON.parse(ht))}He.push(Xe)}),He}function Ie(){$.websocket.onopen=Re=>{if($.websocket.readyState===WebSocket.OPEN){const He={action:"join",list:le.value.vn30f1m},Ve=`42${JSON.stringify(["regs",JSON.stringify(He)])}`;$.websocket.send(Ve)}},$.websocket.onmessage=Re=>{if(xe.isSocketWarning=!1,Re.data.substr(0,1)==="4"&&Re.data.substr(1,1)==="2"){const He=JSON.parse(Re.data.substr(2));if(He[0]==="stockps"){const Ve=He[1].data;Ve.id===3220&&(console.log("VPS",Ve),U.value.scan(Ve.lastPrice),P([Ve]))}}}}function L(){differenceInSeconds(new Date,new Date($.socketUpdatedAt))>60&&(n.dispatch("tradingDerivative/getVpsData").then(Re=>{P(Re,!0),console.log("VPS-first: ",Re)}),$.socketUpdatedAt=new Date)}function z(){$.websocket.on("connect",()=>{if($.websocket.connected){const Re=`quotes/krx/mdds/tick/v1/roundlot/symbol/${le.value.vn30f1m}`;$.websocket.subscribe(Re)}}),$.websocket.on("message",(Re,He)=>{xe.isSocketWarning=!1;var Ve=models.EncapMessage.decode(He);if(console.log("encapMsg",Ve),Ve.type===41){let ze=decodeTick(Ve.payload);U.value.scan(ze.matchPrice);const at=new Date(ze.time.seconds.low*1e3);ze.time=at.toISOString(),console.log("DNSE: ",ze),P([ze])}})}function ee(){differenceInSeconds(new Date,new Date($.socketUpdatedAt))>60&&(n.dispatch("tradingDerivative/getDnseData").then(Re=>{P(Re,!0),console.log("DNSE-first: ",Re)}),$.socketUpdatedAt=new Date)}function De(Re=!1){R.value.refresh(Re)}function ke(Re=!1){Re||T.value.hide(),k.value.hide(),U.value.hide()}function K(Re){s.phone||T.value.hide(i.isSet(Re)),T.value.set(Re),$.hasProgress=!!Re.step}function de(Re){U.value.setPatternOrder(Re)}function F(){$.chart.timeScale().scrollToRealTime()}function te(){const Re=getUnixTime(addHours(new Date,7));return le.value.openingMarket&&Re>=V.START&&Re<=V.END}function ue(){if(!xe.chartDate)return!1;A()}function Ue(){$.whitespaces=[],xe.bars=[],$.socketUpdatedAt=subSeconds(new Date,61),Ce(),A()}function p(){c("showPendingOrders")}function f(){c("showMatchedOrders")}function y(){n.dispatch("tradingDerivative/initChart").then(()=>{Ce(),!u.query.date&&le.value.lastOpeningDate&&(xe.chartDate=le.value.lastOpeningDate),A()})}function A(){n.dispatch("tradingDerivative/getChartData",xe.chartDate).then(Re=>{Re&&Ke()})}function j(){N.value.connection?Ne():se()}function se(){c("showVpsOtpPopup")}function Ne(){n.dispatch("tradingDerivative/getStatus")}function Ke(){n.dispatch("tradingDerivative/getTools")}function rt(){n.dispatch("tradingDerivative/getAccountInfo").then(Re=>{let He="";He+='<div style="width: 200px;">',He+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${r("trading.derivative.accountInfoPopup.nav")}</div><div>: ${a.currency(Re.nav)}</div></div>`,He+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${r("trading.derivative.accountInfoPopup.maxVol")}</div><div>: ${a.numberVnFormat(Re.maxVol)}</div></div>`,He+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${r("trading.derivative.accountInfoPopup.vm")}</div><div>: ${a.currency(Re.vm)}</div></div>`,He+=`<div style="display: flex;"><div style="flex: 0 0 75px;">${r("trading.derivative.accountInfoPopup.fee")}</div><div>: ${a.currency(Re.fee)}</div></div>`,He+="</div>",alert(He,r("trading.derivative.accountInfoPopup.title"))})}function st(){U.value.closeAllOrders()}function Ye(Re){return i.fmtNum($.series.price.coordinateToPrice(Re))}function et(Re){let He=$.whitespaces.findIndex(Ve=>Ve.time===Re);if(He===-1)try{const Ve=format(new Date(Re*1e3),"yyyy-MM-dd"),ze=getUnixTime(new Date(`${Ve}T11:30:00Z`)),at=getUnixTime(new Date(`${Ve}T13:00:00Z`)),Xe=getUnixTime(new Date(`${Ve}T14:30:00Z`));Re>ze&&Re<at?Re=ze:Re>Xe&&(Re=Xe),He=$.whitespaces.findIndex(ht=>ht.time===Re)}catch(Ve){console.log("error",Ve)}return He}function Qe(Re){return Re<$.whitespaces.length?$.whitespaces[Re].time:$.whitespaces.at(-1).time}function ct(Re,He=!1){if(He)$.series.price.removePriceLine(Re);else return $.series.price.createPriceLine(Re)}function yt(Re){Re.forEach(Ve=>{let ze,at,Xe;switch(le.value.source){case"FIREANT":ze=addHours(new Date(Ve.date),7),Xe=Ve.price;break;case"VPS":ze=new Date(`${D}T${Ve.time}Z`),Xe=Ve.lastPrice;break;case"DNSE":ze=addHours(new Date(Ve.sendingTime),7),Xe=Ve.matchPrice;break}if(at=getUnixTime(ze),ze=formatISO(ze),$.ohlcMap.has(at)){const ht=$.ohlcMap.get(at);ht.high=Math.max(ht.high,Xe),ht.low=Math.min(ht.low,Xe),ht.open=Xe,ht.close=Xe}else{const ht={date:ze,time:at,open:Xe,high:Xe,low:Xe,close:Xe};$.ohlcMap.set(at,ht)}});const He=Array.from($.ohlcMap.values()).sort((Ve,ze)=>new Date(Ve.time)-new Date(ze.time));$.series.price.setData(He),xe.bars=He}function mt(Re){switch(le.value.source){case"FIREANT":Re.sort((Ve,ze)=>Ve.date===ze.date?Ve.id-ze.id:new Date(Ve.date)-new Date(ze.date));break;case"VPS":Re.sort((Ve,ze)=>Ve.time===ze.time?Number(Ve.sID)-Number(ze.sID):_t(Ve.time)-_t(ze.time));break}Re.forEach(Ve=>{let ze,at,Xe;switch(le.value.source){case"FIREANT":ze=addHours(new Date(Ve.date),7),Xe=Ve.price;break;case"VPS":ze=new Date(`${D}T${Ve.time}Z`),Xe=Ve.lastPrice;break;case"DNSE":ze=addHours(new Date(Ve.time),7),Xe=Ve.matchPrice;break}if(at=getUnixTime(ze),ze=formatISO(ze),$.ohlcMap.has(at))try{const ht=$.ohlcMap.get(at);ht.high=Math.max(ht.high,Xe),ht.low=Math.min(ht.low,Xe),ht.open=Xe,ht.close=Xe,$.series.price.update(ht)}catch{return}else{const ht={date:ze,time:at,open:Xe,high:Xe,low:Xe,close:Xe};$.series.price.update(ht),$.ohlcMap.set(at,ht)}});const He=Array.from($.ohlcMap.values());xe.bars=He}function _t(Re){const[He,Ve,ze]=Re.split(":").map(Number);return He*3600+Ve*60+ze}return(Re,He)=>(openBlock(),createElementBlock("div",{ref_key:"chartContainerRef",ref:h,class:"derivative-chart",onClick:We,onContextmenu:H},[createBaseVNode("div",{ref_key:"chartRef",ref:d},null,512),createBaseVNode("div",{class:"area data-area",onClick:ye,onContextmenu:G},[createBaseVNode("div",{ref_key:"connectionRef",ref:g,class:normalizeClass(["command",{yellow:N.value.pendingOrders.length>0,red:le.value.volInvalid}]),title:Re.$t("trading.derivative.connection"),onClick:j,onContextmenu:p},[createBaseVNode("i",{class:normalizeClass(["far",{"fa-link-simple":N.value.connection,"fa-link-simple-slash":!N.value.connection,blink:xe.isSocketWarning}])},null,2)],42,_hoisted_1),createBaseVNode("div",{class:normalizeClass(["command status",{green:N.value.position>0,red:N.value.position<0}]),title:Re.$t("trading.derivative.position"),onClick:rt,onContextmenu:f},toDisplayString(N.value.position),43,_hoisted_2),createBaseVNode("div",{class:"command clock",onClick:Ce},toDisplayString(xe.clock),1),withDirectives(createBaseVNode("input",{type:"date",class:"chart-date command",title:Re.$t("trading.derivative.date"),"onUpdate:modelValue":He[0]||(He[0]=Ve=>xe.chartDate=Ve),onChange:ue},null,40,_hoisted_3),[[vModelText,xe.chartDate]]),createBaseVNode("div",{ref_key:"reloadToolRef",ref:b,class:"command",title:Re.$t("trading.derivative.reload"),onClick:Ue,onContextmenu:Ke},[createBaseVNode("i",{class:normalizeClass(["far fa-sync-alt",{"fa-spin":Le.value}])},null,2)],40,_hoisted_4)],32),createBaseVNode("div",{class:"area tool-area",onClick:ye,onContextmenu:G},[createVNode(_sfc_main$9,{ref_key:"fullscreenToolRef",ref:w,chartContainerRef:h.value},null,8,["chartContainerRef"]),createVNode(_sfc_main$a,{ref_key:"tradingviewToolRef",ref:E,vpsUser:le.value.vpsUser,vpsSession:le.value.vpsSession,chartContainerRef:h.value,symbol:"VN30F1M",timeframe:"15"},null,8,["vpsUser","vpsSession","chartContainerRef"]),createVNode(_sfc_main$6,{ref_key:"progressToolRef",ref:T,chartHeightEnough:xe.chartHeightEnough,onRefreshPattern:He[1]||(He[1]=()=>De(!0)),onHideContext:ke},null,8,["chartHeightEnough"]),createVNode(_sfc_main$5,{ref_key:"patternToolRef",ref:R,bars:xe.bars,pickTimeToolRef:I.value,timeToIndex:et,indexToTime:Qe,onSetProgress:K,onSetPatternOrder:de,onHideContext:ke},null,8,["bars","pickTimeToolRef"]),createVNode(_sfc_main$4,{ref_key:"pickTimeToolRef",ref:I,onRefreshPattern:He[2]||(He[2]=()=>De()),onHideContext:ke},null,512),createVNode(_sfc_main$3,{ref_key:"timeRangeToolRef",ref:W,timeToIndex:et,indexToTime:Qe,onHideContext:ke},null,512),createVNode(_sfc_main$b,{ref_key:"lineToolRef",ref:k,symbol:"VN30F1M",storeModule:"tradingDerivative",drawPriceLine:ct,onHideContext:ke},null,512),createVNode(_sfc_main$c,{ref_key:"targetToolRef",ref:Q,symbol:"VN30F1M",storeModule:"tradingDerivative",drawPriceLine:ct,levels:[.5,1,2,4],isPercent:!1,showPercent:!0,onHideContext:ke},null,512),createVNode(_sfc_main$1,{ref_key:"orderToolRef",ref:U,position:N.value.position,drawPriceLine:ct,inSession:te,TIME:xe.TIME,onHideContext:ke},null,8,["position","TIME"])],32),createBaseVNode("div",null,[createBaseVNode("div",{class:"chart-top",onClick:F},_hoisted_6)])],544))}};export{_sfc_main as default};
