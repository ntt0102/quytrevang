import{x as k,y as D,z as $,G as O,c as m,d as R,e as i,w as l,B as o,i as q,C as x,N as B,D as g,o as f,R as n,F as S,s as N,f as w,Q as C}from"./app-950811ac.js";import{_ as I}from"./PickImagePopup-1dbc3a91.js";import"./FileManager-a0a9b165.js";import"./exporter-6fc9ee04.js";import"./row_dragging-505d7467.js";import"./dialog-a4c4ca08.js";const A={class:"content-block dx-card responsive-paddings"},P=["onSubmit"],G={__name:"Notification",setup(T){const b=x(),v=B(),{t:s}=k(),y=g("bus"),r=g("mt"),p=D(null),t=$({formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:s("settings.notification.receiver")+r.validations.required}],title:[{type:"required",message:s("settings.notification.notificationTitle")+r.validations.required}],body:[{type:"required",message:s("settings.notification.body")+r.validations.required}]}});t.actionOptions=c(t.formData.actions),t.addActionOptions={icon:"add",text:s("buttons.add"),onClick:()=>{t.formData.actions.push(""),t.actionOptions=c(t.formData.actions)}},O(()=>{t.formData.receiver=v.query.codes||null,setTimeout(()=>{p.value.instance.getEditor("receiver").focus()},500)});function h(){y.emit("checkPin",()=>{b.dispatch("setting/sendNotification",t.formData)})}function c(e){let u=[];for(let a=0;a<e.length;a++)u.push(_(a));return u}function _(e){return{placeholder:s("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{t.formData.actions.splice(e,1),t.actionOptions=c(t.formData.actions)}}}]}}return(e,u)=>(f(),m("div",A,[R("form",{class:"setting-notification-page",onSubmit:q(h,["prevent"])},[i(o(C),{ref_key:"formRef",ref:p,"form-data":t.formData,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:l(()=>[i(o(n),{"item-type":"group"},{default:l(()=>[i(o(n),{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:e.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>e.$router.push({name:"users",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:e.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),i(o(n),{"data-field":"title","validation-rules":t.validationRules.title,label:{text:e.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"body","validation-rules":t.validationRules.body,label:{text:e.$t("settings.notification.body")}},null,8,["validation-rules","label"]),i(o(n),{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>e.$refs.pickImagePopupRef.show({clientPath:"notifications",callback:a=>t.formData.image=a})},name:"pickImage",location:"after"}]},label:{text:e.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),i(o(n),{"item-type":"group",caption:e.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[i(o(n),{"item-type":"group",name:"actions"},{default:l(()=>[(f(!0),m(S,null,N(t.actionOptions,(a,d)=>(f(),w(o(n),{key:"action"+(d+1),"data-field":"actions["+d+"]","editor-options":a,label:{text:e.$t("settings.notification.action.title")+" "+(d+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),i(o(n),{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),i(o(n),{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:e.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],40,P),i(I,{ref:"pickImagePopupRef"},null,512)]))}};export{G as default};
