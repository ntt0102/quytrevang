import y from"./Chart-D8pMGtuV.js";import{u as k,r as x,c as r,a as C,L as _,b as $,e as p,g as A,h as B,j as I,k as W,x as f,m as L,o as O,l as T}from"./app-C4N23e75.js";import{s as E}from"./subYears-CRB8KRbE.js";import"./lightweight-charts.esm.development-DLnB4uYX.js";const M={class:"share-page content-block dx-card responsive-paddings"},G={__name:"Index",setup(P){const e=B(),g=I(),{t:s}=k(),u=W("bus"),n=x(null),m=r(()=>e.state.tradingShare.groups),d=r(()=>e.state.tradingShare.symbols.length),h=r(()=>e.state.tradingShare.config.source),w=r(()=>e.state.tradingShare.config.sources),i=r(()=>e.state.tradingShare.filterProcess),o=C({group:g.query.list??"",fromDate:E(new Date,5),watchlistActions:[{icon:"far fa-heart-circle-plus small",text:s("trading.share.filterWatchList"),value:!0},{icon:"far fa-heart-circle-minus small",text:s("trading.share.deleteWatchList"),value:!1}]});e.dispatch("tradingShare/getGroups"),_(()=>{e.dispatch("tradingShare/resetState")});function l({component:t}){const a=t.option("value");o.group=a!==null?a.trim().toUpperCase():"",e.dispatch("tradingShare/getSymbols",o.group)}function v({value:t}){o.fromDate=t,n.value.getChartData(!0,t)}function b({item:t}){e.dispatch("tradingShare/setSource",t)}function S({itemData:t}){u.emit("checkPin",()=>{const a={multi:!0,group:o.group,add:t.value};e.dispatch("tradingShare/changeWatchlist",a).then(c=>{n.value.updateWatchlist(c)})})}function D(){const t=o.group;if(!t)return f.warning(s("trading.share.filterGroupWarning"));const a=n.value.getFilterTimes();if(a.length<2)return f.warning(s("trading.share.filterTimeWarning"));u.emit("checkPin",()=>{e.dispatch("tradingShare/filterSymbols",{group:t,filterTimes:a})})}return(t,a)=>{const c=L("DxToolbar");return O(),$("div",M,[p(c,{items:[{visible:t.$mf.isSet(t.$route.query),location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:t.$t("buttons.back"),onClick:()=>t.$router.go(-1)}},{location:"before",widget:"dxDateBox",options:{width:"25",type:"date",elementAttr:{class:"from-date"},hint:A(T)(o.fromDate,"dd/MM/yyyy"),value:o.fromDate,onValueChanged:v}},{location:"before",widget:"dxAutocomplete",options:{showClearButton:!0,openOnFieldClick:!0,minSearchLength:0,dataSource:m.value,value:o.group,width:"80",dropDownOptions:{width:"90"},elementAttr:{class:"symbol-group"},placeholder:t.$t("trading.share.group"),onEnterKey:l,onFocusOut:l,onItemClick:l}},{visible:d.value>0,location:"before",text:`(${d.value})`},{visible:i.value===0,location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:w.value,selectedItemKey:h.value,stylingMode:"text",useSelectMode:!0,width:"90",dropDownOptions:{width:"100"},elementAttr:{class:"source"},onSelectionChanged:b}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:o.watchlistActions,displayExpr:"text",keyExpr:"value",icon:"far fa-heart-circle-bolt small",dropDownOptions:{width:"220"},onItemClick:S}},{location:"after",widget:"dxButton",options:{icon:"far fa-filter small",hint:t.$t("trading.share.filterSymbols"),onClick:D}},{visible:i.value>0,location:"after",text:`(${i.value}%)`}]},null,8,["items"]),p(y,{source:h.value,fromDate:o.fromDate,group:o.group,ref_key:"chartRef",ref:n},null,8,["source","fromDate","group"])])}}};export{G as default};
