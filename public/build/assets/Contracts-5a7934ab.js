import{u as C,i as R,r as _,e as S,d as F,g as r,h as t,t as i,B as b,G as P,j as u,k as m,l as f,o,A as T,D as G,m as N}from"./app-bf9ede50.js";import{_ as z}from"./ContractDetailPopup-890fecc0.js";const A={class:"overview-contracts"},B={class:"sum dx-card responsive-paddings content-block"},E={class:"title"},V={key:0,class:"currency"},j={key:1},U={class:"title"},L={key:0,class:"currency"},O={key:1},q={class:"title"},H={key:0,class:"currency interest"},J={key:1},K={class:"list content-block"},M=["onClick"],Q={class:"responsive-paddings",style:{position:"relative"}},W={class:"info"},X={class:"interest-rate"},Y={class:"date"},Z={class:"currency"},x={class:"principal"},I={class:"interest"},ee=100,h=4,ne={__name:"Contracts",setup(te){const d=C(),g=R("mf"),p=_(null),v=_(null),y=S(()=>d.state.auth.user.level),a=F({gridData:null,asset:null,principal:null,interest:null});let s={sum:{},interval:{},change:{},doneFlag:!1};d.dispatch("userContract/getContracts",!1).then(()=>{a.gridData=g.cloneDeep(d.state.userContract.contracts),k()});function D(e){e.rowType=="header"&&(e.rowElement.style.display="none")}function w(e){return`status-${e}`}function k(){s.sum=a.gridData.reduce((e,l)=>([2,3].includes(l.status)&&(e.principal+=l.principal,e.interest+=l.interest,e.asset+=l.total),e),{principal:0,interest:0,asset:0}),$(),s.interval=setInterval(()=>{c("principal"),c("interest"),c("asset"),s.doneFlag&&clearInterval(s.interval)},h)}function $(){let e=ee/h;s.change={principal:s.sum.principal/e,interest:s.sum.interest/e,asset:s.sum.asset/e}}function c(e){a[e]<s.sum[e]-s.change[e]?(a[e]+=s.change[e],s.doneFlag=!1):(a[e]=s.sum[e],s.doneFlag=!0)}return(e,l)=>(o(),r("div",A,[t("div",B,[t("div",null,[t("div",E,i(e.$t("user.overview.assetSum")),1),a.asset!=null?(o(),r("div",V,i(e.$filters.currency(a.asset.toFixed(0))),1)):(o(),r("div",j,"-"))]),t("div",null,[t("div",U,i(e.$t("user.overview.principalSum")),1),a.principal!=null?(o(),r("div",L,i(e.$filters.currency(a.principal.toFixed(0))),1)):(o(),r("div",O,"-"))]),t("div",null,[t("div",q,i(e.$t("user.overview.interestSum")),1),a.interest!=null?(o(),r("div",H,i(e.$filters.currency(a.interest.toFixed(0),"+ ")),1)):(o(),r("div",J,"-"))])]),b(t("div",K,[u(f(N),{ref_key:"dataGridRef",ref:p,"data-source":a.gridData,"key-expr":"id","show-borders":!1,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowAdding:!1,allowUpdating:!1,allowDeleting:!1},"data-row-template":"dataRowTemplate",onContentReady:l[0]||(l[0]=()=>e.$mf.dataGridPreload(a.gridData,p.value.instance)),onRowPrepared:D},{dataRowTemplate:m(({data:n})=>[t("tr",{role:"cell",class:"item",onClick:se=>v.value.show(n.data)},[t("td",null,[t("div",Q,[t("div",{class:T(["status",w(n.data.status)])},null,2),t("div",W,[t("div",null,[t("span",null,"#"+i(n.data.code),1),t("span",X,i(e.$filters.percentInterestRate(n.data.interest_rate)),1)]),t("div",Y,[t("div",null,i(e.$filters.formatDate(n.data.paid_at))+" ~ "+i(e.$filters.formatDate(n.data.withdrawn_at))+" Â  ",1),t("div",null,"("+i(n.data.duration)+")",1)])]),t("div",Z,[t("div",x,i(e.$filters.currency(n.data.principal)),1),t("div",I,i(e.$filters.currency(n.data.interest,"+ ")),1)])])])],8,M)]),default:m(()=>[u(f(G))]),_:1},8,["data-source"])],512),[[P,y.value>=6]]),u(z,{ref_key:"contractDetailPopupRef",ref:v},null,512)]))}};export{ne as default};
