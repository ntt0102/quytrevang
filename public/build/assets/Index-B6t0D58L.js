import y from"./Chart-DI87tNVy.js";import{u as k,r as x,c as s,a as C,H as A,b as I,e as p,g as _,h as $,j as B,k as T,x as f,m as W,o as E,l as O}from"./app-CAA78cf6.js";import{s as F}from"./subYears-DPH33etp.js";import"./lightweight-charts.esm.development-B7T1yR96.js";const L={class:"share-page content-block dx-card responsive-paddings"},G={__name:"Index",setup(M){const o=$(),g=B(),{t:n}=k(),d=T("bus"),r=x(null),m=s(()=>o.state.tradingShare.groups),h=s(()=>o.state.tradingShare.symbols.length),i=s(()=>o.state.tradingShare.source),v=s(()=>o.state.tradingShare.sources),l=s(()=>o.state.tradingShare.filterProcess),t=C({group:g.query.list??"",fromDate:F(new Date,5),watchlistActions:[{icon:"far fa-heart-circle-plus small",text:n("trading.share.filterWatchList"),value:!0},{icon:"far fa-heart-circle-minus small",text:n("trading.share.deleteWatchList"),value:!1}]});o.dispatch("tradingShare/getGroups"),A(()=>{o.dispatch("tradingShare/resetState")});function c({component:e}){const a=e.option("value");t.group=a!==null?a.trim().toUpperCase():"",o.dispatch("tradingShare/getSymbols",t.group)}function w({value:e}){t.fromDate=e,r.value.getChartData(!0,e)}function b({item:e}){o.dispatch("tradingShare/setSource",e),i.value==="FIREANT"?r.value.connectSocket():r.value.getChartData(!0,t.fromDate)}function S({itemData:e}){d.emit("checkPin",()=>{const a={multi:!0,group:t.group,add:e.value};o.dispatch("tradingShare/changeWatchlist",a).then(u=>{r.value.updateWatchlist(u)})})}function D(){const e=t.group;if(!e)return f.warning(n("trading.share.filterGroupWarning"));const a=r.value.getFilterTimes();if(a.length<2)return f.warning(n("trading.share.filterTimeWarning"));d.emit("checkPin",()=>{o.dispatch("tradingShare/filterSymbols",{group:e,filterTimes:a})})}return(e,a)=>{const u=W("DxToolbar");return E(),I("div",L,[p(u,{items:[{visible:e.$mf.isSet(e.$route.query),location:"before",widget:"dxButton",options:{icon:"far fa-arrow-left small",hint:e.$t("buttons.back"),onClick:()=>e.$router.go(-1)}},{location:"before",widget:"dxDateBox",options:{width:"25",type:"date",elementAttr:{class:"from-date"},hint:_(O)(t.fromDate,"dd/MM/yyyy"),value:t.fromDate,onValueChanged:w}},{location:"before",widget:"dxAutocomplete",options:{showClearButton:!0,openOnFieldClick:!0,minSearchLength:0,dataSource:m.value,value:t.group,width:"80",dropDownOptions:{width:"90"},elementAttr:{class:"symbol-group"},placeholder:e.$t("trading.share.group"),onEnterKey:c,onFocusOut:c,onItemClick:c}},{visible:h.value>0,location:"before",text:`(${h.value})`},{visible:l.value===0,location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:v.value,selectedItemKey:i.value,stylingMode:"text",useSelectMode:!0,width:"90",dropDownOptions:{width:"100"},elementAttr:{class:"source"},onSelectionChanged:b}},{location:"after",widget:"dxDropDownButton",options:{showArrowIcon:!1,items:t.watchlistActions,displayExpr:"text",keyExpr:"value",icon:"far fa-heart-circle-bolt small",dropDownOptions:{width:"220"},onItemClick:S}},{location:"after",widget:"dxButton",options:{icon:"far fa-filter small",hint:e.$t("trading.share.filterSymbols"),onClick:D}},{visible:l.value>0,location:"after",text:`(${l.value}%)`}]},null,8,["items"]),p(y,{source:i.value,fromDate:t.fromDate,group:t.group,ref_key:"chartRef",ref:r},null,8,["source","fromDate","group"])])}}};export{G as default};
