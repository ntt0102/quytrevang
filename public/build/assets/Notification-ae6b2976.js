import{u as _,r as D,a as $,x as O,b as m,d as R,e as i,f as l,g as o,s as q,h as x,j as B,k as g,o as f,a6 as a,F as S,A,n as I,a7 as N}from"./app-be61326e.js";import{_ as w}from"./PickImagePopup-f2d71e9f.js";import"./FileManager-df744bdc.js";const C={class:"content-block dx-card responsive-paddings"},z={__name:"Notification",setup(P){const b=x(),v=B(),{t:s}=_(),y=g("bus"),r=g("mt"),p=D(null),t=$({formData:{receiver:null,title:null,body:null,image:null,actions:[""]},actionOptions:null,addActionOptions:null,validationRules:{receiver:[{type:"required",message:s("settings.notification.receiver")+r.validations.required}],title:[{type:"required",message:s("settings.notification.notificationTitle")+r.validations.required}],body:[{type:"required",message:s("settings.notification.body")+r.validations.required}]}});t.actionOptions=c(t.formData.actions),t.addActionOptions={icon:"add",text:s("buttons.add"),onClick:()=>{t.formData.actions.push(""),t.actionOptions=c(t.formData.actions)}},O(()=>{t.formData.receiver=v.query.codes||null,setTimeout(()=>{p.value.instance.getEditor("receiver").focus()},500)});function h(){y.emit("checkPin",()=>{b.dispatch("setting/sendNotification",t.formData)})}function c(e){let u=[];for(let n=0;n<e.length;n++)u.push(k(n));return u}function k(e){return{placeholder:s("settings.notification.action.placeholder"),buttons:[{name:"trash",location:"after",options:{stylingMode:"text",icon:"trash",onClick:()=>{t.formData.actions.splice(e,1),t.actionOptions=c(t.formData.actions)}}}]}}return(e,u)=>(f(),m("div",C,[R("form",{class:"setting-notification-page",onSubmit:q(h,["prevent"])},[i(o(N),{ref_key:"formRef",ref:p,"form-data":t.formData,"label-location":e.$screen.getScreenSizeInfo.isXSmall?"top":"left","scrolling-enabled":!0},{default:l(()=>[i(o(a),{"item-type":"group"},{default:l(()=>[i(o(a),{"data-field":"receiver","editor-type":"dxTextBox","editor-options":{placeholder:e.$t("settings.notification.receiverPlaceholder"),buttons:[{options:{icon:"far fa-user",onClick:()=>e.$router.push({name:"admin-user",query:{selected:t.formData.receiver}})},name:"selectUsers",location:"after"}]},"validation-rules":t.validationRules.receiver,label:{text:e.$t("settings.notification.receiver")}},null,8,["editor-options","validation-rules","label"]),i(o(a),{"data-field":"title","validation-rules":t.validationRules.title,label:{text:e.$t("settings.notification.notificationTitle")}},null,8,["validation-rules","label"]),i(o(a),{"data-field":"body","validation-rules":t.validationRules.body,label:{text:e.$t("settings.notification.body")}},null,8,["validation-rules","label"]),i(o(a),{"data-field":"image","editor-type":"dxTextBox","editor-options":{buttons:[{options:{icon:"far fa-image",onClick:()=>e.$refs.pickImagePopupRef.show({clientPath:"notifications",callback:n=>t.formData.image=n})},name:"pickImage",location:"after"}]},label:{text:e.$t("settings.notification.image")}},null,8,["editor-options","label"])]),_:1}),i(o(a),{"item-type":"group",caption:e.$t("settings.notification.action.title"),name:"actions-container"},{default:l(()=>[i(o(a),{"item-type":"group",name:"actions"},{default:l(()=>[(f(!0),m(S,null,A(t.actionOptions,(n,d)=>(f(),I(o(a),{key:"action"+(d+1),"data-field":"actions["+d+"]","editor-options":n,label:{text:e.$t("settings.notification.action.title")+" "+(d+1)}},null,8,["data-field","editor-options","label"]))),128))]),_:1}),i(o(a),{"item-type":"button","button-options":t.addActionOptions,"horizontal-alignment":"left"},null,8,["button-options"])]),_:1},8,["caption"]),i(o(a),{"item-type":"button","button-options":{width:100,left:0,type:"default",icon:"far fa-paper-plane",text:e.$t("buttons.send"),useSubmitBehavior:!0}},null,8,["button-options"])]),_:1},8,["form-data","label-location"])],32),i(w,{ref:"pickImagePopupRef"},null,512)]))}};export{z as default};
