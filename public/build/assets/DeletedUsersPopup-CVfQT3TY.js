import{r as g,a as $,w as x,p as C,f as c,_ as R,h as I,k as w,m as T,o as U,e as i,g as l,n as s}from"./app-e7TxAvT7.js";const _={__name:"DeletedUsersPopup",setup(z,{expose:h}){const m=I(),v=w("bus"),r=w("mf"),t=g(null),p=g(null),d=$({gridData:null});x(()=>m.state.adminUser.deletedUsers,e=>{d.gridData=r.cloneDeep(e)});function y(){p.value.show()}function D(e){v.emit("checkPin",()=>{e.isDeleted=!0,m.dispatch("adminUser/save",e)})}function f(e){const o=t.value.instance.option("editing.changes").find(a=>a.type=="update"&&a.key==e);return r.isSet(o)}function k(e){let o=t.value.instance.option("editing.changes");o=o.filter(a=>!(a.type=="update"&&a.key==e)),t.value.instance.option("editing.changes",o)}function u(e){const o=t.value.instance.option("editing.changes").find(a=>a.type=="remove"&&a.key==e);return r.isSet(o)}function b(){}function S(){}return h({show:y}),(e,o)=>{const a=T("DxToolbar");return U(),C(R,{ref_key:"popupRef",ref:p,title:e.$t("admin.users.deletedUsers"),onShown:b,onHidden:S},{default:c(()=>[i(l(s.DxDataGrid),{ref_key:"dataGridRef",ref:t,"data-source":d.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},editing:{allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:o[0]||(o[0]=n=>e.$mf.dataGridPreload(d.gridData,t.value.instance)),onSaved:D},{commandCellTemplate:c(({data:n})=>[i(a,{items:[{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{disabled:u(n.key),type:"default",icon:f(n.key)?"undo":"repeat",hint:e.$t("admin.users.buttons.revert"),text:e.$t("admin.users.buttons.revert"),onClick:()=>{f(n.key)?k(n.key):t.value.instance.cellValue(n.rowIndex,"deleted_at",null),t.value.instance.repaintRows(n.rowIndex)}}},{locateInMenu:"auto",showText:"inMenu",location:"before",widget:"dxButton",options:{type:"default",icon:u(n.key)?"undo":"clearsquare",hint:e.$t("admin.users.buttons.remove"),text:e.$t("admin.users.buttons.remove"),onClick:()=>{u(n.key)?t.value.instance.undeleteRow(n.rowIndex):t.value.instance.deleteRow(n.rowIndex)}}}]},null,8,["items"])]),default:c(()=>[i(l(s.DxColumn),{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:75,type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),i(l(s.DxColumn),{"allow-editing":!1,"data-field":"code","data-type":"string",caption:e.$t("models.user.codeShort")},null,8,["caption"]),i(l(s.DxColumn),{"allow-editing":!1,"data-field":"name",caption:e.$t("models.user.name")},null,8,["caption"]),i(l(s.DxColumn),{"allow-editing":!1,"data-field":"phone",caption:e.$t("models.user.phone")},null,8,["caption"]),i(l(s.DxColumn),{"allow-editing":!1,visible:!1,"data-field":"deleted_at"})]),_:1},8,["data-source"])]),_:1},8,["title"])}}};export{_ as default};
