import{a as o,D as v}from"./data-grid-0eec16c9.js";import w from"./TransactionFinbookPopup-42a76b43.js";import{x as h,y,z as d,A as T,B as $,C as D,r as R,c as S,e as a,w as p,D as n,o as C}from"./app-1d96e4f7.js";import"./row_dragging-39c76075.js";import"./dialog-24b6b308.js";import"./exporter-1d49b0ae.js";const F={class:"finbooks-page content-block dx-card responsive-paddings"},M={__name:"Index",setup(I){const s=h(),{t:i}=y(),m=d("bus"),l=d("mt"),f=d("mf"),u=T(null),t=$({gridData:null,validationRules:{name:[{type:"required",message:i("trading.finbooks.name")+l.validations.required}],balance:[{type:"required",message:i("trading.finbooks.balance")+l.validations.required}],lastTransaction:[{type:"required",message:i("trading.finbooks.lastTransaction")+l.validations.required}],display:[{type:"required",message:i("trading.finbooks.display")+l.validations.required}]}});s.dispatch("tradingFinbook/getFinbook"),D(()=>s.state.tradingFinbook.finbooks,e=>{t.gridData=f.cloneDeep(e)});function g(e){m.emit("checkPin",()=>s.dispatch("tradingFinbook/save",{changes:e.changes}))}function b(e){e.data.last_transaction=i("trading.finbooks.openNewBook")}return(e,c)=>{const k=R("DxToolbar");return C(),S("div",F,[a(n(v),{ref_key:"dataGridRef",ref:u,"data-source":t.gridData,"key-expr":"id","show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",paging:{pageSize:10},headerFilter:{visible:!0},loadPanel:{enabled:!0},selection:{mode:"single"},editing:{allowAdding:!0,allowUpdating:!0,allowDeleting:!0,confirmDelete:!1,mode:"batch"},onContentReady:c[0]||(c[0]=r=>e.$mf.dataGridPreload(t.gridData,u.value.instance)),onInitNewRow:b,onSaved:g},{commandCellTemplate:p(({data:r})=>[a(k,{items:[{locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"far fa-envelope-open-dollar small",hint:e.$t("trading.finbooks.createTransaction"),text:e.$t("trading.finbooks.createTransaction"),onClick:()=>e.$refs.transactionFinbookPopupRef.show(r.data)}},{visible:r.data.balance==0,locateInMenu:"auto",showText:"inMenu",location:"center",widget:"dxButton",options:{type:"default",icon:"trash",hint:e.$t("buttons.delete"),text:e.$t("buttons.delete"),onClick:()=>e.dataGrid.instance.deleteRow(r.rowIndex)}}]},null,8,["items"])]),default:p(()=>[a(n(o),{fixed:!0,width:e.$screen.getScreenSizeInfo.isXSmall?35:70,alignment:"center",type:"buttons",cssClass:"dx-datagrid-command-column","cell-template":"commandCellTemplate",caption:e.$t(`titles.commandHeaderTitle${e.$screen.getScreenSizeInfo.isXSmall?"Short":""}`)},null,8,["width","caption"]),a(n(o),{"data-field":"display",dataType:"number",caption:e.$t("trading.finbooks.display"),"validation-rules":t.validationRules.display},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"name",dataType:"string","header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.name"),"validation-rules":t.validationRules.name},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"balance","data-type":"number",format:"#,##0 ₫","editor-options":{step:"1000000",format:"#,##0 ₫"},"header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.balance"),"validation-rules":t.validationRules.balance},null,8,["caption","validation-rules"]),a(n(o),{"data-field":"last_transaction",dataType:"string","header-filter":{allowSearch:!0},caption:e.$t("trading.finbooks.lastTransaction"),"validation-rules":t.validationRules.lastTransaction},null,8,["caption","validation-rules"]),a(n(o),{"allow-editing":!1,"data-field":"updated_at","data-type":"date","editor-options":{dateSerializationFormat:e.$mc.DX_SERVER_DATE_FORMAT},caption:e.$t("trading.finbooks.updatedAt")},null,8,["editor-options","caption"])]),_:1},8,["data-source"]),a(w,{ref:"transactionFinbookPopupRef"},null,512)])}}};export{M as default};
